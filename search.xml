<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>APFS、Mac OS 扩展、ExFAT格式有何区别</title>
    <url>/posts/33677/</url>
    <content><![CDATA[<h2 id="APFS"><a href="#APFS" class="headerlink" title="APFS"></a><strong>APFS</strong></h2><p>是<strong>Apple 苹果系统特有的一种文件格式</strong>，是 Mac OS High Sierra 操作系统版本时发布的；这种文件格式只能苹果 Mac OS 操作系统使用。（必须至少是 Mac OS High Sierra 版本以及更新的 Mac OS 才行，老版本的苹果系统不支持）这种系统非常牛逼，主要是<strong>针对 PCIe 闪存和 SSD 固态硬盘进行了优化</strong>；如果你是使用固态硬盘，且<strong>不考虑硬盘上的东西在 Windows 操作系统中使用，那推荐使用 APFS 硬盘格式</strong>。</p>
<h2 id="Mac-OS-扩展格式"><a href="#Mac-OS-扩展格式" class="headerlink" title="Mac OS 扩展格式"></a><strong>Mac OS 扩展格式</strong></h2><p>Mac OS Extended 是以前苹果 Mac OS 使用的文件系统，现在基本上已经淘汰了。能用 APFS 就尽量使用 APFS，与其考虑<strong>兼容旧版的 Mac OS</strong>，不如让更新旧版的 Mac OS 系统。</p>
<h2 id="Mac-OS-日志格式"><a href="#Mac-OS-日志格式" class="headerlink" title="Mac OS 日志格式"></a><strong>Mac OS 日志格式</strong></h2><p>Mac OS 操作系统有一个自带的硬盘备份工具，叫 Time Machine（时间机器）；这种硬盘格式就是<strong>专门用于 Time Machine</strong>。如果是要<strong>把这个硬盘作为备份盘</strong>，那就格式化成这种硬盘格式。</p>
<h2 id="ExFAT"><a href="#ExFAT" class="headerlink" title="ExFAT"></a><strong>ExFAT</strong></h2><p>上面说的三种硬盘格式都是专门用于苹果的 Mac OS 操作系统的，而 ExFAT 则是不仅可用于 Mac OS 苹果操作系统，还可以用于 Windows 操作系统。<strong>如果你想该硬盘的东西在 Windows 系统可以被读取，那就选择 ExFAT 操作系统</strong>。</p>
]]></content>
      <categories>
        <category>操作系统</category>
        <category>macOS</category>
      </categories>
      <tags>
        <tag>macOS</tag>
      </tags>
  </entry>
  <entry>
    <title>AppStore审核被拒原因</title>
    <url>/posts/36545/</url>
    <content><![CDATA[<h2 id="Guideline-5-1-1-Legal-Privacy-Data-Collection-and-Storage"><a href="#Guideline-5-1-1-Legal-Privacy-Data-Collection-and-Storage" class="headerlink" title="Guideline 5.1.1 - Legal - Privacy - Data Collection and Storage"></a>Guideline 5.1.1 - Legal - Privacy - Data Collection and Storage</h2><p>今天 App 审核被拒了，理由如下：</p>
<blockquote>
<p>We noticed that your app requests the user’s consent to access their contacts, camera, and photos but does not clarify the use of the contacts, camera, and photos in the applicable purpose string.</p>
</blockquote>
<p>意思就是没有对请求的相关权限进行描述，或者描述的不够准确，比如使用到了定位，相册相机，通讯录等权限，要把为什么使用这些权限做下详细描述!</p>
<p>例如一个外卖应用，获取定位后需要展示附近的美食信息。那么，相应的定位权限描述，应当是类似“获取定位信息用于为用户提供附近的美食信息”这样的描述。</p>
<a id="more"></a>

<h2 id="Guideline-5-1-2-Legal-Privacy-Data-Use-and-Sharing"><a href="#Guideline-5-1-2-Legal-Privacy-Data-Use-and-Sharing" class="headerlink" title="Guideline 5.1.2 Legal: Privacy - Data Use and Sharing"></a>Guideline 5.1.2 Legal: Privacy - Data Use and Sharing</h2><p>7 月 23 日审核又被拒了，理由如下：</p>
<blockquote>
<p>Your app accesses user data from the device but does not have the required precautions in place.</p>
<p>Next Steps</p>
<p>To collect personal data with your app, you must make it clear to the user that their personal data will be uploaded to your server and you must obtain the user’s consent before the data is uploaded. You must also have a Privacy Policy URL and ensure that the URL you provide directs users to your privacy policy.</p>
</blockquote>
<p>搜了下被拒原因：</p>
<p>App 申请了通讯录访问权限，所以必须向用户明确其个人数据将上传至应用的服务器，并且必须获得用户的同意才能上传数据。还必须拥有隐私政策 URL，并确保提供的 URL 将用户引导至提供的隐私政策上。</p>
<p>修改方案：</p>
<img src="/posts/36545/agree.jpeg" class="" title="agree">

<p>P.S. 上方点击「隐私授权协议」后，用户会跳转到我准备好的一个协议说明链接。</p>
<h3 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h3><ul>
<li><a href="http://www.jeepxie.net/article/147613.html">获取用户隐私信息，苹果审核 app 被拒（2.5.13 5.1.1 5.1.2）</a></li>
</ul>
]]></content>
      <categories>
        <category>iOS</category>
        <category>上架</category>
      </categories>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title>Axios异步请求跨域解决方案</title>
    <url>/posts/29963/</url>
    <content><![CDATA[<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><blockquote>
<p>后端 127.0.0.1（默认 80）；前端 127.0.0.1:8081</p>
</blockquote>
<p>在 vue 开发过程中使用 axios 发起 POST 请求：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">  url: <span class="string">&#x27;http://127.0.0.1&#x27;</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>

<p>会报跨域错误：</p>
<p><a href="https://gitee.com/evestorm/various_resources/raw/master/ajax/%E8%B7%A8%E5%9F%9F.png"><img src="Axios%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82%E8%B7%A8%E5%9F%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/%E8%B7%A8%E5%9F%9F.png" alt="跨域"></a></p>
<p>原因是浏览器同源策略，只有 <strong>同协议、同域名、同端口</strong> 三同的地址才能互相通过 AJAX 的方式请求。而上面情形虽然协议（http）和域名（127.0.0.1）都相同，但端口不同（80 和 8081），所以无法正常请求。</p>
<a id="more"></a>

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="方案一"><a href="#方案一" class="headerlink" title="方案一"></a>方案一</h3><p>服务端添加响应头，以 Koa 为例，在 <code>app.js</code> 中添加响应头：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  ctx.set(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这样设置会允许任何来源（*）的跨域。</p>
<p>但往往后端的某些接口是需要身份验证的，比如用户对文章、商品之类的进行评论或点赞，就需要用户登录才能操作。这种情况下就需要使用到 cookie 或者 session ，所以还得设置 <code>Access-Control-Allow-Credentials</code> 为 true ，表示在 CORS 请求中允许客户端发送 cookie 。然而一旦这样设置，<code>Access-Control-Allow-Origin</code> 就不能再是通配符 <code>*</code> ，必须指定具体的域，所以服务端最终的 header 设置为：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  ctx.set(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;http://127.0.0.1:8081&#x27;</span>);</span><br><span class="line">  ctx.set(<span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>后端这样设置后，前端就能够实现跨域请求了。</p>
<h3 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h3><p>如果服务端不加 <code>ctx.set(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);</code> 这一段。可以在 <code>@vue-cli</code> 中 <a href="https://cli.vuejs.org/zh/config/#devserver-proxy">配置代理</a> 。也就是 <strong>前端设置代理</strong> 的解决方案。</p>
<h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>利用后端不存在跨域问题，而让 vue 服务器代为获取数据。因为启动 vue 项目本质上也是用 node 启了个服务器（127.0.0.1:8080），配置了代理后，就不再是浏览器直接请求我们在 axios 中配置的 <a href="http://127.0.0.1/%EF%BC%88%E9%BB%98%E8%AE%A480%E7%AB%AF%E5%8F%A3%EF%BC%89">http://127.0.0.1/（默认80端口）</a> ，而是用 vue 启动的这个服务器去请求 <a href="http://127.0.0.1/">http://127.0.0.1/</a> 这个接口，由于后端相互之前请求不存在跨域问题，所以能获取数据，获取后给到前端。</p>
<p>在前端项目根目录下新建 <code>vue.config.js</code> 文件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="comment">// 前端 axios 发这样的请求：http://127.0.0.1:8081/api/ (8081是启动vue项目时的端口)，会被此处捕获，然后代为请求真正的服务器API地址 `http://127.0.0.1`</span></span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        target: <span class="string">&#x27;http://127.0.0.1&#x27;</span>, <span class="comment">// 此处是服务端API接口，不写端口默认80</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="前端发送-POST-跨域请求"><a href="#前端发送-POST-跨域请求" class="headerlink" title="前端发送 POST 跨域请求"></a>前端发送 POST 跨域请求</h3><p>上面也提到了，前端有时候往往不止需要发送 GET 请求，POST 请求也是常有的事儿。所以还需要对 Axios 进行如下配置：</p>
<blockquote>
<p>vue 项目下的 main.js 中全局配置 axios</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line">axios.defaults.baseURL = <span class="string">&#x27;http://127.0.0.1&#x27;</span>;</span><br><span class="line">axios.defaults.withCredentials = <span class="literal">true</span>; <span class="comment">// 让 ajax 携带 cookie</span></span><br><span class="line">axios.defaults.headers.post[<span class="string">&#x27;Content-Type&#x27;</span>] =</span><br><span class="line">  <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>; <span class="comment">// 设置post请求的头部格式</span></span><br><span class="line"></span><br><span class="line">Vue.prototype.$ajax = axios;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>由于需要把请求时的数据序列化为 url 的形式，所以要下载 qs 包</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm i qs</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在具体页面中发送 POST 请求</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> loginInfo = &#123;</span><br><span class="line">    username: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    password: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.$ajax(&#123;(&#123;</span><br><span class="line">    method: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    url: <span class="string">&#x27;http://127.0.0.1/login&#x27;</span>,</span><br><span class="line">    data: qs.stringify(login_info),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>axios</tag>
        <tag>跨域</tag>
      </tags>
  </entry>
  <entry>
    <title>BFC的理解与应用</title>
    <url>/posts/9722/</url>
    <content><![CDATA[<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>先上MDN上对 BFC 的定义：</p>
<blockquote>
<p>块格式化上下文（Block Formatting Context，BFC） 是Web页面的可视化CSS渲染的一部分，是块盒子的布局过程发生的区域，也是浮动元素与其他元素交互的区域。</p>
</blockquote>
<p>———— <a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Block_formatting_context">BFC | MDN</a></p>
<p>不知道别人看完这段定义有何感受，反正我是懵逼的。不过我在这儿还是建议各位认真阅读上面给出的MDN链接至少两遍，这能让你对一个陌生的概念有一个基本的认知。</p>
<a id="more"></a>

<h2 id="理解"><a href="#理解" class="headerlink" title="理解"></a>理解</h2><p>这里谈下我对BFC的理解：BFC其实是一个独立的，与外界隔离了的容器，容器里面的子元素不会影响到外面的元素，外面的也同样不会影响到容器内部的元素。我们可以利用这个特性，来解决一些布局上的问题。</p>
<h2 id="BFC触发条件"><a href="#BFC触发条件" class="headerlink" title="BFC触发条件"></a>BFC触发条件</h2><p>BFC的触发条件有很多，想要知道所有细节可以移步上面给出的 MDN 链接。这里我只列出一些常见触发条件：</p>
<ul>
<li>根元素（HTML元素）</li>
<li>浮动元素（float不为none）</li>
<li>绝对定位元素（position 为 absolute 或 fixed）</li>
<li>display 为 block, inline-block, flex, inline-flex, list-item, table</li>
<li>overflow 值不为 visible 的块元素</li>
</ul>
<h2 id="BFC布局特性"><a href="#BFC布局特性" class="headerlink" title="BFC布局特性"></a>BFC布局特性</h2><p>对于一个BFC容器来说：</p>
<ul>
<li>内部相邻的两个元素垂直方向上的 margin 会发生重叠</li>
<li>不会与外界的浮动元素产生交集，而是紧贴浮动元素的边缘</li>
<li>元素从容器的顶端开始垂直地一个接一个地排列</li>
<li>每一个元素的左外边缘（margin-left）会触碰到容器的左边缘（border-left）（如果设置了容器内部的元素从右到左的格式排布，则触碰的是右边缘）</li>
<li>在计算它的高度时，还会检测内部浮动或者定位元素的高度</li>
</ul>
<h2 id="实际应用"><a href="#实际应用" class="headerlink" title="实际应用"></a>实际应用</h2><h3 id="清除浮动"><a href="#清除浮动" class="headerlink" title="清除浮动"></a>清除浮动</h3><p>利用BFC “在计算它的高度时，还会检测内部浮动或者定位元素的高度” 这条特性，我们可以触发父元素的BFC来清除子元素浮动带来的影响。常见的用法是给父元素设置 <code>overflow: hidden</code> 样式（如果考虑IE6版本，还需设置 <code>zoom: 1</code>，因为IE6不支持 <code>overflow: hidden</code> 来清除浮动）：</p>
<iframe height="265" scrolling="no" title="利用BFC清除浮动" src="https://codepen.io/JingW/embed/BbxEGP/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="解决外边距合并问题"><a href="#解决外边距合并问题" class="headerlink" title="解决外边距合并问题"></a>解决外边距合并问题</h3><p>如果看上面标题不知道在说什么，请很戳<a href="http://www.w3school.com.cn/css/css_margin_collapsing.asp">这里</a>了解详情。由于属于同一个BFC的两个相邻盒子的垂直margin会发生重叠，那么我们可以隔离开这两个元素，让它们不属于同一个BFC，这样就不会发生margin重叠了。</p>
<iframe height="265" scrolling="no" title="解决外边距合并问题" src="https://codepen.io/JingW/embed/YgLbzY/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="两栏布局，右边宽度自适应"><a href="#两栏布局，右边宽度自适应" class="headerlink" title="两栏布局，右边宽度自适应"></a>两栏布局，右边宽度自适应</h3><p>我们常常在开发中有这样类似的需求：两栏布局，左边定宽，右边自适应。<br>这时我们就可以利用BFC特性来实现需求：左边设置定宽+左浮动；右边给自己加上 <code>overflow: hidden</code> 。<br>原理就是：给元素设置BFC后，为了和浮动元素不产生任何交集，它会顺着浮动元素的边缘形成自己的封闭上下文。直接上代码看效果：</p>
<iframe height="265" scrolling="no" title="利用BFC实现两栏布局" src="https://codepen.io/JingW/embed/MxGdEe/?height=265&amp;theme-id=0&amp;default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<p>以上是我对BFC的一些理解以及实际应用，希望能够帮助大家了解BFC这个听起来摸不着头脑的东西。</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>布局</tag>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>CORS详解（转载）</title>
    <url>/posts/28096/</url>
    <content><![CDATA[<h2 id="转载文章"><a href="#转载文章" class="headerlink" title="转载文章"></a>转载文章</h2><p>博客源：<a href="https://github.com/hstarorg/HstarDoc/blob/master/%E5%89%8D%E7%AB%AF%E7%9B%B8%E5%85%B3/CORS%E8%AF%A6%E8%A7%A3.md">CORS 详解</a></p>
<h2 id="关于-CORS"><a href="#关于-CORS" class="headerlink" title="关于 CORS"></a>关于 CORS</h2><p>说到 CORS，就不得不先了解跨站 HTTP 请求（Cross-site HTTP request）。</p>
<p>跨域 HTTP 请求是指发起请求的资源所在域不同于该请求所指向资源所在的域的 HTTP 请求。</p>
<p>正如大家所知，出于安全考虑，浏览器会限制脚本中发起的跨站请求。使用 XMLHttpRequest 发起 HTTP 请求必须遵守同源策略。 具体而言，Web 应用程序能且只能使用 XMLHttpRequest 对象向其加载的源域名发起 HTTP 请求，而不能向任何其它域名发起请求。</p>
<p>由于 Web 应用技术越来越丰富，我们非常渴望在不丢失安全的前提下，能够实现跨站请求。特别是现在的 Web 程序结构，一般是 HTML+REST API。在之前的实现中，我们一般采用 jsonp 来发起跨站请求，这其实是利用了 html 标签的特点。</p>
<p>W3C 的 Web 应用工作组推荐了一种新的机制，即跨域资源共享（Cross-Origin Resource Sharing），也就是当前我们提到的 CORS。</p>
<p>CORS 的核心，就是让服务器来确定是否允许跨域访问。</p>
<a id="more"></a>

<h2 id="1、典型场景"><a href="#1、典型场景" class="headerlink" title="1、典型场景"></a>1、典型场景</h2><h3 id="1-1、简单请求"><a href="#1-1、简单请求" class="headerlink" title="1.1、简单请求"></a>1.1、简单请求</h3><p>什么是简单请求？全部满足以下条件的请求可以称之为简单请求：</p>
<ol>
<li>只使用 GET、HEAD 或者 POST 请求方法。如果是 POST，则数据类型（Content-Type）只能是<code>application/x-www-form-urlencodeed</code>、<code>multipart/form-data</code>、<code>text/plain</code>中的一种。</li>
<li>没有使用自定义的请求头（如 x-token）</li>
</ol>
<p>按照这个规则，那我们的能实现跨域请求的情况如下：</p>
<p>Server 代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//之后设置了Access-Control-Allow-Origin，才会允许跨域</span></span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">  res.write(<span class="string">&#x27;abc&#x27;</span>);</span><br><span class="line">  res.end();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">10000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;started.&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Client 代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.readyState === XMLHttpRequest.DONE) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Result：&#x27;</span>, xhr.responseText);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//场景一：GET请求，不需要Header，允许跨域</span></span><br><span class="line">xhr.open(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line"><span class="comment">//场景二： POST请求，需要设置为指定Header（不设置content-type也可），允许跨域</span></span><br><span class="line">xhr.open(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="comment">//此处value必须是text/plain或者application/x-www-form-urlencoded或者multipart/form-data。</span></span><br><span class="line"><span class="comment">//此处也可以不设置</span></span><br><span class="line">xhr.setRequestHeader(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/plain&#x27;</span>);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line"><span class="comment">//场景三：DELETE请求（不允许跨域）</span></span><br><span class="line">xhr.open(<span class="string">&#x27;DELETE&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line"><span class="comment">//场景四：POST请求，有自定义Header（不允许跨域）</span></span><br><span class="line">xhr.open(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.setRequestHeader(<span class="string">&#x27;x-token&#x27;</span>, <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<h3 id="1-2、预请求"><a href="#1-2、预请求" class="headerlink" title="1.2、预请求"></a>1.2、预请求</h3><p>不同于简单请求，预请求要求必须先发送一个 OPTIONS 请求给站点，来查明该站点是否允许跨域请求，这样做的原因是为了避免跨站请求可能对目的站点的数据造成的损坏。</p>
<p>如果请求满足以下任一条件，则会产生预请求：</p>
<ol>
<li>请求以 GET、HEAD、POST 之外的方法发起。或者，使用 POST，但数据类型为<code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code> 或者 <code>text/plain</code> 以外的数据类型。（注：之前的版本只有 text/plain 可以不用发起预请求）。</li>
<li>使用了自定义请求头。</li>
</ol>
<p>按照如上规则，我们来列举几个应用场景：</p>
<p>Server 端代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//之后设置了Access-Control-Allow-Origin，才会允许跨域</span></span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;POST, DELETE, GET&#x27;</span>);</span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;x-token&#x27;</span>);</span><br><span class="line">  <span class="comment">//设置预请求缓存1天，1天内再次请求，可以跳过预请求</span></span><br><span class="line">  <span class="comment">//此功能需要客户端缓存支持，如果客户端禁用缓存，那么每次都会预请求</span></span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Max-Age&#x27;</span>, <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>);</span><br><span class="line">  res.write(<span class="string">&#x27;abc&#x27;</span>);</span><br><span class="line">  res.end();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">10000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;started.&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Client 端代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.readyState === XMLHttpRequest.DONE) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Result：&#x27;</span>, xhr.responseText);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//场景一：DELETE请求，发送OPTIONS，匹配，允许跨域</span></span><br><span class="line">xhr.open(<span class="string">&#x27;DELETE&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line"><span class="comment">//场景二：PUT请求，发送OPTIONS，不匹配，不允许跨域</span></span><br><span class="line">xhr.open(<span class="string">&#x27;PUT&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line"><span class="comment">//场景三：DELETE请求匹配，使用自定义Header不匹配，不允许跨域</span></span><br><span class="line">xhr.open(<span class="string">&#x27;DELETE&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.setRequestHeader(<span class="string">&#x27;x-token1&#x27;</span>, <span class="string">&#x27;aa&#x27;</span>);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line"><span class="comment">//场景四：POST请求，匹配的自定义Header，允许跨域</span></span><br><span class="line">xhr.open(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.setRequestHeader(<span class="string">&#x27;x-token&#x27;</span>, <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<h3 id="1-3、带凭证的请求"><a href="#1-3、带凭证的请求" class="headerlink" title="1.3、带凭证的请求"></a>1.3、带凭证的请求</h3><p>一般来说，对于跨站请求，浏览器是不会发送凭证（HTTP Cookies 和验证信息）的。如果要发送带凭证的信息，只需要给 XMLHttpRequest 设置一个特殊的属性<code>withCredentials = true</code>，通过这种方式，浏览器就允许发送凭证信息。</p>
<p>带凭证的请求可能是简单请求，也可以是会有预请求。是否允许跨域，会先判断简单请求和预请求的规则，然后还会带上带凭证的请求自己的规则。</p>
<p>在带凭证的请求中，后端的响应必须包含 Header<code>Access-Control-Allow-Credentials=true</code>，同时 Header <code>Access-Control-Allow-Origin</code>，不能再使用*号这种匹配符。</p>
<p>具体示例如下：</p>
<p>服务端代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//要处理带凭证的请求，此Header不能使用*。</span></span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;http://10.16.85.170:8000&#x27;</span>);</span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;POST, DELETE, GET&#x27;</span>);</span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;x-token&#x27;</span>);</span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Max-Age&#x27;</span>, <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>);</span><br><span class="line">  <span class="comment">//只有设置了该Header，才允许带凭证的请求。</span></span><br><span class="line">  res.setHeader(<span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">  res.write(<span class="string">&#x27;abc&#x27;</span>);</span><br><span class="line">  res.end();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">10000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;started.&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>客户端代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.readyState === XMLHttpRequest.DONE) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Result：&#x27;</span>, xhr.responseText);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//优先满足预请求，然后满足凭证请求，允许跨域。</span></span><br><span class="line">xhr.open(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;http://localhost:10000/&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.withCredentials = <span class="literal">true</span>;</span><br><span class="line">xhr.setRequestHeader(<span class="string">&#x27;x-token&#x27;</span>, <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<h2 id="2、HTTP-响应头"><a href="#2、HTTP-响应头" class="headerlink" title="2、HTTP 响应头"></a>2、HTTP 响应头</h2><h3 id="2-1、-后端-HTTP-响应头"><a href="#2-1、-后端-HTTP-响应头" class="headerlink" title="2.1、 后端 HTTP 响应头"></a>2.1、 后端 HTTP 响应头</h3><p>此处列举后端有关 CORS 的响应头：</p>
<ol>
<li>Access-Control-Allow-Origin： | _允许的域名，只能有一个值。比如“_”或“abc.com”，”a.com,b.com”这种不允许</li>
<li>Access-Control-Expose-Headers: 允许的白名单 Header，多个用逗号隔开</li>
<li>Access-Control-Max-Age: 预请求缓存时间，单位秒，<strong>禁用缓存</strong>时无效哦！</li>
<li>Access-Control-Allow-Credentials: true | false 是否允许带凭证的请求，如果为 true，则 Origin 只能是具体的值</li>
<li>Access-Control-Allow-Methods: 允许的请求类型，多个用逗号隔开</li>
<li>Access-Control-Allow-Headers: 在实际请求中，允许的自定义 header，多个用逗号隔开</li>
</ol>
<h3 id="2-2、-浏览器发出跨域请求的响应头"><a href="#2-2、-浏览器发出跨域请求的响应头" class="headerlink" title="2.2、 浏览器发出跨域请求的响应头"></a>2.2、 浏览器发出跨域请求的响应头</h3><p>此处列举出浏览器在发送跨域请求时，会带上的响应头：</p>
<ol>
<li>Origin: 告诉服务器，请求来自哪里，仅仅是服务器名，不包含路径。</li>
<li>Access-Control-Request-Method: 预请求时，告诉服务器实际的请求方式</li>
<li>Access-Control-Request-Headers: 预请求时，告诉服务器，实际请求所携带的自定义 Header</li>
</ol>
<h2 id="3、参考资料"><a href="#3、参考资料" class="headerlink" title="3、参考资料"></a>3、参考资料</h2><ol>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Preflighted_requests">MDN HTTP access control (CORS)</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS">MDN HTTP 访问控制(CORS)</a></li>
</ol>
]]></content>
      <categories>
        <category>前端</category>
        <category>浏览器</category>
        <category>跨域</category>
      </categories>
      <tags>
        <tag>跨域</tag>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS3伪元素实现自定义复选框</title>
    <url>/posts/3583/</url>
    <content><![CDATA[<p>我们都知道原生的复选框控件样式极难自定义，这对于工程师实现设计稿的难度加大了一大截。css3 的出现，增加了:checked 选择器，因此我们可以利用:checked 和 label 来实现各式各样的表单选择控件，接下来让我们来看看如何实现吧！</p>
<a id="more"></a>

<p>我们来看看如何实现上述自定义的复选框：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.check-wrap</span> &#123;</span></span><br><span class="line">    text-align: center;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.checkbox</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    clip: rect(0, 0, 0, 0);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.checkbox</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span><span class="selector-pseudo">:focus</span> + <span class="selector-tag">label</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">box-shadow</span>: 0 0 0.6<span class="selector-tag">em</span> <span class="selector-id">#06c</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.checkbox</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span> + <span class="selector-tag">label</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    content: &#x27;\a0&#x27;; /* 不换行空格 */</span><br><span class="line">    display: inline-block;</span><br><span class="line">    margin-right: 0.3em;</span><br><span class="line">    width: 2em;</span><br><span class="line">    height: 2em;</span><br><span class="line">    border-radius: 0.3em;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">line-height</span>: 2<span class="selector-tag">em</span>; <span class="comment">/* 关键 */</span></span></span><br><span class="line">    font-size: 20px;</span><br><span class="line">    text-align: center;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">    background: gray;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.checkbox</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    content: &#x27;\2713&#x27;; /* 对勾 */</span><br><span class="line">    background: black;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  label &#123;</span><br><span class="line">    margin-right: 40px;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;check-wrap&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">id</span>=<span class="string">&quot;check-1&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;check-1&quot;</span>&gt;</span>生男孩<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">id</span>=<span class="string">&quot;check-2&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;check-2&quot;</span>&gt;</span>生女孩<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>这里为了隐藏原生的 checkbox 控件，我们用了 clip: rect(0,0,0,0)进行截取，然后使用 checkbox 的伪类:checked 来实现交互。</p>
<p>接下来扩展一下，我们来实现自定义开关：</p>


<p>这里原理是一样的，只不过样式做了改动，直接上代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.check-wrap</span> &#123;</span></span><br><span class="line">    margin-bottom: 20px;</span><br><span class="line">    text-align: center;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.switch</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    clip: rect(0, 0, 0, 0);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.switch</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span> + <span class="selector-tag">label</span> &#123;</span></span><br><span class="line">    width: 6em;</span><br><span class="line">    height: 3em;</span><br><span class="line">    padding: 0.3em;</span><br><span class="line">    border-radius: 0.3em;</span><br><span class="line">    border: 1px solid rgba(0, 0, 0, 0.2);</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">line-height</span>: 2<span class="selector-tag">em</span>; <span class="comment">/* 关键 */</span></span></span><br><span class="line">    font-size: 20px;</span><br><span class="line">    text-align: center;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">    box-shadow: 0 1px white inset;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#ccc</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background-image</span>: <span class="selector-tag">linear-gradient</span>(<span class="selector-id">#ddd</span>, <span class="selector-id">#bbb</span>);</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.switch</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span> &#123;</span></span><br><span class="line">    box-shadow: 0.05em 0.1em 0.2em rgba(0, 0, 0, 0.6) inset;</span><br><span class="line">    border-color: rgba(0, 0, 0, 0.3);</span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#bbb</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  label &#123;</span><br><span class="line">    margin-right: 40px;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.switch-an</span> &#123;</span></span><br><span class="line">    position: absolute;</span><br><span class="line">    clip: rect(0, 0, 0, 0);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.switch-an</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span> + <span class="selector-tag">label</span> &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    width: 5em;</span><br><span class="line">    height: 2em;</span><br><span class="line">    border-radius: 1em;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>: <span class="selector-id">#06c</span>;</span></span><br><span class="line">    text-align: left;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">  <span class="selector-class">.switch-an</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span> + <span class="selector-tag">label</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    content: &#x27;&#x27;;</span><br><span class="line">    width: 2em;</span><br><span class="line">    height: 2em;</span><br><span class="line">    position: absolute;</span><br><span class="line">    left: 0;</span><br><span class="line">    border-radius: 100%;</span><br><span class="line">    vertical-align: middle;</span><br><span class="line"><span class="css">    <span class="selector-tag">background-color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">    transition: left 0.3s;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.switch-an</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span> + <span class="selector-tag">label</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line">    content: &#x27;OFF&#x27;;</span><br><span class="line">    margin-left: 2.6em;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.switch-an</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line">    transition: left 0.3s;</span><br><span class="line">    left: 3em;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.switch-an</span><span class="selector-attr">[type=<span class="string">&#x27;checkbox&#x27;</span>]</span><span class="selector-pseudo">:checked</span> + <span class="selector-tag">label</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line">    content: &#x27;NO&#x27;;</span><br><span class="line">    margin-left: 0.6em;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;check-wrap&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;switch&quot;</span> <span class="attr">id</span>=<span class="string">&quot;switch-1&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;switch-1&quot;</span>&gt;</span>生男孩<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;switch&quot;</span> <span class="attr">id</span>=<span class="string">&quot;switch-2&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;switch-2&quot;</span>&gt;</span>生女孩<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;check-wrap&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;switch-an&quot;</span> <span class="attr">id</span>=<span class="string">&quot;switch-an-1&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;switch-an-1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>转载</tag>
        <tag>CSS3</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS使用技巧汇总</title>
    <url>/posts/61575/</url>
    <content><![CDATA[<h2 id="CSS-样式"><a href="#CSS-样式" class="headerlink" title="CSS 样式"></a>CSS 样式</h2><h3 id="css-设置文字无法选中"><a href="#css-设置文字无法选中" class="headerlink" title="css 设置文字无法选中"></a>css 设置文字无法选中</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">-webkit-user-select</span>: <span class="selector-tag">none</span>;</span><br><span class="line"><span class="selector-tag">-moz-user-select</span>: <span class="selector-tag">none</span>;</span><br><span class="line"><span class="selector-tag">-ms-user-select</span>: <span class="selector-tag">none</span>;</span><br><span class="line"><span class="selector-tag">user-select</span>: <span class="selector-tag">none</span>;</span><br></pre></td></tr></table></figure>

<h2 id="CSS-函数"><a href="#CSS-函数" class="headerlink" title="CSS 函数"></a>CSS 函数</h2><p>转载自：<a href="https://blog.csdn.net/qq449245884/article/details/108467025">https://blog.csdn.net/qq449245884/article/details/108467025</a></p>
<p>DEMO 地址：<a href="https://codepen.io/protic_milos/pen/GRpYJKd">https://codepen.io/protic_milos/pen/GRpYJKd</a></p>
<a id="more"></a>

<h3 id="attr"><a href="#attr" class="headerlink" title="attr()"></a>attr()</h3><p><code>attr</code> 函数用于获取所选元素的属性值。 它接受三个参数，<code>属性名称</code> ，<code>属性值的单位</code> 和 <code>默认值</code> 。</p>
<p>语法: <code>attr( attribute-name ? [, ]? )</code></p>
<p><strong>DEMO</strong></p>
<blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">data-text</span>=<span class="string">&quot;the attr function&quot;</span> <span class="attr">data-tooltip</span>=<span class="string">&quot;Hi from attr!&quot;</span> <span class="attr">class</span>=<span class="string">&quot;attr&quot;</span>&gt;</span></span><br><span class="line">  This text is combined with</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27; &#x27;</span> <span class="built_in">attr</span>(data-text);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.attr</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27; &#x27;</span> <span class="built_in">attr</span>(data-tooltip);</span><br><span class="line">  <span class="attribute">background-color</span>: orange;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="calc"><a href="#calc" class="headerlink" title="calc()"></a>calc()</h3><p>这个函数使我们能够计算 CSS 值，而不是指定确切的值。通常用于计算元素的大小或位置。它支持加法、减法、乘法和除法。</p>
<p>需要特别注意重要一点是+和-运算符必须用空格隔开，不然无法正常工作。*和/运算符不有这限制，但出于一致性的考虑，建议添加空格。</p>
<p>另外，很棒的是，我们可以混合 CSS 单位，例如，我们可以减去百分比和像素。</p>
<p>我们可以用 calc 构建一个带有居中元素的示例:</p>
<blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;calc&quot;</span>&gt;</span>Centered with calc<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-class">.calc</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: orange;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">100px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="var"><a href="#var" class="headerlink" title="var()"></a>var()</h3><p>通过这个函数，我们可以使用一个自定义属性的值作为另一个 CSS 属性的值。简单地说，我们可以定义一个颜色，例如，将它放在自定义属性(CSS 变量)中，然后通过调用 var 函数重用该属性值。</p>
<p>与 CSS 变量一起，该函数提高了可维护性并减少了重复。一个用例是为网站创建主题。</p>
<p>此函数接受两个参数，即自定义属性和一个默认值，如果出现问题，将使用它们。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attribute">--bg-color</span>: green;</span><br><span class="line">  <span class="attribute">--color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-class">.var</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--bg-color);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="counter"><a href="#counter" class="headerlink" title="counter()"></a>counter()</h3><p>就我个人而言，我从未使用过这种方法，但它看起来是很有趣。这个函数返回指定计数器的当前值，需要与 <code>counter-reset</code>和<code>counter-increment</code> 配合使用。</p>
<p>我们可以用它来计算其他元素，比如有序列表。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;counter&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Mars<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Bounty<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Snickers<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="circle"><a href="#circle" class="headerlink" title="circle()"></a>circle()</h3><p>这个函数创建一个圆形区域来屏蔽它所应用的元素。你可以指定它的半径和位置。通常与图像一起使用来创建圆角形状。此函数是<code>clip-path</code>属性值。</p>
<p>另外，值得一提的是，除了圆之外，您还可以创建椭圆和多边形形状。</p>
<blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;img</span><br><span class="line">  class=&quot;circle&quot;</span><br><span class="line">  src=&quot;https://devinduct.com/Uploads/PostImages/1122dcb9-954a-4641-9ca6-c38e9472698f.png&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">img</span><span class="selector-class">.circle</span> &#123;</span><br><span class="line">  <span class="attribute">clip-path</span>: <span class="built_in">circle</span>(<span class="number">30%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS百分比实现高度自适应</title>
    <url>/posts/40550/</url>
    <content><![CDATA[<h2 id="基本知识点"><a href="#基本知识点" class="headerlink" title="基本知识点"></a>基本知识点</h2><p>当 <code>padding/margin</code> 取形式为百分比的值时，无论是 <code>left/right</code>，还是 <code>top/bottom</code> ，都是以父元素的 <code>width</code> 为参照物。</p>
<img src="/posts/40550/margin-top.png" class="" title="margin-top">

<a id="more"></a>

<h2 id="1-给容器设置-padding-top-bottom"><a href="#1-给容器设置-padding-top-bottom" class="headerlink" title="1. 给容器设置 padding-top/bottom"></a>1. 给容器设置 padding-top/bottom</h2><p><code>padding-top/bottom</code> 的百分比值，是依赖父容器宽度的，所以给子元素设置一个与父元素高度相同百分值的 <code>padding-top</code> 即可实现。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">  <span class="attribute">background</span>: green;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>; <span class="comment">/*父元素宽度一半*/</span></span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">50%</span>; <span class="comment">/*与width一样，为父元素宽度一半*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此方案浏览器兼容性很不错，唯一的缺陷是无法给容器设置 <code>max-height</code> 属性了，因为 <code>max-height</code> 只能限制内容高度，而不能限制 <code>padding</code> ，为了解决这个问题我们可以选择下面这个办法。</p>
<h2 id="2-给子元素-伪元素设置-margin-padding-撑开容器"><a href="#2-给子元素-伪元素设置-margin-padding-撑开容器" class="headerlink" title="2. 给子元素/伪元素设置 margin/padding 撑开容器"></a>2. 给子元素/伪元素设置 margin/padding 撑开容器</h2><p>从上面的方案的盒模型看出 max-height 失效的原因是容器的高度本来就是 padding 撑的，而内容高度为 0，max-height 无法起作用。那想要优化这一点，唯一的方法就是利用内容高度来撑开而非 padding，这个方案跟消除浮动所用的方案非常相似：给容器添加一个子元素/伪元素，并把子元素/伪元素的 pading/margin 设为 100%，使其实际高度相当于容器的宽度，如此一来，便能把容器的高度撑至与宽度达成我们预想的宽高比(1:1)了。由于添加子元素与 HTML 语义化相悖，因此更推荐使用伪元素:after 来实现此方案。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">  <span class="attribute">background</span>: green;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>; <span class="comment">/*父元素宽度一半*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用该方法可能需考虑 <code>margin</code> 折叠的问题，可在父元素上加 <code>overflow:hidden</code> 触发 BFC 解决。</p>
<p>转载自：<a href="https://www.jianshu.com/p/25e7d0793bf0">https://www.jianshu.com/p/25e7d0793bf0</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>布局</tag>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS粘住固定底部的5种方法(转载)</title>
    <url>/posts/52603/</url>
    <content><![CDATA[<p>译文地址：<a href="http://caibaojian.com/css-5-ways-sticky-footer.html">http://caibaojian.com/css-5-ways-sticky-footer.html</a><br>原文地址：<a href="https://css-tricks.com/couple-takes-sticky-footer/">https://css-tricks.com/couple-takes-sticky-footer/</a><br>译者：前端开发博客-Jack</p>
<h3 id="方法一：全局增加一个负值下边距等于底部高度"><a href="#方法一：全局增加一个负值下边距等于底部高度" class="headerlink" title="方法一：全局增加一个负值下边距等于底部高度"></a>方法一：全局增加一个负值下边距等于底部高度</h3><p>有一个全局的元素包含除了底部之外的所有内容。它有一个负值下边距等于底部的高度，就像<a href="http://ryanfait.com/html5-sticky-footer/">这个演示链接</a>。</p>
<a id="more"></a>

<p><a href="http://caibaojian.com/t/html">HTML</a>代码</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">    content</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;push&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a href="http://caibaojian.com/css3/">CSS</a>代码：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100%</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Equal to height of footer */</span></span><br><span class="line">  <span class="comment">/* But also accounting for potential margin-bottom of last child */</span></span><br><span class="line">  <span class="attribute">margin-bottom</span>: -<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.footer</span>,</span><br><span class="line"><span class="selector-class">.push</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>演示：</p>
<iframe name="cp_embed_1" src="https://codepen.io/chriscoyier/embed/VjZmGj?height=392&amp;theme-id=1&amp;slug-hash=VjZmGj&amp;default-tab=result&amp;user=chriscoyier&amp;embed-version=2&amp;name=cp_embed_1" scrolling="no" frameborder="0" height="392" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="CodePen Embed" class="cp_embed_iframe " loading="lazy" id="cp_embed_VjZmGj" style="margin: 0px; padding: 0px; border: 0px; font: inherit; vertical-align: baseline; width: 688px; overflow: hidden; display: block;"></iframe>

<p>这个代码需要一个额外的元素.push 等于底部的高度，来防止内容覆盖到底部的元素。这个 push 元素是智能的，它并没有占用到底部的利用，而是通过全局加了一个负边距来填充。</p>
<h3 id="方法二：底部元素增加负值上边距"><a href="#方法二：底部元素增加负值上边距" class="headerlink" title="方法二：底部元素增加负值上边距"></a>方法二：底部元素增加负值上边距</h3><p>虽然这个代码减少了一个.push 的元素，但还是需要增加多一层的元素包裹内容，并给他一个内边距使其等于底部的高度，防止内容覆盖到底部的内容。</p>
<p>HTML 代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content-inside&quot;</span>&gt;</span>content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a href="http://caibaojian.com/t/css">CSS</a>：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content-inside</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.footer</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>演示：</p>
<iframe name="cp_embed_2" src="https://codepen.io/chriscoyier/embed/aZoBMb?height=300&amp;theme-id=1&amp;slug-hash=aZoBMb&amp;default-tab=result&amp;user=chriscoyier&amp;embed-version=2&amp;name=cp_embed_2" scrolling="no" frameborder="0" height="300" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="CodePen Embed" class="cp_embed_iframe " loading="lazy" id="cp_embed_aZoBMb" style="margin: 0px; padding: 0px; border: 0px; font: inherit; vertical-align: baseline; width: 688px; overflow: hidden; display: block;"></iframe>

<h2 id="方法三：使用-calc-计算内容的高度"><a href="#方法三：使用-calc-计算内容的高度" class="headerlink" title="方法三：使用 calc()计算内容的高度"></a>方法三：使用 calc()计算内容的高度</h2><p>HTML</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a href="http://caibaojian.com/t/css">CSS</a>:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="built_in">calc</span>(<span class="number">100vh</span> - <span class="number">70px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.footer</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>演示：</p>
<iframe name="cp_embed_3" src="https://codepen.io/chriscoyier/embed/jqRXBz?height=414&amp;theme-id=1&amp;slug-hash=jqRXBz&amp;default-tab=result&amp;user=chriscoyier&amp;embed-version=2&amp;name=cp_embed_3" scrolling="no" frameborder="0" height="414" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="CodePen Embed" class="cp_embed_iframe " loading="lazy" id="cp_embed_jqRXBz" style="margin: 0px; padding: 0px; border: 0px; font: inherit; vertical-align: baseline; width: 688px; overflow: hidden; display: block;"></iframe>

<p>给 70px 而不是 50px 是为了为了跟底部隔开 20px，防止紧靠在一起。</p>
<h3 id="方法四：使用flexbox"><a href="#方法四：使用flexbox" class="headerlink" title="方法四：使用flexbox"></a>方法四：使用<a href="http://caibaojian.com/t/flexbox">flexbox</a></h3><p>关于 flexbox 的教程，还请查看之前的一篇<a href="http://caibaojian.com/flexbox-guide.html">详细的教程</a></p>
<p>HTML:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>CSS:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>演示：</p>
<iframe name="cp_embed_4" src="https://codepen.io/chriscoyier/embed/RRbKrL?height=488&amp;theme-id=1&amp;slug-hash=RRbKrL&amp;default-tab=result&amp;user=chriscoyier&amp;embed-version=2&amp;name=cp_embed_4" scrolling="no" frameborder="0" height="488" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="CodePen Embed" class="cp_embed_iframe " loading="lazy" id="cp_embed_RRbKrL" style="margin: 0px; padding: 0px; border: 0px; font: inherit; vertical-align: baseline; width: 688px; overflow: hidden; display: block;"></iframe>

<h3 id="方法五：使用-grid-布局"><a href="#方法五：使用-grid-布局" class="headerlink" title="方法五：使用 grid 布局"></a>方法五：使用 grid 布局</h3><p>HTML：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>CSS：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-rows</span>: <span class="number">1</span>fr auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.footer</span> &#123;</span><br><span class="line">  <span class="attribute">grid-row-start</span>: <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">grid-row-end</span>: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>演示：</p>
<iframe name="cp_embed_5" src="https://codepen.io/chriscoyier/embed/YWKNrE?height=477&amp;theme-id=1&amp;slug-hash=YWKNrE&amp;default-tab=result&amp;user=chriscoyier&amp;embed-version=2&amp;name=cp_embed_5" scrolling="no" frameborder="0" height="477" allowtransparency="true" allowfullscreen="true" allowpaymentrequest="true" title="CodePen Embed" class="cp_embed_iframe " loading="lazy" id="cp_embed_YWKNrE" style="margin: 0px; padding: 0px; border: 0px; font: inherit; vertical-align: baseline; width: 688px; overflow: hidden; display: block;"></iframe>

<p>grid 早于 flexbox 出现，但并没有 flexbox 被广泛支持，你可能在 chrome Canary 或者 Firefox 开发版上才可以看见效果</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>布局</tag>
        <tag>技巧</tag>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS超出部分省略号</title>
    <url>/posts/26295/</url>
    <content><![CDATA[<h2 id="CSS-实现单行省略号"><a href="#CSS-实现单行省略号" class="headerlink" title="CSS 实现单行省略号"></a>CSS 实现单行省略号</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="CSS-实现多行省略号"><a href="#CSS-实现多行省略号" class="headerlink" title="CSS 实现多行省略号"></a>CSS 实现多行省略号</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">  <span class="attribute">-webkit-box-orient</span>: vertical;</span><br><span class="line">  -webkit-line-clamp: 3; //行数</span><br><span class="line">  <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>-webkit-line-clamp 用来限制在一个块元素显示的文本的行数。 为了实现该效果，它需要组合其他的 WebKit 属性。常见结合属性：</p>
<p>display: -webkit-box; 必须结合的属性 ，将对象作为弹性伸缩盒子模型显示 。</p>
<p>-webkit-box-orient 必须结合的属性 ，设置或检索伸缩盒对象的子元素的排列方式 。</p>
<p><a href="http://www.daqianduan.com/6179.html">http://www.daqianduan.com/6179.html</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS骨架屏半自动化</title>
    <url>/posts/24488/</url>
    <content><![CDATA[<p>前几天写了个骨架屏组件，但是太定制化了，每次需要的时候都得重新手写骨架屏太麻烦。这次用 CSS 的伪类特性实现了骨架屏的半自动化，虽然还是有点繁琐，但相比以前的效率还是提升了一个档次。</p>
<a id="more"></a>

<h2 id="核心代码（less）"><a href="#核心代码（less）" class="headerlink" title="核心代码（less）"></a>核心代码（less）</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.skt-basic</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">border</span>: none <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: transparent <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">background-image</span>: none <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>, <span class="number">0.9</span>);</span><br><span class="line">  <span class="attribute">transform-origin</span>: left top;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.skt-main</span> &#123;</span><br><span class="line">  <span class="comment">/* 默认深色背景 */</span></span><br><span class="line">  &amp;::after &#123;</span><br><span class="line">    content: &#x27;&#x27;;</span><br><span class="line">    <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span>;</span><br><span class="line">    <span class="selector-tag">left</span>: 0;</span><br><span class="line">    <span class="selector-tag">top</span>: 0;</span><br><span class="line">    <span class="selector-tag">z-index</span>: 9;</span><br><span class="line">    <span class="selector-tag">width</span>: 100%;</span><br><span class="line">    <span class="selector-tag">height</span>: 100%;</span><br><span class="line">    <span class="selector-tag">background-color</span>: <span class="selector-id">#e6e6e6</span>;</span><br><span class="line">    <span class="selector-tag">display</span>: <span class="selector-tag">block</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 想要圆角加 yyt-sk-round */</span></span><br><span class="line">  &amp;<span class="selector-class">.yyt-sk-round</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">4</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* 不想要动画加 yyt-sk-not-ani */</span></span><br><span class="line">  &amp;<span class="selector-pseudo">:not(.yyt-sk-not-ani)</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">30%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(</span><br><span class="line">      to right,</span><br><span class="line">      rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>) <span class="number">0</span>,</span><br><span class="line">      <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.3</span>) <span class="number">50%</span>,</span><br><span class="line">      <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>) <span class="number">100%</span></span><br><span class="line">    );</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">skewX</span>(-<span class="number">45deg</span>);</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">99</span>;</span><br><span class="line">    <span class="attribute">animation</span>: skeleton-ani <span class="number">1s</span> ease infinite;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* 浅色背景 */</span></span><br><span class="line">  &amp;<span class="selector-class">.yyt-light</span> &#123;</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">      <span class="selector-tag">background-color</span>: <span class="selector-id">#f8fafc</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 骨架屏</span><br><span class="line"><span class="selector-class">.skt-loading</span> &#123;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none; <span class="comment">/* 加载中阻止事件 */</span></span><br><span class="line">  .skeleton,</span><br><span class="line">  <span class="selector-class">.skeleton-25</span>,</span><br><span class="line">  <span class="selector-class">.skeleton-50</span>,</span><br><span class="line">  <span class="selector-class">.skeleton-75</span> &#123;</span><br><span class="line">    .skt-basic();</span><br><span class="line">    <span class="selector-class">.skt-main</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.skeleton-25</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.25</span>, <span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.skeleton-50</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.5</span>, <span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.skeleton-75</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.75</span>, <span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> skeleton-ani &#123;</span><br><span class="line">  <span class="comment">/* 骨架屏动画 */</span></span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">100%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">150%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><blockquote>
<p>HTML 部分</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 使用 skt-loading 包裹整个容器 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;&#123;&#x27;skt-loading&#x27;: loading &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 给想要用骨架屏展示的容器添加 skeleton 类 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;skeleton&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">        loading: <span class="literal">true</span> <span class="comment">// 默认loading为true，加载骨架屏</span></span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.loading = <span class="literal">false</span>;</span></span><br><span class="line">      &#125;, 3000);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="使用注意"><a href="#使用注意" class="headerlink" title="使用注意"></a>使用注意</h2><ul>
<li>after 伪元素无法插入到 <code>input</code>、<code>img</code> 等非容器元素中，所以如果需要添加 <code>.skleton</code>，则需要加一层元素将其包裹</li>
<li>Vue 中使用到 v-for 动态渲染的类似列表数据，则需要先有 mock 数据来生成 dom</li>
</ul>
<p><a href="https://evestorm.github.io/tags/Vue/"> Vue</a> <a href="https://evestorm.github.io/tags/%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C/"> 用户体验</a> [ 骨架屏](</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>用户体验</tag>
        <tag>骨架屏</tag>
      </tags>
  </entry>
  <entry>
    <title>DOM操作-insertAdjacentHTML</title>
    <url>/posts/39637/</url>
    <content><![CDATA[<h2 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h2><iframe height="377" scrolling="no" title="添加DOM - insertAdjacentHTML" src="https://codepen.io/JingW/embed/VweRydj?height=377&amp;theme-id=light&amp;default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<a id="more"></a>

<h2 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h2><iframe height="265" scrolling="no" title="移动DOM元素" src="https://codepen.io/JingW/embed/PoZLExJ?height=265&amp;theme-id=light&amp;default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">targetElement.remove();</span><br></pre></td></tr></table></figure>

<h2 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">insertAdjacentElement: IE8+</span><br><span class="line">insertAdjacentText: IE11+</span><br><span class="line">insertAdjacentHTML: IE11+ Chrome80+</span><br><span class="line">remove Edge Chrome80+</span><br></pre></td></tr></table></figure>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/insertAdjacentHTML">MDN - insertAdjacentHTML</a></li>
<li><a href="https://www.caniuse.com/">Can i use</a></li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>HTML</category>
      </categories>
      <tags>
        <tag>DOM</tag>
      </tags>
  </entry>
  <entry>
    <title>Eruda-移动端项目调试工具</title>
    <url>/posts/41294/</url>
    <content><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>之前移动端页面调试我都是手机插线连电脑用 Chrome 或者 Safari 搞定的，然而这种方式挺麻烦的，起码我这么觉得。（p.s. 如果不熟悉连线操作方式，可以查看掘金的<a href="https://juejin.im/post/5b15022ff265da6e163720c6">这篇文章</a>）后来就考虑搜索替代方案了，于是发现了 <a href="https://github.com/liriliri/eruda">Eruda</a> 这款调试工具。</p>
<a id="more"></a>

<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>直接引用作者对这款插件的介绍：Eruda 是一个专为手机网页前端设计的调试面板，类似 DevTools 的迷你版，其主要功能包括：捕获 console 日志、检查元素状态、捕获 XHR 请求、显示本地存储和 Cookie 信息等等。</p>
<p>总结来讲，使用它的好处就是，手机在不连线的情况下访问页面，会在右下角生成一个按钮，点击会弹出一个调试窗口，能够在上面查看 log 日志等信息，方便调试。</p>
<h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><img src="/posts/41294/screenshot.jpg" class="" title="screenshot">

<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><h3 id="通过-cdn"><a href="#通过-cdn" class="headerlink" title="通过 cdn"></a>通过 cdn</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;//cdn.bootcss.com/eruda/1.5.2/eruda.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">  eruda.init();</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="通过-npm"><a href="#通过-npm" class="headerlink" title="通过 npm"></a>通过 npm</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i eruda -D</span><br></pre></td></tr></table></figure>

<p>入口文件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="regexp">/mdebug=true/</span>.test(<span class="built_in">window</span>.location.href)) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">  script.src = <span class="string">&#x27;https://cdn.bootcss.com/eruda/1.5.2/eruda.min.js&#x27;</span>;</span><br><span class="line">  script.async = <span class="literal">true</span>;</span><br><span class="line">  <span class="built_in">document</span>.getElementsByTagName(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>].appendChild(script);</span><br><span class="line">  script.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    eruda.init();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>在需要调试时，给地址栏末尾正价 mdebug=true 就 OK 了。</p>
<h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><ul>
<li><a href="https://github.com/liriliri/eruda">github - eruda</a></li>
<li><a href="https://github.com/Tencent/vConsole">另一款调试工具 - vconsole</a></li>
</ul>
]]></content>
      <categories>
        <category>工具</category>
        <category>测试</category>
      </categories>
      <tags>
        <tag>技巧</tag>
        <tag>调试</tag>
      </tags>
  </entry>
  <entry>
    <title>Event Loop 学习笔记</title>
    <url>/posts/10505/</url>
    <content><![CDATA[<p>我们只关心打钩的的阶段：</p>
<ol>
<li>timers</li>
<li>poll（此阶段会停留一段时间）</li>
<li>check（执行一些立即执行的函数【主要就是：setImmediate(fn) 函数】）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">   ┌───────────────────────┐</span><br><span class="line">┌─&gt;│        timers   ✅    │</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">│  │     I&#x2F;O callbacks     │</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">│  │     idle, prepare     │</span><br><span class="line">│  └──────────┬────────────┘      ┌───────────────┐</span><br><span class="line">│  ┌──────────┴────────────┐      │   incoming:   │</span><br><span class="line">│  │         poll    ✅    │&lt;─────┤  connections, │</span><br><span class="line">│  └──────────┬────────────┘      │   data, etc.  │</span><br><span class="line">│  ┌──────────┴────────────┐      └───────────────┘</span><br><span class="line">│  │        check    ✅    │</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">└──┤    close callbacks    │</span><br><span class="line">   └───────────────────────┘</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h2 id="timers-和-poll"><a href="#timers-和-poll" class="headerlink" title="timers 和 poll"></a>timers 和 poll</h2><img src="/posts/10505/event-loop.png" class="" title="event-loop">

<p>根据 <a href="https://juejin.im/post/5ab7677f6fb9a028d56711d0">官方文档</a> 的描述，事件循环应该是从 timers 开始的，但不一定。</p>
<p>NodeJS 的内部代码大概是这样写的：</p>
<ul>
<li>开启 eventLoop()</li>
<li>执行 JS()</li>
</ul>
<p>但由于启动 event loop 是开个进程，需要时间的，而执行 JS 也得启动 V8 引擎，也是需要时间的，所以不确定这两个谁快谁慢。所以：</p>
<ul>
<li>有可能 setTimeout 先执行，后才进入 timers 阶段</li>
<li>也有可能先进入 timers 阶段，后执行 setTimeout</li>
</ul>
<p>假设一段代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(fn, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<img src="/posts/10505/poll.png" class="" title="poll">p

<p>当我们在执行这段代码时，会把 fn 放进 timers 中的一个队列中去（也可以认为是一个数组）。然后 JS 就做自己的事情去了。此时 timers 可能开启了，也可能没有开启。但最大的可能是，在执行 <code>setTimeout(fn, 1000);</code> 的时候，我们进入了 poll 阶段，poll 阶段就是等待（e.g. 等待 ajax 请求成功，或者读文件成功），大概几十毫秒。在等待期间，它会看时间，比如刚才 JS 让我 1000 毫秒后执行一个 fn，现在刚过去 500 毫秒，那我继续等，直到等到 1000 毫秒时，赶紧经过 check 阶段，进入 timers 阶段去执行 fn：</p>
<img src="/posts/10505/el2.png" class="">

<p>执行完毕后，又进入 poll 阶段，什么都不做，继续等。这个等有个时间限制的，假设是 3s，那么 3s 后如果什么都没等到，就进入 check 阶段，然后再回到 timers 阶段，如此循环。</p>
<h2 id="check"><a href="#check" class="headerlink" title="check"></a>check</h2><p>check 阶段会执行一些立即执行的函数，主要就是 setImmediate(fn) 函数。该函数类似 setTimeout，但没有第二个参数。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn&#x27;</span>), <span class="number">1000</span>);</span><br><span class="line">setImmediate(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn2&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>所以在执行例如 setImmediate(fn2) 时，fn2 不会进入 timers，而会进入 check 阶段的一个队列中：</p>
<img src="/posts/10505/poll2.png" class="" title="poll2">

<p>由于我们不确定 timers 这个一阶段结束了还是未结束，所以我们以二阶段 poll 来研究。</p>
<p>当执行 setTimeout 后，我们把 fn 扔进了 timers ，然后进入 poll 阶段开始等，现在又执行到了 setImmediate ，这是个立即执行函数，有事情开始做了，所以 poll 不等了，直接进入 check 阶段去执行 fn2。</p>
<p>然后又回到 timers 阶段，不执行 fn（因为没到 1000 毫秒），又进入 poll 阶段，等到 1000 毫秒后，进入 check 阶段，然后返回 timers 阶段，开始执行 fn （fn 只能在进入 timers 阶段才能执行）。</p>
<h2 id="经典考题"><a href="#经典考题" class="headerlink" title="经典考题"></a>经典考题</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn&#x27;</span>), <span class="number">0</span>);</span><br><span class="line">setImmediate(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn2&#x27;</span>));</span><br></pre></td></tr></table></figure>

<img src="/posts/10505/poll3.png" class="" width="22">

<p>按照理论（NodeJS 内部代码先调用的 event loop，再调用的执行 JS），应该 fn2 先执行，但实际结果是不一定的，有可能先打印 fn，再打印 fn2；也有可能先打印 fn2，再打印 fn。原因就在于 <strong>开启 event loop</strong> 和 <strong>执行 JS</strong> 的顺序是随机的。</p>
<p>如果先开启了 event loop ，那么就先从 poll 阶段开始，因为 timers 阶段没发现有任何函数，所以进入 poll 开始等。接着等到了 <strong>执行 JS</strong> ，执行第一段代码，就把 0s 延迟的 fn 放进了 timers 的队列，接着执行第二段代码，把 fn2 放进了 check 队列，此刻 <strong>执行 JS</strong> 完毕，event loop 说：你执行完了是吧？我可以开始做事了，然后 poll 发现有任务要执行了，就进入 check 阶段执行 fn2，再返回到 timers 阶段，发现有个 fn 已经过时间了（因为延迟 0s），马上执行 fn。所以这种情况下，先打印 fn2，再打印 fn。</p>
<p>但如果 event loop 开启的比较慢，执行 JS 这一步先开始了。那么就会先把 fn 扔进队列，再才开始进入 timers 的第一阶段，此刻 timers 发现已经有了个 fn，还是 0s 延迟执行，所以就执行了 fn，再进入 poll ，poll 发现还有个 fn2 在等我立即执行，就接着进入 check 然后执行 fn2。所以这种情况下，先打印 fn，再打印 fn2。</p>
<p>说到底，就是看 fn 是在第一次进入 timers 阶段前就存在，还是第一次进入 timers 阶段后才存在。</p>
<p>那怎样才能保证 fn2 先执行呢？解决方案把这两段代码放进一个 setTimeout 中去，然后延迟 1s 执行，为的就是等 event loop 开启后，进入 poll 阶段，再开始执行这两段代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn&#x27;</span>), <span class="number">0</span>);</span><br><span class="line">  setImmediate(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn2&#x27;</span>));</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<h2 id="process-nextTick"><a href="#process-nextTick" class="headerlink" title="process.nextTick()"></a>process.nextTick()</h2><p>这个重要的异步 API 不属于 event loop 的任何一个阶段。nextTick 队列会在当前阶段后就被执行。</p>
<p>以下面代码为例：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn&#x27;</span>), <span class="number">0</span>);</span><br><span class="line">  setImmediate(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn2&#x27;</span>));</span><br><span class="line">  process.nextTick(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;fn3&#x27;</span>));</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>由于三段代码被放进了一个 setTimeout 中，且在 1s 后再被执行。所以 1s 后 event loop 肯定已经存在，此时就从 poll 阶段开始，然后执行三段代码，第一段把 fn 放进 timers 的队列，第二段把 fn2 放进 check 队列，然后 poll 阶段执行完了，根据 nextTick 队列会在<strong>当前阶段</strong>后就被执行，所以此刻在马上要进入 check 阶段之前，就把 nextTick 中的代码执行掉了，所以先打印 fn3，然后进入 check 阶段后打印 fn2，最后重新进入 timers 打印 fn。</p>
<p>再来看下面这段代码：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">setTimeout(() =&gt; &#123;</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    <span class="selector-tag">console</span><span class="selector-class">.log</span>(&quot;<span class="selector-tag">fn</span>&quot;);</span><br><span class="line">    process.nextTick(() =&gt; console.log(&quot;fn4&quot;));</span><br><span class="line">  &#125;, 0);</span><br><span class="line">  setImmediate(() =&gt; console.log(&quot;fn2&quot;));</span><br><span class="line">  process.nextTick(() =&gt; console.log(&quot;fn3&quot;));</span><br><span class="line">&#125;, 1000);</span><br></pre></td></tr></table></figure>

<p>由于 fn4 紧跟着 fn，所以在 timers 阶段完成后，就执行了 fn4（注意 fn4 不会放进 timers 的队列，而是在队列里函数执行完后，紧跟着执行 fn4），所以最终顺序为：</p>
<p>fn3, fn2, fn, fn4</p>
<h2 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  setImmediate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;setImmediate1&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;setTimeout1&#x27;</span>);</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;setTimeout2&#x27;</span>);</span><br><span class="line">    setImmediate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;setImmediate2&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<img src="/posts/10505/el-test.png" class="" title="el-test">

<p>执行第 2 行 setImmediate 后，把 setImmediate 中的函数 f1 放进 check 中（此刻不执行 f1），然后执行第 9 行的 setTimeout ，把 setTimeout 中的函数 f2 放进 timers 中（此刻也不执行 f2），然后进入 poll 阶段等待，发现有 f1 待执行，所以执行 f1，打印 setImmediate1 ，接着把 f3 放进 timers 的队列。此刻 check 阶段完成，重回 timers 阶段，发现队列中的 f2，执行 f2，打印 setTimeout2 ，接着把 f4 扔进 check 队列，然后执行 f3， 打印 setTimeout1 ，执行完后，进入 poll 阶段，发现有 f4 没执行，进入 check 阶段，执行 f4，所以最后打印 setImmediate2 。</p>
<h2 id="宏任务-amp-微任务"><a href="#宏任务-amp-微任务" class="headerlink" title="宏任务&amp;微任务"></a>宏任务&amp;微任务</h2><h3 id="Event-Loop"><a href="#Event-Loop" class="headerlink" title="Event Loop"></a>Event Loop</h3><h4 id="NodeJS："><a href="#NodeJS：" class="headerlink" title="NodeJS："></a>NodeJS：</h4><ul>
<li>timers（setTimeout）</li>
<li>poll</li>
<li>check（setImmediate）</li>
</ul>
<p><strong>注意：</strong>nextTick 不属于任何阶段，但会在当前阶段后执行</p>
<p>如果强行问 NodeJS 中的宏任务微任务，那就是：</p>
<p>setTimeout 和 setImmediate 是宏任务，nextTick 是微任务。因为 nextTick 不用等到下个阶段，会在当前阶段完成后立即执行。</p>
<p>还有个 promise.then(fn)【注意是小写的 p，大写的 P 不能直接 then】，一般不考。Node 中的 promise.then 一般是用 nextTick 实现的，所以也按照当前阶段的后面来推。这里 then 里面的 fn 不是马上放队列（setTImeout，setImmediate 和 nextTick 都是里面的 fn 马上放队列），而是当你 resolve 以后，才放进当前阶段的后面执行。</p>
<h4 id="chrome："><a href="#chrome：" class="headerlink" title="chrome："></a>chrome：</h4><ul>
<li>宏任务（一会儿）setTimeout</li>
<li>微任务（马上）.then(fn) <strong>fn 放马上</strong></li>
<li>一会儿就是等会做，马上就是立即做；如果一会儿里面有个马上做的，还是马上做。</li>
</ul>
<p><strong>注意：</strong></p>
<ol>
<li>遇到 await 把它转为 promise 再看，因为 await 本来就是 promise 的语法糖。</li>
<li>new Promise 是立即执行的，.then 才是微任务。</li>
</ol>
<h3 id="面试题-1"><a href="#面试题-1" class="headerlink" title="面试题"></a>面试题</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">await</span> async2();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async1();</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">4</span>);</span><br><span class="line">  resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">5</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>画图！！！不画图做不出来！！！</strong></p>
<p>代码从上到下，先执行 11 行 async1，进入 async1，<strong>先打印 1</strong>。遇到 await 转为 promise =&gt;</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">async2(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="number">3</span>)).then(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="number">2</span>));</span><br></pre></td></tr></table></figure>

<p>（<strong>await 后面所有代码都属于 then 当中的，</strong>比如第 4 行后面加个 console.log(“233”)，那么此行代码也属于 then）而 async2 本身的代码会被立即执行，<strong>所以打印第 8 行中的 3</strong>。打印完后<strong>执行 then （</strong>执行 then 其实是需要 resolve 的，但 async 会去看你函数中有没有 resolve，如果没有会自动加上 resolve，相当于 async 帮你干了这样一件事：<strong>Promise.resolve(**async2()</strong>)<strong>.then(f1)**）</strong>，<strong>then 就是放队列</strong>，我们把 <code>console.log(2)</code> 记做任务 f1 放进「马上」中去，但此刻不执行。此刻 async1 彻底执行完了。</p>
<p>接着执行 13 行的 new Promise，14 到 15 行代码会被立即执行（new Promise 中的函数会被立即执行，没有什么宏任务微任务，就相当于裸写 14 到 15 行代码），<strong>所以打印 4</strong>。在执行完 14 行 resolve 的时候，<strong>会指明执行 then 后面的第一个函数，而不是第二个函数（reject 时所执行的）</strong>，也就是 17 行代码的任务也放进「马上」中去，该任务记做 f2 ，至此当前代码全部执行完毕，然后看「马上」中的任务，执行 f1，<strong>打印 2</strong>。接着执行 f2， <strong>打印 5</strong>。</p>
<img src="/posts/10505/answer.png" class="" title="answer">

<p><strong>注意点</strong>：上面的 resolve 只是决定执行 then 里面的成功回调函数，并不决定加入队列。<strong>决定加入队列的是 then。</strong></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>宏任务（一会儿）：setTimeout，setInterval，setImmediate（优先级比前两个高，因为是在 check 阶段）</p>
<p>微任务（马上）：promise.then，process.nextTick</p>
<p>宏任务微任务执行顺序：有微任务先执行微任务，微任务都执行完了，再执行宏任务</p>
<p><a href="https://cdn.nlark.com/yuque/0/2019/png/260235/1557198825204-924929ec-1115-4e21-a771-cf18796f8f15.png?x-oss-process=image/resize,w_984">![image.png](Event Loop 学习笔记/resize,w_984.png)</a></p>
<p><a href="https://evestorm.github.io/tags/Node/"> Node</a> <a href="https://evestorm.github.io/tags/EventLoop/"> EventLoop</a></p>
]]></content>
      <categories>
        <category>后端</category>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
        <tag>EventLoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Github添加个人Profile</title>
    <url>/posts/22751/</url>
    <content><![CDATA[<p>用户现在可直接在 GitHub 个人页中添加 README 介绍，用于展示更加详细的个人信息。</p>
<p>效果：<a href="https://github.com/evestorm">https://github.com/evestorm</a></p>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>摘自：<a href="https://zhuanlan.zhihu.com/p/161029860">https://zhuanlan.zhihu.com/p/161029860</a></p>
<p>第一步，创建与 GitHub 用户名同名的代码仓库。</p>
<a id="more"></a>

<img src="/posts/22751/step1.jpg" class="" title="step1">

<p>第二步，返回个人页，即可看到成功生成 README 展示区块。</p>
<p>接着点击编辑按钮，用 Markdown 语法编写 README 文件，即可快速更新：</p>
<img src="/posts/22751/step2.jpg" class="" title="step2">

<h2 id="Github-Profile-模板"><a href="#Github-Profile-模板" class="headerlink" title="Github Profile 模板"></a>Github Profile 模板</h2><p>在 github 上找到了个 repo ，摘录了大量 Profile 模板，可以去上面找找自己心仪的应用到自己的 github 上：</p>
<p><a href="https://github.com/kautukkundan/Awesome-Profile-README-templates">https://github.com/kautukkundan/Awesome-Profile-README-templates</a></p>
<h2 id="Github-readme-统计数据"><a href="#Github-readme-统计数据" class="headerlink" title="Github readme 统计数据"></a>Github readme 统计数据</h2><p><a href="https://github.com/anuraghazra/github-readme-stats">https://github.com/anuraghazra/github-readme-stats</a></p>
<p>这个 repo 可以让我们统计 Github 上的一些数据信息。例如最近一年的提交次数，star 个数等。可以放进 Github Profile 中展示。</p>
<h2 id="徽章生成"><a href="#徽章生成" class="headerlink" title="徽章生成"></a>徽章生成</h2><p>经常看到不少 github 项目中有类似下图所示的徽章：</p>
<img src="/posts/22751/badge.jpg" class="" title="badge">

<p>这样的徽章可以在 <a href="https://shields.io/">https://shields.io/</a> 上生成。网上有不少教程，我就不自己写了，贴个链接：</p>
<p><a href="https://blog.csdn.net/woshiwangdaye/article/details/105182357">https://blog.csdn.net/woshiwangdaye/article/details/105182357</a></p>
]]></content>
      <tags>
        <tag>其他</tag>
        <tag>GitHub</tag>
      </tags>
  </entry>
  <entry>
    <title>Git回滚到历史节点=&gt;SourceTree篇(转载)</title>
    <url>/posts/19083/</url>
    <content><![CDATA[<p>转载自：<a href="https://blog.csdn.net/u010416101/article/details/78142697">https://blog.csdn.net/u010416101/article/details/78142697</a></p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>原理，我们都知道 Git 是基于 Git 树进行管理的，要想要回滚必须做到如下 2 点:</p>
<ol>
<li>本地头节点与远端头节点一样(Git 提交代码的前提条件)；</li>
<li>于本地头节点获取某次历史节点的更改。</li>
</ol>
<a id="more"></a>

<p>说的有点抽象，以图来进行形容：</p>
<img src="/posts/19083/head-node.jpeg" class="" title="head-node">

<h2 id="详细步骤"><a href="#详细步骤" class="headerlink" title="详细步骤"></a>详细步骤</h2><p>步骤简记如下:<br>两个节点 当前节点(最新节点) 与 历史节点</p>
<ol>
<li>点击历史节点，重置到历史节点，选择硬合并；</li>
<li>点击当前节点，重置到当前节点，选择软合并；</li>
<li>提交；</li>
</ol>
<p>PS: 注意检出 Head 不是重置步骤！Head 节点是不属于任何一个节点的。</p>
<h2 id="详细步骤-图示"><a href="#详细步骤-图示" class="headerlink" title="详细步骤(图示)"></a>详细步骤(图示)</h2><p>1 点击历史节点，重置到历史节点</p>
<img src="/posts/19083/reset-1.jpeg" class="" title="reset-1">

<p>2 选择硬合并</p>
<img src="/posts/19083/merge-1.jpeg" class="" title="merge-1">

<p>3 点击当前节点，重置到当前节点</p>
<img src="/posts/19083/reset-2.jpeg" class="" title="reset-2">

<p>4 选择软合并</p>
<img src="/posts/19083/merge-2.jpeg" class="" title="merge-2">

<p>5 提交</p>
<img src="/posts/19083/submit-1.jpeg" class="" title="submit-1">

<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ol>
<li><a href="https://www.zhihu.com/question/48178380">(知乎)Source tree 如何回滚到以前版本？</a></li>
<li><a href="https://blog.csdn.net/zhangbinsijifeng/article/details/47005613">(新拉分支做法)使用 SourceTree 将 bitbucket 的远程仓库回滚到某一次提交</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/23970048">(知乎)Git 自动回滚 和 应用发布的二三事</a></li>
<li><a href="https://www.cnblogs.com/hopeway-shaon/p/5740280.html">(博客园 操作图示)sourceTree 回滚操作</a></li>
</ol>
]]></content>
      <categories>
        <category>工具</category>
        <category>版本控制</category>
      </categories>
      <tags>
        <tag>转载</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Git学习笔记</title>
    <url>/posts/8520/</url>
    <content><![CDATA[<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>安装链接：<a href="https://git-scm.com/book/zh/v2/%E8%B5%B7%E6%AD%A5-%E5%AE%89%E8%A3%85-Git">起步 - 安装 Git</a></p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="配置-user-name-和-user-email"><a href="#配置-user-name-和-user-email" class="headerlink" title="配置 user.name 和 user.email"></a>配置 user.name 和 user.email</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git config --global user.name &#x27;your name&#x27;</span><br><span class="line">git config --global user.email &#x27;your_email@domain.com&#x27;</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="相关配置说明"><a href="#相关配置说明" class="headerlink" title="相关配置说明"></a>相关配置说明</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git config --local 只针对某个仓库有效</span><br><span class="line">git config --global 对当前用户的所有仓库有效</span><br><span class="line">git config --system 对系统所有登录用户有效</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示 config 的配置</span></span><br><span class="line">git config --list --local</span><br><span class="line">git config --list --global</span><br><span class="line">git config --list --system</span><br></pre></td></tr></table></figure>

<h2 id="创建-Git-仓库"><a href="#创建-Git-仓库" class="headerlink" title="创建 Git 仓库"></a>创建 Git 仓库</h2><h3 id="1-把已有的项目代码纳入-Git-管理"><a href="#1-把已有的项目代码纳入-Git-管理" class="headerlink" title="1. 把已有的项目代码纳入 Git 管理"></a>1. 把已有的项目代码纳入 Git 管理</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd 项目代码所在文件夹</span><br><span class="line">git init</span><br></pre></td></tr></table></figure>

<h3 id="2-新建的项目直接用-Git-管理"><a href="#2-新建的项目直接用-Git-管理" class="headerlink" title="2. 新建的项目直接用 Git 管理"></a>2. 新建的项目直接用 Git 管理</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd 某个文件夹</span><br><span class="line">git init your_project # 会在当前路径下创建和项目名称同名的文件夹</span><br><span class="line">cd your_project</span><br></pre></td></tr></table></figure>

<h2 id="常见-Git-命令"><a href="#常见-Git-命令" class="headerlink" title="常见 Git 命令"></a>常见 Git 命令</h2><ul>
<li><p><code>git init</code> 创建 git 仓库</p>
</li>
<li><pre><code class="shell">git clone
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  拷贝现有仓库（本地 or 远程）</span><br><span class="line"></span><br><span class="line">  - &#96;git clone LINK custom_name&#96; 拷贝现有仓库并重命名</span><br><span class="line"></span><br><span class="line">- &#96;&#96;&#96;shell</span><br><span class="line">  git log</span><br></pre></td></tr></table></figure>

查看 commit 日志

- `git log --oneline` 一行显示 commit 的提交信息

- ```shell
  git log --stat
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">    用来显示 commit 中更改的文件以及添加或删除的行数</span><br><span class="line"></span><br><span class="line">    - 显示被修改的文件</span><br><span class="line">    - 显示添加&#x2F;删除的行数</span><br><span class="line">    - 显示一个摘要，其中包含修改&#x2F;删除的总文件数和总行数</span><br><span class="line"></span><br><span class="line">- &#96;&#96;&#96;shell</span><br><span class="line">  git add index.html</span><br></pre></td></tr></table></figure>

暂存文件

- `git add .` 暂存所有</code></pre>
</li>
<li><p><code>git status</code> 了解仓库状况</p>
</li>
<li><p><code>git commit -m &#39;初次提交&#39;</code> 提交 commit</p>
</li>
<li><p><code>git diff</code> 命令用来查看已经执行但是尚未 commit 的更改</p>
</li>
<li><pre><code class="shell">git branch
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  列出所有分支</span><br><span class="line"></span><br><span class="line">  - &#96;git branch sidebar&#96; 创建分支</span><br><span class="line">  - &#96;git checkout sidebar&#96; 切换分支</span><br><span class="line">  - &#96;git checkout -b sidebar&#96; 新建分支并切换到新建的分支</span><br><span class="line">  - &#96;git branch -d sidebar&#96; 删除分支</span><br><span class="line"></span><br><span class="line">- &#96;git merge &lt;name-of-branch-to-merge-in&gt;&#96; 合并分支</span><br><span class="line"></span><br><span class="line">- &#96;git reset --hard HEAD^&#96; 如果在错误的分支上进行了合并，可以使用此命令撤消</span><br><span class="line"></span><br><span class="line">## 合并分支</span><br><span class="line"></span><br><span class="line">要合并 &#96;sidebar&#96; 分支，确保你位于 &#96;master&#96; 分支上，并运行：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;shell</span><br><span class="line">git merge sidebar</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<p>合并有以下两种类型：</p>
<ul>
<li>快进合并 – 要合并的分支必须位于检出分支前面。检出分支的指针将向前移动，指向另一分支所指向的同一 commit。</li>
<li>普通类型的合并<ul>
<li>两个完全不同的分支被合并</li>
<li>创建一个合并 commit</li>
</ul>
</li>
</ul>
<h3 id="合并冲突"><a href="#合并冲突" class="headerlink" title="合并冲突"></a>合并冲突</h3><h4 id="合并冲突指示符解释"><a href="#合并冲突指示符解释" class="headerlink" title="合并冲突指示符解释"></a>合并冲突指示符解释</h4><p>编辑器具有以下合并冲突指示符：</p>
<ul>
<li><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</code> 此行下方的所有内容（直到下个指示符）显示了当前分支上的行</li>
<li><code>||||||| merged common ancestors</code> 此行下方的所有内容（直到下个指示符）显示了原始行的内容</li>
<li><code>=======</code> 表示原始行内容的结束位置，之后的所有行（直到下个指示符）是被合并的当前分支上的行的内容</li>
<li><code>&gt;&gt;&gt;&gt;&gt;&gt;&gt; heading-update</code> 是要被合并的分支（此例中是 <code>heading-update</code> 分支）上的行结束指示符</li>
</ul>
<p>当相同的行在要合并的不同分支上做出了更改时，就会出现合并冲突。git 将在合并途中暂停，并告诉你存在冲突，以及哪些文件存在冲突。要解决文件中的冲突：</p>
<ul>
<li>找到并删掉存在合并冲突指示符的所有行</li>
<li>决定保留哪些行</li>
<li>保存文件</li>
<li>暂存文件</li>
<li>提交 commit</li>
</ul>
<p>注意一个文件可能在多个部分存在合并冲突，因此检查整个文件中的合并冲突指示符，搜索 <code>&lt;&lt;&lt;</code> 能够帮助你找到所有这些指示符。</p>
<h2 id="撤销更改"><a href="#撤销更改" class="headerlink" title="撤销更改"></a>撤销更改</h2><h3 id="更改最后一个-commit"><a href="#更改最后一个-commit" class="headerlink" title="更改最后一个 commit"></a>更改最后一个 commit</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git commit --amend</span><br></pre></td></tr></table></figure>

<p>借助 <code>--amend</code> 选项，可以更改最近的 commit。</p>
<p>如果你的工作目录没有内容（也就是仓库中没有任何未 commit 的更改），那么运行 <code>git commit --amend</code> 将使你能够重新提供 commit 消息。代码编辑器将打开，并显示原始 commit 消息。只需纠正拼错的单词或重新表述即可！然后保存文件并关闭编辑器，以便采用新的 commit 消息。</p>
<h3 id="向-commit-中添加忘记的文件"><a href="#向-commit-中添加忘记的文件" class="headerlink" title="向 commit 中添加忘记的文件"></a>向 commit 中添加忘记的文件</h3><p>此外，<code>git commit --amend</code> 使你能够包含忘记包含的文件（或文件更改）。假设你更新了整个网站的导航链接颜色。commit 了该更改，并以为完事了。但是后来发现深藏在页面上的一个特殊导航链接没有新的颜色。你可以执行新的 commit 并更新该链接的颜色，但是这样就会出现两个 commit 执行完全相同的任务（更改链接颜色）。</p>
<p>相反，你可以修改最后一个 commit（更新所有其他链接颜色的 commit）以包含这个忘记的链接。要包含忘记的链接，只需：</p>
<ul>
<li>编辑文件</li>
<li>保存文件</li>
<li>暂存文件</li>
<li>运行 <code>git commit --amend</code></li>
</ul>
<p>你对必要的 CSS 和/或 HTML 文件作出了更改，以便修正被遗忘的链接样式，然后保存所有被修改的文件，并使用 <code>git add</code> 暂存所有被修改的文件（就像要提交新的 commit 那样！），但是你可以运行 <code>git commit --amend</code> 来更新最近的 commit，而不是创建新的 commit。</p>
<h3 id="还原-commit"><a href="#还原-commit" class="headerlink" title="还原 commit"></a>还原 commit</h3><p>创建了一个包含一些更改的 commit，然后使用 <code>git revert</code> 命令还原它</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git revert &lt;SHA-of-commit-to-revert&gt;</span><br></pre></td></tr></table></figure>

<p>因为最近的 commit 的 SHA 是 <code>db7e87a</code>，要还原该 commit： 需要运行 <code>git revert db7e87a</code>（随即弹出代码编辑器，以便编辑/确认提供的 commit 消息）</p>
<p><strong>注意此命令：</strong></p>
<ul>
<li>将撤消目标 commit 所做出的更改</li>
<li>创建一个新的 commit 来记录这一更改</li>
</ul>
<h3 id="重置-commit"><a href="#重置-commit" class="headerlink" title="重置 commit"></a>重置 commit</h3><p>初看，<strong>重置（reset）</strong> 似乎和 <strong>还原（revert）</strong> 相似，但它们实际上差别很大。还原会创建一个新的 commit，并还原或撤消之前的 commit。但是重置会清除 commit！</p>
<blockquote>
<p>⚠️ 重置很危险 ⚠️</p>
</blockquote>
<blockquote>
<p>一定要谨慎使用 git 的重置功能。这是少数几个可以从仓库中清除 commit 的命令。如果某个 commit 不再存在于仓库中，它所包含的内容也会消失。</p>
</blockquote>
<blockquote>
<p>P.S. git 会在完全清除任何内容之前，持续跟踪大约 30 天。要调用这些被重置的内容，需要使用 <code>git reflog</code> 命令。你可以参阅以下链接以了解详情：</p>
</blockquote>
<blockquote>
<ul>
<li><a href="https://git-scm.com/docs/git-reflog">git-reflog (英)</a></li>
<li><a href="https://www.atlassian.com/git/tutorials/rewriting-history">重写历史记录 (英)</a></li>
<li><a href="http://gitready.com/intermediate/2009/02/09/reflog-your-safety-net.html">reflog，你的安全屏障 (英)</a></li>
</ul>
</blockquote>
<h3 id="相关-commit-引用"><a href="#相关-commit-引用" class="headerlink" title="相关 commit 引用"></a>相关 commit 引用</h3><p>我们知道可以使用 SHA、标签、分支和特殊的 <code>HEAD</code> 指针引用 commit。但有时候这些并不足够，我们可能需要引用相对于另一个 commit 的 commit。例如，有时候我们需要告诉 git 调用当前 commit 的前一个 commit，或者是前两个 commit。我们可以使用特殊的“祖先引用”字符来告诉 git 这些相对引用。这些字符为：</p>
<ul>
<li><code>^</code> – 表示父 commit</li>
<li><code>~</code> – 表示第一个父 commit</li>
</ul>
<p>我们可以通过以下方式引用之前的 commit：</p>
<ul>
<li>父 commit – 以下内容表示当前 commit 的父 commit</li>
<li><code>HEAD^</code></li>
<li><code>HEAD~</code></li>
<li><code>HEAD~1</code></li>
<li>祖父 commit – 以下内容表示当前 commit 的祖父 commit</li>
<li>HEAD^^</li>
<li>HEAD~2</li>
<li>曾祖父 commit – 以下内容表示当前 commit 的曾祖父 commit</li>
<li>HEAD^^^</li>
<li>HEAD~3</li>
</ul>
<p><code>^</code> 和 <code>~</code> 的区别主要体现在通过合并而创建的 commit 中。合并 commit 具有两个父级。对于合并 commit，<code>^</code> 引用用来表示第一个父 commit，而 <code>^2</code> 表示第二个父 commit。第一个父 commit 是当你运行 <code>git merge</code> 时所处的分支，而第二个父 commit 是被合并的分支。</p>
<p>我们来看一个示例，这样更好理解。这是我的 <code>git log</code> 当前的显示结果：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">* 9ec05ca (HEAD -&gt; master) Revert &quot;Set page heading to &quot;Quests &amp; Crusades&quot;&quot;</span><br><span class="line">* db7e87a Set page heading to &quot;Quests &amp; Crusades&quot;</span><br><span class="line">*   796ddb0 Merge branch &#x27;heading-update&#x27;</span><br><span class="line">|\</span><br><span class="line">| * 4c9749e (heading-update) Set page heading to &quot;Crusade&quot;</span><br><span class="line">* | 0c5975a Set page heading to &quot;Quest&quot;</span><br><span class="line">|/</span><br><span class="line">*   1a56a81 Merge branch &#x27;sidebar&#x27;</span><br><span class="line">|\</span><br><span class="line">| * f69811c (sidebar) Update sidebar with favorite movie</span><br><span class="line">| * e6c65a6 Add new sidebar content</span><br><span class="line">* | e014d91 (footer) Add links to social media</span><br><span class="line">* | 209752a Improve site heading for SEO</span><br><span class="line">* | 3772ab1 Set background color for page</span><br><span class="line">|/</span><br><span class="line">* 5bfe5e7 Add starting HTML structure</span><br><span class="line">* 6fa5f34 Add .gitignore file</span><br><span class="line">* a879849 Add header to blog</span><br><span class="line">* 94de470 Initial commit</span><br></pre></td></tr></table></figure>

<p>我们来看看如何引用一些之前的 commit。因为 <code>HEAD</code> 指向 <code>9ec05ca</code> commit：</p>
<ul>
<li><code>HEAD^</code> 是 <code>db7e87a</code> commit</li>
<li><code>HEAD~1</code> 同样是 <code>db7e87a</code> commit</li>
<li><code>HEAD^^</code> 是 <code>796ddb0</code> commit</li>
<li><code>HEAD~2</code> 同样是 <code>796ddb0</code> commit</li>
<li><code>HEAD^^^</code> 是 <code>0c5975a</code> commit</li>
<li><code>HEAD~3</code> 同样是 <code>0c5975a</code> commit</li>
<li><code>HEAD^^^2</code> 是 <code>4c9749e</code> commit（这是曾祖父的 (<code>HEAD^^</code>) 第二个父 commit (<code>^2</code>))</li>
</ul>
<h3 id="git-reset-命令"><a href="#git-reset-命令" class="headerlink" title="git reset 命令"></a><code>git reset</code> 命令</h3><p><code>git reset</code> 命令用来重置（清除）commit：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git reset &lt;reference-to-commit&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以用来：</p>
<ul>
<li>将 HEAD 和当前分支指针移到目标 commit</li>
<li>清除 commit</li>
<li>将 commit 的更改移到暂存区</li>
<li>取消暂存 commit 的更改</li>
</ul>
<h4 id="git-reset-的选项"><a href="#git-reset-的选项" class="headerlink" title="git reset 的选项"></a>git reset 的选项</h4><p>git 根据所使用选项来判断是清除、暂存之前 commit 的更改，还是取消暂存之前 commit 的更改。这些选项包括：</p>
<blockquote>
<p>起始</p>
</blockquote>
<img src="/posts/8520/image-20200120161811703.png" class="" title="image-20200120161811703">

<h5 id="mixed-git-reset-默认执行的此操作"><a href="#mixed-git-reset-默认执行的此操作" class="headerlink" title="-mixed git reset 默认执行的此操作"></a><code>-mixed</code> git reset 默认执行的此操作</h5><img src="/posts/8520/image-20200120162215190.png" class="" title="image-20200120162215190">

<p>此刻执行 <code>git reset HEAD~1</code> 会把 <code>3</code> 中的提交存留于<strong>工作区</strong>的文件中，更改未暂存。</p>
<p>如果此刻我们暂存文件并再次提交，将会获得相同的提交内容。但我们会获得一个不同的提交 SHA，这是因为本次提交的时间戳和之前的 <code>3</code> 不同。但提交内容完全一样。</p>
<h5 id="soft"><a href="#soft" class="headerlink" title="--soft"></a><code>--soft</code></h5><img src="/posts/8520/image-20200120162410814.png" class="" title="image-20200120162410814">

<p>此刻执行 <code>git reset --soft HEAD~1</code> 会把 <code>3</code> 中的提交放进<strong>暂存区</strong>。这些更改仍然相同，而且已经暂存好了，如果你再 commit 会得到 reset 前一样的版本。同样 SHA 值不同。</p>
<h5 id="hard"><a href="#hard" class="headerlink" title="--hard"></a><code>--hard</code></h5><img src="/posts/8520/image-20200120162626566.png" class="" title="image-20200120162626566">

<p>此刻执行 <code>git reset --hard HEAD~1</code> 会把 <code>3</code> 中的提交全部删除。</p>
<h4 id="小节"><a href="#小节" class="headerlink" title="小节"></a>小节</h4><p>总结下，<code>git reset</code> 命令被用来清除 commit：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git reset &lt;reference-to-commit&gt;</span></span><br></pre></td></tr></table></figure>

<p>它可以用来：</p>
<ul>
<li>将 HEAD 和当前分支指针移到引用的 commit</li>
<li>使用 <code>--hard</code> 选项清除 commit</li>
<li>使用 <code>--soft</code> 选项将 commit 的更改移至暂存区</li>
<li>使用 <code>--mixed</code> 选项取消暂存已被 commit 的更改</li>
</ul>
<p>我们通常会用到祖先引用来指代之前的 commit。祖先引用包含：</p>
<ul>
<li><code>^</code> – 表示父 commit</li>
<li><code>~</code> – 表示第一个父 commit</li>
</ul>
<h2 id="使用远程仓库"><a href="#使用远程仓库" class="headerlink" title="使用远程仓库"></a>使用远程仓库</h2><h3 id="添加远程仓库"><a href="#添加远程仓库" class="headerlink" title="添加远程仓库"></a>添加远程仓库</h3><p>使用下面命令，在本地仓库与 GitHub 帐户上创建的远程仓库之间创建连接。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/richardkalehoff/RichardsFantasticProject.git</span><br></pre></td></tr></table></figure>

<p>对于刚在命令行中运行的命令，有几点需要注意：</p>
<ol>
<li><p>首先，这条命令包含一个子命令 <code>add</code></p>
</li>
<li><p>这里使用了 <code>origin</code> 一词，设置了我们之前所说的简写名</p>
<ul>
<li><p>记住， <code>origin</code> 一词并没什么特殊性。</p>
</li>
<li><p>如果你想将它改为 <code>repo-on-GitHub</code>，那么只需（在运行命令之前）将 “origin” 改为 “repo-on-GitHub”：</p>
<p><code>$ git remote add repo-on-GitHub https://github.com/richardkalehoff/RichardsFantasticProject.git</code></p>
</li>
</ul>
</li>
<li><p>第三，添加了仓库的完整路径（即 Web 上的远程仓库 URL）</p>
</li>
</ol>
<p>然后使用 <code>git remote -v</code> 来验证我已经正确添加了远程仓库。</p>
<h3 id="将更改推送到远程仓库"><a href="#将更改推送到远程仓库" class="headerlink" title="将更改推送到远程仓库"></a>将更改推送到远程仓库</h3><p>要将本地 commits 推送到远程仓库，你需要使用 <code>git push</code> 命令。你要提供远程仓库简写名以及用于容纳你的 commit 的分支名：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git push &lt;remote-shortname&gt; &lt;branch&gt;</span></span><br></pre></td></tr></table></figure>

<p>我的远程仓库的简写名为 <code>origin</code>，并且我想推送的 commit 位于<code>master</code>分支上。那么，我要使用以下命令将我的 commit 推送到 GitHub 上的远程仓库：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git push origin master</span></span><br></pre></td></tr></table></figure>

<h3 id="从远程仓库拉取修改"><a href="#从远程仓库拉取修改" class="headerlink" title="从远程仓库拉取修改"></a>从远程仓库拉取修改</h3><p><code>git push</code> 会同步<strong>远程</strong>仓库与<strong>本地</strong>仓库。要执行相反操作（将<strong>本地仓库</strong>与<strong>远程仓库</strong>同步），我们需要使用 <code>git pull</code>。<code>git pull</code> 的格式与 <code>git push</code> 的非常相似 - 提供远程仓库的简写名，以及你要拉取 commit 的分支名称。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git pull origin master</span></span><br></pre></td></tr></table></figure>

<h4 id="Fetch-vs-Pull"><a href="#Fetch-vs-Pull" class="headerlink" title="Fetch vs Pull"></a>Fetch vs Pull</h4><p>git fetch 用于从远程仓库分支检索 commit ，但<strong>不会</strong>在收到这些 commit 之后，自动将本地分支与远程跟踪分支合并。</p>
<p>上面的段落有点密集，你可以多读几遍。</p>
<p>你需要向 <code>git fetch</code> 提供和 <code>git pull</code> 完全相同的信息，也就是说要提供你想获取的远程仓库的简写名及其分支：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git fetch origin master</span></span><br></pre></td></tr></table></figure>

<p>运行 <code>git fetch</code> 后，会发生以下活动：</p>
<ul>
<li>远程分支上的 commit 会复制到本地仓库</li>
<li>本地跟踪分支（例如，<code>origin/master</code>）移到指向最新的 commit</li>
</ul>
<p>需要注意的一点是，本地分支完全不会被改变。</p>
<p>你可以将 <code>git fetch</code> 想象成 <code>git pull</code> 它的一半操作，而 <code>git pull</code> 的另一半是合并。</p>
<p>使用 <code>git fetch</code> 而不是 <code>git pull</code> 的一个主要情形是当你的远程分支和本地分支都拥有对方所没有的更改时。在这种情况下，你要获取远程更改，将它们存储到本地分支中，然后手动执行合并。最后，你可以将新的合并 commit 推送会远程仓库。</p>
<h2 id="常见终端命令"><a href="#常见终端命令" class="headerlink" title="常见终端命令"></a>常见终端命令</h2><ul>
<li><pre><code>ls
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  \- 用来列出文件和目录</span><br><span class="line"></span><br><span class="line">  - &#96;ls -l&#96; 列出文件和目录（长列表形式，更详细）</span><br><span class="line">  - &#96;ls *.png&#96; 列出后缀为 png 的图像文件</span><br><span class="line"></span><br><span class="line">- &#96;mkdir&#96; - 用来新建目录</span><br><span class="line"></span><br><span class="line">- &#96;&#96;&#96;</span><br><span class="line">  mv</span><br></pre></td></tr></table></figure>

\- 移动文件

- `mv logo.png Project` 把 logo.png 文件移入 Project 文件夹
- `mv Document/*.png Project` 把 Document 文件夹下所有 .png 结尾文件扔进 Project 文件夹</code></pre>
</li>
<li><p><code>cd</code> - 用来更换当前目录</p>
</li>
<li><p><code>pwd</code> - 查看当前工作目录</p>
</li>
<li><p><code>rm</code> - 用来删除文件和目录</p>
</li>
<li><p><code>rmdir</code> - 用来删除目录</p>
</li>
<li><pre><code>cat</code></pre>
<p>- 查看文件内容（文件内容过多会直接定位到文件最底部）</p>
<ul>
<li><code>cat less</code> 只显示一屏高度的文件内容（按下 q 退出）</li>
</ul>
</li>
</ul>
<h3 id="less-分页器"><a href="#less-分页器" class="headerlink" title="less 分页器"></a>less 分页器</h3><ul>
<li>要<strong>向下</strong>滚动，按下</li>
<li><code>j</code> 或 <code>↓</code> 一次向下移动一行</li>
<li><code>d</code> 按照一半的屏幕幅面移动</li>
<li><code>f</code> 按照整个屏幕幅面移动</li>
<li>要 <strong>向上</strong>滚动，按上</li>
<li><code>k</code> 或 <code>↑</code> 一次向上移动一行</li>
<li><code>u</code> 按照一半的屏幕幅面移动</li>
<li><code>b</code> 按照整个屏幕幅面移动</li>
<li>按下 <code>q</code> 可以<strong>退出</strong>日志（返回普通的命令提示符）</li>
</ul>
]]></content>
      <categories>
        <category>工具</category>
        <category>版本控制</category>
      </categories>
      <tags>
        <tag>Git</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>Grid布局入门</title>
    <url>/posts/42136/</url>
    <content><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><h3 id="什么是-Grid-Layout"><a href="#什么是-Grid-Layout" class="headerlink" title="什么是 Grid Layout"></a>什么是 Grid Layout</h3><p>Grid Layout 翻译过来是[网格布局]的意思，它是一个二维系统，包含了行（row）与列（column）以及间距（gap）。下图能够很好的说明这一点（图片来自<a href="https://developer.mozilla.org/zh-CN/docs/Learn/CSS/CSS_layout/Grids">mdn</a>）：</p>
<img src="/posts/42136/grid.png" class="" title="grid_layout">

<a id="more"></a>

<h3 id="Grid-vs-Flex"><a href="#Grid-vs-Flex" class="headerlink" title="Grid vs Flex"></a>Grid vs Flex</h3><p>工作中写移动端页面的朋友对 Flex 布局肯定不陌生，有些人可能更极端一点，直接 Flex 一把梭。那 Grid 和 Flex 有什么区别呢？我们仍然可以用一张图片进行举例说明：</p>
<img src="/posts/42136/gridvflex.png" class="" title="grid-vs-flex">

<p>在上图中，我们可以使用 Grid 来搭建页面的整体结构；而使用 Flex 控制 Grid 中的单个区域，例如顶部导航栏中的具体内容。</p>
<p><strong>Grid vs Flex 总结</strong></p>
<ul>
<li>Grid 是一种二维布局方式，而 Flex 是一维的。</li>
<li>Grid 重点关注布局, 而 Flex 重点关注内容的流向。</li>
<li>Flex 适用于应用的组件，而 Grid 适用于应用本身的布局。</li>
</ul>
<p>总的来说，Grid 擅长搭建布局结构，而 Flex 则擅长处理元素的流向。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="行与列"><a href="#行与列" class="headerlink" title="行与列"></a>行与列</h3><p>首先我们需要将容器的 display 属性设置为 grid，然后使用下列 CSS 属性来控制其中的行与列：</p>
<ul>
<li>grid-template-columns 用来划分列数</li>
<li>grid-template-rows 用来划分行数</li>
</ul>
<h4 id="固定宽度-amp-百分比宽度"><a href="#固定宽度-amp-百分比宽度" class="headerlink" title="固定宽度 &amp; 百分比宽度"></a>固定宽度 &amp; 百分比宽度</h4><iframe height="826" scrolling="no" title="01-grid-行与列基本使用" src="https://codepen.io/JingW/embed/RwNjowB?height=826&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="重复设置"><a href="#重复设置" class="headerlink" title="重复设置"></a>重复设置</h4><p>通过上面 demo 你会发现一个问题，如果一行有 3 列，我们就需要定义 3 列各自的宽，那如果有 10 列，20 列呢？难道都需要一个个设置，岂不是太麻烦了？所以重复设置的需求应运而生。我们可以使用 <code>repeat</code> 统一设置值，第一个参数为重复数量，第二个参数是重复值。下面是两个示例：</p>
<iframe height="1030" scrolling="no" title="02-grid-repeat重复" src="https://codepen.io/JingW/embed/abzVQmR?height=1020&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="比例划分"><a href="#比例划分" class="headerlink" title="比例划分"></a>比例划分</h4><p>我们还可以像 Flex 布局的 <code>flex: 1</code> 那样，给布局中的元素设置比例。在 Grid 中，我们使用 <code>fr</code> 这个单位来设置元素在空间中所占的比例。</p>
<iframe height="700" scrolling="no" title="03-grid-比例划分" src="https://codepen.io/JingW/embed/oNgoQEK?height=700&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="组合定义"><a href="#组合定义" class="headerlink" title="组合定义"></a>组合定义</h4><p><code>grid-tempalte</code> 是 <code>grid-template-rows</code>、<code>grid-template-columns</code>、<code>grid-template-areas</code> 的三个属性的简写。</p>
<p>下面是使用 <code>grid-template</code> 同时声明 <code>grid-template-rows、grid-template-columns</code>。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">grid-template</span>: 100<span class="selector-tag">px</span> 1<span class="selector-tag">fr</span> / 50<span class="selector-tag">px</span> 1<span class="selector-tag">fr</span>;</span><br></pre></td></tr></table></figure>

<p>下面是使用 <code>grid-template</code> 定义 <code>grid-template-areas</code> ，有关 <code>grid-template-areas</code> 的使用方法会在下面介绍：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">grid-template</span>:</span><br><span class="line">  &#x27;header . .&#x27;</span><br><span class="line">  &#x27;. main .&#x27;</span><br><span class="line">  &#x27;footer footer .&#x27;;</span><br></pre></td></tr></table></figure>

<iframe height="1133" scrolling="no" title="yLyPQjj" src="https://codepen.io/JingW/embed/yLyPQjj?height=1133&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="minmax"><a href="#minmax" class="headerlink" title="minmax"></a>minmax</h4><p>使用 minmax 方法可以设置取值范围。下面行高在 <code>最小100px ~ 最大1fr</code> 间取值：</p>
<iframe height="531" scrolling="no" title="05-grid-minmax设置最大最小值" src="https://codepen.io/JingW/embed/dyPZQro?height=531&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="间距"><a href="#间距" class="headerlink" title="间距"></a>间距</h3><h4 id="行间距"><a href="#行间距" class="headerlink" title="行间距"></a>行间距</h4><iframe height="439" scrolling="no" title="06-grid-行间距row-gap" src="https://codepen.io/JingW/embed/ExabOqB?height=439&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="列间距"><a href="#列间距" class="headerlink" title="列间距"></a>列间距</h4><iframe height="443" scrolling="no" title="07-grid-列间距column-gap" src="https://codepen.io/JingW/embed/QWwOzLr?height=443&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="间距简写"><a href="#间距简写" class="headerlink" title="间距简写"></a>间距简写</h4><p>使用 gap 规则可以一次定义行、列间距，如果间距一样可以只设置一个值：</p>
<iframe height="437" scrolling="no" title="07-grid-间距简写gap" src="https://codepen.io/JingW/embed/zYxPyOQ?height=437&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="网格线命名"><a href="#网格线命名" class="headerlink" title="网格线命名"></a>网格线命名</h3><p>通过 grid-template-rows 和 grid-template-columns 定义网格时，网格线可以被命名。网格线名称也可以设置网格项目位置</p>
<p>分配网格线名称必须用方括号[网格线名称]，然后后面紧跟网格轨道的尺寸值。定义网格线名称时需要避免使用规范中出现的关键词，以免导致混乱。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">grid-template-rows</span>: <span class="selector-attr">[row-1-start]</span> 1<span class="selector-tag">fr</span> <span class="selector-attr">[row-2-start]</span> 1<span class="selector-tag">fr</span> <span class="selector-attr">[row-2-end]</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">grid-template-columns</span>: <span class="selector-attr">[col-1-start]</span> 1<span class="selector-tag">fr</span> <span class="selector-attr">[col-2-start]</span> 1<span class="selector-tag">fr</span> <span class="selector-attr">[col-3-start]</span> 1<span class="selector-tag">fr</span> <span class="selector-attr">[col-3-end]</span>;</span><br></pre></td></tr></table></figure>

<img src="/posts/42136/shangexian.png" class="" title="栅格线">

<p>可以在方括号中添加多个名称来命名网格线名称，使用多外名称命名网格线名称时，名称间要用空格隔开。每一个网格线的名称可以用来定位网格项目的位置</p>
<img src="/posts/42136/shangexianduomingming.png" class="" title="栅格线多命名">

<p>使用网格线名称设置网格项目位置和使用网格线号码设置网格项目位置类似，引用网格线名称的时候不应该带方括号</p>
<p>使用 repeat()函数可以给网格线分配相同的名称。这可以节省一定的时间。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">grid-template-rows</span>: <span class="selector-tag">repeat</span>(3, <span class="selector-attr">[row-start]</span> 1<span class="selector-tag">fr</span> <span class="selector-attr">[row-end]</span>);</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">grid-template-columns</span>: <span class="selector-tag">repeat</span>(3, <span class="selector-attr">[col-start]</span> 1<span class="selector-tag">fr</span> <span class="selector-attr">[col-end]</span>);</span><br></pre></td></tr></table></figure>

<p>使用 repeat()函数可以给网格线命名，这也导致多个网格线具有相同的网格线名称。相同网格线名称指定网格线的位置和名称，也且会自动在网格线名称后面添加对应的数字，使其网格线名称也是唯一的标识符</p>
<img src="/posts/42136/shangexianrepeat.png" class="" title="repeat命名栅格线">

<p>使用相同的网格线名称可以设置网格项目的位置。网格线的名称和数字之间需要用空格分开</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">grid-row</span>: <span class="selector-tag">row-start</span> 2 / <span class="selector-tag">row-end</span> 3;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">grid-column</span>: <span class="selector-tag">col-start</span> / <span class="selector-tag">col-start</span> 3;</span><br></pre></td></tr></table></figure>

<h3 id="网格区域命名"><a href="#网格区域命名" class="headerlink" title="网格区域命名"></a>网格区域命名</h3><p>像网格线名称一样，网格区域的名称可以使用 grid-template-areas 属性来命名。引用网格区域名称也可以设置网格项目位置。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">grid-template-areas: &#x27;header header&#x27; &#x27;content sidebar&#x27; &#x27;footer footer&#x27;;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">grid-template-rows</span>: 150<span class="selector-tag">px</span> 1<span class="selector-tag">fr</span> 100<span class="selector-tag">px</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">grid-template-columns</span>: 1<span class="selector-tag">fr</span> 200<span class="selector-tag">px</span>;</span><br></pre></td></tr></table></figure>

<p>设置网格区域的名称应该放置在单引号或双引号内，每个名称由一个空格符分开。网格区域的名称，每组（单引号或双引号内的网格区域名称）定义了网格的一行，每个网格区域名称定义网格的一列</p>
<p><strong>[注意]grid-template-areas: “header header” “content sidebar” “footer footer”;不可以简写为 grid-template-areas: “header” “content sidebar” “footer”;</strong></p>
<img src="/posts/42136/grid-template-areas.png" class="" title="grid-template-areas">

<p>grid-row-start、grid-row-end、grid-column-start 和 grid-column-end 以及简写的 grid-row、grid-column、grid-area 都可以引用网格区域名称，用来设置网格项目位置</p>
<h3 id="元素定位"><a href="#元素定位" class="headerlink" title="元素定位"></a>元素定位</h3><table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">grid-row-start</td>
<td align="left">行开始栅格线</td>
</tr>
<tr>
<td align="left">grid-row-end</td>
<td align="left">行结束栅格线</td>
</tr>
<tr>
<td align="left">grid-column-start</td>
<td align="left">列开始栅格线</td>
</tr>
<tr>
<td align="left">grid-column-end</td>
<td align="left">列结束栅格线</td>
</tr>
</tbody></table>
<h4 id="根据栅格线"><a href="#根据栅格线" class="headerlink" title="根据栅格线"></a>根据栅格线</h4><p>通过设置具体的第几条栅格线来设置区域位置，设置的数值可以是正数和负数：</p>
<iframe height="435" scrolling="no" title="09-grid-栅格线" src="https://codepen.io/JingW/embed/oNgomod?height=435&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="根据栅格命名"><a href="#根据栅格命名" class="headerlink" title="根据栅格命名"></a>根据栅格命名</h4><iframe height="436" scrolling="no" title="10-grid-栅格线命名" src="https://codepen.io/JingW/embed/mdyqvgZ?height=436&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="根据偏移量"><a href="#根据偏移量" class="headerlink" title="根据偏移量"></a>根据偏移量</h4><p>使用 <code>span</code> 可以设置移动单元格数量，数值只能为正数。</p>
<ul>
<li>设置在 <code>grid-*-end</code> 表示 <code>grid-*-end</code> 栅格线是从 <code>grid-*-start</code> 移动几个单元格</li>
<li>设置在 <code>grid-*-start</code> 表示 <code>grid-*-start</code> 栅格线是从 <code>grid-*-end</code> 移动几个单元格</li>
</ul>
<iframe height="445" scrolling="no" title="11-grid-偏移量" src="https://codepen.io/JingW/embed/dyPZrOE?height=445&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="推荐-简写模式-grid-row-grid-column"><a href="#推荐-简写模式-grid-row-grid-column" class="headerlink" title="[推荐]简写模式 grid-row/grid-column"></a>[推荐]简写模式 grid-row/grid-column</h4><p>可以使用 <code>grid-row</code> 设置行开始栅格线，使用 <code>grid-column</code> 设置结束栅格线。</p>
<p>上例中的居中对齐元素，可以使用以下简写的方式声明（推荐）。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">grid-row</span>: 2/3;</span><br><span class="line"><span class="selector-tag">grid-column</span>: 2/3;</span><br></pre></td></tr></table></figure>

<iframe height="438" scrolling="no" title="12-grid-grid-row/grid-column简写形式" src="https://codepen.io/JingW/embed/bGNabrX?height=438&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="简写形式-grid-area"><a href="#简写形式-grid-area" class="headerlink" title="简写形式 grid-area"></a>简写形式 grid-area</h4><p><code>grid-area</code> 更加简洁是同时对 <code>grid-row</code> 与 <code>grid-column</code> 属性的组合声明。</p>
<p>语法结构如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">grid-row-start</span>/<span class="selector-tag">grid-column-start</span>/<span class="selector-tag">grid-row-end</span>/<span class="selector-tag">grid-column-end</span></span><br></pre></td></tr></table></figure>

<p>下面是将元素定位在中间的示例：</p>
<iframe height="412" scrolling="no" title="13-grid-grid-area简写形式" src="https://codepen.io/JingW/embed/mdypbBQ?height=412&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="栅格流动"><a href="#栅格流动" class="headerlink" title="栅格流动"></a>栅格流动</h3><p>在容器中设置<code>grid-auto-flow</code> 属性可以改变单元流动方式。</p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">column</td>
<td align="left">按列排序</td>
</tr>
<tr>
<td align="left">row</td>
<td align="left">按行排列</td>
</tr>
</tbody></table>
<h4 id="栅格流动的基本使用"><a href="#栅格流动的基本使用" class="headerlink" title="栅格流动的基本使用"></a>栅格流动的基本使用</h4><iframe height="557" scrolling="no" title="14-grid-grid-auto-flow栅格流动" src="https://codepen.io/JingW/embed/gObobYm?height=557&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="强制填充"><a href="#强制填充" class="headerlink" title="强制填充"></a>强制填充</h4><p>当元素在栅格中放不下时，将会发生换行产生留白，使用 grid-auto-flow: row dense; 可以执行填充空白区域操作。</p>
<iframe height="495" scrolling="no" title="15-grid-强制填充" src="https://codepen.io/JingW/embed/eYmymZX?height=495&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="栅格对齐"><a href="#栅格对齐" class="headerlink" title="栅格对齐"></a>栅格对齐</h3><p>可以通过属性方便的定义栅格的对齐方式，可用值包括 <code>start | end | center | stretch | space-between | space-evenly | space-around</code>。</p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">说明</th>
<th align="left">对象</th>
</tr>
</thead>
<tbody><tr>
<td align="left">align-items</td>
<td align="left">栅格内所有元素的垂直排列方式</td>
<td align="left">栅格容器</td>
</tr>
<tr>
<td align="left">justify-items</td>
<td align="left">栅格内所有元素的横向排列方式</td>
<td align="left">栅格容器</td>
</tr>
<tr>
<td align="left">justify-content</td>
<td align="left">所有栅格在容器中的水平对齐方式，容器有额外空间时</td>
<td align="left">栅格容器</td>
</tr>
<tr>
<td align="left">align-content</td>
<td align="left">所有栅格在容器中的垂直对齐方式，容器有额外空间时</td>
<td align="left">栅格容器</td>
</tr>
<tr>
<td align="left">align-self</td>
<td align="left">元素在栅格中垂直对齐方式</td>
<td align="left">栅格元素</td>
</tr>
<tr>
<td align="left">justify-self</td>
<td align="left">元素在栅格中水平对齐方式</td>
<td align="left">栅格元素</td>
</tr>
</tbody></table>
<iframe height="559" scrolling="no" title="16-grid-元素对齐" src="https://codepen.io/JingW/embed/LYEeERG?height=559&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="组合简写-place-content"><a href="#组合简写-place-content" class="headerlink" title="组合简写 place-content"></a>组合简写 place-content</h4><p>用于控制栅格的对齐方式，语法如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">place-content</span>: &lt;<span class="selector-tag">align-content</span>&gt; &lt;<span class="selector-tag">justify-content</span>&gt;;</span><br></pre></td></tr></table></figure>

<h4 id="组合简写-place-items"><a href="#组合简写-place-items" class="headerlink" title="组合简写 place-items"></a>组合简写 place-items</h4><p>控制所有元素的对齐方式，语法结构如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">place-items</span>: &lt;<span class="selector-tag">align-items</span>&gt; &lt;<span class="selector-tag">justify-items</span>&gt;;</span><br></pre></td></tr></table></figure>

<h4 id="组合简写-place-self"><a href="#组合简写-place-self" class="headerlink" title="组合简写 place-self"></a>组合简写 place-self</h4><p>控制单个元素的对齐方式</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">place-self</span>: &lt;<span class="selector-tag">align-self</span>&gt; &lt;<span class="selector-tag">justify-self</span>&gt;;</span><br></pre></td></tr></table></figure>

<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://www.cnblogs.com/wangxiang9528/p/9867822.html">Grid 布局方式的实例详解</a></li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>CSS3</tag>
        <tag>Grid</tag>
      </tags>
  </entry>
  <entry>
    <title>HTML5的自定义属性</title>
    <url>/posts/39974/</url>
    <content><![CDATA[<blockquote>
<p>在 HTML5 中我们可以自定义属性，其格式为 <code>data-*=&quot;&quot;</code></p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;demo&quot;</span> <span class="attr">data-my-name</span>=<span class="string">&quot;sw&quot;</span> <span class="attr">data-age</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">/*</span><br><span class="line">  Node.dataset 是以对象形式存在的，当我们为同一个 DOM 节点指定了多个自定义属性时，</span><br><span class="line">  Node.dataset 则存储了所有的自定义属性的值。</span><br><span class="line">  */</span><br><span class="line"><span class="javascript"><span class="keyword">var</span> demo = <span class="built_in">document</span>.querySelector(<span class="string">&quot;#demo&quot;</span>);</span></span><br><span class="line"><span class="javascript"><span class="comment">//获取</span></span></span><br><span class="line"><span class="javascript"><span class="comment">//注：当我们如下格式设置时，则需要以驼峰格式才能正确获取</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> name = demo.dataset[<span class="string">&#x27;myName&#x27;</span>];</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> age = demo.dataset[<span class="string">&#x27;age&#x27;</span>];</span></span><br><span class="line"><span class="javascript"><span class="comment">//设置</span></span></span><br><span class="line"><span class="javascript">demo.dataset[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;web developer&#x27;</span>;</span></span><br><span class="line"><span class="handlebars"><span class="xml"><span class="tag">&lt;<span class="name">script</span>/&gt;</span></span></span></span><br></pre></td></tr></table></figure>

<p><strong>资源</strong></p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes/data-*">mdn - data-*</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>HTML</category>
      </categories>
  </entry>
  <entry>
    <title>H5在移动端上传头像图片旋转90度问题解决方案</title>
    <url>/posts/26493/</url>
    <content><![CDATA[<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>移动端上的 H5 页面，在拍照上传后会出现图片自动旋转 90° 的问题，这里记录下解决方案。</p>
<h2 id="解决思路"><a href="#解决思路" class="headerlink" title="解决思路"></a>解决思路</h2><p>从图片 Exif 信息中读取 Orientation，根据它来判断是否该修正图片的方向：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//获取照片方向角属性，用户旋转控制</span></span><br><span class="line"><span class="keyword">let</span> Orientation = <span class="literal">null</span>;</span><br><span class="line">EXIF.getData(image, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  Orientation = EXIF.getTag(<span class="built_in">this</span>, <span class="string">&#x27;Orientation&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">switch</span> (Orientation) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 不需要选择，正常</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">6</span>: <span class="comment">// 需要顺时针（向左）90度旋转</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">8</span>: <span class="comment">// 需要逆时针（向右）90度旋转</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// 需要180度旋转</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>然后用 canvas 的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/drawImage">ctx.drawImage</a> 对图片进行绘制，最后用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLCanvasElement/toDataURL">canvas.toDataURL</a> 将画布转为 base64 格式数据的 DataURL 传给后端。</p>
<p>P.S. 什么是 EXIF</p>
<p>Exif（Exchangeable image file format）是专门为数码相机拍摄的照片定义的，可以记录数码照片的属性信息和拍摄数据。<br>Exif 可以附加于 JPEG、TIFF、RIFF 等文件之中，为其增加有关数码相机拍摄信息的内容和索引图或图像处理软件的版本信息。<br>Exif 信息是可以被任意编辑的，因此只有参考的功能。Exif 可能会泄露隐私信息，请选择图片查看其 Exif 信息。</p>
<h2 id="具体代码"><a href="#具体代码" class="headerlink" title="具体代码"></a>具体代码</h2><p>引入 <code>exif.js</code> ：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/exif-js/2.3.0/exif.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>uni-app 下创建上传头像组件：</p>
<blockquote>
<p>yyt-upload-img.vue</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;yyt-upload-img&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> &#123; <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./yyt-upload-img.js&#x27;</span>;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="keyword">@import</span> url(<span class="string">&#x27;yyt-upload-img.less&#x27;</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>yyt-upload-img.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">&#x27;yyt-upload-img&#x27;</span>,</span><br><span class="line">  <span class="comment">// 注册属性</span></span><br><span class="line">  props: &#123;</span><br><span class="line">    <span class="comment">// 图片最大Size(兆M)</span></span><br><span class="line">    maxSize: &#123;</span><br><span class="line">      type: <span class="built_in">Number</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="number">9</span>,</span><br><span class="line">      required: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 图片最大宽度(px)</span></span><br><span class="line">    maxWidth: &#123;</span><br><span class="line">      type: <span class="built_in">Number</span>,</span><br><span class="line">      <span class="keyword">default</span>: uni.upx2px(<span class="number">500</span>),</span><br><span class="line">      required: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    getImgUrl: &#123;</span><br><span class="line">      type: <span class="built_in">Function</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">      <span class="comment">// required: true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;&#125;,</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 图片信息</span></span><br><span class="line">      picInfo: &#123;</span><br><span class="line">        imgSize: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 图片大小M</span></span><br><span class="line">        picName: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 图片名称</span></span><br><span class="line">        url: <span class="string">&#x27;&#x27;</span> <span class="comment">// 图片地址</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="comment">// 开始选择图片</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">_startChoose</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="comment">// 选择图片</span></span><br><span class="line">      <span class="keyword">let</span> [error, imgRes] = <span class="keyword">await</span> uni.chooseImage(&#123;</span><br><span class="line">        count: <span class="number">1</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 验证大小</span></span><br><span class="line">      <span class="keyword">let</span> size = imgRes.tempFiles[<span class="number">0</span>].size;</span><br><span class="line">      <span class="keyword">if</span> (size / <span class="number">1024000</span> &gt; <span class="built_in">this</span>.maxSize) &#123;</span><br><span class="line">        <span class="built_in">this</span>.$cw.showError(<span class="string">`图片不能大于<span class="subst">$&#123;<span class="built_in">this</span>.maxSize&#125;</span>M`</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//文件路径</span></span><br><span class="line">      <span class="keyword">let</span> filePath = imgRes.tempFiles[<span class="number">0</span>].name;</span><br><span class="line">      <span class="comment">// 临时文件列表</span></span><br><span class="line">      <span class="keyword">const</span> tempFilePaths = imgRes.tempFiles;</span><br><span class="line">      <span class="comment">// 获取最后一个.的位置</span></span><br><span class="line">      <span class="keyword">let</span> index = filePath.lastIndexOf(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">      <span class="comment">// 文件大小</span></span><br><span class="line">      <span class="built_in">this</span>.picInfo.imgSize = (tempFilePaths[<span class="number">0</span>].size / <span class="number">1048576</span>).toFixed(<span class="number">2</span>);</span><br><span class="line">      <span class="built_in">this</span>.picInfo.picName = tempFilePaths[<span class="number">0</span>].name; <span class="comment">//上传人文件描述 名字</span></span><br><span class="line">      <span class="comment">//获取后缀</span></span><br><span class="line">      <span class="keyword">let</span> ext = filePath.substr(index + <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> ([<span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;bmp&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>].indexOf(ext) == -<span class="number">1</span>) &#123;</span><br><span class="line">        uni.showToast(&#123;</span><br><span class="line">          title: <span class="string">&#x27;图片格式不正确&#x27;</span>,</span><br><span class="line">          icon: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> baseStr = <span class="keyword">await</span> <span class="built_in">this</span>.uploadImg(&#123;</span><br><span class="line">        url: imgRes.tempFiles[<span class="number">0</span>].path</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="built_in">console</span>.log(&#123;</span><br><span class="line">        baseStr</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">if</span> (baseStr) &#123;</span><br><span class="line">        <span class="keyword">let</span> [error2, res] = <span class="keyword">await</span> uni.uploadFile(&#123;</span><br><span class="line">          url: getApp().globalData.PicDomain,</span><br><span class="line">          fileType: <span class="string">&#x27;image&#x27;</span>,</span><br><span class="line">          filePath: baseStr,</span><br><span class="line">          name: <span class="string">&#x27;file&#x27;</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">let</span> fileData = <span class="built_in">JSON</span>.parse(res.data);</span><br><span class="line">        <span class="built_in">this</span>.picInfo.url = <span class="string">`<span class="subst">$&#123;getApp().globalData.PicDomain&#125;</span><span class="subst">$&#123;fileData.path&#125;</span>`</span>;</span><br><span class="line">        <span class="comment">// 通知已拿到数据</span></span><br><span class="line">        <span class="built_in">this</span>.$emit(<span class="string">&#x27;getImgUrl&#x27;</span>, <span class="built_in">this</span>.picInfo);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.$cw.showError(<span class="string">&#x27;上传失败，请重试&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.$emit(<span class="string">&#x27;getImgUrl&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 图片上传</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">uploadImg</span>(<span class="params">opt</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> maxWidth = uni.upx2px(<span class="built_in">this</span>.maxWidth);</span><br><span class="line">      opt = opt || &#123;&#125;;</span><br><span class="line">      opt.url = opt.url || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      <span class="keyword">let</span> Orientation = <span class="number">1</span>;</span><br><span class="line">      <span class="comment">//获取图片META信息</span></span><br><span class="line">      <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="built_in">this</span>.getImageTag(opt.url, <span class="string">&#x27;Orientation&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">undefined</span>) Orientation = e;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">var</span> img = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">var</span> canvas = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">let</span> obj = <span class="keyword">await</span> <span class="built_in">this</span>.loadingImage(opt.url);</span><br><span class="line">      <span class="keyword">if</span> (obj) &#123;</span><br><span class="line">        img = obj.img;</span><br><span class="line">        canvas = obj.canvas;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(Orientation);</span><br><span class="line">        <span class="keyword">let</span> baseStr = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="comment">//如果方向角不为1，都需要进行旋转</span></span><br><span class="line">        <span class="keyword">switch</span> (Orientation) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="number">6</span>: <span class="comment">//需要顺时针（向右）90度旋转</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;（向右）90度旋转&#x27;</span>);</span><br><span class="line">            baseStr = <span class="built_in">this</span>.rotateImg(img, <span class="string">&#x27;right&#x27;</span>, canvas);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="number">8</span>: <span class="comment">//需要逆时针（向左）90度旋转</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;向左）90度旋转&#x27;</span>);</span><br><span class="line">            baseStr = <span class="built_in">this</span>.rotateImg(img, <span class="string">&#x27;left&#x27;</span>, canvas);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">//需要180度旋转 转两次</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;需要180度旋转&#x27;</span>);</span><br><span class="line">            baseStr = <span class="built_in">this</span>.rotateImg(img, <span class="string">&#x27;right&#x27;</span>, canvas, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">default</span>:</span><br><span class="line">            baseStr = <span class="built_in">this</span>.rotateImg(img, <span class="string">&#x27;&#x27;</span>, canvas);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> baseStr;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description </span>加载图片</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>imgSrc 图片地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">loadingImage</span>(<span class="params">imgSrc</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!imgSrc) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">let</span> [err, res] = <span class="keyword">await</span> uni.getImageInfo(&#123;</span><br><span class="line">        src: imgSrc</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res) &#123;</span><br><span class="line">          <span class="keyword">let</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">          img.style.opacity = <span class="number">1</span>;</span><br><span class="line">          img.style.backgroundColor = <span class="string">&#x27;#FFFFFF&#x27;</span>;</span><br><span class="line">          img.src = res.path;</span><br><span class="line">          img.width = res.width;</span><br><span class="line">          img.height = res.height;</span><br><span class="line"></span><br><span class="line">          img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">let</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line">            <span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">            obj.img = img;</span><br><span class="line">            obj.canvas = canvas;</span><br><span class="line">            resolve(obj);</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          that.$cw.showError(<span class="string">&#x27;加载图片失败，请重试！&#x27;</span>);</span><br><span class="line">          reject(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@desc </span>获取图片信息，使用exif.js库，具体用法请在github中搜索</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>file 上传的图片文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>tag 需要获取的信息 例如：&#x27;Orientation&#x27;旋转信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return <span class="type">&#123;Promise&lt;Any&gt;&#125;</span> </span>读取是个异步操作，返回指定的图片信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getImageTag</span>(<span class="params">file, tag, cb</span>)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!file) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">let</span> that = <span class="built_in">this</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> imgObj = <span class="keyword">new</span> Image();</span><br><span class="line">        imgObj.src = file;</span><br><span class="line"></span><br><span class="line">        uni.getImageInfo(&#123;</span><br><span class="line">          src: file,</span><br><span class="line">          <span class="function"><span class="title">success</span>(<span class="params">res</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(&#123;</span><br><span class="line">              res</span><br><span class="line">            &#125;);</span><br><span class="line">            EXIF.getData(imgObj, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">              <span class="built_in">console</span>.log(<span class="built_in">this</span>);</span><br><span class="line">              EXIF.getAllTags(<span class="built_in">this</span>);</span><br><span class="line">              <span class="keyword">let</span> or = EXIF.getTag(<span class="built_in">this</span>, <span class="string">&#x27;Orientation&#x27;</span>); <span class="comment">//这个Orientation 就是我们判断需不需要旋转的值了，有1、3、6、8</span></span><br><span class="line">              resolve(cb(or));</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="function"><span class="title">fail</span>(<span class="params">e</span>)</span> &#123;</span><br><span class="line">            that.$cw.showError(<span class="string">&#x27;加载图片失败，请换张图片重试！&#x27;</span>);</span><br><span class="line">            reject(<span class="literal">null</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//网上提供的旋转function</span></span><br><span class="line">    <span class="function"><span class="title">rotateImg</span>(<span class="params">img, direction, canvas, times = <span class="number">1</span></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;开始旋转&#x27;</span>);</span><br><span class="line">      <span class="comment">//最小与最大旋转方向，图片旋转4次后回到原方向</span></span><br><span class="line">      <span class="keyword">var</span> min_step = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">var</span> max_step = <span class="number">3</span>;</span><br><span class="line">      <span class="keyword">if</span> (img == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">      <span class="comment">//img的高度和宽度不能在img元素隐藏后获取，否则会出错</span></span><br><span class="line">      <span class="keyword">var</span> height = img.height;</span><br><span class="line">      <span class="keyword">var</span> width = img.width;</span><br><span class="line">      <span class="comment">// debugger</span></span><br><span class="line">      <span class="keyword">let</span> maxWidth = <span class="built_in">this</span>.maxWidth;</span><br><span class="line">      <span class="keyword">let</span> canvasWidth = width; <span class="comment">//图片原始长宽</span></span><br><span class="line">      <span class="keyword">let</span> canvasHeight = height;</span><br><span class="line">      <span class="keyword">let</span> base = canvasWidth / canvasHeight;</span><br><span class="line">      <span class="keyword">if</span> (canvasWidth &gt; maxWidth) &#123;</span><br><span class="line">        canvasWidth = maxWidth;</span><br><span class="line">        canvasHeight = <span class="built_in">Math</span>.floor(canvasWidth / base);</span><br><span class="line">      &#125;</span><br><span class="line">      width = canvasWidth;</span><br><span class="line">      height = canvasHeight;</span><br><span class="line">      <span class="keyword">var</span> step = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (step == <span class="literal">null</span>) &#123;</span><br><span class="line">        step = min_step;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (direction == <span class="string">&#x27;right&#x27;</span>) &#123;</span><br><span class="line">        step += times;</span><br><span class="line">        <span class="comment">//旋转到原位置，即超过最大值</span></span><br><span class="line">        step &gt; max_step &amp;&amp; (step = min_step);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (direction == <span class="string">&#x27;left&#x27;</span>) &#123;</span><br><span class="line">        step -= times;</span><br><span class="line">        step &lt; min_step &amp;&amp; (step = max_step);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//不旋转</span></span><br><span class="line">        step = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//旋转角度以弧度值为参数</span></span><br><span class="line">      <span class="keyword">var</span> degree = (step * <span class="number">90</span> * <span class="built_in">Math</span>.PI) / <span class="number">180</span>;</span><br><span class="line">      <span class="keyword">var</span> ctx = canvas.getContext(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line">      <span class="comment">// 在canvas绘制前填充白色背景</span></span><br><span class="line">      ctx.fillStyle = <span class="string">&#x27;#fff&#x27;</span>;</span><br><span class="line">      ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="built_in">this</span>.maxWidth, <span class="built_in">this</span>.maxWidth);</span><br><span class="line"></span><br><span class="line">      <span class="built_in">console</span>.log(degree);</span><br><span class="line">      <span class="built_in">console</span>.log(step);</span><br><span class="line">      <span class="keyword">switch</span> (step) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;右旋转 90度&#x27;</span>);</span><br><span class="line">          canvas.width = height;</span><br><span class="line">          canvas.height = width;</span><br><span class="line">          ctx.rotate(degree);</span><br><span class="line">          ctx.drawImage(img, <span class="number">0</span>, -height, width, height);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;旋转 180度&#x27;</span>);</span><br><span class="line">          canvas.width = width;</span><br><span class="line">          canvas.height = height;</span><br><span class="line">          ctx.rotate(degree);</span><br><span class="line">          ctx.drawImage(img, -width, -height, width, height);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;左旋转 90度&#x27;</span>);</span><br><span class="line">          canvas.width = height;</span><br><span class="line">          canvas.height = width;</span><br><span class="line">          ctx.rotate(degree);</span><br><span class="line">          ctx.drawImage(img, -width, <span class="number">0</span>, width, height);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          <span class="comment">//不旋转</span></span><br><span class="line">          canvas.width = width;</span><br><span class="line">          canvas.height = height;</span><br><span class="line">          <span class="built_in">console</span>.log(&#123;</span><br><span class="line">            ctx,</span><br><span class="line">            canvas</span><br><span class="line">          &#125;);</span><br><span class="line">          ctx.drawImage(img, <span class="number">0</span>, <span class="number">0</span>, width, height);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> imgData = ctx.getImageData(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height);</span><br><span class="line">      <span class="keyword">var</span> data = imgData.data;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.length; i += <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (data[i + <span class="number">3</span>] &lt; <span class="number">255</span>) &#123;</span><br><span class="line">          data[i] = <span class="number">255</span> - data[i];</span><br><span class="line">          data[i + <span class="number">1</span>] = <span class="number">255</span> - data[i + <span class="number">1</span>];</span><br><span class="line">          data[i + <span class="number">2</span>] = <span class="number">255</span> - data[i + <span class="number">2</span>];</span><br><span class="line">          data[i + <span class="number">3</span>] = <span class="number">255</span> - data[i + <span class="number">3</span>];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      ctx.putImageData(imgData, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> baseStr = canvas.toDataURL(<span class="string">&#x27;image/png&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">return</span> baseStr;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;&#125;,</span><br><span class="line">  filters: &#123;</span><br><span class="line">    <span class="comment">// parseScene(value) &#123;</span></span><br><span class="line">    <span class="comment">// return value+&#x27;123&#x27;;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">    <span class="comment">// &quot;currentStore.storeId&quot;: &#123;</span></span><br><span class="line">    <span class="comment">//    handler(val, oldval) &#123;</span></span><br><span class="line">    <span class="comment">//        if (val) &#123;</span></span><br><span class="line">    <span class="comment">//        &#125;</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="使用组件"><a href="#使用组件" class="headerlink" title="使用组件"></a>使用组件</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">yyt-upload-img</span> <span class="attr">ref</span>=<span class="string">&quot;uploadImg&quot;</span> @<span class="attr">getImgUrl</span>=<span class="string">&quot;getImgUrl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">yyt-upload-img</span>&gt;</span></span><br><span class="line">// 点击上传头像按钮时调用 this.$refs.uploadImg._startChoose(); //</span><br><span class="line">获取上传后的http图片地址 getImgUrl(imgUrl) &#123; console.log(imgUrl); &#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>移动端</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>uniapp</tag>
        <tag>兼容性</tag>
        <tag>移动端</tag>
      </tags>
  </entry>
  <entry>
    <title>HTML知识点（面试系列）</title>
    <url>/posts/55598/</url>
    <content><![CDATA[<h2 id="你对语义化的理解"><a href="#你对语义化的理解" class="headerlink" title="你对语义化的理解"></a>你对语义化的理解</h2><p>用正确的标签做正确的事情</p>
<ul>
<li>利于开发：使代码<strong>结构清晰</strong>，<strong>可读性高</strong>，<strong>方便维护</strong></li>
<li>利于 SEO：方便爬虫根据语义标签确定<strong>页面结构</strong>和<strong>关键字</strong>的权重</li>
</ul>
<a id="more"></a>

<h3 id="你在平常工作中使用过哪些语义标签？"><a href="#你在平常工作中使用过哪些语义标签？" class="headerlink" title="你在平常工作中使用过哪些语义标签？"></a>你在平常工作中使用过哪些语义标签？</h3><p>header, nav, aside, main, section, article, footer, canvas, video, audio</p>
<h3 id="你说你用过-canvas-video-audio，你是怎么用它们的？"><a href="#你说你用过-canvas-video-audio，你是怎么用它们的？" class="headerlink" title="你说你用过 canvas/video/audio，你是怎么用它们的？"></a>你说你用过 canvas/video/audio，你是怎么用它们的？</h3><ul>
<li><p>画布：<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial">canvas</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">width</span>=<span class="string">&quot;500&quot;</span> <span class="attr">height</span>=<span class="string">&quot;500&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> canvas = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;canvas&#x27;</span>);</span></span><br><span class="line"><span class="handlebars"><span class="xml">    <span class="comment">&lt;!-- 获取上下文 --&gt;</span></span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> ctx = canvas.getContext(<span class="string">&#x27;2d&#x27;</span>);</span></span><br><span class="line">    ctx.beginPath();</span><br><span class="line"><span class="handlebars"><span class="xml">    <span class="comment">&lt;!-- 设置图形轮廓的颜色 --&gt;</span></span></span></span><br><span class="line"><span class="javascript">    ctx.strokeStyle = <span class="string">&#x27;red&#x27;</span>;</span></span><br><span class="line"><span class="handlebars"><span class="xml">    <span class="comment">&lt;!-- 绘制直线 --&gt;</span></span></span></span><br><span class="line">    ctx.moveTo(10, 20);</span><br><span class="line">    ctx.lineTo(100, 200);</span><br><span class="line">    ctx.stroke();</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>媒体元素：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/video">video</a> 和 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/audio">audio</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;视频资源路径&quot;</span> <span class="attr">poster</span>=<span class="string">&quot;海报资源路径&quot;</span> <span class="attr">controls</span> <span class="attr">autoplay</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;音频资源路径&quot;</span> <span class="attr">controls</span> <span class="attr">autoplay</span> <span class="attr">loop</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="解释下移动端为什么要添加-meta-viewport-，怎么写？"><a href="#解释下移动端为什么要添加-meta-viewport-，怎么写？" class="headerlink" title="解释下移动端为什么要添加 meta viewport ，怎么写？"></a>解释下移动端为什么要添加 meta viewport ，怎么写？</h2><p>作用：</p>
<p>防止页面在移动端可以缩放。</p>
<p>写法：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;meta</span><br><span class="line">  name=&quot;viewport&quot;</span><br><span class="line">  content=&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

<p>解释：</p>
<ul>
<li><p>使用 <code>viewport</code> 来控制浏览器视口的宽度和缩放比例</p>
</li>
<li><p>添加 <code>width=device-width</code> 以便让视口的宽度与设备一致</p>
</li>
<li><p>添加 <code>initial-scale=1.0</code> 设置初始缩放比例为 1.0</p>
</li>
<li><p>添加</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">user-scalable&#x3D;no</span><br></pre></td></tr></table></figure>

<p>使得用户不能放大或缩小网页</p>
<ul>
<li>添加 <code>minimum-scale=1.0, maximum-scale=1.0</code> 是为了兼容 iOS10 不支持 <code>user-scalable</code> 导致用户仍可缩放</li>
</ul>
</li>
</ul>
<p>参考阅读：</p>
<ul>
<li><strong><a href="https://developer.mozilla.org/zh-CN/docs/Mozilla/Mobile/Viewport_meta_tag">在移动浏览器中使用 viewport 元标签控制布局</a></strong></li>
<li><strong><a href="https://developers.google.cn/web/tools/lighthouse/audits/has-viewport-meta-tag?hl=zh-cn">HTML 具有视口元标记</a></strong></li>
<li><strong><a href="https://www.cnblogs.com/chunyangji/p/5795487.html">移动端 web 开发——视口</a></strong></li>
</ul>
<h2 id="关于图片，你了解哪些形式，你觉得哪种场合用哪种？它们优劣如何？然后这些图片的应用场景能说说不？"><a href="#关于图片，你了解哪些形式，你觉得哪种场合用哪种？它们优劣如何？然后这些图片的应用场景能说说不？" class="headerlink" title="关于图片，你了解哪些形式，你觉得哪种场合用哪种？它们优劣如何？然后这些图片的应用场景能说说不？"></a>关于图片，你了解哪些形式，你觉得哪种场合用哪种？它们优劣如何？然后这些图片的应用场景能说说不？</h2><table>
<thead>
<tr>
<th align="left">格式</th>
<th align="left">特点</th>
<th align="left">使用场景</th>
</tr>
</thead>
<tbody><tr>
<td align="left">JPG/JPEG</td>
<td align="left">有损压缩 体积小 不支持透明</td>
<td align="left">1. 大的背景图； 2. 轮播图； 3. Banner 图</td>
</tr>
<tr>
<td align="left">PNG</td>
<td align="left">无损压缩 质量高 体积大 支持透明</td>
<td align="left">1. 小 Logo； 2. 透明背景</td>
</tr>
<tr>
<td align="left">GIF</td>
<td align="left">支持动画</td>
<td align="left">动态图片</td>
</tr>
<tr>
<td align="left">SVG</td>
<td align="left">文本文件 体积小 不失真 兼容性好</td>
<td align="left">能适应不同设备且画质不能损坏的图片</td>
</tr>
<tr>
<td align="left">Base64</td>
<td align="left">文本文件 依赖编码 小图标解决方案</td>
<td align="left">大小不超过 2KB，且更新率低的图片</td>
</tr>
<tr>
<td align="left">webp</td>
<td align="left">细节丰富 支持透明 支持动画 兼容性差</td>
<td align="left">Chrome UC 等浏览器支持，局限性大，一般不考虑</td>
</tr>
<tr>
<td align="left">雪碧图</td>
<td align="left">一次加载多处使用</td>
<td align="left">小图太多的时候，集中成一张图片减少 HTTP 请求</td>
</tr>
</tbody></table>
<p>更多阅读：<a href="https://github.com/LiangJunrong/document-library/blob/master/other-library/interview/personal-experience/other-%E5%9B%BE%E7%89%87.md">面试知识点 - 图片</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>面试</category>
      </categories>
      <tags>
        <tag>面试</tag>
      </tags>
  </entry>
  <entry>
    <title>JS中如何实现继承</title>
    <url>/posts/2751/</url>
    <content><![CDATA[<h2 id="组合继承（原型链-借用构造函数）"><a href="#组合继承（原型链-借用构造函数）" class="headerlink" title="组合继承（原型链 + 借用构造函数）"></a>组合继承（原型链 + 借用构造函数）</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 组合继承:原型继承+借用（调用）构造函数继承</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age, sex</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">  <span class="built_in">this</span>.age = age;</span><br><span class="line">  <span class="built_in">this</span>.sex = sex;</span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sayHi = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;Hello world&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, sex, score</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 借用构造函数</span></span><br><span class="line">  Person.call(<span class="built_in">this</span>,name,age,sex);</span><br><span class="line">  <span class="built_in">this</span>.score = score;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 改变原型指向----继承</span></span><br><span class="line"><span class="comment">// 我们让 Student.prototype 指向一个Person的实例对象</span></span><br><span class="line"><span class="comment">// 这个对象的__proto__指向的是Person.prototype</span></span><br><span class="line"><span class="comment">// 所以我们就可以借助这个实例对象拿到sayHi方法，实现继承</span></span><br><span class="line">Student.prototype=<span class="keyword">new</span> Person();</span><br><span class="line">Student.prototype.eat = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;吃东西&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student(<span class="string">&quot;Lance&quot;</span>, <span class="number">20</span>, <span class="string">&quot;男&quot;</span>, <span class="string">&quot;100分&quot;</span>);</span><br><span class="line">stu.sayHi();</span><br><span class="line"><span class="keyword">var</span> stu2 = <span class="keyword">new</span> Student(<span class="string">&quot;Jerry&quot;</span>, <span class="number">19</span>, <span class="string">&quot;男&quot;</span>, <span class="string">&quot;101分&quot;</span>);</span><br><span class="line">stu2.eat();</span><br><span class="line"></span><br><span class="line"><span class="comment">//属性和方法都被继承了</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h2 id="寄生组合继承（组合继承升级版）"><a href="#寄生组合继承（组合继承升级版）" class="headerlink" title="寄生组合继承（组合继承升级版）"></a>寄生组合继承（组合继承升级版）</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">object</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">  F.prototype = o;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inheritPrototype</span>(<span class="params">subType, superType</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> prototype = object(superType.prototype); <span class="comment">// 创建了父类原型的浅复制</span></span><br><span class="line">    prototype.constructor = subType;             <span class="comment">// 修正原型的构造函数</span></span><br><span class="line">    subType.prototype = prototype;               <span class="comment">// 将子类的原型替换为这个原型</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;green&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="built_in">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">    SuperType.call(<span class="built_in">this</span>, name);</span><br><span class="line">    <span class="built_in">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 核心：因为是对父类原型的复制，所以不包含父类的构造函数，也就不会调用两次父类的构造函数造成浪费</span></span><br><span class="line">inheritPrototype(SubType, SuperType);</span><br><span class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="built_in">this</span>.age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ES6继承写法"><a href="#ES6继承写法" class="headerlink" title="ES6继承写法"></a>ES6继承写法</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name, age</span>)</span> &#123;<span class="built_in">this</span>.name=name;<span class="built_in">this</span>.age=age&#125;</span><br><span class="line">  <span class="function"><span class="title">sayHi</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">name, age, weight</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(name, age); <span class="built_in">this</span>.weight = weight;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">run</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="在原型链继承时，为什么不直接-Student-prototype-Person-prototype-？"><a href="#在原型链继承时，为什么不直接-Student-prototype-Person-prototype-？" class="headerlink" title="在原型链继承时，为什么不直接 Student.prototype = Person.prototype ？"></a>在原型链继承时，为什么不直接 <code>Student.prototype = Person.prototype</code> ？</h2><p>因为对象的赋值只是引用的赋值, 上面两者都指向同一个内存地址，只要随便通过1个途径就能修改该内存地址的对象，这样子类就无法单独扩展方法，而且会影响父类。</p>
<h2 id="组合继承的缺点"><a href="#组合继承的缺点" class="headerlink" title="组合继承的缺点"></a>组合继承的缺点</h2><p>缺点就是调用了两次父类的构造函数。<br>第一次给子类的原型添加了父类构造函数中的属性方法；第二次又给子类的构造函数添加了父类的构造函数的属性方法，从而覆盖了子类原型中的同名参数。这种被覆盖的情况造成了性能上的浪费：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;parent&#x27;</span>;</span><br><span class="line">    <span class="built_in">this</span>.arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">SuperType.prototype.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;this is parent&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    SuperType.call(<span class="built_in">this</span>) <span class="comment">// 第二次调用SuperType</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType() <span class="comment">// 第一次调用SuperType</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>继承</tag>
      </tags>
  </entry>
  <entry>
    <title>JS数组有哪些常用方法</title>
    <url>/posts/21501/</url>
    <content><![CDATA[<h2 id="改变原数组的方法"><a href="#改变原数组的方法" class="headerlink" title="改变原数组的方法"></a>改变原数组的方法</h2><h3 id="splice-添加-删除数组元素"><a href="#splice-添加-删除数组元素" class="headerlink" title="splice() 添加/删除数组元素"></a>splice() 添加/删除数组元素</h3><blockquote>
<p>splice() 方法<strong>向/从数组中添加/删除</strong>项目，然后返回被删除的项目</p>
<p>array.splice(index,howmany,item1,…..,itemX)</p>
<ol>
<li>index：必需。整数，规定添加/删除项目的位置，使用负数可从数组结尾处规定位置。</li>
<li>howmany：可选。要删除的项目数量。如果设置为 0，则不会删除项目。</li>
<li>item1, …, itemX： 可选。向数组添加的新项目。</li>
</ol>
<p>返回值: 如果有元素被删除,返回包含被删除项目的新数组。</p>
</blockquote>
<a id="more"></a>

<h4 id="删除元素"><a href="#删除元素" class="headerlink" title="删除元素"></a>删除元素</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 从数组下标0开始，删除3个元素</span></span><br><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>];</span><br><span class="line"><span class="keyword">let</span> item = a.splice(<span class="number">0</span>, <span class="number">3</span>); <span class="comment">// [1,2,3]</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// [4,5,6,7]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 从最后一个元素开始删除3个元素，因为最后一个元素，所以只删除了7</span></span><br><span class="line"><span class="keyword">let</span> item = a.splice(-<span class="number">1</span>, <span class="number">3</span>); <span class="comment">// [7]</span></span><br></pre></td></tr></table></figure>

<h4 id="删除并添加"><a href="#删除并添加" class="headerlink" title="删除并添加"></a>删除并添加</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 从数组下标0开始，删除3个元素，并添加元素&#x27;添加&#x27;</span></span><br><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>];</span><br><span class="line"><span class="keyword">let</span> item = a.splice(<span class="number">0</span>,<span class="number">3</span>,<span class="string">&#x27;添加&#x27;</span>); <span class="comment">// [1,2,3]</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// [&#x27;添加&#x27;,4,5,6,7]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 从数组最后第二个元素开始，删除3个元素，并添加两个元素&#x27;添加1&#x27;、&#x27;添加2&#x27;</span></span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>];</span><br><span class="line"><span class="keyword">let</span> item = b.splice(-<span class="number">2</span>,<span class="number">3</span>,<span class="string">&#x27;添加1&#x27;</span>,<span class="string">&#x27;添加2&#x27;</span>); <span class="comment">// [6,7]</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// [1,2,3,4,5,&#x27;添加1&#x27;,&#x27;添加2&#x27;]</span></span><br></pre></td></tr></table></figure>

<h4 id="不删除只添加"><a href="#不删除只添加" class="headerlink" title="不删除只添加"></a>不删除只添加</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>];</span><br><span class="line"><span class="keyword">let</span> item = a.splice(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&#x27;添加1&#x27;</span>,<span class="string">&#x27;添加2&#x27;</span>); <span class="comment">// [] 没有删除元素，返回空数组</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// [&#x27;添加1&#x27;,&#x27;添加2&#x27;,1,2,3,4,5,6,7]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>];</span><br><span class="line"><span class="keyword">let</span> item = b.splice(-<span class="number">1</span>,<span class="number">0</span>,<span class="string">&#x27;添加1&#x27;</span>,<span class="string">&#x27;添加2&#x27;</span>); <span class="comment">// [] 没有删除元素，返回空数组</span></span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// [1,2,3,4,5,6,&#x27;添加1&#x27;,&#x27;添加2&#x27;,7] 在最后一个元素的前面添加两个元素</span></span><br></pre></td></tr></table></figure>

<h3 id="sort-数组排序"><a href="#sort-数组排序" class="headerlink" title="sort() 数组排序"></a>sort() 数组排序</h3><blockquote>
<p>定义: sort()方法对数组元素进行排序，并返回这个数组。</p>
<p>参数可选: 规定排序顺序的比较函数。</p>
<p>默认情况下sort()方法没有传比较函数的话，默认按字母升序，如果不是元素不是字符串的话，会调用<code>toString()</code>方法将元素转化为字符串的Unicode(万国码)位点，然后再比较字符。</p>
</blockquote>
<h4 id="不传参"><a href="#不传参" class="headerlink" title="不传参"></a>不传参</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 字符串排列 看起来很正常</span></span><br><span class="line"><span class="keyword">var</span> a = [<span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Orange&quot;</span>, <span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Mango&quot;</span>];</span><br><span class="line">a.sort(); <span class="comment">// [&quot;Apple&quot;,&quot;Banana&quot;,&quot;Mango&quot;,&quot;Orange&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数字排序的时候 因为转换成Unicode字符串之后，有些数字会比较大会排在后面 这显然不是我们想要的</span></span><br><span class="line"><span class="keyword">var</span> a = [<span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">20</span>,<span class="number">25</span>,<span class="number">8</span>];</span><br><span class="line"><span class="built_in">console</span>.log(a.sort()) <span class="comment">// [1,10,20,25,3,8];</span></span><br></pre></td></tr></table></figure>

<p><strong>比较函数的两个参数：</strong></p>
<p>sort的比较函数有两个默认参数，要在函数中接收这两个参数，这两个参数是数组中两个要比较的元素，通常我们用 a 和 b 接收两个将要比较的元素：</p>
<ul>
<li>若比较函数返回值&lt;0，那么a将排到b的前面;</li>
<li>若比较函数返回值=0，那么a 和 b 相对位置不变；</li>
<li>若比较函数返回值&gt;0，那么b 排在a 将的前面；</li>
</ul>
<h4 id="数字升降序"><a href="#数字升降序" class="headerlink" title="数字升降序"></a>数字升降序</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> array =  [<span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">20</span>, <span class="number">4</span>, <span class="number">25</span>, <span class="number">8</span>];  </span><br><span class="line">array.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a-b;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(array); <span class="comment">// [1,3,4,4,8,10,20,25];</span></span><br><span class="line"></span><br><span class="line">array.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> b-a;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(array); <span class="comment">// [25,20,10,8,4,4,3,1];</span></span><br></pre></td></tr></table></figure>

<h3 id="pop-删除一个数组中的最后的一个元素"><a href="#pop-删除一个数组中的最后的一个元素" class="headerlink" title="pop() 删除一个数组中的最后的一个元素"></a>pop() 删除一个数组中的最后的一个元素</h3><blockquote>
<p>定义: pop() 方法删除一个数组中的最后的一个元素，并且返回这个元素。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span>  a =  [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> item = a.pop();  <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// [1,2]</span></span><br></pre></td></tr></table></figure>

<h3 id="shift-删除数组的第一个元素"><a href="#shift-删除数组的第一个元素" class="headerlink" title="shift() 删除数组的第一个元素"></a>shift() 删除数组的第一个元素</h3><blockquote>
<p>定义: shift()方法删除数组的第一个元素，并返回这个元素。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span>  a =  [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> item = a.shift();  <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// [2,3]</span></span><br></pre></td></tr></table></figure>

<h3 id="push-向数组的末尾添加元素"><a href="#push-向数组的末尾添加元素" class="headerlink" title="push() 向数组的末尾添加元素"></a>push() 向数组的末尾添加元素</h3><blockquote>
<p>定义：push() 方法可向数组的末尾添加一个或多个元素，并返回新的长度。</p>
<p>参数: item1, item2, …, itemX ,要添加到数组末尾的元素</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span>  a =  [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> item = a.push(<span class="string">&#x27;末尾&#x27;</span>, <span class="string">&#x27;233&#x27;</span>);  <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// [1,2,3,&#x27;末尾&#x27;, &#x27;233&#x27;]</span></span><br></pre></td></tr></table></figure>

<h3 id="unshift"><a href="#unshift" class="headerlink" title="unshift()"></a>unshift()</h3><blockquote>
<p>定义：unshift() 方法可向数组的开头添加一个或更多元素，并返回新的长度。</p>
<p>参数: item1, item2, …, itemX ,要添加到数组开头的元素</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> item = a.unshift(<span class="string">&#x27;开头&#x27;</span>, <span class="string">&#x27;开头2&#x27;</span>);  <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// [ &#x27;开头&#x27;, &#x27;开头2&#x27;, 1, 2, 3 ]</span></span><br></pre></td></tr></table></figure>

<h3 id="reverse-颠倒数组中元素的顺序"><a href="#reverse-颠倒数组中元素的顺序" class="headerlink" title="reverse() 颠倒数组中元素的顺序"></a>reverse() 颠倒数组中元素的顺序</h3><blockquote>
<p>定义: reverse() 方法用于颠倒数组中元素的顺序。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span>  a =  [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">a.reverse();  </span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// [3,2,1]</span></span><br></pre></td></tr></table></figure>

<h2 id="不改变原数组的方法"><a href="#不改变原数组的方法" class="headerlink" title="不改变原数组的方法"></a>不改变原数组的方法</h2><h3 id="slice-浅拷贝数组的元素"><a href="#slice-浅拷贝数组的元素" class="headerlink" title="slice() 浅拷贝数组的元素"></a>slice() 浅拷贝数组的元素</h3><blockquote>
<p>定义： 方法返回一个从开始到结束（<strong>不包括结束</strong>）选择的数组的一部分浅拷贝到一个新数组对象，且原数组不会被修改。</p>
<p>语法：array.slice(begin, end);</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a= [<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;world&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> b=a.slice(<span class="number">0</span>,<span class="number">1</span>); <span class="comment">// [&#x27;hello&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 新数组是浅拷贝的，元素是简单数据类型，改变之后不会互相干扰。</span></span><br><span class="line"><span class="comment">// 如果是复杂数据类型(对象,数组)的话，改变其中一个，另外一个也会改变。</span></span><br><span class="line">a[<span class="number">0</span>]=<span class="string">&#x27;改变原数组&#x27;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a,b); <span class="comment">// [&#x27;改变原数组&#x27;,&#x27;world&#x27;] [&#x27;hello&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a= [&#123;<span class="attr">name</span>:<span class="string">&#x27;OBKoro1&#x27;</span>&#125;];</span><br><span class="line"><span class="keyword">let</span> b=a.slice();</span><br><span class="line"><span class="built_in">console</span>.log(b,a); <span class="comment">// [&#123;&quot;name&quot;:&quot;OBKoro1&quot;&#125;]  [&#123;&quot;name&quot;:&quot;OBKoro1&quot;&#125;]</span></span><br><span class="line"><span class="comment">// a[0].name=&#x27;改变原数组&#x27;;</span></span><br><span class="line"><span class="comment">// console.log(b,a); // [&#123;&quot;name&quot;:&quot;改变原数组&quot;&#125;] [&#123;&quot;name&quot;:&quot;改变原数组&quot;&#125;]</span></span><br></pre></td></tr></table></figure>

<h3 id="join-数组转字符串"><a href="#join-数组转字符串" class="headerlink" title="join() 数组转字符串"></a>join() 数组转字符串</h3><blockquote>
<p>定义: join() 方法用于把数组中的所有元素通过指定的分隔符进行分隔放入一个字符串，返回生成的字符串。</p>
<p>语法: array.join(str)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a= [<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;world&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> str=a.join(); <span class="comment">// &#x27;hello,world&#x27;</span></span><br><span class="line"><span class="keyword">let</span> str2=a.join(<span class="string">&#x27;+&#x27;</span>); <span class="comment">// &#x27;hello+world&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a= [[<span class="string">&#x27;OBKoro1&#x27;</span>,<span class="string">&#x27;23&#x27;</span>],<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> str1=a.join(); <span class="comment">// OBKoro1,23,test</span></span><br><span class="line"><span class="keyword">let</span> b= [&#123;<span class="attr">name</span>:<span class="string">&#x27;OBKoro1&#x27;</span>,<span class="attr">age</span>:<span class="string">&#x27;23&#x27;</span>&#125;,<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> str2 = b.join(); <span class="comment">// [object Object],test</span></span><br><span class="line"><span class="comment">// 对象转字符串推荐JSON.stringify(obj);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 结论：</span></span><br><span class="line"><span class="comment">// join()/toString()方法在数组元素是数组的时候，会将里面的数组也调用join()/toString(),</span></span><br><span class="line"><span class="comment">// 如果是对象的话，对象会被转为[object Object]字符串。</span></span><br></pre></td></tr></table></figure>

<h3 id="join-数组转字符串-1"><a href="#join-数组转字符串-1" class="headerlink" title="join() 数组转字符串"></a>join() 数组转字符串</h3><blockquote>
<p>定义: join() 方法用于把数组中的所有元素通过指定的分隔符进行分隔放入一个字符串，返回生成的字符串。</p>
<p>语法: array.join(str)</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a= [<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;world&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> str=a.join(); <span class="comment">// &#x27;hello,world&#x27;</span></span><br><span class="line"><span class="keyword">let</span> str2=a.join(<span class="string">&#x27;+&#x27;</span>); <span class="comment">// &#x27;hello+world&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a= [[<span class="string">&#x27;OBKoro1&#x27;</span>,<span class="string">&#x27;23&#x27;</span>],<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> str1=a.join(); <span class="comment">// OBKoro1,23,test</span></span><br><span class="line"><span class="keyword">let</span> b= [&#123;<span class="attr">name</span>:<span class="string">&#x27;OBKoro1&#x27;</span>,<span class="attr">age</span>:<span class="string">&#x27;23&#x27;</span>&#125;,<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="keyword">let</span> str2 = b.join(); <span class="comment">// [object Object],test</span></span><br><span class="line"><span class="comment">// 对象转字符串推荐JSON.stringify(obj);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 结论：</span></span><br><span class="line"><span class="comment">// join()/toString()方法在数组元素是数组的时候，会将里面的数组也调用join()/toString(),</span></span><br><span class="line"><span class="comment">// 如果是对象的话，对象会被转为[object Object]字符串。</span></span><br></pre></td></tr></table></figure>

<h3 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h3><blockquote>
<p>定义： 方法用于合并两个或多个数组，返回一个新数组。</p>
<p>语法：var newArr =oldArray.concat(arrayX,arrayX,……,arrayX)</p>
<p>参数：arrayX（必须）：该参数可以是具体的值，也可以是数组对象。可以是任意多个。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"><span class="comment">//连接两个数组</span></span><br><span class="line"><span class="keyword">let</span> newVal=a.concat(b); <span class="comment">// [1,2,3,4,5,6]</span></span><br><span class="line"><span class="comment">// 连接三个数组</span></span><br><span class="line"><span class="keyword">let</span> c = [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="keyword">let</span> newVal2 = a.concat(b, c); <span class="comment">// [1,2,3,4,5,6,7,8,9]</span></span><br><span class="line"><span class="comment">// 添加元素</span></span><br><span class="line"><span class="keyword">let</span> newVal3 = a.concat(<span class="string">&#x27;添加元素&#x27;</span>,b, c,<span class="string">&#x27;再加一个&#x27;</span>); </span><br><span class="line"><span class="comment">// [1,2,3,&quot;添加元素&quot;,4,5,6,7,8,9,&quot;再加一个&quot;]</span></span><br><span class="line"><span class="comment">// 合并嵌套数组  会浅拷贝嵌套数组</span></span><br><span class="line"><span class="keyword">let</span> d = [<span class="number">1</span>,<span class="number">2</span> ];</span><br><span class="line"><span class="keyword">let</span> f = [<span class="number">3</span>,[<span class="number">4</span>]];</span><br><span class="line"><span class="keyword">let</span> newVal4 = d.concat(f); <span class="comment">// [1,2,3,[4]]</span></span><br></pre></td></tr></table></figure>

<h3 id="ES6扩展运算符-合并数组"><a href="#ES6扩展运算符-合并数组" class="headerlink" title="ES6扩展运算符...合并数组"></a>ES6扩展运算符<code>...</code>合并数组</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">let</span> b = [ <span class="number">4</span>,...a, <span class="number">4</span>, <span class="number">4</span>]</span><br><span class="line"><span class="built_in">console</span>.log(a,b); <span class="comment">//  [2, 3, 4, 5] [4,2,3,4,5,4,4]</span></span><br></pre></td></tr></table></figure>

<h3 id="indexOf-查找数组是否存在某个元素，返回下标"><a href="#indexOf-查找数组是否存在某个元素，返回下标" class="headerlink" title="indexOf() 查找数组是否存在某个元素，返回下标"></a>indexOf() 查找数组是否存在某个元素，返回下标</h3><blockquote>
<p>定义: 返回在数组中可以找到一个给定元素的第一个索引，如果不存在，则返回-1。</p>
<p>p.s. 字符串也有此方法，要注意当 ‘lance’.indexOf(‘’) 一个空字符串时，返回0而不是-1</p>
<p>语法：array.indexOf(searchElement,fromIndex)</p>
<p>参数：</p>
<p>searchElement(必须):被查找的元素</p>
<p>fromIndex(可选):开始查找的位置(不能大于等于数组的长度，返回-1)，接受负值，默认值为0。</p>
<p>严格相等的搜索:</p>
<p>数组的indexOf搜索跟字符串的indexOf不一样,数组的indexOf使用严格相等<code>===</code>搜索元素，即<strong>数组元素要完全匹配</strong>才能搜索成功。</p>
<p><strong>注意</strong>：indexOf()不能识别<code>NaN</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a=[<span class="string">&#x27;啦啦&#x27;</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">24</span>,<span class="literal">NaN</span>]</span><br><span class="line"><span class="built_in">console</span>.log(a.indexOf(<span class="string">&#x27;啦&#x27;</span>));  <span class="comment">// -1 </span></span><br><span class="line"><span class="built_in">console</span>.log(a.indexOf(<span class="string">&#x27;NaN&#x27;</span>));  <span class="comment">// -1 </span></span><br><span class="line"><span class="built_in">console</span>.log(a.indexOf(<span class="string">&#x27;啦啦&#x27;</span>)); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>

<h3 id="lastIndexOf-查找指定元素在数组中的最后一个位置"><a href="#lastIndexOf-查找指定元素在数组中的最后一个位置" class="headerlink" title="lastIndexOf() 查找指定元素在数组中的最后一个位置"></a>lastIndexOf() 查找指定元素在数组中的最后一个位置</h3><blockquote>
<p>定义: 方法返回指定元素,在数组中的最后一个的索引，如果不存在则返回 -1。（从数组后面往前查找）</p>
<p>语法：arr.lastIndexOf(searchElement,fromIndex)</p>
<p>参数:</p>
<p>searchElement(必须): 被查找的元素</p>
<p>fromIndex(可选): 逆向查找开始位置，默认值数组的 <code>长度-1</code>，即查找整个数组。</p>
<p>关于fromIndex有三个规则:</p>
<ol>
<li>正值。如果该值大于或等于数组的长度，则整个数组会被查找。</li>
<li>负值。将其视为从数组末尾向前的偏移。(比如-2，从数组最后第二个元素开始往前查找)</li>
<li>负值。其绝对值大于数组长度，则方法返回 -1，即数组不会被查找。</li>
</ol>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a=[<span class="string">&#x27;OB&#x27;</span>,<span class="number">4</span>,<span class="string">&#x27;Koro1&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;Koro1&#x27;</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="string">&#x27;Koro1&#x27;</span>]; <span class="comment">// 数组长度为10</span></span><br><span class="line"><span class="comment">// let b=a.lastIndexOf(&#x27;Koro1&#x27;,4); // 从下标4开始往前找 返回下标2</span></span><br><span class="line"><span class="comment">// let b=a.lastIndexOf(&#x27;Koro1&#x27;,100); //  大于或数组的长度 查找整个数组 返回9</span></span><br><span class="line"><span class="comment">// let b=a.lastIndexOf(&#x27;Koro1&#x27;,-11); // -1 数组不会被查找</span></span><br><span class="line"><span class="keyword">let</span> b=a.lastIndexOf(<span class="string">&#x27;Koro1&#x27;</span>,-<span class="number">9</span>); <span class="comment">// 从第二个元素4往前查找，没有找到 返回-1</span></span><br></pre></td></tr></table></figure>

<h3 id="ES7-includes-查找数组是否包含某个元素-返回布尔"><a href="#ES7-includes-查找数组是否包含某个元素-返回布尔" class="headerlink" title="ES7 includes() 查找数组是否包含某个元素 返回布尔"></a>ES7 includes() 查找数组是否包含某个元素 返回布尔</h3><blockquote>
<p>定义： 返回一个布尔值，表示某个数组是否包含给定的值</p>
<p>语法：array.includes(searchElement,fromIndex=0)</p>
<p>参数：</p>
<p>searchElement(必须):被查找的元素</p>
<p>fromIndex(可选):默认值为0，参数表示搜索的起始位置，接受负值。正值超过数组长度，数组不会被搜索，返回false。负值绝对值超过长数组度，重置从0开始搜索。</p>
<p><strong>includes方法是为了弥补indexOf方法的缺陷而出现的:</strong></p>
<ol>
<li>indexOf方法不能识别<code>NaN</code></li>
<li>indexOf方法检查是否包含某个值不够语义化，需要判断是否不等于<code>-1</code>，表达不够直观</li>
</ol>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a=[<span class="string">&#x27;OB&#x27;</span>,<span class="string">&#x27;Koro1&#x27;</span>,<span class="number">1</span>,<span class="literal">NaN</span>];</span><br><span class="line"><span class="comment">// let b=a.includes(NaN); // true 识别NaN</span></span><br><span class="line"><span class="comment">// let b=a.includes(&#x27;Koro1&#x27;,100); // false 超过数组长度 不搜索</span></span><br><span class="line"><span class="comment">// let b=a.includes(&#x27;Koro1&#x27;,-3);  // true 从倒数第三个元素开始搜索 </span></span><br><span class="line"><span class="comment">// let b=a.includes(&#x27;Koro1&#x27;,-100);  // true 负值绝对值超过数组长度，搜索整个数组</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
  </entry>
  <entry>
    <title>【翻译】Minification 压缩与 Gzip 压缩的区别</title>
    <url>/posts/8214/</url>
    <content><![CDATA[<blockquote>
<p>原链接：<a href="https://css-tricks.com/the-difference-between-minification-and-gzipping/">https://css-tricks.com/the-difference-between-minification-and-gzipping/</a><br>作者：Chris Coyier</p>
</blockquote>
<p>这两种方法都针对你网站上的资源（比如 .css 文件和 .js 文件）所使用。它们都用来压缩文件大小，使服务器和浏览器之间的网络更加通畅，提高网页性能。网络是网页的速度瓶颈所在，而压缩文件大小能够改善这一点。</p>
<p>但这两者也截然不同。如果之前你并不知道这一点，那么你应当花时间来了解它。</p>
<a id="more"></a>

<h1 id="Minification-能够删除空格符（whitespace）、注释符（comments）、无用的分号（semicolons）或是减少-hex-代码的长度…"><a href="#Minification-能够删除空格符（whitespace）、注释符（comments）、无用的分号（semicolons）或是减少-hex-代码的长度…" class="headerlink" title="Minification 能够删除空格符（whitespace）、注释符（comments）、无用的分号（semicolons）或是减少 hex 代码的长度…"></a>Minification 能够删除空格符（whitespace）、注释符（comments）、无用的分号（semicolons）或是减少 hex 代码的长度…</h1><p>……诸如此类。剩下的文件依然是有效代码。你不必尝试读取它或是使用它，它并没有违反任何规则。就像对原始文件那样，浏览器可以读取它和使用它。</p>
<p>Minification 能够创建你最终使用的新文件。比如当你创建了一个名为 <code>style.css</code> 的文件之后，你可以把它压缩为 <code>style.min.css</code>。</p>
<h1 id="Gizpping-能识别所有重复的字符串，并使用指代该字符串第一个实例的指针来代替。"><a href="#Gizpping-能识别所有重复的字符串，并使用指代该字符串第一个实例的指针来代替。" class="headerlink" title="Gizpping 能识别所有重复的字符串，并使用指代该字符串第一个实例的指针来代替。"></a>Gizpping 能识别所有重复的字符串，并使用指代该字符串第一个实例的指针来代替。</h1><p>Julia Evans 曾想出一个绝佳的方法来解释这一点（点击<a href="https://jvns.ca/blog/2013/10/24/day-16-gzip-plus-poetry-equals-awesome/">这里</a>查阅她发布的内容和视频）。下面是一首诗的第一段：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Once upon a midnight dreary, <span class="keyword">while</span> I &#123;pon&#125;dered weak an&#123;d wea&#125;&#123;ry,&#125;</span><br><span class="line">Over many&#123; a &#125;quaint&#123; and &#125;curious volume <span class="keyword">of</span> forgotten lore,</span><br><span class="line">W&#123;hile I &#125;nodded, n&#123;ear&#125;ly napping, su&#123;dde&#125;n&#123;ly &#125;th&#123;ere&#125; ca&#123;me &#125;a t&#123;apping,&#125;</span><br><span class="line">As&#123; <span class="keyword">of</span> &#125;so&#123;me o&#125;ne gent&#123;ly &#125;r&#123;apping, &#125;&#123;rapping&#125; at my chamb&#123;er &#125;door.</span><br><span class="line"><span class="string">`&#x27;Tis&#123; some &#125;visitor,&#x27;&#123; I &#125;mu&#123;tte&#125;r&#123;ed, &#125;`</span>t&#123;apping at my chamber door&#125; -</span><br><span class="line">O&#123;nly th&#125;is,&#123; and &#125;no&#123;thi&#125;&#123;ng &#125;m&#123;ore&#125;.</span><br></pre></td></tr></table></figure>

<p>Gzip 识别出括弧里的文字都是重复的，因此将会使用指针来代替它们，这样这些文字占用的空间将会比原来更小。</p>
<p>对于减少文件大小、尤其是代码而言，这种方法十分高效，因为代码中有大量重复的内容。设想一下一个 HTML 文件里有多少个 <code>&lt;div</code>，一个 CSS 文件里又有多少 <code>&#123;</code>。</p>
<p>你也可以创建某个文件的 Gzip 压缩版本，比如 style.css.zip。但你一般不会这样做，浏览器也不知道应该如何使用这个文件。</p>
<p>在网页中，Gzip 压缩直接通过服务器完成。因此你要做的是配置服务器。一旦完成配置，Gzip 压缩将会自动进行，你无需再做任何工作。服务器会压缩文件，并通过网络传送文件。浏览器则接受文件，并在使用之前进行解压。我从未听谁提到过压缩和解压的成本，因此在这里我假设这些成本可以忽略不计，并且我们获得的受益远大于成本。</p>
<p>点击<a href="https://css-tricks.com/snippets/htaccess/active-gzip-compression/">这里</a>查看如何在 Apache 服务器中进行配置，这里使用了 <code>mod_deflate</code> 模块。H5BP 也为所有常见的服务器<a href="https://github.com/h5bp/server-configs">提供了服务器配置</a>，包括 Gzipping。</p>
<h1 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h1><p>我们将用到 <a href="https://getbootstrap.com/">Bootstrap</a> 中常见的 CSS 文件。</p>
<img src="/posts/8214/3e99e9b284d401c365c5044bc715ba44c9246f83.jpg" class="" title="3e99e9b284d401c365c5044bc715ba44c9246f83">

<p>通过 Minification 来压缩这个 CSS 文件，你将节省 17% 的空间，而使用 Gzipping 能够节省 85%，将两种方法结合使用节省的空间是 86%。</p>
<p>下面是使用 DevTools 检查工作状况时的理想情况：</p>
<img src="/posts/8214/997aee7f7378ac61ca5b36877a65f44c3ed70bc5.jpg" class="" title="997aee7f7378ac61ca5b36877a65f44c3ed70bc5">

<h1 id="Gzip压缩-要高效得多，而将两种方法结合起来更为理想。"><a href="#Gzip压缩-要高效得多，而将两种方法结合起来更为理想。" class="headerlink" title="Gzip压缩 要高效得多，而将两种方法结合起来更为理想。"></a>Gzip压缩 要高效得多，而将两种方法结合起来更为理想。</h1><p>Gzip 压缩节省的空间大概是 Minification 压缩的五倍。然而，通过 Minification 压缩，你也可以获得一些帮助，不过在构建步骤时你需要耗费一些额外的力气。</p>
<p>同样<a href="http://carlos.bueno.org/2010/02/measuring-javascript-parse-and-load.html#minifi">有证据</a>证明浏览器在读取和解析 Minification 压缩的文件时速度更快：</p>
<blockquote>
<p>正如预期的那样，除了缩短网络传输时间以外，Minification 压缩还有助于解析和加载。这也许是因为缺少注释符和额外的空白符。</p>
</blockquote>
<p>微软也开始为此优化它们的语法分析器：</p>
<blockquote>
<p>因此，在 Window 10 和 Microsoft Edge 中，我们新添加了快速路径，改善了在 Chakra 的 JIT 编译器中嵌入和优化部分探视程序的体验，以保证压缩代码的运行速度不低于原始版本。通过这些改变，通过 UglifyJS 压缩过的个体代码模式的性能提高了 20% 到 50%。</p>
</blockquote>
<p>缓存资源同样与这段对话相关，没有什么比一个不需要请求任何资源的浏览器速度更快了！关于这一点，网上或者<a href="https://www.amazon.com/Designing-Performance-Weighing-Aesthetics-Speed/dp/1491902515/ref=as_li_ss_tl?ie=UTF8&linkCode=sl1&tag=css-tricks-20&linkId=d4d794b5604a084164c8ba33d2540283">书</a>中还有许多相关知识，不过很快我们也许会发布一些有关使用技巧的内容。</p>
]]></content>
      <categories>
        <category>后端</category>
        <category>构建工具</category>
      </categories>
      <tags>
        <tag>翻译</tag>
      </tags>
  </entry>
  <entry>
    <title>Promise用法</title>
    <url>/posts/7878/</url>
    <content><![CDATA[<h2 id="Promise是什么"><a href="#Promise是什么" class="headerlink" title="Promise是什么"></a>Promise是什么</h2><p>Promise 是一种异步编程的解决方案，比传统的异步解决方案【回调函数】和【事件】更合理、更强大。</p>
<h2 id="诞生的原因"><a href="#诞生的原因" class="headerlink" title="诞生的原因"></a>诞生的原因</h2><p>异步网络请求的<strong>回调地狱</strong>，而且我们还得对每次请求的结果进行一些处理，代码会更加臃肿。一张图完美诠释：</p>
<img src="/posts/7878/call-back-hello.jpg" class="" title="回调地狱">

<p>不够？再加一张：</p>
<img src="/posts/7878/8144ca8cgw1f2wc9ed35zj218g0p0tey.jpg" class="" title="行为艺术">

<a id="more"></a>

<h2 id="Promise的三种状态"><a href="#Promise的三种状态" class="headerlink" title="Promise的三种状态"></a>Promise的三种状态</h2><ul>
<li>pedding 等待（默认状态。异步代码执行完毕后会转换为以下两种状态）</li>
<li>resolve 成功</li>
<li>reject 失败</li>
</ul>
<h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><ul>
<li>Promise:<ul>
<li>构造函数</li>
<li>接受一个参数：callback，我们把要执行的异步任务放置在这个callback中</li>
</ul>
</li>
<li>then:<ul>
<li>Promise对象下的一个方法：该方法在Promise对象的状态发生改变的时候触发then的回调</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//defined Promise async function</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asyncFun</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (resolve) &#123;</span><br><span class="line">            resolve(<span class="comment">/*resolve parameter*/</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="comment">/*Error*/</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//use Promise&amp;then</span></span><br><span class="line">asyncFun().then(<span class="comment">/*function*/</span>).then(<span class="comment">/*function*/</span>)...</span><br></pre></td></tr></table></figure>

<h2 id="Promise特性"><a href="#Promise特性" class="headerlink" title="Promise特性"></a>Promise特性</h2><h3 id="立即执行"><a href="#立即执行" class="headerlink" title="立即执行"></a>立即执行</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 当Promise被实例化的时候，callback的异步任务就会被执行</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;一个Promise对象被创建出来&quot;</span>);</span><br><span class="line">    resolve(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;flag&quot;</span>);</span><br><span class="line"></span><br><span class="line">p.then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行结果：</span></span><br><span class="line"><span class="comment">// 一个Promise对象被创建出来</span></span><br><span class="line"><span class="comment">// flag</span></span><br><span class="line"><span class="comment">// success</span></span><br></pre></td></tr></table></figure>

<h3 id="状态不可逆"><a href="#状态不可逆" class="headerlink" title="状态不可逆"></a>状态不可逆</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    reject(<span class="string">&quot;reject&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">p.then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行结果：</span></span><br><span class="line"><span class="comment">// success</span></span><br></pre></td></tr></table></figure>

<h3 id="链式调用"><a href="#链式调用" class="headerlink" title="链式调用"></a>链式调用</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 通过传入的resolve, reject，去改变当前Promise任务的状态</span></span><br><span class="line">    <span class="comment">// resolve, reject 是两个函数，调用 resolve ，会把状态改成 resolved ，调用 reject 函数会把状态改成 rejected</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">        reject();</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// then接受两个参数：这两个参数都是回调，当对应的 promise 对象的状态变成了resolved，那么 then 的第一个 callback 就会被执行，如果状态变成了 rejected ，那么 then 的第二个 callback 就会被执行</span></span><br><span class="line">p.then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;成功&#x27;</span>);</span><br><span class="line">&#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;失败&#x27;</span>);</span><br><span class="line">&#125; );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行结果：</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 失败</span></span><br></pre></td></tr></table></figure>

<h3 id="then的回调异步性"><a href="#then的回调异步性" class="headerlink" title="then的回调异步性"></a>then的回调异步性</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;我是Promise的callback中的代码&quot;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        resolve(<span class="string">&quot;我1s后才会被执行&quot;</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">p.then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;我是主线程中的同步代码&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行结果：</span></span><br><span class="line"><span class="comment">// 我是Promise的callback中的代码</span></span><br><span class="line"><span class="comment">// 我是主线程中的同步代码</span></span><br><span class="line"><span class="comment">// 我1s后才会被执行</span></span><br></pre></td></tr></table></figure>

<p>解释：Promise 的 callback 回调函数中的代码是立即执行的（setTimeout 这个定时器也是立即执行的，只是函数内的 resolve 被延迟1s执行，跟 Promise 本身的立即执行没关系），但 then 方法中的回调函数执行则是异步的，因此，<code>&quot;我1s后才会被执行&quot;</code> 会在最后输出。</p>
<h3 id="异常的捕获"><a href="#异常的捕获" class="headerlink" title="异常的捕获"></a>异常的捕获</h3><p>Promise的异常有两种方法可以捕获，一种是 then 的第二个回调；一种 <code>.catch()</code> 来捕获前一个 Promise 抛出的错误。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    reject(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">p.then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">&#125;, <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行结果：</span></span><br><span class="line"><span class="comment">// error</span></span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    reject(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">p.then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;catch:&quot;</span> + error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行结果：</span></span><br><span class="line"><span class="comment">// catch:error</span></span><br></pre></td></tr></table></figure>

<h2 id="Promise-all-和-Promise-race"><a href="#Promise-all-和-Promise-race" class="headerlink" title="Promise.all 和 Promise.race"></a>Promise.all 和 Promise.race</h2><h3 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all"></a>Promise.all</h3><p>Promise.all 接收一个参数，它必须是可以迭代的，例如数组。<br>它通常用来处理一些并发的异步操作，即它们的结果互不干扰，但是又需要异步执行。当所有 Promise 都成功的时候，整个 Promise.all 才成功。成功调用后返回一个数组，数组的值是有序的，顺序就是传入参数的数组顺序：</p>
<blockquote>
<p>成功的情况</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> tasks = arr.map(<span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(num * <span class="number">5</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all(tasks).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 有序输出</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr); <span class="comment">// [1, 2, 3]</span></span><br><span class="line">    <span class="built_in">console</span>.log(data); <span class="comment">// [5, 10, 15]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>失败的情况</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> tasks = arr.map(<span class="function"><span class="params">num</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (num === <span class="number">3</span>) &#123;</span><br><span class="line">            reject(<span class="string">&#x27;rejected&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        resolve(num * <span class="number">5</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all(tasks).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 这里不会执行</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr);</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err); <span class="comment">// rejected</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race"></a>Promise.race</h3><p>Promise.race 和 Promise.all 类似，都接收一个可以迭代的参数，但是不同之处是 Promise.race 的状态变化不是全部受参数内的状态影响，一旦参数内有一个值的状态发生的改变，那么该 Promise 的状态就是改变的状态。就跟 race 单词的字面意思一样，谁跑的快谁赢。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(resolve, <span class="number">300</span>, <span class="string">&#x27;p1 doned&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(resolve, <span class="number">50</span>, <span class="string">&#x27;p2 doned&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(reject, <span class="number">100</span>, <span class="string">&#x27;p3 rejected&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.race([p1, p2, p3]).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 显然p2更快，所以状态变成了fulfilled</span></span><br><span class="line">    <span class="comment">// 如果p3更快，那么状态就会变成rejected</span></span><br><span class="line">    <span class="built_in">console</span>.log(data); <span class="comment">// p2 doned</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err); <span class="comment">// 不执行</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>Promise</tag>
      </tags>
  </entry>
  <entry>
    <title>Sequelize框架进阶</title>
    <url>/posts/3278/</url>
    <content><![CDATA[<h2 id="传送门"><a href="#传送门" class="headerlink" title="传送门"></a>传送门</h2><ul>
<li><a href="https://evestorm.github.io/posts/1183/">Sequelize框架入门</a></li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>上一篇入门讲到了 <code>Sequelize框架</code> 的基本用法，比如实现简单的增删查改。原本打算一篇文章写到底的，但感觉内容太多，对读者不太友好，就另开了这篇文章。</p>
<p>虽然标题写着“进阶”，但其实有标题党的以为。这篇文章仍然着手于框架的使用，不涉及源码。大纲见侧边栏的目录，我们直接开始吧~</p>
<a id="more"></a>

<h2 id="连表查询"><a href="#连表查询" class="headerlink" title="连表查询"></a>连表查询</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>既然是连表查询，至少得有两个表吧。所以我们还需要另外新建一张表，这里起名为 <code>message</code> 表，表结构如下：</p>
<img src="/posts/3278/message-table.png" class="" title="message-table">

<p>其中 uid 对应用户的 id 。下面是两表的数据：</p>
<img src="/posts/3278/user-message-data.png" class="" title="user-message-data">

<p>接着我们新建一个 <code>app2.js</code> 文件，引入之前 <code>app.js</code> 中的部分代码（连接数据库+UserModel）以及创建一个 <code>MessageModel</code> 模型：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Sequelize = <span class="built_in">require</span>(<span class="string">&#x27;sequelize&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> Sequelize(<span class="string">&quot;miaov&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>, &#123;</span><br><span class="line">    host: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">    port: <span class="number">8889</span>,</span><br><span class="line">    dialect: <span class="string">&quot;mysql&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    sequelize.authenticate();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;数据库连接成功!&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;连接失败&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> UserModel = sequelize.define(<span class="string">&#x27;User&#x27;</span>, &#123;</span><br><span class="line">    id: &#123;</span><br><span class="line">        type: Sequelize.INTEGER(<span class="number">11</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        autoIncrement: <span class="literal">true</span>,</span><br><span class="line">        primaryKey: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    username: &#123;</span><br><span class="line">        type: Sequelize.STRING(<span class="number">50</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    age: &#123;</span><br><span class="line">        type: Sequelize.TINYINT(<span class="number">3</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    gender: &#123;</span><br><span class="line">        type: Sequelize.ENUM([<span class="string">&#x27;men&#x27;</span>, <span class="string">&#x27;women&#x27;</span>, <span class="string">&#x27;other&#x27;</span>]),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="string">&#x27;men&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    timestamps: <span class="literal">false</span>,</span><br><span class="line">    tableName: <span class="string">&#x27;users&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MessageModel = sequelize.define(<span class="string">&#x27;Message&#x27;</span>, &#123;</span><br><span class="line">    id: &#123;</span><br><span class="line">        type: Sequelize.INTEGER(<span class="number">11</span>),</span><br><span class="line">        primaryKey: <span class="literal">true</span>,</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        autoIncrement: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    uid: &#123;</span><br><span class="line">        type: Sequelize.INTEGER(<span class="number">11</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="number">0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    content: &#123;</span><br><span class="line">        type: Sequelize.STRING(<span class="number">255</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    timestamps: <span class="literal">false</span>,</span><br><span class="line">    freezeTableName: <span class="literal">true</span>, <span class="comment">// 默认 false 将自动修改表名为复数，true 表示不修改表名，与数据库表名同步</span></span><br><span class="line">    tableName: <span class="string">&#x27;message&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h3 id="需求-普通做法"><a href="#需求-普通做法" class="headerlink" title="需求+普通做法"></a>需求+普通做法</h3><p>我们这次的需求是获取某条留言的所有数据，其中包含 <code>留言本身的数据</code> + <code>该留言的用户数据</code> ，先来看最“耿直”的做法：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> data = &#123;&#125;;</span><br><span class="line">    <span class="comment">// 根据 id 查找 message</span></span><br><span class="line">    <span class="keyword">let</span> message = <span class="keyword">await</span> MessageModel.findByPk(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 根据 message 的 uid 反查出发布这条 message 的 user</span></span><br><span class="line">    <span class="keyword">let</span> user = <span class="keyword">await</span> UserModel.findByPk(message.get(<span class="string">&#x27;uid&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Object</span>.assign(data, &#123;</span><br><span class="line">        id: message.id,</span><br><span class="line">        uid: message.uid,</span><br><span class="line">        content: message.content,</span><br><span class="line">        username: user.username,</span><br><span class="line">        age: user.age,</span><br><span class="line">        gender: user.gender,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h3 id="BelongsTo"><a href="#BelongsTo" class="headerlink" title="BelongsTo"></a>BelongsTo</h3><p>除了上面这种做法外，我们还可以使用 <code>sequelize</code> 提供的 <code>BelongsTo</code> 来关联两个模型进行查询。</p>
<p>思考一下我们的 <code>users</code> 和 <code>message</code> 表，从 <code>message</code> 的角度来讲，一条留言属于一个用户发布的，是一对一的关系。而 <code>BelongsTo</code> 关联的含义就是 A 属于 B。那我们应该怎么写代码呢？步骤如下：</p>
<ol>
<li><p>首先在模型中给关联的字段定义外键关系</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">references: &#123;</span><br><span class="line">   model: 关联的外键表模型, e.g. UserModel</span><br><span class="line">   key: 关联的外键表的字段, e.g. id</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在调用 <code>belongsTo</code> 或 <code>hasMany</code> 等方法的时候，通过第二个参数设置对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123; </span><br><span class="line">   foreignKey: 当前关联表的字段, e.g. uid</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>没有完全理解上面的步骤也没关系，直接上代码更加清晰：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> MessageModel = sequelize.define(<span class="string">&#x27;Message&#x27;</span>, &#123;</span><br><span class="line">    ...,</span><br><span class="line">    uid: &#123; <span class="comment">// 第一步：在模型中给关联的字段定义外键关系</span></span><br><span class="line">        ...</span><br><span class="line">        references: &#123;</span><br><span class="line">            model: UserModel, <span class="comment">// 关联的外键表模型</span></span><br><span class="line">            key: <span class="string">&#x27;id&#x27;</span>,        <span class="comment">// 关联的外键表的字段</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">&#125;, ...);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 第二步：声明两表关系及外键</span></span><br><span class="line">    <span class="comment">// 下面方法翻译过来：留言属于用户</span></span><br><span class="line">    MessageModel.belongsTo(UserModel, &#123;</span><br><span class="line">        foreignKey: <span class="string">&#x27;uid&#x27;</span> <span class="comment">// 声明自己（message）的外键是 uid</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> data = <span class="keyword">await</span> MessageModel.findByPk(<span class="number">1</span>, &#123;</span><br><span class="line">        include: [UserModel] <span class="comment">// 表述查出的 message 记录中包含有对应的 user</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`</span></span><br><span class="line"><span class="string">        留言id：<span class="subst">$&#123;data.id&#125;</span></span></span><br><span class="line"><span class="string">        留言人名称：<span class="subst">$&#123;data.User.username&#125;</span></span></span><br><span class="line"><span class="string">        留言内容：<span class="subst">$&#123;data.content&#125;</span></span></span><br><span class="line"><span class="string">    `</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<h3 id="HasMany"><a href="#HasMany" class="headerlink" title="HasMany"></a>HasMany</h3><p>这次我们换个角度，来通过某个用户查找他/她所有的留言。稍微想一下，一个用户是可以发布多条留言的，所以从 <code>users</code> 角度来讲，跟 <code>message</code> 是一对多的关系。而 <code>sequelize</code> 也提供了处理这种关系的方法，那就是 <code>HasMany</code>。直接上代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// users 拥有</span></span><br><span class="line">    UserModel.hasMany(MessageModel, &#123;</span><br><span class="line">        foreignKey: <span class="string">&#x27;uid&#x27;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> data = <span class="keyword">await</span> UserModel.findByPk(<span class="number">3</span>, &#123;</span><br><span class="line">        include: [MessageModel]</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`</span></span><br><span class="line"><span class="string">        id为 <span class="subst">$&#123;data.id&#125;</span> 的留言人 <span class="subst">$&#123;data.username&#125;</span> 的留言内容：</span></span><br><span class="line"><span class="string">    `</span>);</span><br><span class="line">    data.Messages.forEach(<span class="function"><span class="params">m</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`</span></span><br><span class="line"><span class="string">            <span class="subst">$&#123;m.content&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<h2 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h2><p>安装的 sequelize 和 mysql2 的版本为：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;mysql2&quot;</span>: <span class="string">&quot;^1.6.5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sequelize&quot;</span>: <span class="string">&quot;^5.3.1&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>后端</category>
        <category>SQL</category>
      </categories>
      <tags>
        <tag>Sequelize</tag>
      </tags>
  </entry>
  <entry>
    <title>VSCode+Vue项目Ctrl加V自动格式化代码</title>
    <url>/posts/22469/</url>
    <content><![CDATA[<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>期望多人开发 Vue 项目时，大家的代码风格保持一致。并且在 VSCode 中，Ctrl+V 保存代码时自动按照 eslint 规范格式化代码。</p>
<h2 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h2><ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint">ESLint</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=octref.vetur">Vetur</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode">Prettier - Code formatter</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=christian-kohler.path-intellisense">Path Intellisense</a></li>
</ul>
<a id="more"></a>

<h2 id="配置-VSCode-用户-Settings-json"><a href="#配置-VSCode-用户-Settings-json" class="headerlink" title="配置 VSCode 用户 Settings.json"></a>配置 VSCode 用户 Settings.json</h2><h3 id="打开方式"><a href="#打开方式" class="headerlink" title="打开方式"></a>打开方式</h3><ol>
<li>文件——&gt;首选项——&gt;设置</li>
<li>Ctrl+P 搜索 settings.json</li>
</ol>
<h3 id="添加配置"><a href="#添加配置" class="headerlink" title="添加配置"></a>添加配置</h3><blockquote>
<p>有注释的才需要添加，其他没注释的可以不用管</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;editor.fontSize&quot;</span>: <span class="number">14</span>,</span><br><span class="line">  <span class="attr">&quot;bracket-pair-colorizer-2.showBracketsInGutter&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;workbench.iconTheme&quot;</span>: <span class="string">&quot;material-icon-theme&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;sync.gist&quot;</span>: <span class="string">&quot;e9262ee54aa0988ee98c24e6be1dada1&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;workbench.colorTheme&quot;</span>: <span class="string">&quot;Atom One Dark&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;editor.fontFamily&quot;</span>: <span class="string">&quot;&#x27;Fira Code&#x27;, Menlo, Monaco, &#x27;Courier New&#x27;, monospace&quot;</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 新增配置</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;editor.formatOnSave&quot;</span>: <span class="literal">true</span>, <span class="comment">// #每次保存的时候自动格式化</span></span><br><span class="line">  <span class="attr">&quot;editor.codeActionsOnSave&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;source.fixAll.eslint&quot;</span>: <span class="literal">true</span></span><br><span class="line">  &#125;, <span class="comment">// 每次保存的时候将代码按eslint格式进行修复</span></span><br><span class="line">  <span class="attr">&quot;editor.tabSize&quot;</span>: <span class="number">2</span>, <span class="comment">// 重新设定tabSize</span></span><br><span class="line">  <span class="attr">&quot;prettier.semi&quot;</span>: <span class="literal">true</span>, <span class="comment">// 添加代码结尾的分号</span></span><br><span class="line">  <span class="attr">&quot;prettier.singleQuote&quot;</span>: <span class="literal">true</span>, <span class="comment">// 使用单引号替代双引号</span></span><br><span class="line">  <span class="attr">&quot;prettier.arrowParens&quot;</span>: <span class="string">&quot;avoid&quot;</span>, <span class="comment">// 箭头函数参数只有一个时是否要有小括号。</span></span><br><span class="line">  <span class="comment">// avoid - 省略括号</span></span><br><span class="line">  <span class="comment">// always - 总是不省略</span></span><br><span class="line">  <span class="attr">&quot;prettier.htmlWhitespaceSensitivity&quot;</span>: <span class="string">&quot;ignore&quot;</span>, <span class="comment">// 指定 HTML 文件的全局空白区域敏感度</span></span><br><span class="line">  <span class="comment">// &quot;css&quot;- 遵守 CSS display属性的默认值。</span></span><br><span class="line">  <span class="comment">// &quot;strict&quot; - 空格被认为是敏感的。</span></span><br><span class="line">  <span class="comment">// &quot;ignore&quot; - 空格被认为是不敏感的。</span></span><br><span class="line">  <span class="comment">// html 中空格也会占位，影响布局，prettier 格式化的时候可能会将文本换行，造成布局错乱</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// --------------- html -----------------</span></span><br><span class="line">  <span class="comment">//  &lt;a href=&quot;https://prettier.io/&quot;&gt;Prettier is an opinionated code formatter.&lt;/a&gt;</span></span><br><span class="line">  <span class="comment">//  &lt;!-- 变成 --&gt;</span></span><br><span class="line">  <span class="comment">//  &lt;!-- &quot;Prettier is an opinionated code formatter. &quot; 另起一行，在页面的布局上就会多一个节点文本出来 --&gt;</span></span><br><span class="line">  <span class="comment">//  &lt;a href=&quot;https://prettier.io/&quot;&gt;</span></span><br><span class="line">  <span class="comment">//    Prettier is an opinionated code formatter.</span></span><br><span class="line">  <span class="comment">//  &lt;/a&gt;</span></span><br><span class="line">  <span class="comment">// --------------- html -----------------</span></span><br><span class="line">  <span class="attr">&quot;prettier.jsxBracketSameLine&quot;</span>: <span class="literal">true</span>, <span class="comment">// 将 &gt; 多行 JSX 元素放在最后一行的末尾，而不是单独放在下一行（不适用于自闭元素）。</span></span><br><span class="line">  <span class="comment">// true - 放最后一行末尾</span></span><br><span class="line">  <span class="comment">// false - 单独放在末尾的下一行</span></span><br><span class="line">  <span class="attr">&quot;prettier.bracketSpacing&quot;</span>: <span class="literal">true</span>, <span class="comment">// 在对象，数组括号与文字之间加空格 &quot;&#123; foo: bar &#125;&quot;</span></span><br><span class="line">  <span class="attr">&quot;prettier.trailingComma&quot;</span>: <span class="string">&quot;none&quot;</span>, <span class="comment">// 在对象或数组最后一个元素后面是否加逗号（在ES5中加尾逗号）</span></span><br><span class="line">  <span class="attr">&quot;javascript.preferences.quoteStyle&quot;</span>: <span class="string">&quot;single&quot;</span>, <span class="comment">// JS格式化设置单引号</span></span><br><span class="line">  <span class="attr">&quot;typescript.preferences.quoteStyle&quot;</span>: <span class="string">&quot;single&quot;</span>, <span class="comment">// TS格式化设置单引号</span></span><br><span class="line">  <span class="attr">&quot;javascript.format.insertSpaceBeforeFunctionParenthesis&quot;</span>: <span class="literal">false</span>, <span class="comment">// 让函数(名)和后面的括号之间加个空格</span></span><br><span class="line">  <span class="comment">// 配置 ESLint 检查的文件类型</span></span><br><span class="line">  <span class="attr">&quot;eslint.validate&quot;</span>: [<span class="string">&quot;javascript&quot;</span>, <span class="string">&quot;vue&quot;</span>, <span class="string">&quot;html&quot;</span>],</span><br><span class="line">  <span class="attr">&quot;eslint.options&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// 指定vscode的eslint所处理的文件的后缀</span></span><br><span class="line">    <span class="attr">&quot;extensions&quot;</span>: [<span class="string">&quot;.js&quot;</span>, <span class="string">&quot;.vue&quot;</span>, <span class="string">&quot;.ts&quot;</span>, <span class="string">&quot;.tsx&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//一定要在vutur.defaultFormatterOptions参数中设置，单独修改prettier扩展的设置是无法解决这个问题的，因为perttier默认忽略了vue文件（事实上从忽略列表移除vue也不能解决这个问题）</span></span><br><span class="line">  <span class="attr">&quot;vetur.format.defaultFormatterOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;prettier&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;semi&quot;</span>: <span class="literal">true</span>, <span class="comment">// 格式化末尾加分号</span></span><br><span class="line">      <span class="attr">&quot;singleQuote&quot;</span>: <span class="literal">true</span>, <span class="comment">// 格式化以单引号为主</span></span><br><span class="line">      <span class="attr">&quot;trailingComma&quot;</span>: <span class="string">&quot;none&quot;</span> <span class="comment">// 是否末尾自动添加逗号（数组，json，对象）</span></span><br><span class="line">      <span class="comment">// &quot;es5&quot; - 在ES5中的对象、数组等最后一个元素后面加逗号</span></span><br><span class="line">      <span class="comment">// &quot;none&quot; - 不加逗号</span></span><br><span class="line">      <span class="comment">// &quot;all&quot; - 尽可能都加逗号 (包括函数function的参数).</span></span><br><span class="line">    &#125;, <span class="comment">// 配置文档：https://prettier.io/docs/en/options.html</span></span><br><span class="line">    <span class="attr">&quot;js-beautify-html&quot;</span>: &#123;</span><br><span class="line">      <span class="comment">// force-aligned | force-expand-multiline vue html代码格式化</span></span><br><span class="line">      <span class="attr">&quot;wrap_attributes&quot;</span>: <span class="string">&quot;force-aligned&quot;</span>, <span class="comment">// 对除第一个属性外的其他每个属性进行换行，并保持对齐</span></span><br><span class="line">      <span class="comment">// - auto: 仅在超出行长度时才对属性进行换行。</span></span><br><span class="line">      <span class="comment">// - force: 对除第一个属性外的其他每个属性进行换行。</span></span><br><span class="line">      <span class="comment">// - force-aligned: 对除第一个属性外的其他每个属性进行换行，并保持对齐。</span></span><br><span class="line">      <span class="comment">// - force-expand-multiline: 对每个属性进行换行。</span></span><br><span class="line">      <span class="comment">// - aligned-multiple: 当超出折行长度时，将属性进行垂直对齐。</span></span><br><span class="line">      <span class="attr">&quot;wrap_line_length&quot;</span>: <span class="number">200</span>, <span class="comment">// 换行长度</span></span><br><span class="line">      <span class="attr">&quot;wrap_width_line&quot;</span>: <span class="literal">false</span>, <span class="comment">// 根据行宽换行</span></span><br><span class="line">      <span class="attr">&quot;semi&quot;</span>: <span class="literal">false</span>, <span class="comment">// 格式化不加分号</span></span><br><span class="line">      <span class="attr">&quot;singleQuote&quot;</span>: <span class="literal">true</span> <span class="comment">// 格式化使用单引号</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;prettyhtml&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;printWidth&quot;</span>: <span class="number">200</span>, <span class="comment">// 每行最多多少字符换行</span></span><br><span class="line">      <span class="attr">&quot;singleQuote&quot;</span>: <span class="literal">false</span>, <span class="comment">// 格式化使用单引号</span></span><br><span class="line">      <span class="attr">&quot;wrapAttributes&quot;</span>: <span class="literal">false</span>, <span class="comment">// 强制属性换行</span></span><br><span class="line">      <span class="attr">&quot;sortAttributes&quot;</span>: <span class="literal">true</span> <span class="comment">// 按字母顺序排序属性</span></span><br><span class="line">    &#125; <span class="comment">// 配置文档：https://github.com/Prettyhtml/prettyhtml</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;vetur.format.defaultFormatter.html&quot;</span>: <span class="string">&quot;js-beautify-html&quot;</span>, <span class="comment">// 使用 js-beautify-html 格式化 html</span></span><br><span class="line">  <span class="attr">&quot;vetur.format.defaultFormatter.js&quot;</span>: <span class="string">&quot;prettier&quot;</span>, <span class="comment">// 使用 prettier 格式化 js</span></span><br><span class="line">  <span class="attr">&quot;[vue]&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;editor.defaultFormatter&quot;</span>: <span class="string">&quot;octref.vetur&quot;</span> <span class="comment">// 使用 vetur 格式化 vue</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;editor.fontFamily&quot;</span>: <span class="string">&quot;&#x27;Fira Code&#x27;, Menlo, Monaco, &#x27;Courier New&#x27;, monospace&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;path-intellisense.mappings&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;@&quot;</span>: <span class="string">&quot;$&#123;workspaceRoot&#125;/src&quot;</span></span><br><span class="line">  &#125; <span class="comment">// Vue路径提示配置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="配置-eslintrc-js"><a href="#配置-eslintrc-js" class="headerlink" title="配置 .eslintrc.js"></a>配置 .eslintrc.js</h2><p>Vue 项目的根目录下创建 .eslintrc.js ：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  root: <span class="literal">true</span>,</span><br><span class="line">  parserOptions: &#123;</span><br><span class="line">    parser: <span class="string">&#x27;babel-eslint&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  env: &#123;</span><br><span class="line">    browser: <span class="literal">true</span>,</span><br><span class="line">    node: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">extends</span>: [<span class="string">&#x27;plugin:vue/essential&#x27;</span>, <span class="string">&#x27;eslint:recommended&#x27;</span>, <span class="string">&#x27;airbnb-base/legacy&#x27;</span>],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="comment">// 文档：https://cn.eslint.org/docs/rules/</span></span><br><span class="line">    <span class="string">&#x27;generator-star-spacing&#x27;</span>: <span class="string">&#x27;off&#x27;</span>, <span class="comment">// 强制 generator 函数中 * 号周围使用一致的空格</span></span><br><span class="line">    <span class="comment">// 开发模式允许使用console</span></span><br><span class="line">    <span class="string">&#x27;no-console&#x27;</span>: process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;error&#x27;</span> : <span class="string">&#x27;off&#x27;</span>,</span><br><span class="line">    <span class="comment">// 开发环境允许使用调试 (生产模式禁用)</span></span><br><span class="line">    <span class="string">&#x27;no-debugger&#x27;</span>: process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span> ? <span class="string">&#x27;error&#x27;</span> : <span class="string">&#x27;off&#x27;</span>,</span><br><span class="line">    <span class="comment">// 禁止使用 var</span></span><br><span class="line">    <span class="string">&#x27;no-var&#x27;</span>: <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;padded-blocks&#x27;</span>: <span class="string">&#x27;off&#x27;</span>, <span class="comment">// 代码块中避免多余留白</span></span><br><span class="line">    <span class="string">&#x27;comma-dangle&#x27;</span>: [<span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;never&#x27;</span>], <span class="comment">// 是否允许对象中出现结尾逗号</span></span><br><span class="line">    <span class="string">&#x27;no-undef&#x27;</span>: <span class="number">0</span>, <span class="comment">// 禁用未声明的变量，除非它们在 /*global */ 注释中被提到</span></span><br><span class="line">    quotes: <span class="number">0</span>, <span class="comment">// 强制使用一致的反勾号、双引号或单引号 (0: double, 1: single, 2: backtick)</span></span><br><span class="line">    eqeqeq: <span class="string">&#x27;off&#x27;</span>, <span class="comment">//  关闭 (要求使用 === 和 !==) 的校验</span></span><br><span class="line">    <span class="string">&#x27;eol-last&#x27;</span>: <span class="string">&#x27;off&#x27;</span>, <span class="comment">// 要求或禁止文件末尾存在空行</span></span><br><span class="line">    indent: <span class="number">0</span>, <span class="comment">// 忽略强制使用一致的缩进</span></span><br><span class="line">    <span class="string">&#x27;no-tabs&#x27;</span>: <span class="number">0</span>, <span class="comment">// 忽略tab检查</span></span><br><span class="line">    <span class="string">&#x27;no-mixed-spaces-and-tabs&#x27;</span>: <span class="number">0</span> <span class="comment">// 忽略检查当空格用于对齐时，允许混合制表符和空格。</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>npm 安装 <code>eslint-config-airbnb-base</code> ：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm info &quot;eslint-config-airbnb-base@latest&quot; peerDependencies</span><br></pre></td></tr></table></figure>

<p>在 <code>.eslintrc.js</code> 中添加（上面配置已添加）：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;extends&quot;</span>: <span class="string">&quot;airbnb-base/legacy&quot;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>工具</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
      </tags>
  </entry>
  <entry>
    <title>Vuex的基本使用</title>
    <url>/posts/36068/</url>
    <content><![CDATA[<h2 id="什么是-Vuex"><a href="#什么是-Vuex" class="headerlink" title="什么是 Vuex"></a>什么是 Vuex</h2><p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理工具。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>首先使用 vue-cli 脚手架工具新建一个项目：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vue create vuex-demo</span><br></pre></td></tr></table></figure>

<p>src文件夹下的目录结构：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">src</span><br><span class="line">├── App.vue</span><br><span class="line">├── assets</span><br><span class="line">│   └── logo.png</span><br><span class="line">├── components</span><br><span class="line">│   └── HelloWorld.vue</span><br><span class="line">└── main.js # 入口文件</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h2 id="安装-vuex"><a href="#安装-vuex" class="headerlink" title="安装 vuex"></a>安装 vuex</h2><p>命令行下执行：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i vuex</span><br></pre></td></tr></table></figure>

<p>然后在入口文件引入 vuex ：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line">Vue.use(Vuex)</span><br></pre></td></tr></table></figure>

<h2 id="一个例子"><a href="#一个例子" class="headerlink" title="一个例子"></a>一个例子</h2><p>为了了解 vuex 到底做了什么事情、解决了哪些问题。我们先来实现一个简单的 demo ，有一个标签显示数字，两个按钮分别做数字的 +1 和 -1 操作。</p>
<p>我们先在 <code>src/components/</code> 下的 Normal.vue 组件中使用纯 Vue 版本编写代码：</p>
<blockquote>
<p>Normal.vue</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;normal&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;count&#125;&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;inc&quot;</span>&gt;</span> + <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;dec&quot;</span>&gt;</span> - <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line">      count: 0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">inc</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.count++</span></span><br><span class="line">    &#125;,</span><br><span class="line"><span class="javascript">    <span class="function"><span class="title">dec</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.count--</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后在 <code>src/App.vue</code> 中引入并使用该组件：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Normal</span>&gt;</span><span class="tag">&lt;/<span class="name">Normal</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> Normal <span class="keyword">from</span> <span class="string">&#x27;@/components/Normal&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">  components: &#123;</span><br><span class="line">    Normal,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>命令行执行 <code>npm run serve</code> 就能运行 App 了。</p>
<p>如上的代码的含义是：两个 button 标签绑定函数，当点击的时候分别调用 inc 和 dec 方法，接着会调用 vue 中的 methods 的对应的方法<br>。然后会让 data 中的 count 属性值发生改变，改变后会把最新值渲染到视图中。</p>
<p>现在我们来看看使用 vuex 的方式来实现如上 demo ：</p>
<blockquote>
<p>src下新建 <code>vuex/store.js</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意是new【Vuex.Store】实例而不是【Vuex】</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        count: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">        inc: <span class="function"><span class="params">state</span> =&gt;</span> state.count++,</span><br><span class="line">        dec: <span class="function"><span class="params">state</span> =&gt;</span> state.count--</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>main.js 中引入</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/vuex/store&#x27;</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App),</span><br><span class="line">  store</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在 <code>src/components/</code> 下新建 SWVuex.vue 组件</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;vuex&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;count&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;inc&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;dec&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        computed: &#123;</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">count</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="built_in">this</span>.$store.state.count</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">inc</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;inc&#x27;</span>)</span></span><br><span class="line">            &#125;,</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">dec</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;dec&#x27;</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在 App.vue 中使用 SWVuex 组件</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">SWVuex</span>&gt;</span><span class="tag">&lt;/<span class="name">SWVuex</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> SWVuex <span class="keyword">from</span> <span class="string">&#x27;@/components/SWVuex&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">  components: &#123;</span><br><span class="line">    SWVuex</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="两者比较"><a href="#两者比较" class="headerlink" title="两者比较"></a>两者比较</h3><ol>
<li>需要引用 vuex 。</li>
<li>methods 的方法不变，但是方法内的逻辑不在函数内进行，而是让 store 对象去处理。</li>
<li>count 数据不再是一个 data 函数返回的对象的属性了。而是通过 store 方法内的计算字段返回的。</li>
</ol>
<p>回到 store 对象上来，store 对象是 Vuex.Store 的实例。在 store 内分为 state 对象和 mutations 对象，其中 state 存放的是状态，<br>比如 count 属性就是它的状态值，而 mutations 则是一个会引发状态改变的所有方法。</p>
<h2 id="什么是状态管理模式"><a href="#什么是状态管理模式" class="headerlink" title="什么是状态管理模式"></a>什么是状态管理模式</h2><p>简单的理解就是<strong>统一管理和维护各个 vue 组件的可变化状态</strong>。</p>
<p>我们明白 vue 是单向数据流的，那么它的状态管理一般包含如下几部分：</p>
<ol>
<li>state：驱动应用的数据（一般指 data 中返回的数据）</li>
<li>view：一般指模板，以声明的方式将 state 的数据映射到视图</li>
<li>actions：响应在 view 上的用户输入导致的状态变化</li>
</ol>
<p>但是当我们的应用遇到多个组件共享状态时候，那么单向数据流可能不太满足我们的需求，比如：</p>
<ol>
<li>组件的多层嵌套</li>
<li>多个视图依赖同一个状态</li>
</ol>
<p>上面这些情况确实能在不使用 vuex 的情况下实现，但往往会导致写出无法维护的代码。因此我们可以把组件的共享状态<strong>提取出来、全局管理</strong>，因此 vuex 产生了。</p>
<h2 id="Vuex-的优点"><a href="#Vuex-的优点" class="headerlink" title="Vuex 的优点"></a>Vuex 的优点</h2><p>最主要解决了组件之间共享同一状态的问题。可以把组件的共享状态提取出来，作为全局来管理。</p>
<h2 id="什么情况下才推荐使用-Vuex"><a href="#什么情况下才推荐使用-Vuex" class="headerlink" title="什么情况下才推荐使用 Vuex"></a>什么情况下才推荐使用 Vuex</h2><p>大型单页应用！！！如果你的项目不够大，足够简单，最好不要使用 Vuex ，一个简单的 global event bus 就足够所需了。</p>
<h2 id="State-对象状态的访问"><a href="#State-对象状态的访问" class="headerlink" title="State 对象状态的访问"></a>State 对象状态的访问</h2><h3 id="通过-computed-计算属性直接赋值"><a href="#通过-computed-计算属性直接赋值" class="headerlink" title="通过 computed 计算属性直接赋值"></a>通过 computed 计算属性直接赋值</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;vuex&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过 $store.state 方式获取：&#123;&#123;$store.state.count&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过 computed 计算属性赋值：&#123;&#123;count&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;inc&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;dec&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        computed: &#123;</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">count</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="built_in">this</span>.$store.state.count</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">inc</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;inc&#x27;</span>)</span></span><br><span class="line">            &#125;,</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">dec</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;dec&#x27;</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="借助-mapState-辅助函数"><a href="#借助-mapState-辅助函数" class="headerlink" title="借助 mapState 辅助函数"></a>借助 mapState 辅助函数</h3><h4 id="对象形式"><a href="#对象形式" class="headerlink" title="对象形式"></a>对象形式</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;vuex&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过 $store.state 方式获取：&#123;&#123;$store.state.count&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过 computed 计算属性赋值：&#123;&#123;count&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;inc&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;dec&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;mapState&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        computed: mapState(&#123;</span><br><span class="line"><span class="javascript">            count: <span class="function"><span class="params">state</span> =&gt;</span> state.count</span></span><br><span class="line">        &#125;),</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">inc</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;inc&#x27;</span>)</span></span><br><span class="line">            &#125;,</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">dec</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;dec&#x27;</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="数组形式"><a href="#数组形式" class="headerlink" title="数组形式"></a>数组形式</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 数组中的 count 必须和 store.js 中定义的常量 count 同名，因为这是直接访问 state 的 count</span></span><br><span class="line">computed: mapState([<span class="string">&#x27;count&#x27;</span>])</span><br></pre></td></tr></table></figure>

<h2 id="Getters-计算过滤操作"><a href="#Getters-计算过滤操作" class="headerlink" title="Getters 计算过滤操作"></a>Getters 计算过滤操作</h2><p>有时候我们需要从 store 的 state 中派生出一些状态，比如在使用 store 中的 state 之前，我们会对 state 中的某些字段进行过滤——让 count 字段都进行加 10 这样的数据操作；但是如果有多个组件需要用到这个操作的话，那么我们就需要复制这个函数，或者抽取到一个共享函数内，<br>然后多处导入这个函数，但是这上面两种方式都不是太好，因为我们现在有更好的方式来解决它。</p>
<p>Vuex 允许我们在 store 中定义 getters，getters 的返回值会根据它的依赖被缓存起来，且只有当他的依赖值发生改变了才会重新计算。</p>
<p>现在我们对 store.js 文件中的 count 进行一个计算属性的操作，在它每次输出之前，加上20。</p>
<p>如下代码有两个按钮，一个加5，一个减5，那么在加5或者减5之前，先加20，然后再进行加5或者5操作。代码如下：</p>
<blockquote>
<p>store.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        count: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">        inc: <span class="function">(<span class="params">state, num</span>) =&gt;</span> state.count += num,</span><br><span class="line">        dec: <span class="function">(<span class="params">state, num</span>) =&gt;</span> state.count -= num</span><br><span class="line">    &#125;,</span><br><span class="line">    getters: &#123;</span><br><span class="line">        <span class="function"><span class="title">myCount</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> state.count + <span class="number">20</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>SWVuex.vue</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;vuex&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过 $store.state 方式获取：&#123;&#123;$store.state.count&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过 computed 计算属性赋值：&#123;&#123;myCount&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用 $store.commit(&#x27;inc&#x27;, 5) 方式调用<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- $store.commit(&#x27;inc&#x27;, 5) 第一个参数是方法名，第二个是参数 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;$store.commit(&#x27;inc&#x27;, 5)&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;$store.commit(&#x27;dec&#x27;, 5)&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用mapMutations修改状态：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;inc(10)&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;dec(10)&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;mapState, mapGetters, mapMutations&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        computed: &#123;</span><br><span class="line"><span class="javascript">            <span class="comment">// mapState([&#x27;count&#x27;]) 此处的 count 必须和 store.js</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// state 中的 count 同名，因为这是直接访问 state 的 count</span></span></span><br><span class="line"><span class="javascript">            ...mapState([<span class="string">&#x27;count&#x27;</span>]),</span></span><br><span class="line"><span class="javascript">            <span class="comment">// mapGetters 辅助函数，</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// 可以将 store 中的 getter 映射到局部计算属性 myCount</span></span></span><br><span class="line"><span class="javascript">            ...mapGetters([<span class="string">&#x27;myCount&#x27;</span>])</span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="javascript">            ...mapMutations([<span class="string">&#x27;inc&#x27;</span>, <span class="string">&#x27;dec&#x27;</span>])</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Mutations-修改状态"><a href="#Mutations-修改状态" class="headerlink" title="Mutations 修改状态"></a>Mutations 修改状态</h2><p>Mutations 是修改 vuex 中的 store 的唯一方法。每个 mutations 都有一个字符串的事件类型(type)和一个回调函数(handler)。这个回调函数就是我们进行更改的地方。它也会接受 state 作为第一个参数。</p>
<p>回顾上面的 <code>store.js</code> 中有关 mutations 的代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mutations: &#123;</span><br><span class="line">    inc: <span class="function">(<span class="params">state, num</span>) =&gt;</span> state.count += num,</span><br><span class="line">    dec: <span class="function">(<span class="params">state, num</span>) =&gt;</span> state.count -= num</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>当我们点击页面上的按钮后会触发事件并执行方法，方法中又会调用 <code>$store.commit(type, args)</code> 来传入参数改变 state 数据。</p>
<h2 id="Actions-异步修改状态"><a href="#Actions-异步修改状态" class="headerlink" title="Actions 异步修改状态"></a>Actions 异步修改状态</h2><p>Actions 和 Mutations 类似，但它用来异步修改 state 的状态。而 Mutations 则是同步修改 state 的状态。</p>
<p>我们在 store.js 中声明 actions，actions 可以调用 mutations 的方法的。代码如下：</p>
<blockquote>
<p>store.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 增加两个 actions 方法</span></span><br><span class="line">actions: &#123;</span><br><span class="line">    <span class="function"><span class="title">incAction</span>(<span class="params">context</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(context)</span><br><span class="line">        <span class="comment">// 调用 mutations 中的 inc 方法，并传参数5</span></span><br><span class="line">        context.commit(<span class="string">&#x27;inc&#x27;</span>, <span class="number">5</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">decAction</span>(<span class="params">context</span>)</span> &#123;</span><br><span class="line">        context.commit(<span class="string">&#x27;dec&#x27;</span>, <span class="number">5</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上方代码中的参数 context 指上下文，即 store 本身。</p>
<p>然后在 SWVuex.vue 中通过 <code>this.$store.dispatch(action方法名, 参数)</code> 的方式调用：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;vuex&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过 $store.state 方式获取：&#123;&#123;$store.state.count&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过 computed 计算属性赋值：&#123;&#123;myCount&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用 $store.commit(&#x27;inc&#x27;, 5) 方式调用<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- $store.commit(&#x27;inc&#x27;, 5) 第一个参数是方法名，第二个是参数 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;$store.commit(&#x27;inc&#x27;, 5)&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;$store.commit(&#x27;dec&#x27;, 5)&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用mapMutations修改状态：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;inc(10)&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;dec(10)&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>actions的异步操作<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;incAction&quot;</span>&gt;</span> + <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;decAction&quot;</span>&gt;</span> - <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;mapState, mapGetters, mapMutations&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">        computed: &#123;</span><br><span class="line"><span class="javascript">            <span class="comment">// mapState([&#x27;count&#x27;]) 此处的 count 必须和 store.js</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// state 中的 count 同名，因为这是直接访问 state 的 count</span></span></span><br><span class="line"><span class="javascript">            ...mapState([<span class="string">&#x27;count&#x27;</span>]),</span></span><br><span class="line"><span class="javascript">            <span class="comment">// mapGetters 辅助函数，</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// 可以将 store 中的 getter 映射到局部计算属性 myCount</span></span></span><br><span class="line"><span class="javascript">            ...mapGetters([<span class="string">&#x27;myCount&#x27;</span>])</span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="javascript">            ...mapMutations([<span class="string">&#x27;inc&#x27;</span>, <span class="string">&#x27;dec&#x27;</span>]),</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">incAction</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.$store.dispatch(<span class="string">&#x27;incAction&#x27;</span>)</span></span><br><span class="line">            &#125;,</span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">decAction</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.$store.dispatch(<span class="string">&#x27;decAction&#x27;</span>)</span></span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当然，除了使用 <code>this.$store.dispatch()</code> 的方式以外，还可以借助 <code>mapActions</code> 来简化代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新加 mapActions</span></span><br><span class="line"><span class="keyword">import</span> &#123;mapState, mapGetters, mapMutations, mapActions&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line">...</span><br><span class="line">methods: &#123;</span><br><span class="line">    ...mapMutations([<span class="string">&#x27;inc&#x27;</span>, <span class="string">&#x27;dec&#x27;</span>]),</span><br><span class="line">    ...mapActions([<span class="string">&#x27;incAction&#x27;</span>, <span class="string">&#x27;decAction&#x27;</span>]) <span class="comment">// +</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>框架</category>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vuex</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue深度作用选择器</title>
    <url>/posts/5691/</url>
    <content><![CDATA[<p>之前写 uni-app 在修改三方深层样式时，会使用 <code>/deep/</code> ，例如：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> /<span class="selector-tag">deep</span>/ <span class="selector-class">.el-input__inner</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但在我的 Vue 项目中却报错，使用 <code>::v-deep</code> 则可以：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> <span class="selector-pseudo">::v-deep</span> <span class="selector-class">.el-input__inner</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2><p><a href="https://vue-loader.vuejs.org/guide/scoped-css.html#deep-selectors">Deep Selectors</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>框架</category>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>scss</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue的生命周期函数</title>
    <url>/posts/33186/</url>
    <content><![CDATA[<h2 id="创建期间的生命周期函数"><a href="#创建期间的生命周期函数" class="headerlink" title="创建期间的生命周期函数"></a>创建期间的生命周期函数</h2><h3 id="beforeCreate"><a href="#beforeCreate" class="headerlink" title="beforeCreate"></a>beforeCreate</h3><p>实例刚在内存中被创建出来，此时还没有初始化好 data 和 methods 属性。</p>
<h4 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h4><p>执行 loading 动画。</p>
<h3 id="created"><a href="#created" class="headerlink" title="created"></a>created</h3><p>实例已经在内存中创建完毕，data 和 methods 等属性也已经创建完成。但此刻<strong>还没有开始编译模板</strong>。</p>
<a id="more"></a>

<h4 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a>作用</h4><ul>
<li>结束掉 loading 动画</li>
<li>做一些初始化工作，比如函数自执行，发起异步请求获取数据</li>
</ul>
<h3 id="beforeMount"><a href="#beforeMount" class="headerlink" title="beforeMount"></a>beforeMount</h3><p>此刻<strong>已经完成了模板的编译</strong>，但<strong>还没有挂载到页面上</strong>。换句话说，此时页面中类似 的语法还没有被替换成真正的数据。</p>
<h3 id="mounted"><a href="#mounted" class="headerlink" title="mounted"></a>mounted</h3><p>此刻已经将编译好的模板挂载到了页面中指定的容器中显示。用户已经可以看到渲染好的页面了。</p>
<h4 id="作用-2"><a href="#作用-2" class="headerlink" title="作用"></a>作用</h4><ul>
<li>由于此刻已经把模板挂载到了页面，所以能够在此钩子函数中获取 DOM 节点。</li>
<li>此函数中也能发起异步请求</li>
</ul>
<h2 id="运行期间的生命周期函数"><a href="#运行期间的生命周期函数" class="headerlink" title="运行期间的生命周期函数"></a>运行期间的生命周期函数</h2><h3 id="beforeUpdate"><a href="#beforeUpdate" class="headerlink" title="beforeUpdate"></a>beforeUpdate</h3><p>状态更新之前执行此函数，此刻 data 中的状态值是最新的，但是<strong>界面上显示的数据还是旧的</strong>。因此此时还没有开始重新渲染 DOM 节点。</p>
<h3 id="updated"><a href="#updated" class="headerlink" title="updated"></a>updated</h3><p>实例更新完毕后调用此函数，此刻 data 中的状态值和界面上显示的数据，都已经完成了更新，界面已经被重新渲染好了。</p>
<h2 id="销毁期间的生命周期函数"><a href="#销毁期间的生命周期函数" class="headerlink" title="销毁期间的生命周期函数"></a>销毁期间的生命周期函数</h2><h3 id="beforeDestroy"><a href="#beforeDestroy" class="headerlink" title="beforeDestroy"></a>beforeDestroy</h3><p>实例销毁之前调用。此刻实例仍然完全可用。</p>
<h4 id="作用-3"><a href="#作用-3" class="headerlink" title="作用"></a>作用</h4><p>一切你想要在组件销毁之前做事，例如弹出确认窗：“你确认删除XXX吗？”</p>
<h3 id="destroyed"><a href="#destroyed" class="headerlink" title="destroyed"></a>destroyed</h3><p>实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>框架</category>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>Webpack4 如何优雅打包缓存文件（转载）</title>
    <url>/posts/64694/</url>
    <content><![CDATA[<p>一般来说，对于静态资源，我们都希望浏览器能够进行缓存，那样以后进入页面就可以直接使用缓存资源，页面直接直逼火箭速度打开，既提高了用户的体验也节省了宽带资源。</p>
<p>当然浏览器缓存方法有很多种，这里只简单讨论下 webpack 利用 hash 方式修改文件名，以达到缓存目的。</p>
<h2 id="webpack-hash"><a href="#webpack-hash" class="headerlink" title="webpack hash"></a>webpack hash</h2><p>webpack 内置了多种可使用 hash，官网解释分别如下：</p>
<ul>
<li><code>hash</code>：the hash of the module identifier</li>
<li><code>chunkHash</code>：the hash of the chunk content</li>
<li><code>contentHash</code>：the hash of extracted content</li>
</ul>
<p>注：hash 的默认长度为 20 个字符，可通过 <code>output.hashDigestLength</code> 全局配置，或使用 <code>[hash:16]</code> 方式配置，还可以通过 <code>output.hashDigest</code> 配置何时生成 hash。</p>
<p>那么问题来了，这么多种 hash 该如何选择呢？</p>
<a id="more"></a>

<h2 id="实战-hash"><a href="#实战-hash" class="headerlink" title="实战 hash"></a>实战 hash</h2><p>基础的配置文件如下（基于webpack 4，入口文件分别为 index 和 detail，其中每个文件中引入了一个图片）：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">&#x27;none&#x27;</span>, <span class="comment">// 设置为 none，避免 development 或 production 默认设置的一些影响</span></span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: <span class="string">&#x27;./src/index.js&#x27;</span>, </span><br><span class="line">    detail: <span class="string">&#x27;./src/detail.js&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&#x27;[name].[hash].js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="hash（the-hash-of-the-module-identifier）"><a href="#hash（the-hash-of-the-module-identifier）" class="headerlink" title="hash（the hash of the module identifier）"></a>hash（the hash of the module identifier）</h3><p>首先，我们来解释下 the module identifier。webpack 默认为给各个模块分配一个 id 以作标识，用来处理模块之间的依赖关系。而默认的 id 命名规则是根据模块引入的顺序，赋予一个整数(1、2、3……)。如下图就是使用 hash 的打包，index 和 detail 作为 entry 的两个入口，可以看到其 hash 值是一样的，而另外两个图片的 hash 值是不同的。</p>


<p>由于该 hash 是基于整个 module identifier 序列计算得到的，所以 JS 或 CSS 文件如果使用该 hash，则所有值都一样，而任意增添或删减一个模块的依赖，都会对整个 id 序列造成影响，从而改变 hash 值。这样的话 JS 或 CSS 文件是不适合使用该 hash 值的。</p>
<p>当然对于图片、字体、PDF 等资源该 hash 还是可以生成一个唯一值的。</p>
<h4 id="runtime-amp-manifest"><a href="#runtime-amp-manifest" class="headerlink" title="runtime &amp; manifest"></a>runtime &amp; manifest</h4><p>假如我们什么都不改动，只是重新跑一次构建，会惊奇的发现 index 和 detail 的 hash 值居然变了（图片的 hash 是不变的），如下图：</p>


<p>这究竟是怎么回事呢？webpack 官方解释为：</p>
<blockquote>
<p>This is because webpack includes certain boilerplate, specifically the <a href="https://webpack.js.org/concepts/manifest/">runtime and manifest</a>, in the entry chunk.</p>
</blockquote>
<p>为了解决这个不稳定的因素，webpack 4 提供了一个配置可以直接把 boilerplate 给单独抽离出来，配置如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">    runtimeChunk: <span class="string">&#x27;single&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样我们就能得到一个 runtime 的 js 文件，如下图：</p>


<h3 id="chunkhash（the-hash-of-the-chunk-content）"><a href="#chunkhash（the-hash-of-the-chunk-content）" class="headerlink" title="chunkhash（the hash of the chunk content）"></a>chunkhash（the hash of the chunk content）</h3><p>现在我们把 hash 改成 chunkhash ，如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">  filename: <span class="string">&#x27;[name].[chunkhash].js&#x27;</span>,</span><br><span class="line">  path: path.resolve(__dirname, <span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重新跑下构建，会发现打包出来的三个 JS 文件的 chunkhash 值是不一样的了，如下：</p>


<p>现在我们在 index 文件中再引入一个 JS 模块，重新打包如下：</p>


<p>我们会发现 index 和 detail 文件的 chunkhash 都变了，这就奇怪了，按理来说 detail 文件我们根本没有改变啊，为什么它的 chunkhash 值变了呢？</p>
<p>其实根本原因还是 module identifier，因为 index 新引入的模块改变了以后所有模块的 id 值，所以 detail 文件中引入的模块 id 值发生了改变，于是 detail 的 chunkhash 也随着发生改变。</p>
<p>解决方案是将默认的数字 id 命名规则换成路径的方式。webpack 4 中当 mode 为 development 会默认启动</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">    namedModules: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然如果是生产环境的话，全路径是有点太长，所以我们可以换成使用<a href="https://webpack.js.org/plugins/hashed-module-ids-plugin/">HashedModuleIdsPlugin</a> 插件来根据路径生成的 hash 作为 module identifier。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.HashedModuleIdsPlugin(),</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<p>这样最后 chunkhash 改变的就只有修改的文件了，也达到了我们想要的效果。</p>
<h3 id="contenthash（the-hash-of-extracted-content）"><a href="#contenthash（the-hash-of-extracted-content）" class="headerlink" title="contenthash（the hash of extracted content）"></a>contenthash（the hash of extracted content）</h3><p>现在我们将 CSS 样式单独抽离生成文件（使用了 <a href="https://webpack.js.org/plugins/mini-css-extract-plugin/">MiniCssExtractPlugin</a> 插件），会发现其 chunkhash 值跟该 entry 的 js 文件的 chunkhash 是一样的，如下图：</p>


<p>现在如果只改变 CSS 文件，会发现对应的 entry JS 和 CSS 文件的 chunkhash 都会改变。（注意：可能以前 <a href="https://webpack.js.org/plugins/extract-text-webpack-plugin/">ExtractTextWebpackPlugin</a> 不会改变，所以只能对抽离的 CSS 文件使用 contenthash）。</p>
<p>反正不管同时变或不变，可能都不是我们想要的效果，我们需要应该是改变了什么就反应到什么文件上。而不是 CSS 和 JS 文件的 chunkhash 同时改变或不变，无法区分 CSS 和 JS 的更新。</p>
<p>所以这里抽离出来的 CSS 文件将使用 contenthash，以区分 CSS 文件和 JS 文件的更新。</p>
<h3 id="Chunks-ID"><a href="#Chunks-ID" class="headerlink" title="Chunks ID"></a>Chunks ID</h3><p>然而这还没有结束，还有个问题，那就是目前我们的 chunks ID 还是以自增的数字命名的，这当我们的 entry 文件发生改变（新增或删除）的时候，原先的 chunks ID 就有可能发生变化。于是我们也需要把数字改掉就好，webpack 4 在 <code>optimization</code> 新增了一个 <code>namedChunks</code> 配置，该配置开发环境为 <code>true</code>，生产环境为 <code>false</code>，所以在生产环境的时候我们为了构建稳定的 hash 时，还是需要把该选项设置为 <code>true</code>，如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  optimization: &#123;</span><br><span class="line">    namedChunks: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>为了一份理想的缓存文件，我们需要做这些事情：</p>
<ul>
<li>抽离 boilerplate（[runtime &amp; manifest）</li>
<li>将 module identifier 默认的数字标识方式转成使用路径标识</li>
<li>JS 文件使用 chunkhash</li>
<li>抽离的 CSS 样式文件使用 contenthash</li>
<li>gif|png|jpe?g|eot|woff|ttf|svg|pdf 等使用 hash</li>
<li>设置 <code>namedChunks</code> 为 true</li>
</ul>
<h2 id="原文地址"><a href="#原文地址" class="headerlink" title="原文地址"></a>原文地址</h2><p><a href="https://imweb.io/topic/5b6f224a3cb5a02f33c013ba">Webpack4 如何优雅打包缓存文件</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>构建工具</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>animation动画（一）</title>
    <url>/posts/57136/</url>
    <content><![CDATA[<h2 id="传送门"><a href="#传送门" class="headerlink" title="传送门"></a>传送门</h2><ul>
<li><a href="https://evestorm.github.io/posts/31280/">animation动画（一）</a></li>
<li><a href="https://evestorm.github.io/posts/20298/">animation动画（二）</a></li>
</ul>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><blockquote>
<p>CSS Animations 是CSS的一个模块，它定义了如何用关键帧来随时间推移对CSS属性的值进行动画处理。关键帧动画的行为可以通过指定它们的持续时间，它们的重复次数以及它们如何重复来控制。</p>
</blockquote>
<p>———— 出自 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Animations">CSS Animations | MDN</a></p>
<a id="more"></a>

<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 简写 */</span></span><br><span class="line"><span class="selector-tag">animation</span>: 动画名称，一个周期所花费的时间，运动曲线（默认<span class="selector-tag">ease</span>），</span><br><span class="line">           动画延迟（默认0），播放次数（默认1），</span><br><span class="line">           是否反向播放动画（默认<span class="selector-tag">normal</span>），是否暂停动画（默认<span class="selector-tag">running</span>）</span><br></pre></td></tr></table></figure>

<p>就像在介绍中写到的那样，整个 animations 是个模块，包含很多属性来定义动画，比方说 <code>animation-name</code> 、<code>animation-duration</code> 和 <code>animation-delay</code> 等等。但本着快速上手的目的，第一篇文章主要围绕 <code>animation</code> 这个简写属性来讲，因为用它最直观，而且就经验来讲，日常使用最多的也是这个属性。</p>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p>一个CSS3动画由两个基本项组成：</p>
<ol>
<li>关键帧（Keyforames） - 用来定义动画的阶段和样式。</li>
<li>动画属性 - 分配关键帧（@keyframes）到一个特定的css元素，来定义它的动画方式。</li>
</ol>
<p>我们围绕这两项讨论，并在这个过程中实现一个按钮不断放大缩小的动画效果：</p>
<img src="/posts/57136/shrink.gif" class="" title="shrink">

<h3 id="keyframes"><a href="#keyframes" class="headerlink" title="keyframes"></a>keyframes</h3><p>关键帧 keyframes 定义了动画在每个阶段的动画效果。它包括：</p>
<ul>
<li>动画名称：定义动画的名称</li>
<li>动画阶段：整个动画阶段用百分比来表示。0% 表示动画的开始状态。100% 表示动画的结束状态。可以在其间添加多个中间状态，比如 20%，60%…</li>
<li>动画属性：给动画每个阶段定义的CSS属性</li>
</ul>
<p>现在我们来编写一段 @keyframes 。动画名称命名为 <code>shrink</code> 。它只有简单的两个阶段：</p>
<ul>
<li>第一阶段（0%）：元素的缩放比例为 1:1</li>
<li>第二阶段（100%）：元素的缩放比例为 1:0.8</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> shrink &#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123;</span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(<span class="number">0.8</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0.8</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="动画属性"><a href="#动画属性" class="headerlink" title="动画属性"></a>动画属性</h3><p>接着，我们给要设置动画的元素添加上动画属性。要使动画生效，我们至少要添加以下两个动画属性：</p>
<ul>
<li>animation-name: 动画的名称，在 @keyframes 中定义。</li>
<li>animation-duration: 动画的持续时间，以秒为单位（例如 5s）或毫秒（例如 200ms）。</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="comment">/*  其他样式  */</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">/*  动画名称: shrink  */</span></span><br><span class="line">  <span class="selector-tag">animation-name</span>: <span class="selector-tag">shrink</span>;</span><br><span class="line">  <span class="comment">/*  动画持续时间: 0.5秒 */</span></span><br><span class="line">  <span class="selector-tag">animation-duration</span>: .5<span class="selector-tag">s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样我们就实现页面加载后，一个按钮从开始的原始大小，经过0.5s后变成了原始大小的0.8的动画效果。然而我们希望最终的效果是一个按钮的不断放大和缩小，交替进行。这就得添加 <code>animation-iteration-count</code> 和 <code>animation-direction</code> 两个动画属性了，它们一个用来定义元素动画的循环次数，一个用来定义动画在循环过程中是否反向运动：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">/*  动画的循环次数: 无限次  */</span></span><br><span class="line">  <span class="selector-tag">animation-iteration-count</span>: <span class="selector-tag">infinite</span>;</span><br><span class="line">  <span class="comment">/*  循环是否反向：先正向后反向  */</span></span><br><span class="line">  <span class="selector-tag">animation-direction</span>: <span class="selector-tag">alternate</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最终的简写形式如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="selector-tag">animation</span>: <span class="selector-tag">shrink</span> .5<span class="selector-tag">s</span> <span class="selector-tag">linear</span> <span class="selector-tag">alternate</span> <span class="selector-tag">infinite</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>完整效果：</p>
<iframe height="265" scrolling="no" title="animation-shrink" src="https://codepen.io/JingW/embed/MRaJrz/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="资源-📚"><a href="#资源-📚" class="headerlink" title="资源 📚"></a>资源 📚</h2><ul>
<li><p>animation | 一个CSS3动画库</p>
<p>【推荐】</p>
<ul>
<li><a href="https://daneden.github.io/animate.css/">点我查看效果</a></li>
</ul>
</li>
<li><p>magic | 另一个CSS3动画库</p>
<ul>
<li><a href="https://www.minimamente.com/example/magic_animations/">点我查看效果</a></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>CSS3</tag>
      </tags>
  </entry>
  <entry>
    <title>animation动画（二）</title>
    <url>/posts/20298/</url>
    <content><![CDATA[<h2 id="传送门"><a href="#传送门" class="headerlink" title="传送门"></a>传送门</h2><ul>
<li><a href="https://evestorm.github.io/posts/31280/">animation动画（一）</a></li>
<li><a href="https://evestorm.github.io/posts/20298/">animation动画（二）</a></li>
</ul>
<p>老规矩，二系列来谈谈具体每个动画属性的含义和用法，算是一个对知识点的总结吧。</p>
<h2 id="animation-name-动画名称"><a href="#animation-name-动画名称" class="headerlink" title="animation-name 动画名称"></a>animation-name 动画名称</h2><p>CSS语法：<code>animation-name: shrink</code></p>
<p>用来设置元素的动画名称。</p>
<a id="more"></a>

<h2 id="animation-duration-持续时间"><a href="#animation-duration-持续时间" class="headerlink" title="animation-duration 持续时间"></a>animation-duration 持续时间</h2><p>CSS语法：<code>animation-duration: 1s</code></p>
<p>用来指定动画在一个周期内所花费的时间。</p>
<h2 id="animation-timing-function-运动曲线"><a href="#animation-timing-function-运动曲线" class="headerlink" title="animation-timing-function 运动曲线"></a>animation-timing-function 运动曲线</h2><p>CSS语法：<code>animation-timing-function: ease-in-out</code></p>
<p>用来设置元素的动画速度曲线，它的用法和 <a href="https://evestorm.github.io/posts/13167/#transition-timing-function-%E6%95%88%E6%9E%9C%E6%9B%B2%E7%BA%BF">transition-timing-function</a> 类似，想要了解详情的直接点这个链接吧。</p>
<blockquote>
<p>DEMO</p>
</blockquote>
<iframe height="521" scrolling="no" title="animation-timing-function" src="https://codepen.io/JingW/embed/qwbVgB/?height=521&amp;theme-id=0&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="animation-delay-动画延迟"><a href="#animation-delay-动画延迟" class="headerlink" title="animation-delay 动画延迟"></a>animation-delay 动画延迟</h2><p>CSS语法：<code>animation-delay: 1s</code></p>
<p>用来设置动画延迟多少秒/毫秒后才开始执行。正值（例如2s）将在2s后启动动画；负值（例如-2s）将立即执行动画，但是动画会从它的动画序列中的第2s位置处立即开始。</p>
<h2 id="animation-iteration-count-循环次数"><a href="#animation-iteration-count-循环次数" class="headerlink" title="animation-iteration-count 循环次数"></a>animation-iteration-count 循环次数</h2><p>CSS语法：<code>animation-iteration-count: 1s</code></p>
<p>用来设置动画循环的次数，默认值是1，表示动画只播放一次。除了使用正整数来设置次数外，还可以将值设置为 <code>infinite</code> ，表示无限循环。</p>
<h2 id="animation-direction-是否反向"><a href="#animation-direction-是否反向" class="headerlink" title="animation-direction 是否反向"></a>animation-direction 是否反向</h2><p>CSS语法：<code>animation-direction: normal | reverse | alternate | alternate-reverse</code></p>
<p>用来设置动画在循环过程中是否反向运动，默认值为 <code>normal</code> ，即正常模式，动画会从第一帧播放到最后一帧；<code>reverse</code> 表示反向模式，动画会从最后一帧倒着播放到第一帧；<code>alternate</code> 设置动画先正向播放，第二次再从反向播放，交替进行，例如 animation 系列一中的案例；<code>alternate-reverse</code> 则是先让动画反向播放，第二次再正向播放，交替进行。</p>
<h2 id="animation-fill-mode-动画填充模式"><a href="#animation-fill-mode-动画填充模式" class="headerlink" title="animation-fill-mode 动画填充模式"></a>animation-fill-mode 动画填充模式</h2><p>CSS语法：<code>animation-fill-mode: none | forwards | backwards | both</code></p>
<p>用来指定在动画执行之前和之后如何给动画的目标应用样式。这个属性在我第一次接触时没太理解，直到我看了 <a href="https://segmentfault.com/">segmentfault</a> 上的 <a href="https://segmentfault.com/q/1010000003867335">这篇文章</a> 。</p>
<p>在理解它之前，我们需要在脑海里有个概念，那就是一个动画是分为初始状态、等待期、动画执行期、完成期四个阶段的。而上面 animation-fill-mode 接收的四个值则分别对应：</p>
<ul>
<li>none 表示 等待期和完成期，元素样式都为初始状态样式，不受动画定义（@keyframes）的影响</li>
<li>forwards 表示等待期保持初始样式，完成期间保持最后一帧样式</li>
<li>backwards 表示等待期为第一帧样式，完成期跳转为初始样式</li>
<li>both 表示 等待期样式为第一帧样式，完成期保持最后一帧样式</li>
</ul>
<p>单纯的文字不直观？相信下面的这个demo能让你豁然开朗：</p>
<iframe height="435" scrolling="no" title="animation-fill-mode" src="https://codepen.io/JingW/embed/qwNLJE/?height=435&amp;theme-id=0&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="animation-play-state-动画播放状态"><a href="#animation-play-state-动画播放状态" class="headerlink" title="animation-play-state 动画播放状态"></a>animation-play-state 动画播放状态</h2><p>CSS语法：<code>animation-play-state: running | paused</code></p>
<p>用来设置动画的播放或者暂停。比如希望在鼠标经过的时候，让动画先停止下来，鼠标移开之后再继续播放，就可以通过设置 <code>.element:hover &#123; animation-play-state: paused; &#125;</code> 来实现。下面是一个案例，在鼠标移入时钟后指针暂停旋转；移出后时钟继续旋转。</p>
<iframe height="339" scrolling="no" title="animation-play-state闹钟示例" src="https://codepen.io/JingW/embed/rbMWjB/?height=339&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>CSS3</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】chrome调试技巧-汇总</title>
    <url>/posts/62808/</url>
    <content><![CDATA[<h2 id="打印"><a href="#打印" class="headerlink" title="打印"></a>打印</h2><h3 id="console-table"><a href="#console-table" class="headerlink" title="console.table"></a>console.table</h3><p>使用 <code>console.table()</code> 可以将传入的对象，或数组以表格形式输出。适合排列整齐的元素：</p>
<img src="/posts/62808/console_table.png" class="" title="console_table效果图">

<h3 id="让日志更易读"><a href="#让日志更易读" class="headerlink" title="让日志更易读"></a>让日志更易读</h3><p>即使 <code>console.log</code> 一个简单变量，你都可能会忘记（或混淆）哪一个是那个。当你有不同的变量需要打印的时候，阅读起来会更费劲。</p>
<img src="/posts/62808/log-ugly.png" class="" title="难以阅读的log">

<blockquote>
<p>“嗯？哪一个值对应哪一个变量来着？”</p>
</blockquote>
<p>为了让它变得更加易读，你可以打印一个对象 - 只需将所有<code>console.log</code> 的参数包装在大括号中。感谢 ECMAScript 2015 中引入了 <code>enhanced object literal(增强对象文字面量)</code> ，所以这（加了个括号）就是你需要做的全部了：</p>
<img src="/posts/62808/log-nice.png" class="" title="友好的日志">

<a id="more"></a>

<h2 id="触发伪类"><a href="#触发伪类" class="headerlink" title="触发伪类"></a>触发伪类</h2><p>右键单击 <code>Elements</code> 面板中的目标元素节点并选择「force state」。或者在 <code>Styles</code> 子窗格中单击「:hov」图标。可以触发元素上的伪类来研究元素在悬停时的效果和样式：</p>
<p><a href="https://gitee.com/evestorm/various_resources/raw/master/tools/chromehover.gif"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/chromehover.gif" alt="触发伪类"></a></p>
<h2 id="ALT-单击可以展开所有子节点"><a href="#ALT-单击可以展开所有子节点" class="headerlink" title="ALT+单击可以展开所有子节点"></a>ALT+单击可以展开所有子节点</h2><p>在 Elements 面板中,使用 Alt+单击可以展开该 Dom 节点下的所有 Dom 子节点：</p>
<p><a href="https://img-blog.csdnimg.cn/2019082016164342.gif"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/2019082016164342.gif" alt="alt+单击展开所有子节点"></a></p>
<h2 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h2><h3 id="拷贝资源"><a href="#拷贝资源" class="headerlink" title="拷贝资源"></a>拷贝资源</h3><p>你可以通过全局的方法 <code>copy()</code> 在 <code>console</code> 里 <code>copy</code> 任何你能拿到的资源，例如：</p>
<p><a href="https://gitee.com/evestorm/various_resources/raw/master/tools/copy_resource.gif"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/copy_resource.gif" alt="copy 资源"></a></p>
<h3 id="拷贝-HTML-最快的方式"><a href="#拷贝-HTML-最快的方式" class="headerlink" title="拷贝 HTML (最快的方式)"></a>拷贝 HTML (最快的方式)</h3><p>可能你知道右击或者点击在 <code>html</code> 元素边上的省略号(…)就能将它 <code>copy</code> 到操作系统剪贴板中 但你同样可以用非常古老的 <code>[ctrl] + [c]</code> + <code>[ctrl] + [v]</code> 大法来实现同样的效果！</p>
<p><a href="https://gitee.com/evestorm/various_resources/raw/master/tools/copy_html.gif"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/copy_html.gif" alt="copy html"></a></p>
<h2 id="snippet-代码块"><a href="#snippet-代码块" class="headerlink" title="snippet 代码块"></a>snippet 代码块</h2><p>作用：Chrome 开发者工具的 Snippets 提供了在 Chrome 里保存及运行或者调试一段 js 代码的功能<br>入口：Chrome 开发者工具-Sources 面板-Snippets 面板</p>
<p>直达：<a href="https://juejin.im/post/5c2653b4e51d457b8c1f5c41">你不知道的 Chrome 调试工具技巧 第二十一天：Snippets(代码块)</a></p>
<h2 id="在控制台中引用上一次的执行结果"><a href="#在控制台中引用上一次的执行结果" class="headerlink" title="在控制台中引用上一次的执行结果"></a>在控制台中引用上一次的执行结果</h2><p>我们常常需要在控制台中调试代码。比如你想知道如何在 JavaScript 中反转字符串，然后你在网络上搜索相关信息并找到以下代可行代码。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copy&#39;abcde&#39;.split(&#39;&#39;).reverse().join(&#39;&#39;)</span><br></pre></td></tr></table></figure>

<p><a href="https://evestorm.github.io/posts/63676/split.jpg"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/split.jpg" alt="split">split</a></p>
<p>没问题，上面的代码确实对字符串进行了翻转。但你还想了解 split()、reverse()、join() 这些方法的作用以及运行他们的中间步骤的结果。因此，现在你想逐步执行上述代码，可能会编写如下内容：</p>
<p><a href="https://evestorm.github.io/posts/63676/chrome-split.jpg"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/chrome-split.jpg" alt="chrome-split">chrome-split</a></p>
<p>好了，经过上面这些操作，我们确实知道了每个方法运行的返回值，也就了解了各个方法的作用。</p>
<p>但是，这给人的感觉有点多此一举。上面的做法既容易出错，又难以理解。实际上，在控制台中，我们可以使用魔术变量$_引用上一次操作的结果。</p>
<p><a href="https://evestorm.github.io/posts/63676/chrome-full.jpg"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/chrome-full.jpg" alt="chrome-full">chrome-full</a></p>
<p>$_是一个特殊变量，它的值始终等于控制台中上一次操作的执行结果。它可以让你更加优雅地调试代码。</p>
<h2 id="重新发送-XHR-请求"><a href="#重新发送-XHR-请求" class="headerlink" title="重新发送 XHR 请求"></a>重新发送 XHR 请求</h2><p>XHR，即 XMLHttpRequest，是一种创建 AJAX 请求的 JavaScript API 。<br>在我们的前端项目中，我们经常需要使用 XHR 向后端发出请求来获取数据。如果你想重新发送 XHR 请求，那么该怎么办呢？<br>对于新手来说，可能会选择刷新页面，但这可能比较麻烦。实际上，我们可以直接在“网络”面板中进行调试。</p>
<p><a href="https://evestorm.github.io/posts/63676/xhr.jpg"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/xhr.jpg" alt="xhr">xhr</a></p>
<h2 id="将复制图像为-Data-URI"><a href="#将复制图像为-Data-URI" class="headerlink" title="将复制图像为 Data URI"></a>将复制图像为 Data URI</h2><p>处理网页上的图像的通常有两种方法，一种是通过外部资源链接加载它们，另一种是将图像编码为 Data URI。</p>
<blockquote>
<p>Data URL，即前缀为 data:协议的 URL，允许内容创建者在文档中嵌入小文件。在被 WHATWG 撤消该名称之前，它们被称为“Data URI”。</p>
</blockquote>
<p>将这些小图像编码到 Data URL 并将它们直接嵌入到我们的代码中，可以减少页面需要发出的 HTTP 请求的数量，从而加快页面加载速度。</p>
<p>所以在 Chrome 浏览器中，我们该如何将图像转换为 Data URL 呢？可以参考下面的 gif 图像：</p>
<p><a href="https://evestorm.github.io/posts/63676/datauri.jpg"><img src="chrome%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7-%E6%B1%87%E6%80%BB/datauri.jpg" alt="datauri">datauri</a></p>
<h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2><ul>
<li><a href="https://segmentfault.com/a/1190000012957199">Javascript 调试命令——你只会 Console.log() ?</a></li>
<li><a href="https://juejin.im/post/5c2653b4e51d457b8c1f5c41">【译】你不知道的 Chrome 调试工具技巧 第二十一天：Snippets(代码块)</a></li>
<li><a href="https://blog.fundebug.com/2018/08/22/art-of-debugging-with-chrome-devtools/">20 个 Chrome DevTools 调试技巧（译）</a></li>
</ul>
]]></content>
      <categories>
        <category>效率</category>
        <category>工具</category>
      </categories>
      <tags>
        <tag>技巧</tag>
        <tag>转载</tag>
        <tag>chrome</tag>
      </tags>
  </entry>
  <entry>
    <title>cookie与session区别</title>
    <url>/posts/63891/</url>
    <content><![CDATA[<h2 id="保存状态"><a href="#保存状态" class="headerlink" title="保存状态"></a>保存状态</h2><p>cookie 是通过在客户端记录信息确定用户身份的，而 session 则通过在服务器端记录信息来确定用户身份。下面是网上找到的两张图，能够对 cookie 以及 session 在客户端与服务端传递的过程有个较清晰的认识：</p>
<img src="/posts/63891/1550245038963-b61378bb-65db-411e-9069-cf7d2b7a2908-20201119143043224.png" class="" title="cookie">

<img src="/posts/63891/1550245194054-9e6b0a42-c09e-4a8b-8e7e-93ba715e6e5a-20201119143043424.png" class="" title="session">

<a id="more"></a>

<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><p>cookie机制：</p>
<ul>
<li>默认情况下，cookie 保存在内存中，<strong>浏览器关闭</strong>就没了；设置过期时间后，cookie 保存在硬盘上，关闭浏览器仍然存在，直到过期时间结束才消失。</li>
<li>cookie 以<strong>文本形式</strong>保存在客户端，每次请求时都带上它。</li>
</ul>
<p>session机制：</p>
<ul>
<li>每次请求，服务器会检查是否有 sessionid<ul>
<li>有，服务器根据 id 返回对应 session 对象</li>
<li>无，服务器创建新的 session 对象，并把 sessionid 在本次响应中返回给客户端。</li>
</ul>
</li>
<li>通常使用 cookie 方式存储 sessionid 到客户端<ul>
<li>用户禁用 cookie 时，则服务端可以使用URL重写，可以通过 response.encodeURL(url) 进行实现</li>
</ul>
</li>
</ul>
<h2 id="存储方式"><a href="#存储方式" class="headerlink" title="存储方式"></a>存储方式</h2><ul>
<li>cookie 只能保存字符串类型，以文本的方式</li>
<li>session 能支持任何类型的对象</li>
</ul>
<h2 id="存储大小"><a href="#存储大小" class="headerlink" title="存储大小"></a>存储大小</h2><ul>
<li>cookie单个不超过4kb</li>
<li>session没限制</li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
  </entry>
  <entry>
    <title>cnchar.js获取汉字的拼音</title>
    <url>/posts/38408/</url>
    <content><![CDATA[<p>分享一个获取汉字拼音的库：</p>
<p><a href="https://github.com/theajack/cnchar">https://github.com/theajack/cnchar</a></p>
<p>几种常用方法：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">array:返回数组；<span class="string">&quot;汉字&quot;</span>.spell(<span class="string">&quot;array&quot;</span>) =&gt;[<span class="string">&#x27;Han&#x27;</span>,<span class="string">&#x27;Zi&#x27;</span>]</span><br><span class="line"></span><br><span class="line">first:返回首字母 ；<span class="string">&quot;汉字&quot;</span>.spell(<span class="string">&quot;first&quot;</span>) =&gt;<span class="string">&#x27;HZ&#x27;</span></span><br><span class="line"></span><br><span class="line">up:将结果全部大写；<span class="string">&quot;汉字&quot;</span>.spell(<span class="string">&quot;up&quot;</span>) =&gt;<span class="string">&#x27;HANZI&#x27;</span></span><br><span class="line"></span><br><span class="line">low:将结果全部小写；<span class="string">&quot;汉字&quot;</span>.spell(<span class="string">&quot;low&quot;</span>) =&gt;<span class="string">&#x27;hanzi&#x27;</span></span><br><span class="line"></span><br><span class="line">组合使用：<span class="string">&quot;汉字&quot;</span>.spell(<span class="string">&quot;first&quot;</span>,<span class="string">&quot;array&quot;</span>,<span class="string">&#x27;low&#x27;</span>) =&gt;[<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;z&#x27;</span>]</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>解决方案</category>
      </categories>
      <tags>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>flex布局中，保持内容不超出容器的解决办法</title>
    <url>/posts/3930/</url>
    <content><![CDATA[<p>在移动端，flex 布局很好用，它能够根据设备宽度来自动调整容器的宽度，用起来很方便，已经越来越离不开它，但是最近在做项目的时候发现一个问题。</p>
<a id="more"></a>

<p>就是在一个设置了 flex:1 的容器中，如果文字很长，这时候文字就会超出容器，而不是呆在设置好的动态剩余的空间中。由于实际项目的比较复杂，不好拿出来说，这里就把问题简化描述如下：</p>
<p>大致是有一个 main 容器是 flex 布局，左边一个 logo 固定宽高，右边 content 动态宽度。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">src</span>=<span class="string">&quot;pic.jpg&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">&quot;name&quot;</span>&gt;</span>a name<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;info&quot;</span>&gt;</span>a info<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;notice&quot;</span>&gt;</span>This is notice content.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">.main &#123; display: flex; &#125; .logo &#123; width: 100px; height: 100px; margin: 10px; &#125;</span><br><span class="line">.content &#123; flex: 1; &#125; .content &gt; * &#123; white-space: nowrap; overflow: hidden;</span><br><span class="line">text-overflow: ellipsis; &#125;12345678910111213141516</span><br></pre></td></tr></table></figure>

<p>.notice 可能会非常长，一些设备下需要隐藏显示，即不换行，并留下省略符…作标记。<br>这里会发现 text-overflow: ellipsis 不生效，省略符根本没有出现。而且因为设置了 nowrap 会发现文字会将 content 撑开，导致内容超出了屏幕。所以必须要解决这个问题。</p>
<blockquote>
<p>尝试取消父元素.content 的 flex: 1，无效。<br>尝试取消.main 容器的 display: flex，省略号出现。</p>
</blockquote>
<p>因此猜测是 flex 布局的问题，进一步猜测省略符需要对父元素限定宽度。<br>尝试对父元素.content 设置 width: 100%无效，但是设置 width: 0 可行。即：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果不设置宽度，.content 可以被子节点无限撑开；因此.notice 总有足够的宽度在一行内显示所有文本，也就不能触发截断省略的效果。测试还有一种方法可以达到效果：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden；;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的二种方法都可以达到我们需要的效果，即给 content 设置了 flex 为 1 的时候，它会动态的获得父容器的剩余宽度，且不会被自己的子元素把内容撑开。</p>
<p>经过测试，以下的方法是无效的：</p>
<blockquote>
<p>给 html, body 设置 max-width，元素似乎能强行撑开页宽；<br>给 body 设置 overflow，页宽不能被撑开了，但元素宽度还在，即元素本身还是溢出；<br>给 html, body 同时设置 max-width 和 overflow，页宽限定在 max-width 内，元素本身还是溢出；<br>给.main 容器设置 overflow: hidden，同理.main 是不溢出了，.notice 本身还是溢出；<br>给.notice 元素设置 width 或 max-width，虽然宽度受限，但在特定宽度下省略符…显示不全，有时只显示两个点..</p>
</blockquote>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
        <category>Flex</category>
      </categories>
      <tags>
        <tag>技巧</tag>
        <tag>flex</tag>
      </tags>
  </entry>
  <entry>
    <title>css扩大元素点击区域</title>
    <url>/posts/1303/</url>
    <content><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>项目中遇到使用滑动条的地方，但设计稿上的按钮面积非常小，用户在手机上由于不容易精确触摸到按钮导致拖动滚动条困难：</p>
<img src="/posts/1303/%E6%BB%91%E5%8A%A8%E6%9D%A1.png" class="" title="滑动条设计稿截图">

<a id="more"></a>

<p>所以就想着扩大按钮的点击区域。通常情况下想要扩大点击区域有两种方案：</p>
<ul>
<li>增加 border</li>
<li>添加 padding</li>
</ul>
<p>然而由于此滑动条使用的是三方库，圆形按钮的位置使用的是绝对定位，不太好改它本身的大小，因为这样要调整的 css 样式太多。所以上面两种方案都被毙掉了，最后 Google 到下面方案。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p><strong>使用伪元素扩大可点击区域</strong></p>
<p>伪元素能为其父元素捕获鼠标交互动作，因此，只需通过伪元素扩大父元素的空间大小，就能扩大可点击区域。</p>
<p>代码如下：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;extend-via-pseudo-elem&quot;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">.extend-via-pseudo-elem &#123; position: relative; &#125; .extend-via-pseudo-elem::before</span><br><span class="line">&#123; content: &#x27;&#x27;; position: absolute; top: -20px; right: -20px; bottom: -20px;</span><br><span class="line">left: -20px; &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>技巧</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>git提交代码到错误的远端分支如何撤回并提交到正确分支</title>
    <url>/posts/61419/</url>
    <content><![CDATA[<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><p>假如你要提交代码到 bug 分支，然而却忘了切分支，仍然在 dev 开发分支上改了 bug，而且已经推送到远端了。此时你该如何撤回远端在 dev 分支的修改，并把代码推送到正确的远端 bug 分支上呢？</p>
<p>你可以执行下面操作：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 切换到你提交了错误代码的分支</span></span><br><span class="line">git checkout dev</span><br><span class="line"><span class="meta">#</span><span class="bash"> 撤销最近的一次提交</span></span><br><span class="line">git revert HEAD --no-edit</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将revert commit push到远端</span></span><br><span class="line">git push origin dev</span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换到正确的分支</span></span><br><span class="line">git checkout bug</span><br><span class="line">将目标 commit 嫁接到当前分支</span><br><span class="line">git cherry-pick db6bb3f &lt;=你之前提交到错误分支的那个commit的SHA</span><br></pre></td></tr></table></figure>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://zhuanlan.zhihu.com/p/42929114">Git 误操作救命篇一： 如何将改动撤销？</a></p>
]]></content>
      <categories>
        <category>工具</category>
        <category>版本控制</category>
      </categories>
      <tags>
        <tag>Git</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS13.4+版本h5拍照图片旋转问题的解决方案</title>
    <url>/posts/13740/</url>
    <content><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>前几天刚解决完 Safari 上 h5 拍照会旋转 90 度的问题，今天更新完苹果系统后（13.4 ——&gt; 13.6），突然发现图片又旋转了。前几天不刚测完是好的么，怎么又出问题了。拿公司测试机 12.6 版本测试了下发现没毛病，就基本定位到问题所在了：iOS13.4+版本可能都存在此问题。</p>
<p>然后就是打断点调试，发现新系统下图片的 <code>Orientation</code> 仍然为 6 ，但其实照片（竖着拍）已经被苹果自动旋转回来了。然后我的代码中针对 6 的情况向右旋转了 90 度，这才导致图片又旋转回去了：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> (Orientation) &#123;</span><br><span class="line">   <span class="keyword">case</span> <span class="number">6</span>: <span class="comment">//需要顺时针（向右）90度旋转</span></span><br></pre></td></tr></table></figure>

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="判断系统版本"><a href="#判断系统版本" class="headerlink" title="判断系统版本"></a>判断系统版本</h3><p>既然是 iOS 系统版本问题，那么最粗暴的方案就是对系统进行判断，如果高于 13.4，就不去旋转。具体封装的方法代码如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 判断是IOS13.4以上的系统 13.4以上返回true</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>file 文件资源</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"><span class="function"><span class="title">detectImageAutomaticRotation</span>(<span class="params">file</span>)</span> &#123;</span><br><span class="line">   <span class="keyword">let</span> u = navigator.userAgent,</span><br><span class="line">      app = navigator.appVersion;</span><br><span class="line">   <span class="keyword">let</span> isAndroid = u.indexOf(<span class="string">&#x27;Android&#x27;</span>) &gt; -<span class="number">1</span> || u.indexOf(<span class="string">&#x27;Linux&#x27;</span>) &gt; -<span class="number">1</span>; <span class="comment">//g</span></span><br><span class="line">   <span class="keyword">let</span> isIOS = !!u.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>); <span class="comment">//ios终端</span></span><br><span class="line">   <span class="keyword">if</span> (isIOS) &#123;</span><br><span class="line">      <span class="keyword">let</span> ver = (navigator.appVersion).match(<span class="regexp">/OS (\d+)_(\d+)_?(\d+)?/</span>);</span><br><span class="line">      <span class="keyword">let</span> ver1 = <span class="built_in">parseInt</span>(ver[<span class="number">1</span>])</span><br><span class="line">      <span class="keyword">let</span> ver2 = <span class="built_in">parseInt</span>(ver[<span class="number">2</span>])</span><br><span class="line">      <span class="keyword">if</span> (ver1 &gt;= <span class="number">13</span> &amp;&amp; ver2 &gt;= <span class="number">4</span>) &#123;</span><br><span class="line">         <span class="comment">// if (file.name == &#x27;image.jpg&#x27;) &#123; //判断是拍照上传的还是相册选取的，IOS拍完照还没有确定的时候，图片的名字统一都是image.jpg</span></span><br><span class="line">         <span class="comment">//    return true</span></span><br><span class="line">         <span class="comment">// &#125;</span></span><br><span class="line">         <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>但这个方案有个小的隐患，就是我们无法预知今后苹果是否会把这个“自我修正”行为改回去，一旦有这种情况，我们还要重新变动代码，略显麻烦。</p>
<h3 id="用一张特殊的图片来检测当前浏览器是否对带-EXIF-信息的图片进行回正"><a href="#用一张特殊的图片来检测当前浏览器是否对带-EXIF-信息的图片进行回正" class="headerlink" title="用一张特殊的图片来检测当前浏览器是否对带 EXIF 信息的图片进行回正"></a>用一张特殊的图片来检测当前浏览器是否对带 EXIF 信息的图片进行回正</h3><p>这是网上找到的一种方案，思路就是用一张「 2x1 的 JPEG 且 EXIF Orientation 为 6」的图片来检测当前浏览器是否对带 EXIF 信息的图片进行回正，如果图片变成 1x2，说明浏览器对图片进行了回正。具体代码见下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 用一张特殊的图片来检测当前浏览器是否对带 EXIF 信息的图片进行回正</span></span><br><span class="line"><span class="comment">// 方法来源: https://github.com/blueimp/JavaScript-Load-Image</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 一张 2x1 的 JPEG 图片, EXIF Orientation: 6</span></span><br><span class="line"><span class="keyword">const</span> testAutoOrientationImageURL =</span><br><span class="line">  <span class="string">&#x27;data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAA&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;AAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBA&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;BAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/x&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;ABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAA&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;AAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> isImageAutomaticRotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">detectImageAutomaticRotation</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isImageAutomaticRotation === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> img = <span class="keyword">new</span> Image();</span><br><span class="line"></span><br><span class="line">      img.onload = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 如果图片变成 1x2，说明浏览器对图片进行了回正</span></span><br><span class="line">        isImageAutomaticRotation = img.width === <span class="number">1</span> &amp;&amp; img.height === <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">        resolve(isImageAutomaticRotation);</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      img.src = testAutoOrientationImageURL;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      resolve(isImageAutomaticRotation);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://juejin.im/post/6844904162220572686">关于 iOS 13.4.1 后照片在浏览器中旋转的兼容性处理</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>移动端</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>兼容性</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS上input输入内容拦腰截断</title>
    <url>/posts/40889/</url>
    <content><![CDATA[<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>在 ios 上 input 输入框只显示一半高度的字:</p>
<img src="/posts/40889/input-error.jpeg" class="" title="input输入内容只显示了一半">

<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>固定 input 输入框的高度，把 input 输入框写死高度:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* uniapp 写法，非 uniapp 项目给 input 添加固定高度即可 */</span></span><br><span class="line"><span class="selector-tag">uni-input</span> /<span class="selector-tag">deep</span>/ <span class="selector-class">.uni-input-form</span> &#123;</span><br><span class="line">  .uni-input-input &#123;</span><br><span class="line">    <span class="selector-tag">height</span>: 50<span class="selector-tag">rpx</span> !<span class="selector-tag">important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/posts/40889/input-suc.jpeg" class="" title="解决">
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>uniapp</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS启动页图片无法全屏显示</title>
    <url>/posts/58404/</url>
    <content><![CDATA[<p>在 Xcode 中设置启动页图片发现上下 Safe Area 区域图片没能填满：</p>
<img src="/posts/undefined/safearea.png" class="" title="安全区域未填满">

<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>设置相应约束的 FirstItem ，改 <code>Safe Area</code> 为 <code>SuperView</code> ：</p>
<img src="/posts/undefined/safearea2superview.png" class="" title="安全区域未填满">

<h2 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h2><img src="/posts/undefined/superview.png" class="" title="安全区域未填满">
]]></content>
      <categories>
        <category>移动端</category>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS</tag>
        <tag>Xcode</tag>
      </tags>
  </entry>
  <entry>
    <title>input效果汇总</title>
    <url>/posts/32435/</url>
    <content><![CDATA[<h2 id="text-文本框"><a href="#text-文本框" class="headerlink" title="text 文本框"></a>text 文本框</h2><h3 id="focus-时底部下划线展开动画"><a href="#focus-时底部下划线展开动画" class="headerlink" title="focus 时底部下划线展开动画"></a>focus 时底部下划线展开动画</h3><iframe height="310" scrolling="no" title="Input Boxes" src="https://codepen.io/JingW/embed/NWWERVy?height=265&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<a id="more"></a>

<h2 id="search-搜索框"><a href="#search-搜索框" class="headerlink" title="search 搜索框"></a>search 搜索框</h2><h3 id="聚焦时搜索框变宽动画"><a href="#聚焦时搜索框变宽动画" class="headerlink" title="聚焦时搜索框变宽动画"></a>聚焦时搜索框变宽动画</h3><iframe height="310" scrolling="no" title="Search Form with CSS3" src="https://codepen.io/JingW/embed/KKKrNQY?height=265&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="radio-单选按钮"><a href="#radio-单选按钮" class="headerlink" title="radio 单选按钮"></a>radio 单选按钮</h2><h3 id="自定义小圆点（带动画）"><a href="#自定义小圆点（带动画）" class="headerlink" title="自定义小圆点（带动画）"></a>自定义小圆点（带动画）</h3><iframe height="310" scrolling="no" title="CSS radio buttons" src="https://codepen.io/JingW/embed/KKKrgmy?height=265&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="checkbox-多选按钮"><a href="#checkbox-多选按钮" class="headerlink" title="checkbox 多选按钮"></a>checkbox 多选按钮</h2><h3 id="自定义小方框-1"><a href="#自定义小方框-1" class="headerlink" title="自定义小方框 1"></a>自定义小方框 1</h3><iframe height="310" scrolling="no" title="Simple CSS Checkboxes with Font Awesome" src="https://codepen.io/JingW/embed/WNNYRoN?height=265&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="自定义小方框-2"><a href="#自定义小方框-2" class="headerlink" title="自定义小方框 2"></a>自定义小方框 2</h3><iframe height="310" scrolling="no" title="Pure CSS custom checkboxes" src="https://codepen.io/JingW/embed/XWWypeg?height=265&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="select-下拉选项"><a href="#select-下拉选项" class="headerlink" title="select 下拉选项"></a>select 下拉选项</h2><h3 id="纯-CSS-的下拉列表"><a href="#纯-CSS-的下拉列表" class="headerlink" title="纯 CSS 的下拉列表"></a>纯 CSS 的下拉列表</h3><iframe height="310" scrolling="no" title="Pure CSS Select" src="https://codepen.io/JingW/embed/PooxWaM?height=265&amp;theme-id=default&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>let和const和var的区别</title>
    <url>/posts/37021/</url>
    <content><![CDATA[<h2 id="const-和-let-异同"><a href="#const-和-let-异同" class="headerlink" title="const 和 let 异同"></a>const 和 let 异同</h2><h3 id="不同点"><a href="#不同点" class="headerlink" title="不同点"></a>不同点</h3><ul>
<li>let 定义变量可以只声明不赋值</li>
<li>const 定义常量声明时必须赋值，一旦定义不可轻易改变</li>
</ul>
<h3 id="相同点"><a href="#相同点" class="headerlink" title="相同点"></a>相同点</h3><p>解决 var 没有块作用域,、变量提升、可以重复声明的问题。 let 和 const 有自己的块作用域, 不存在变量提升问题, 同一块作用域中不可重复声明（会报错）。</p>
<h2 id="let-const-和-var-区别"><a href="#let-const-和-var-区别" class="headerlink" title="let/const 和 var 区别"></a>let/const 和 var 区别</h2><ul>
<li>var 有变量提升，let/const 没有</li>
<li>let/const 的作用域是块，而 var 的作用域是函数</li>
<li>let/const 有暂时性死区，只要 let/const 声明的变量，在未声明之前使用或者赋值都会报错（ReferenceError）</li>
<li>let/const 不能被重复定义</li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title>npm-run-build遇到Node Sass could not find a binding for your current environment: OS X 64-bit with Node.js 14.x</title>
    <url>/posts/7710/</url>
    <content><![CDATA[<p>今天 <code>npm run build-prod</code> 打包项目的时候遇到如下报错信息：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Node Sass could not find a binding for your current environment: OS X 64-bit with Node.js</span><br></pre></td></tr></table></figure>

<p>百度了一些解决方案都没法解决问题，后来在 Stack Overflow 上看到了一种解决方案，地址：<a href="https://stackoverflow.com/questions/64612707/node-sass-does-not-yet-support-your-current-environment-windows-64-bit-with-uns">https://stackoverflow.com/questions/64612707/node-sass-does-not-yet-support-your-current-environment-windows-64-bit-with-uns</a></p>
<ol>
<li>install / downgrade node.js to a stable version (LTS) like <a href="https://nodejs.org/en/download/">14.15.0</a></li>
<li>install the compatible node-sass version via <code>npm install node-sass@4.14.0</code>; you can find the list <a href="https://www.npmjs.com/package/node-sass">here</a>, or even install <code>gulp-sass</code>with <code>npm i gulp-sass --save-dev</code>.</li>
</ol>
]]></content>
      <categories>
        <category>解决方案</category>
        <category>Node</category>
      </categories>
      <tags>
        <tag>笔记</tag>
        <tag>解决方案</tag>
      </tags>
  </entry>
  <entry>
    <title>null 和 undefined 的区别</title>
    <url>/posts/63928/</url>
    <content><![CDATA[<h2 id="含义"><a href="#含义" class="headerlink" title="含义"></a>含义</h2><ul>
<li>null 表示一个对象是“没有值”的值，也就是值为“空”</li>
<li>undefined 表示一个变量声明了没有初始化(赋值)</li>
</ul>
<h2 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h2><ul>
<li>undefined 的类型(typeof)是 undefined</li>
<li>null 的类型(typeof)是 object</li>
</ul>
<a id="more"></a>

<h2 id="双等三等"><a href="#双等三等" class="headerlink" title="双等三等"></a>双等三等</h2><p>另外，在验证 null 时，一定要使用 <code>===</code> ，因为 <code>==</code> 无法分辨 null 和 undefined ：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copynull &#x3D;&#x3D; undefined &#x2F;&#x2F; true </span><br><span class="line">null &#x3D;&#x3D;&#x3D; undefined &#x2F;&#x2F; false</span><br></pre></td></tr></table></figure>



<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="undefined"><a href="#undefined" class="headerlink" title="undefined"></a>undefined</h3><ol>
<li>变量提升：只声明未定义默认值就是 undefined</li>
<li>严格模式下：没有明确的执行主体，this 就是 undefined</li>
<li>对象没有这个属性名，属性值是 undefined</li>
<li>函数定义形参不传值，默认就是 undefined</li>
<li>函数没有返回值（没有 return 或者 return; ），默认返回的就是 undefined</li>
<li>数组越界取值也是 undefined （arr=[1,2]; arr[10] =&gt; undefined）</li>
<li>…</li>
</ol>
<h3 id="null"><a href="#null" class="headerlink" title="null"></a>null</h3><ol>
<li>手动设置变量的值或者对象某个属性值为null（此时不赋值，后面会赋值）</li>
<li>在 JS 的 DOM 元素获取中，如果没有获取到指定的元素对象，结果一般都是null</li>
<li>Object.prototype.<strong>proto</strong> 的值也是 null</li>
<li>正则捕获的时候，如果没有捕获到结果，默认也是null</li>
<li>…</li>
</ol>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>Javascript会将未赋值的变量默认值设为undefined；Javascript从来不会将变量设为null。它是用来让程序员表明某个用var声明的变量时没有值的。</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
  </entry>
  <entry>
    <title>transition过渡（一）</title>
    <url>/posts/41749/</url>
    <content><![CDATA[<h2 id="传送门"><a href="#传送门" class="headerlink" title="传送门"></a>传送门</h2><ul>
<li><a href="https://evestorm.github.io/posts/24967/">transition过渡（一）</a></li>
<li><a href="https://evestorm.github.io/posts/13167/">transition过渡（二）</a></li>
</ul>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><blockquote>
<p>CSS3 过渡是元素从一种样式逐渐改变为另一种的效果。<br>要实现这一点，必须规定两项内容：</p>
<ul>
<li>指定要添加效果的CSS属性</li>
<li>指定效果的持续时间。</li>
</ul>
</blockquote>
<p>———— 出自 <a href="http://www.runoob.com/css3/css3-transitions.html">菜鸟教程</a></p>
<a id="more"></a>

<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 分开写：*/</span></span><br><span class="line"><span class="selector-tag">transition-property</span>: <span class="selector-tag">css</span>属性名称;</span><br><span class="line"><span class="selector-tag">transition-duration</span>: 过渡所花时间(默认0);</span><br><span class="line"><span class="selector-tag">transition-timing-function</span>: 过渡的时间曲线(默认<span class="selector-tag">ease</span>);</span><br><span class="line"><span class="selector-tag">transition-delay</span>: 延迟时间(默认0);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 简写形式： */</span></span><br><span class="line"><span class="selector-tag">transition</span>： <span class="selector-tag">CSS</span>属性，花费时间，效果曲线(默认<span class="selector-tag">ease</span>)，延迟时间(默认0)</span><br></pre></td></tr></table></figure>

<h2 id="栗子-🌰"><a href="#栗子-🌰" class="headerlink" title="栗子 🌰"></a>栗子 🌰</h2><h3 id="单个属性的变化-—-gt-按钮-hover-效果"><a href="#单个属性的变化-—-gt-按钮-hover-效果" class="headerlink" title="单个属性的变化 —&gt; 按钮 :hover 效果"></a>单个属性的变化 —&gt; 按钮 :hover 效果</h3><p>下面的两个按钮，在鼠标移入时都被设置了 <code>background: yellow;</code> 样式。但只给第一个加上了 <code>transition: background 2s;</code> 属性，意思是如果背景发生变化，则给2s的过渡效果。</p>
<iframe height="265" scrolling="no" title="XGvqMB" src="https://codepen.io/JingW/embed/XGvqMB/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="多个属性的变化-—-gt-单独设置"><a href="#多个属性的变化-—-gt-单独设置" class="headerlink" title="多个属性的变化 —&gt; 单独设置"></a>多个属性的变化 —&gt; 单独设置</h3><p>针对多个属性设置过渡效果，用逗号隔开就好。下面案例鼠标移入后，使正方形过渡到圆形，且颜色逐渐变浅，核心代码：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">background</span> .5<span class="selector-tag">s</span> <span class="selector-tag">ease-out</span>, <span class="selector-tag">border-radius</span> .5<span class="selector-tag">s</span> <span class="selector-tag">ease-in</span>;</span><br></pre></td></tr></table></figure>



<iframe height="265" scrolling="no" title="transition-多属性" src="https://codepen.io/JingW/embed/dLyWKM/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="多个属性的变化-gt-all"><a href="#多个属性的变化-gt-all" class="headerlink" title="多个属性的变化 -&gt; all"></a>多个属性的变化 -&gt; all</h3><p>如果要过渡的css属性较多，可以尝试使用 all 一步搞定。下面案例中将鼠标移入正方形盒子，会使其慢慢缩小为一个圆形，且颜色逐渐变深，核心代码：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">all</span> .5<span class="selector-tag">s</span> <span class="selector-tag">ease-out</span>;</span><br></pre></td></tr></table></figure>



<iframe height="265" scrolling="no" title="transition-多属性-all" src="https://codepen.io/JingW/embed/GLRmXm/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="实用-demo"><a href="#实用-demo" class="headerlink" title="实用 demo"></a>实用 demo</h2><h3 id="下拉导航菜单"><a href="#下拉导航菜单" class="headerlink" title="下拉导航菜单"></a>下拉导航菜单</h3><iframe height="265" scrolling="no" title="transition-下拉导航" src="https://codepen.io/JingW/embed/MxNXex/?height=265&amp;theme-id=0&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>CSS3</tag>
      </tags>
  </entry>
  <entry>
    <title>vue-cli3配置多环境打包</title>
    <url>/posts/38395/</url>
    <content><![CDATA[<p>由于公司项目需要多环境 —— dev、test、pre、prod，就看了下 vue-cli3 的多环境配置。通过官方 <a href="https://cli.vuejs.org/zh/guide/mode-and-env.html">vue-cli</a> 文档知晓 vue-cli 提供了三种模式：</p>
<ul>
<li>test</li>
<li>development</li>
<li>production</li>
</ul>
<p>而每种 NODE_ENV 下面可以配置多个环境变量。</p>
<a id="more"></a>

<p>我们可以通过 <code>.env</code> 文件增加后缀来设置某个模式下特有的环境变量。</p>
<p>例如我们可以在项目根目录下创建三个 <code>env</code> 文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">.env.development # 开发</span><br><span class="line">.env.prod # 发布</span><br><span class="line">.env.test # 测试</span><br></pre></td></tr></table></figure>

<blockquote>
<p>.env.development 开发环境</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">NODE_ENV = <span class="string">&#x27;development&#x27;</span>;</span><br><span class="line">VUE_APP_API_URL = <span class="string">&#x27;http://...&#x27;</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>.env.test 测试环境</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">NODE_ENV = <span class="string">&#x27;test&#x27;</span>;</span><br><span class="line">VUE_APP_API_URL = <span class="string">&#x27;http://...&#x27;</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>.env.production 发布环境</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">NODE_ENV = <span class="string">&#x27;production&#x27;</span>;</span><br><span class="line">VUE_APP_API_URL = <span class="string">&#x27;http://...&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>如果需要其他环境，可以创建 <code>.env.[model]</code> 文件</p>
<p>例如创建 <code>.env.mock</code> 模拟数据环境，则改写 <code>package.json</code> 文件：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;script&quot;: &#123;</span><br><span class="line">  &quot;dev&quot;: &quot;vue-cli-service serve&quot;,</span><br><span class="line">  &quot;mock&quot;: &quot;vue-cli-service serve --mode mock&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里 需要注意的是 <code>--mode</code> 后面的参数 需要是 <code>.env.[model]</code> 文件 对应的 [mode]</p>
<p>现在 <code>npm run mock</code> 就会执行 <code>vue-cli-service serve --mode mock</code> 脚本，环境变量 <code>VUE_APP_API_URL</code> 就会走 <code>.env.mock</code> 中的配置。</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>框架</category>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>vue-cli3</tag>
      </tags>
  </entry>
  <entry>
    <title>transition过渡（二）</title>
    <url>/posts/13167/</url>
    <content><![CDATA[<h2 id="传送门"><a href="#传送门" class="headerlink" title="传送门"></a>传送门</h2><ul>
<li><a href="https://evestorm.github.io/posts/24967/">transition过渡（一）</a></li>
<li><a href="https://evestorm.github.io/posts/13167/">transition过渡（二）</a></li>
</ul>
<p>上篇文章是对 transition过渡 的一个简单介绍和使用。这篇文章就来聊聊具体属性的含义和用法。</p>
<a id="more"></a>

<h2 id="transition-property-过渡属性"><a href="#transition-property-过渡属性" class="headerlink" title="transition-property 过渡属性"></a>transition-property 过渡属性</h2><p>从上一篇文章能够知道 transition-property 是拿来设置元素中参与过渡的属性的。它的可选值为：</p>
<ul>
<li>none 指所有属性都不参与过渡</li>
<li>all 指所有属性都参与过渡</li>
<li>[IDENT] 指定个别属性参与过渡</li>
</ul>
<p>下面来看一个案例：</p>
<p>👇温馨提示：为了方便看效果，可点击 <code>CSS</code> 按钮折叠代码部分，仅显示页面 👇</p>
<iframe height="265" scrolling="no" title="transition-property-demo1" src="https://codepen.io/JingW/embed/oONwww/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<p>当你依次将鼠标移入上方演示demo中的三个按钮就会发现，都在各自下方显示出了一段文本。我们想要实现的，就是这段文本的显示需要有一个过渡效果，不要太生硬。最简单的一种实现方案就是鼠标移入按钮前，文本容器的 <code>height: 0</code> ，鼠标移入后固定容器高度 <code>height: 150px</code> （第一个按钮效果就用的此方案）。但在实际情况中，往往文本是自适应的，高度无法确定，所以很自然的，我们会想到将 <code>height: 150px</code> 设置为 <code>height: auto</code> ，这样不就能够实现自适应高度的容器过渡了嘛，这就是第二个按钮的一套实现方案。但结果大家都知道了，文本容器不再拥有过渡的动画，而是直接从 <code>0px</code> 瞬间变化到 <code>auto</code>，这是为什么呢？</p>
<p><strong>答案</strong>：并不是所有的属性和属性值都能存在过渡动画。</p>
<p>这里特别需要注意的是，如果想要指定某个属性有过渡状态，就需要保证我们能够计算出过渡过程中每个时间点的属性值。<br>比如，从 <code>height: 0;</code> 过渡到 <code>height: 150px;</code> ，过渡时间是 <code>t</code> ，那我们可以算出在 <code>x</code> 时刻的属性状态是 <code>height: (150px-0)*x/t;</code> 。（注：这里公式成立的前提是假设 <code>transition-timing-function: linear;</code> ，如果<code>transition-timing-function</code> 为其他值，一样可以计算，只不过算法不同）<br>然而刚才第二种方案设置了 <code>height: auto;</code>，则在 <code>x</code> 时刻的属性状态为 <code>height: (auto-0px)*x/t;</code> ，显然，这种状态是不存在的、无法被计算的，因此在设置高度变成 <code>auto</code> 之后，也自然不会再有过渡动画了。</p>
<p><strong>解决方案</strong></p>
<p>第三个按钮的效果就是我们的一种解决方案，在默认状态下，我们不设置文本容器的 <code>height: 0</code> ，而是用 <code>transform: scale(1, 0);</code> 来代替它，意思是在初始状态下，我们的文本容器比例为宽1:1，高1:0，换句话说，宽为我们设置的宽，但高度为0。在鼠标移入按钮后，用 <code>transform: scale(1, 1);</code> 来代替方案二中的 <code>height: auto</code> ，设置文本容器的宽高为1，这样就又能出现过渡动画了。</p>
<p><strong>延伸</strong></p>
<p>由此进行延伸，再比如日常中最常使用的控制元素显示隐藏的代码是 <code>display: block;</code> 和 <code>display: none;</code> ，这也是不存在过渡动画的，因此，可以调整改为使用 <code>opacity: 1;</code> 和 <code>opacity: 0;</code> 来替换。</p>
<h2 id="transition-duration-过渡花费的时间"><a href="#transition-duration-过渡花费的时间" class="headerlink" title="transition-duration 过渡花费的时间"></a>transition-duration 过渡花费的时间</h2><p>这个属性没什么可讲的，用它来设置元素过渡的持续时间</p>
<h2 id="transition-timing-function-效果曲线"><a href="#transition-timing-function-效果曲线" class="headerlink" title="transition-timing-function 效果曲线"></a>transition-timing-function 效果曲线</h2><p>这个属性是设置过渡的动画类型的，换句话说，就是设置在过渡过程中元素值的变化速度。它的可选值包含这样几组：</p>
<ul>
<li>ease | linear | ease-in | ease-out | ease-in-out</li>
<li>step-start | step-end | steps([, [ start | end ] ]?)</li>
<li>cubic-bezier(, , , )</li>
</ul>
<h3 id="预设的五个时间曲线"><a href="#预设的五个时间曲线" class="headerlink" title="预设的五个时间曲线"></a>预设的五个时间曲线</h3><iframe height="519" scrolling="no" title="transition-timing-function-五个预设时间曲线" src="https://codepen.io/JingW/embed/dLyjoN/?height=519&amp;theme-id=0&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="阶跃函数-step"><a href="#阶跃函数-step" class="headerlink" title="阶跃函数 step"></a>阶跃函数 step</h3><p>直接上案例吧，看完效果再来讲阶跃函数几个参数的具体含义：</p>
<iframe height="413" scrolling="no" title="transition-timing-function-阶跃函数" src="https://codepen.io/JingW/embed/PgwWXd/?height=413&amp;theme-id=0&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<p>实际体验了阶跃函数带来的效果后应该对其有个大概认知了吧。阶跃函数接收两个参数，第一个参数为<strong>正整数</strong>，指定阶跃函数的间隔数，你可以理解为把整个过渡过程拆成若干份儿；第二个参数可选，值为<code>[ start | end ]</code>，叫做跃点，指定是在每个间隔的起点还是终点发生阶跃变化，默认值为<code>end</code>。<br>查看上面案例的css代码，你会发现两种 <code>steps</code> 的简写形式：<code>step-start</code> 和 <code>step-end</code> ，它们分别等同于：<code>step-start = steps(1, start)</code> 和 <code>step-end = steps(1, end)</code> 。</p>
<h3 id="cubic-bezier-贝塞尔曲线函数"><a href="#cubic-bezier-贝塞尔曲线函数" class="headerlink" title="cubic-bezier 贝塞尔曲线函数"></a>cubic-bezier 贝塞尔曲线函数</h3><p>贝塞尔曲线函数接收四个参数，取值范围是 0 到 1 之间的数值（包括0和1）。</p>
<p>贝塞尔曲线函数，其实定义的是 <strong>属性状态</strong> 与 <strong>时间</strong> 的一个关系函数。如下坐标轴所示：</p>
<img src="/posts/13167/cubic05000510.png" class="" title="cubic-bezier">

<p>上图坐标轴中横坐标是时间，纵坐标是属性状态，右上角的坐标是(1,1)。在时间曲线中的每一个点，表示的就是对应时刻下属性的取值，每个点的斜率表示的就是在这个时刻属性的变化速度，因此在时间曲线中<strong>斜率越小</strong>，也就是<strong>越平缓</strong>的地方，表示<strong>属性变化速度越慢</strong>；<strong>斜率越大</strong>，也就是<strong>越陡峭</strong>的地方，表示<strong>属性变化速度越快</strong>。如上图中开始跟结束的时候，斜率都比较小，而中间的阶段，斜率比较大，因此这个曲线表示的就是在变化过程中由慢到快再到慢的一个过程。</p>
<p>回到贝塞尔曲线函数接收的四个参数上，前两个是上图中红色点的坐标(x1,y1)，后两个是图中蓝色点的坐标(x2,y2)，也就是 <code>cubic-bezier(x1, y1, x2, y2)</code> 这样的形式。我们可以在 <a href="http://cubic-bezier.com/">http://cubic-bezier.com/</a> 这个工具上来调整我们独特的贝塞尔曲线，通过拖拽红色跟蓝色点，可以形成不一样的贝塞尔曲线。我们发现，其实规定取值范围在[0,1]之间，针对的是<strong>x坐标</strong>，也就是<strong>时间</strong>，因为时间如果超过了这个范围，就会出现在同一个时刻对应了两个不同的属性状态，这个是没有意义的；而y坐标是可以超过这个范围的，如下我们通过拖拽两个点形成了这样一个曲线：</p>
<img src="/posts/13167/cubic55465149.png" class="" title="cubic-bezier">

<p>它表示的是在过渡过程中属性值会超过终止状态的设定值然后再回到终点位置，表现为回弹的效果。大家可以在 <a href="http://cubic-bezier.com/">http://cubic-bezier.com/</a> 上自己拖动两个点尝试一下，最后点击 go 按钮查看效果。</p>
<p>上面两个图的demo效果：</p>
<iframe height="265" scrolling="no" title="transition-timing-function-贝塞尔曲线" src="https://codepen.io/JingW/embed/KYwqgb/?height=265&amp;theme-id=0&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="transition-delay-延迟"><a href="#transition-delay-延迟" class="headerlink" title="transition-delay 延迟"></a>transition-delay 延迟</h2><p>这个属性同样没啥讲的，用它来设置元素延迟过渡的时间。</p>
<h2 id="transition-的不足"><a href="#transition-的不足" class="headerlink" title="transition 的不足"></a>transition 的不足</h2><ul>
<li>无法在页面加载的时候自动触发，因为只有当属性值发生改变的时候才会触发过渡动画。</li>
<li>无法重复播放过渡动画，除非再次触发过渡事件。</li>
<li>无法设置多种状态（keyframes 只有 from，to），只能从初始状态过渡到终止状态，无法再设置其他的状态。</li>
<li>transition 规则作用的是单个属性的过渡状态，不能涉及多个属性，即使定义了 <code>transition: all 1s ease 0s;</code> 这样的规则，其对应的每个属性过渡动画也都是相互独立，相当于是定义了很多个 transition 规则，而每个 transition 只作用于一个属性。</li>
</ul>
<h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><ul>
<li><a href="https://easings.net/en#">Easing Functions Cheat Sheet</a></li>
<li><a href="http://cubic-bezier.com/">cubic-bezier</a></li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>CSS3</tag>
      </tags>
  </entry>
  <entry>
    <title>vue项目如何动态配置后端api地址</title>
    <url>/posts/47242/</url>
    <content><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>后端希望前端能动态配置 API 地址，但前端往往在 <code>npm run build</code> 生成 <code>dist</code> 后，配置就无法更改了。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>利用 <code>generate-asset-webpack-plugin</code> 插件，在 build 的时候生成 json 配置文件，然后再使用 axios 异步获取 json 配置，从而达到动态配置 API 的目的。</p>
<a id="more"></a>

<h2 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h2><h3 id="安装并引入-generate-asset-webpack-plugin"><a href="#安装并引入-generate-asset-webpack-plugin" class="headerlink" title="安装并引入 generate-asset-webpack-plugin"></a>安装并引入 generate-asset-webpack-plugin</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install generate-asset-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<blockquote>
<p>vue.config.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> GenerateAssetPlugin = <span class="built_in">require</span>(<span class="string">&#x27;generate-asset-webpack-plugin&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="定义需要生成的配置内容"><a href="#定义需要生成的配置内容" class="headerlink" title="定义需要生成的配置内容"></a>定义需要生成的配置内容</h3><blockquote>
<p>vue.config.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> createConfig = <span class="function"><span class="keyword">function</span> (<span class="params">compilation</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> cfgJson = &#123;</span><br><span class="line">    server_url: <span class="string">&#x27;http://127.0.0.1&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">JSON</span>.stringify(cfgJson);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">      <span class="keyword">new</span> GenerateAssetPlugin(&#123;</span><br><span class="line">        filename: <span class="string">&#x27;dynamicConfig.json&#x27;</span>,</span><br><span class="line">        fn: (compilation, cb)&#123;</span><br><span class="line">          cb(<span class="literal">null</span>, createConfig(compilation))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译后 dist 根目录下就会生成 <code>dynamicConfig.json</code> 文件。</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>框架</category>
        <category>Vue</category>
      </categories>
      <tags>
        <tag>vue-cli</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】git配置ssh服务</title>
    <url>/posts/1071/</url>
    <content><![CDATA[<p>原文：<a href="https://juejin.cn/post/6844904066032599054">https://juejin.cn/post/6844904066032599054</a></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在管理 Git 项目上，很多时候都是直接使用<code>https url</code>克隆到本地，当然也有有些人使用<code>SSH url</code>克隆到本地。</p>
<p>这两种方式的主要区别在于：</p>
<ul>
<li>使用<code>https url</code>克隆对初学者来说会比较方便，复制<code>https url</code>然后到 git Bash 里面直接用 clone 命令克隆到本地就好了，但是每次 fetch 和 push 代码都需要输入账号和密码，这也是 https 方式的麻烦之处。</li>
<li>而使用<code>SSH url</code>克隆却需要在克隆之前先配置和添加好<code>SSH key</code>，因此，如果你想要使用<code>SSH url</code>克隆的话，你必须是这个项目的拥有者。否则你是无法添加<code>SSH key</code>的，另外 ssh 默认是每次 fetch 和 push 代码都不需要输入账号和密码，如果你想要每次都输入账号密码才能进行 fetch 和 push 也可以另外进行设置。</li>
</ul>
<p>下面主要是讲述如何配置使用 ssh 方式来提交和克隆代码。</p>
<a id="more"></a>

<h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="配置本机-ssh"><a href="#配置本机-ssh" class="headerlink" title="配置本机 ssh"></a>配置本机 ssh</h2><h3 id="一、确定的是你的电脑上是安装过-Git"><a href="#一、确定的是你的电脑上是安装过-Git" class="headerlink" title="一、确定的是你的电脑上是安装过 Git"></a>一、确定的是你的电脑上是安装过 Git</h3><p>打开<code>cmd</code>，查看 git 版本：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">输入：git --version</span><br><span class="line">显示：git version 2.20.1.windows.1</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>如果显示类似<code>git version 2.20.1.windows.1</code>的 Git 版本，说明你的电脑是安装过 Git 的；否则请左转<a href="https://juejin.im/post/6844903749631098893#heading-4">打开 Git 的正确姿势</a>，把 Git 安装完了再来，不送。</p>
<h3 id="二、查看是否配置了-git-用户名和邮箱"><a href="#二、查看是否配置了-git-用户名和邮箱" class="headerlink" title="二、查看是否配置了 git 用户名和邮箱"></a>二、查看是否配置了 git 用户名和邮箱</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">输入：git config user.name</span><br><span class="line">显示：用户名</span><br><span class="line">输入：git config user.email</span><br><span class="line">显示用户邮箱</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>如果没有配置，那么需要配置用户名和邮箱：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">输入：git config --global user.name &quot;xxx&quot;</span><br><span class="line"></span><br><span class="line">输入：git config --global user.email &quot;xxx&quot;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="三、查看是否配置过-SSH-Key-密钥"><a href="#三、查看是否配置过-SSH-Key-密钥" class="headerlink" title="三、查看是否配置过 SSH Key(密钥)"></a>三、查看是否配置过 SSH Key(密钥)</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">输入：cd ~/.ssh</span><br><span class="line">输入：ls，</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>查看该文件下的文件，看是否存在 <code>id_isa</code> 和 <code>id_isa.pub</code> 文件（也可以是别的文件名，只要 <code>yourName</code> 和 <code>yourName.pub</code> 成对存在就可以），如果存在的话，证明已经存在 ssh key 了，可以直接跳过<code>4、生成SSH Key</code>这一步骤，</p>
<h3 id="四、生成-SSH-Key-密钥"><a href="#四、生成-SSH-Key-密钥" class="headerlink" title="四、生成 SSH Key(密钥)"></a>四、生成 SSH Key(密钥)</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">输入: ssh-keygen -t rsa -C &quot;你的邮箱&quot;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>此处会提示<code>Enter file in which to save the key (/Users/shutong/.ssh/id_rsa):</code>这样一段内容,让我们输入文件名，如果第 3 步的文件存在的话最好在这里修改一下文件名以防覆盖之前的内容；如果第 3 步的文件不存在的话则直接按<code>enter</code>键就好了。</p>
<p>之后会有提示你是否需要设置密码，如果设置了每次使用 Git 都会用到密码，一般都是直接不写为空，直接<code>enter</code>就好了。</p>
<p>上述操作执行完毕后，在<code>~/.ssh/</code>目录会生成<code>XXX-rsa</code>(私钥)和<code>XXX-rsa.pub</code>(公钥)，它们默认的存储路径是：</p>
<blockquote>
<p>C:\Users\Administrator.ssh</p>
</blockquote>
<p><strong>注意</strong></p>
<blockquote>
<p>个人建议生成的 rsa 最好单独命名不要使用默认名称，因为有可能 sshkey 可能会用在多个地方，一不小心就可能被覆盖然后导致 git 功能异常</p>
</blockquote>
<h3 id="五、添加公钥到你的远程仓库（github）"><a href="#五、添加公钥到你的远程仓库（github）" class="headerlink" title="五、添加公钥到你的远程仓库（github）"></a>五、添加公钥到你的远程仓库（github）</h3><h4 id="1-、查看你生成的公钥："><a href="#1-、查看你生成的公钥：" class="headerlink" title="1 、查看你生成的公钥："></a>1 、查看你生成的公钥：</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">输入：cat ~/.ssh/id_rsa.pub</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>这里会把公钥显示出来，我们把这段内容复制出来。</p>
<h4 id="2、添加公钥到远程仓库"><a href="#2、添加公钥到远程仓库" class="headerlink" title="2、添加公钥到远程仓库:"></a>2、添加公钥到远程仓库:</h4><p>登陆你的 github 帐户 -&gt; 点击你的头像，然后点击 <code>Settings</code> -&gt; 左栏点击 <code>SSH and GPG keys</code> -&gt; 点击 <code>New SSH key</code></p>
<p>然后将复制的公钥内容，粘贴进<code>Key</code>文本域内。 <code>title</code>域，自己随便起个名字。</p>
<p>点击 <code>Add SSH key</code>。</p>
<h4 id="2、查看-ssh-文件是否配置成功"><a href="#2、查看-ssh-文件是否配置成功" class="headerlink" title="2、查看 ssh 文件是否配置成功"></a>2、查看 ssh 文件是否配置成功</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">输入： ssh -T git@github.com</span><br><span class="line">输出： Hi danygitgit! You&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>恭喜你，你的设置已经成功了。</p>
<h3 id="六、修改-git-的-remote-url"><a href="#六、修改-git-的-remote-url" class="headerlink" title="六、修改 git 的 remote url"></a>六、修改 git 的 remote url</h3><p>如果之前添加的是<code>HTTPS</code>协议的 github 仓库地址，那么每次 push 或者 pull 仍然需要密码，所以，我们需要将其修改为<code>ssh</code>协议的，这样，就不需要这么麻烦了。</p>
<p>那么我们应该怎么办呢？</p>
<h4 id="1、查看当前的-remote-url"><a href="#1、查看当前的-remote-url" class="headerlink" title="1、查看当前的 remote url"></a>1、查看当前的 remote url</h4><p>首先进入本地仓库，右键 -&gt; <code>Git Bash Here</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">输入： git remote -v</span><br><span class="line">输出： origin https://github.com/danygitgit/document-library.git (fetch)</span><br><span class="line">输出： origin https://github.com/danygitgit/document-library.git (push)</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>如果是以上的结果那么说明此项目是使用<code>https</code>协议进行访问的（如果地址是 git 开头则表示是<code>git</code>协议）</p>
<h4 id="2、复制远程仓库的-ssh-链接"><a href="#2、复制远程仓库的-ssh-链接" class="headerlink" title="2、复制远程仓库的 ssh 链接"></a>2、复制远程仓库的 ssh 链接</h4><p>登陆你的远程仓库，在上面可以看到你的 ssh 协议相应的 url，类似：</p>
<blockquote>
<p><a href="mailto:&#x67;&#x69;&#116;&#x40;&#103;&#x69;&#x74;&#104;&#117;&#98;&#46;&#99;&#x6f;&#109;">&#x67;&#x69;&#116;&#x40;&#103;&#x69;&#x74;&#104;&#117;&#98;&#46;&#99;&#x6f;&#109;</a>:danygitgit/document-library.git</p>
</blockquote>
<p>复制此 ssh 链接。</p>
<h4 id="2、修改-git-的-remote-url"><a href="#2、修改-git-的-remote-url" class="headerlink" title="2、修改 git 的 remote url"></a>2、修改 git 的 remote url</h4><p>方法有三种：</p>
<ol>
<li>修改命令</li>
</ol>
<blockquote>
<p>git remote origin set-url [url]</p>
</blockquote>
<ol>
<li>先删后加</li>
</ol>
<blockquote>
<p>git remote rm origin git remote add origin [url]</p>
</blockquote>
<ol>
<li>直接修改<code>config</code>文件</li>
</ol>
<p>找到仓库下 <code>.git</code> 文件夹下的<code>config</code>文件，打开，可以看到以下内容</p>
<blockquote>
<p>[core] repositoryformatversion = 0 filemode = false bare = false logallrefupdates = true symlinks = false ignorecase = true[remote “origin”] url =<a href="https://github.com/danygitgit/document-library.git">https://github.com/danygitgit/document-library.git</a> fetch = +refs/heads/<em>:refs/remotes/origin/</em>[branch “master”] remote = origin merge = refs/heads/master</p>
</blockquote>
<p>将文件中的 <code>url =https://github.com/danygitgit/document-library.git</code>更改为 <code>url = git@github.com:danygitgit/document-library.git</code> 即可。</p>
<p>修改后的文件如下</p>
<blockquote>
<p>[core] repositoryformatversion = 0 filemode = false bare = false logallrefupdates = true symlinks = false ignorecase = true[remote “origin”] url = <a href="mailto:&#x67;&#x69;&#x74;&#64;&#103;&#105;&#116;&#x68;&#117;&#98;&#x2e;&#99;&#x6f;&#x6d;">&#x67;&#x69;&#x74;&#64;&#103;&#105;&#116;&#x68;&#117;&#98;&#x2e;&#99;&#x6f;&#x6d;</a>:danygitgit/document-library.git fetch = +refs/heads/<em>:refs/remotes/origin/</em>[branch “master”] remote = origin merge = refs/heads/master</p>
</blockquote>
<p>以后，不管是 push 还是 pull，你都不需要再提交密码了。</p>
<h3 id="七、Sourcetree-配置-ssh-密钥"><a href="#七、Sourcetree-配置-ssh-密钥" class="headerlink" title="七、Sourcetree 配置 ssh 密钥"></a>七、Sourcetree 配置 ssh 密钥</h3><p><code>SourceTree</code>是一款 git 管理可视化工具，就不需要繁琐的敲打命令行了。个人比较推荐，无论在 windows 环境还是 mac 的 os 环境。<a href="https://www.sourcetreeapp.com/">官网链接</a></p>
<p>关于<code>SourceTree</code>的安装及配置就不赘述了，具体请参考</p>
<ul>
<li><a href="https://blog.csdn.net/wangjiangrong/article/details/80287041">Git SourceTree 免登陆安装及配置 生成 ssh</a></li>
<li><a href="https://www.cnblogs.com/liuxin-673855200/p/11151835.html">SOURCETREE 3.1.3 版本跳过 BITBUCKET 注册方法（亲测好用） | 淡忘&amp;天涯</a></li>
<li><a href="https://jingyan.baidu.com/article/9faa7231cdec65473d28cb11.html">Sourcetree 配置 ssh 密钥</a></li>
</ul>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>磨刀不误砍柴工。勇于尝试，善于总结。开启你的 Git 踩坑之旅吧！</p>
<p>路漫漫其修远兮，希望 Git 可以帮我们记录每一个脚印，每一步成长。与诸君共勉。</p>
<p>祝大家 2020 更上一层楼！</p>
]]></content>
      <categories>
        <category>工具</category>
        <category>版本控制</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】20个ChromeDevTools调试技巧</title>
    <url>/posts/709/</url>
    <content><![CDATA[<p><strong>译者按：</strong> Chrome DevTools 很强大，甚至可以替代 IDE 了！</p>
<ul>
<li>原文: <a href="https://medium.com/frontmen/art-of-debugging-with-chrome-devtools-ab7b5fd8e0b4">Art of debugging with Chrome DevTools</a></li>
<li>译者: <a href="https://www.fundebug.com/">Fundebug</a></li>
</ul>
<p><strong>为了保证可读性，本文采用意译而非直译。另外，本文版权归原作者所有，翻译仅用于学习。</strong></p>
<p><strong>小编推荐：<a href="https://www.fundebug.com/">Fundebug</a>专注于 JavaScript、微信小程序、微信小游戏，Node.js 和 Java 线上 bug 实时监控。真的是一个很好用的 bug 监控服务，众多大佬公司都在使用。</strong></p>
<p>谷歌开发者工具提供了一系列的功能来帮助开发者高效 Debug 网页应用，让他们可以更快地查找和修复 bug。在谷歌的开发者工具中，有非常多有用的小工具，但是很多开发者并不知道。通过这篇文章，我把我常用的那些高效 Debug 的 Chrome 开发者工具的功能分享给大家。</p>
<p>_简洁起见，接下来我会使用<code>开发者工具</code>来指代<code>谷歌开发者工具</code>_。</p>
<p>在我们开始之前，你需要做一些准备工作。</p>
<a id="more"></a>

<h3 id="使用金丝雀版"><a href="#使用金丝雀版" class="headerlink" title="使用金丝雀版"></a><strong>使用金丝雀版</strong></h3><p>如果你想使用谷歌最新的版本和开发者工具，你可以下载<a href="https://www.google.com/chrome/canary/">金丝雀版本</a>，甚至把它设置为开发默认打开的浏览器。金丝雀版本旨在为早期接受者提供最新的更新。它可能不稳定，但是大多数时候是没问题的。你要习惯去使用最新最强的谷歌浏览器。</p>
<p><strong>1. 开启开发者工具的实验性功能</strong></p>
<p>你可以到<code>chrome://flags</code>页面，然后开启<code>Developer Tools experiments</code>选项。</p>
<p>当开启后，在开发者工具的设置页面，可以发现多了一个<code>Experiments</code>选项。如果我使用的一些功能你没有看到，那么请到<code>Experiments</code>窗口打开。</p>
<p><strong>2.超级实验性功能</strong></p>
<p>如果我使用到的功能在<code>Experiments</code>列表没有，那么它可能是一个 WIP 功能(WIP 指 working in progress)。你可以这样开启：页面处在<code>Experiments</code>界面，连续敲击<code>shift</code>键 6 次来开启 WIP 功能。</p>
<img src="/posts/709/Experiments.gif" class="" title="Experiments">

<h3 id="Console"><a href="#Console" class="headerlink" title="Console"></a><strong>Console</strong></h3><p>当 Debug 的时候，我们绝大部分时间是在和 Console 打交道。我们往往在代码中插入很多 Console logs，通过打印变量值来 debug。鉴于 Console 对于我们这么重要，很有必要了解所有开发者工具提供的相关的 APIs 和快捷键。</p>
<p><strong>3. 总是打印对象</strong></p>
<p>我的第一个建议其实和开发者工具没有关系，而是我一直使用的一个技巧。在使用<code>console.log();</code>的时候，不仅仅打印变量，而是要打印对象，用大括号(<code>&#123;&#125;</code>)将变量包围起来。这样的优点是不仅会把变量的值打印，同时还会将变量名打印出来。</p>
<img src="/posts/709/log.png" class="" title="log">
<img src="/posts/709/superlog.png" class="" title="superlog">

<p><strong>4. 使用 console.table 来打印多条目数据</strong></p>
<p>如果你要打印的变量是一个数组，每一个元素都是一个对象。我建议你使用<code>console.table</code>来打印，其表格化的呈现更加美观易读。</p>
<img src="/posts/709/logtable.png" class="" title="logtable">

<p><strong>5. 给 log 加点颜色</strong></p>
<p>log 有时候变得非常多，包含你自己的、一些第三方扩展或者浏览器的 logs。除了使用过滤器(filter)以外，你还可以使用颜色来更好地区分。</p>
<img src="/posts/709/logcolor.png" class="" title="logcolor">

<p><strong>6. $ 和 $$</strong></p>
<p>如果你在 console 下没有任何库使用<code>$</code>和<code>$$</code>，那么你可以使用它们分别作为<code>document.querySelector()</code> 和 <code>document.querySelectorAll()</code>的快捷键。</p>
<p>除了提供了一个更加快捷的方式外，还有一个好处，<code>$$</code>返回一个数组，而不是<a href="http://2ality.com/2013/05/quirk-array-like-objects.html">array-like</a>的<a href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList">NodeList</a>. 所以你可以直接使用<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map">map</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce">reduce</a>和<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter">filter</a> 函数。</p>
<p>你可以使用<code>$$</code>检查页面中的无效链接：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all(</span><br><span class="line">  $$(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    .map(<span class="function"><span class="params">link</span> =&gt;</span> link.href)</span><br><span class="line">    .map(<span class="function"><span class="params">href</span> =&gt;</span> fetch(href))</span><br><span class="line">)</span><br><span class="line">  .then(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;All links working&#x27;</span>))</span><br><span class="line">  .catch(<span class="function">() =&gt;</span> <span class="built_in">console</span>.error(<span class="string">&#x27;Some links are broken&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p><strong>7. $0</strong></p>
<p>如果你想引用某个 DOM 元素，使用<code>$0</code>。<code>$0</code>指向你当前在 Element 中选中的元素。如果指定了<code>$0</code>，<code>$1</code>指向之前选中的元素。以此类推，直到<code>$4</code>都可以使用。</p>
<p><strong>8. $_</strong></p>
<p><code>$_</code>记录了最后一次在 Console 计算的表达式。</p>
<p><strong>9. getEventListeners()</strong></p>
<p><code>getEventListeners(domElement)</code> 返回在 DOM 元素上注册的所有的事件。请看下面的例子：</p>
<img src="/posts/709/getEventListeners.gif" class="" title="getEventListeners">

<p>你也许注意到了，当我在 console 里输入表达式的时候，其结果立即被计算出来了。你可以看到我并没有敲击 Enter 键，而结果已经显示出来。这个是金丝雀版本的一个新功能，叫做”Eager Evaluation”。</p>
<img src="/posts/709/EagerEvaluation.png" class="" title="EagerEvaluation">

<p><strong>10. debug(fn)</strong></p>
<p>在上面的例子中，如果你想在点击按钮后的执行过程中暂停，你可以使用<code>debug</code>函数。<code>debug(fn)</code>接收一个函数作为参数，当每次该函数被调用时，Debugger 就会在该函数的第一行中断执行。</p>
<p>想象一下你要 debug 一个按钮的问题，但是你不知道这个按钮对应的事件函数在代码中什么位置。除了去大量的源代码中慢慢寻找之外，还有一个巧妙的方法。使用<code>getEventListeners</code>函数，然后将<code>debug</code>方法注入进去。这样，当你点击按钮的时候，就会在该函数的第一行停下来。</p>
<p><strong>11. copy(obj)</strong></p>
<p><code>copy(anything)</code> 是一个很有用的工具函数方便你将任何东西拷贝到系统的粘贴板暂存。</p>
<p>给<code>copy</code>函数传入一个没有格式的 JSON，会返回格式化的结果：</p>
<img src="/posts/709/copy.gif" class="" title="copy">

<p><strong>12. Top-level await</strong></p>
<p><code>async/await</code> 使得异步操作变得更加容易和可读。唯一的问题在于<code>await</code>需要在 async 函数中使用。如果我们要在 DevTools 的控制台使用，需要一些特殊的处理，使用<strong>I</strong>mmediately <strong>I</strong>nvoked <strong>A</strong>sync <strong>F</strong>unction <strong>E</strong>xpression (IIAFE). 一点都不方便。好在 DevTools 已经支持直接使用 await 了。</p>
<img src="/posts/709/await.png" class="" title="await">

<h3 id="Debugging-in-the-Sources-panel"><a href="#Debugging-in-the-Sources-panel" class="headerlink" title="Debugging in the Sources panel"></a>Debugging in the Sources panel</h3><p>在 source 面板，使用 breakpoints，stepping-into, stepping-over 等方式，你可以很好地掌控程序的执行状态，来发现代码问题。接下里我不会介绍大家都知道的基础内容，而是一些我经常使用的建议和技巧。</p>
<p><strong>13. 开启 auto-pretty print</strong></p>
<p>在金丝雀版本的实验模式下，你可以开启自动美化代码模式。</p>
<img src="/posts/709/autopre.png" class="" title="autopre">

<p><strong>14. 使用条件断点在生产环境中注入 console logs</strong></p>
<p>断点是一个很棒的功能。但还有一个更棒的：条件断点。只有当设定的条件满足的时候，中断才会执行。也就是说 DevTools 并不会每次都中断程序的执行，而只是在你想要它中断的时候才中断。想了解更多：查看<a href="https://developers.google.com/web/updates/2015/07/set-a-breakpoint-based-on-a-certain-condition">这里</a>.</p>
<p>在生产环境下，因为不能修改源代码，我喜欢使用条件断点来注入 console.log。如果我的断点仅仅是一个 console.log，DevTools 不会中断，因为 console.log 返回 undefined,，是一个 false 的值。但是它会执行我注入的表达式，可以看到输出结果。</p>
<p><a href="https://gitee.com/evestorm/various_resources/raw/master/tools/insertlog.gif"><img src="%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%9120%E4%B8%AAChromeDevTools%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7/insertlog.gif" alt="img"></a></p>
<img src="/posts/709/insertlog.gif" class="" title="insertlog">

<p>为什么不直接使用普通的断点，并且查看变量呢？有时候我并不想这样做。比如，当我在分析那些频繁执行的操作，例如触摸或则滑动。我并不想每一次都导致 Debugger 触发程序中断，但是我想看到程序输出的结果。</p>
<p><strong>15. 暂停 UI 在 Hover 状态下的展示结果</strong></p>
<p>我们很难去检查一个只有在 Hover 状态下展示的元素。比如，如何去检查一个 tooltip？如果你右键并选择检查，元素已经消失了。那么有办法吗？</p>
<p>我是这么操作的：</p>
<ol>
<li>打开 sources 面板</li>
<li>显示 tooltip</li>
<li>使用快捷键来暂停脚本执行(将鼠标停留在暂停的图标上查看快捷键)</li>
<li>回到 Elements 面板，然后像通常一样去检查元素</li>
</ol>
<p><a href="https://gitee.com/evestorm/various_resources/raw/master/tools/tooltips.gif"><img src="%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%9120%E4%B8%AAChromeDevTools%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7/tooltips.gif" alt="img"></a></p>
<img src="/posts/709/tooltips.gif" class="" title="tooltips">

<p><strong>16. XHR breakpoints</strong></p>
<p>如果想要理解一个请求是如何执行的，可以使用 sources 面板的 XHR breakpoints。</p>
<p><strong>17. 使用 DevTools 作为 IDE</strong></p>
<p>DevTools 的 source 面板可以说相当强大。你可以快速查找，跳转到某一行，某个函数，执行一段代码，使用多行光标等等。这些功能在<a href="https://medium.com/google-developers/devtools-tips-for-sublime-text-users-cdd559ee80f8">这篇 medium 文章中有详细描述</a>。</p>
<p>既然如此，为啥不把整个开发都搬到这里呢。这样就不需要浪费时间切换 IDE 和浏览器了。</p>
<p>如果你有一个使用<a href="https://github.com/facebook/create-react-app">create-react-app</a>或则<a href="https://github.com/vuejs/vue-cli">vue-cli</a>构建的项目，你可以直接把整个文件夹拖到 Sources 面板下。DevTools 会自动对所有文件做映射。所以，你可以在 DevTools 下修改文件并立即查看。这样，整个开发效率，特别是 Debugging 效率绝对提高了。</p>
<img src="/posts/709/ide.gif" class="" title="ide">

<p><strong>18. 使用 network overrides 来简单调试生产代码</strong></p>
<p>如果你正在 Debugging 一个生产环境下面的 bug，你可以使用<code>network overrides</code>来调试，而不用在本地搭建整个配置。</p>
<p>你可以很容易将任何远程的资源下载一份本地的版本，然后可以在 DevTools 下编辑，并且 DevTools 会更新展示你编辑后的文件。</p>
<img src="/posts/709/networkoverrides.gif" class="" title="networkoverrides">

<p>在生产环境下，也可以很容易 Debugging，并且做一些性能上的测试也变得容易。</p>
<h3 id="19-Nodejs-debugging"><a href="#19-Nodejs-debugging" class="headerlink" title="19. Nodejs debugging"></a><strong>19. Nodejs debugging</strong></h3><p>如果你想使用 DevTools 的 Debugger 来 debug Node.js 应用，你可以使用<code>--inspect-brk</code> flag 来开启：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">node --inspect-brk script.js</span><br></pre></td></tr></table></figure>

<p>跳转到<code>chrome://inspect</code>页面，在<code>Remote Target</code>选项，可以看到 Node 程序。</p>
<p>并且，在 DevTools 中你会看到一个绿色的 Node 图标，点击图标会打开针对 Node 的 Chrome Debugger。</p>
<p><a href="https://gitee.com/evestorm/various_resources/raw/master/tools/node-debuger.gif"><img src="%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%9120%E4%B8%AAChromeDevTools%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7/node-debuger.gif" alt="img"></a></p>
<img src="/posts/709/node-debuger.gif" class="" title="node-debuger">

<p>如果你想要用 DevTools Debugger 来 debug 你的单元测试，你需要这样调用：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copynode --inspect-brk .&#x2F;node_modules&#x2F;.bin&#x2F;jest</span><br></pre></td></tr></table></figure>

<p>不过这样做其实很麻烦，我们需要自己找到相应的路径。 GoogleChromeLabs 最近发布了一个新的工具非常好用，叫做：<a href="https://github.com/GoogleChromeLabs/ndb">ndb</a>。使用 ndb，你只需要：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ndb npx jest</span><br></pre></td></tr></table></figure>

<p>如果你有一个自定义的脚本，你可以这样调用：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ndb npm run unit</span><br></pre></td></tr></table></figure>

<p>更妙的是，如果你在一个有配置<code>package.json</code>的项目下调用<code>ndb</code>，他甚至会自动分析 package.json 中的脚本，方便你直接使用 DevTools。</p>
<p><strong>20. 使用 Snippets 来辅助 Debugging</strong></p>
<p>DevTools 提供了一个可以创建和保存小段代码的工具，我很喜欢用它们来加速我的工作。比如 lodashify —  可以快速给任何应用添加 lodash。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">  &#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> element = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">  element.src =</span><br><span class="line">    <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.15.0/lodash.min.js&#x27;</span>;</span><br><span class="line">  element.type = <span class="string">&#x27;text/javascript&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.head.appendChild(element);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>另一个小的工具函数式用来增强对象的属性，每次被访问或则修改，它都会提供给我充分的信息，比如谁访问了，谁更改了它。在 Debugging 的时候，非常有用。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> traceProperty = <span class="function">(<span class="params">object, property</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> value = object[property];</span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(object, property, &#123;</span><br><span class="line">    <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.trace(<span class="string">`<span class="subst">$&#123;property&#125;</span> requested`</span>);</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">set</span>(<span class="params">newValue</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.trace(<span class="string">`setting <span class="subst">$&#123;property&#125;</span> to `</span>, newValue);</span><br><span class="line">      value = newValue;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a href="https://gitee.com/evestorm/various_resources/raw/master/tools/methodtools.gif"><img src="%E3%80%90%E8%BD%AC%E8%BD%BD%E3%80%9120%E4%B8%AAChromeDevTools%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7/methodtools.gif" alt="img"></a></p>
<img src="/posts/709/methodtools.gif" class="" title="methodtools">

<p>还有很多非常有用的<a href="http://bgrins.github.io/devtools-snippets/">devtools 代码片段</a>，你可以直接拿去使用。</p>
<h3 id="关于-Fundebug"><a href="#关于-Fundebug" class="headerlink" title="关于 Fundebug"></a>关于 Fundebug</h3><p><a href="https://www.fundebug.com/">Fundebug</a>专注于 JavaScript、微信小程序、微信小游戏、支付宝小程序、React Native、Node.js 和 Java 实时 BUG 监控。 自从 2016 年双十一正式上线，Fundebug 累计处理了 6 亿+错误事件，得到了 Google、360、金山软件等众多知名用户的认可。欢迎免费试用！</p>
<p>版权声明:<br>转载时请注明作者 Fundebug 以及本文地址：<br><a href="https://blog.fundebug.com/2018/08/22/art-of-debugging-with-chrome-devtools/">https://blog.fundebug.com/2018/08/22/art-of-debugging-with-chrome-devtools/</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>浏览器</category>
      </categories>
      <tags>
        <tag>技巧</tag>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】使用Object键值替换Switch</title>
    <url>/posts/10849/</url>
    <content><![CDATA[<p>转载地址：<a href="https://www.cnblogs.com/ZerlinM/p/13595810.html">https://www.cnblogs.com/ZerlinM/p/13595810.html</a><br>原文地址：<a href="https://ultimatecourses.com/blog/deprecating-the-switch-statement-for-object-literals">https://ultimatecourses.com/blog/deprecating-the-switch-statement-for-object-literals</a></p>
<p>在许多编程语言中，switch 语句存在 - 但是它应该更长吗？如果你是一个 JavaScript 程序员，你经常跳进和跳出对象，创建，实例化和操作它们。对象非常灵活，它们是 JavaScript 中几乎所有内容的核心，使用它们代替 switch 语句是我最近一直在做的事情。</p>
<a id="more"></a>

<h2 id="什么是-switch-语句"><a href="#什么是-switch-语句" class="headerlink" title="什么是 switch 语句?"></a>什么是 switch 语句?</h2><p>如果您以前没有使用 switch 过或者有点不确定它是做什么的，那么让我们来看看吧。什么 switch 是输入并提供输出，例如正在运行的代码。<br>让我们来看一个通常的 switch 陈述：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> type = <span class="string">&#x27;coke&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> drink;</span><br><span class="line"><span class="keyword">switch</span> (type) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;coke&#x27;</span>:</span><br><span class="line">    drink = <span class="string">&#x27;Coke&#x27;</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;pepsi&#x27;</span>:</span><br><span class="line">    drink = <span class="string">&#x27;Pepsi&#x27;</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    drink = <span class="string">&#x27;Unknown drink!&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(drink); <span class="comment">// &#x27;Coke&#x27;</span></span><br></pre></td></tr></table></figure>

<p>它类似于 if 和 else 语句，但它应该评估单个值 - 在 switch 我们使用 a case 来评估每个值。<br>当你开始看到很多 else if 陈述时，某些东西可能是错误的，通常你会使用类似于 switch 它更适合目的和意图的东西。这是一些 else if 滥用：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDrink</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (type === <span class="string">&#x27;coke&#x27;</span>) &#123;</span><br><span class="line">    type = <span class="string">&#x27;Coke&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&#x27;pepsi&#x27;</span>) &#123;</span><br><span class="line">    type = <span class="string">&#x27;Pepsi&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&#x27;mountain dew&#x27;</span>) &#123;</span><br><span class="line">    type = <span class="string">&#x27;Mountain Dew&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&#x27;lemonade&#x27;</span>) &#123;</span><br><span class="line">    type = <span class="string">&#x27;Lemonade&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&#x27;fanta&#x27;</span>) &#123;</span><br><span class="line">    type = <span class="string">&#x27;Fanta&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// acts as our &quot;default&quot;</span></span><br><span class="line">    type = <span class="string">&#x27;Unknown drink!&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;You&#x27;ve picked a &quot;</span> + type;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个实现太松散了，有错误的余地，加上它是一个非常冗长的语法，可以不断重复自己。还有一个黑客攻击的空间，因为你可以评估每个内部的多个表达式 else if，例如 else if (type === ‘coke’ &amp;&amp; somethingElse ！== ‘apples’)。这 switch 是该工作的最佳工具，尽管您需要不断添加 break;语句以防止案件失败，这是其众多问题之一。</p>
<h2 id="开关问题"><a href="#开关问题" class="headerlink" title="开关问题"></a>开关问题</h2><p>switch 从程序控制流程到其处理代码块的非标准方式存在多个问题，其余的 JavaScript 使用花括号而交换机则不然。从语法上讲，它不是 JavaScript 的最佳选择，也不是它的设计。我们被迫 break;在每个语句中手动添加语句 case，这可能导致难以调试和嵌套错误，如果我们忘记了！道格拉斯·克罗克福德（Douglas Crockford）曾多次撰写和谈论过这个问题，他的建议是谨慎对待。</p>
<p>我们经常在 JavaScript 中使用 Object 查找，通常用于我们永远不会考虑使用的东西 switch- 那么为什么不使用 Object 键值替换 switch？对象更灵活，具有更好的可读性和可维护性，我们不需要手动 break;每个“案例”。他们对新的 JavaScript 开发人员也很友好，因为他们是标准对象。</p>
<p>随着“案例”数量的增加，对象（哈希表）的性能优于交换机的平均成本（案例的顺序很重要）。对象方法是哈希表查找，并且交换机必须评估每个案例，直到它遇到匹配和中断。</p>
<h2 id="对象文本查找"><a href="#对象文本查找" class="headerlink" title="对象文本查找"></a>对象文本查找</h2><p>我们一直使用对象，无论是构造函数还是文字。通常，我们将它们用于对象查找目的，以从 Object 属性中获取值。<br>让我们设置一个 String 仅返回值的简单 Object 键值。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDrink</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> drinks = &#123;</span><br><span class="line">    coke: <span class="string">&#x27;Coke&#x27;</span>,</span><br><span class="line">    pepsi: <span class="string">&#x27;Pepsi&#x27;</span>,</span><br><span class="line">    lemonade: <span class="string">&#x27;Lemonade&#x27;</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">&#x27;Default item&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;The drink I chose was &#x27;</span> + (drinks[type] || drinks[<span class="string">&#x27;default&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> drink = getDrink(<span class="string">&#x27;coke&#x27;</span>);</span><br><span class="line"><span class="comment">// The drink I chose was Coke</span></span><br><span class="line"><span class="built_in">console</span>.log(drink);</span><br></pre></td></tr></table></figure>

<p>我们从交换机中保存了几行代码，对我而言，数据在演示中更加清晰。我们甚至可以进一步简化它，没有默认情况：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDrink</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="string">&#x27;The drink I chose was &#x27;</span> +</span><br><span class="line">    &#123;</span><br><span class="line">      coke: <span class="string">&#x27;Coke&#x27;</span>,</span><br><span class="line">      pepsi: <span class="string">&#x27;Pepsi&#x27;</span>,</span><br><span class="line">      lemonade: <span class="string">&#x27;Lemonade&#x27;</span></span><br><span class="line">    &#125;[type]</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是，我们可能需要比 a 更复杂的代码 String，这可能会挂在函数内部。为了简洁和易于理解的示例，我将从新创建的函数返回上述字符串：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> type = <span class="string">&#x27;coke&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> drinks = &#123;</span><br><span class="line">  coke: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Coke&#x27;</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  pepsi: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Pepsi&#x27;</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  lemonade: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Lemonade&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>区别在于我们需要调用 Object 文字的函数：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">drinks[type]();</span><br></pre></td></tr></table></figure>

<p>更具可维护性和可读性。我们也不必担心 break;陈述和案例会失败-这只是一个普通的对象。<br>通常，我们会 switch 在函数内部放入一个 return 值，因此在这里做同样的事情，然后将对象文字查找转换为可用的函数：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDrink</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> drinks = &#123;</span><br><span class="line">    coke: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Coke&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    pepsi: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Pepsi&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    lemonade: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Lemonade&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> drinks[type]();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let&#x27;s call it</span></span><br><span class="line"><span class="keyword">var</span> drink = getDrink(<span class="string">&#x27;coke&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(drink); <span class="comment">// &#x27;Coke&#x27;</span></span><br></pre></td></tr></table></figure>

<p>不错，很容易，但这并不能满足“ default”的要求 case，因此我们可以轻松创建它：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDrink</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> fn;</span><br><span class="line">  <span class="keyword">var</span> drinks = &#123;</span><br><span class="line">    coke: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Coke&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    pepsi: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Pepsi&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    lemonade: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Lemonade&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">default</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Default item&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// if the drinks Object contains the type</span></span><br><span class="line">  <span class="comment">// passed in, let&#x27;s use it</span></span><br><span class="line">  <span class="keyword">if</span> (drinks[type]) &#123;</span><br><span class="line">    fn = drinks[type];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// otherwise we&#x27;ll assign the default</span></span><br><span class="line">    <span class="comment">// also the same as drinks.default</span></span><br><span class="line">    <span class="comment">// it&#x27;s just a little more consistent using square</span></span><br><span class="line">    <span class="comment">// bracket notation everywhere</span></span><br><span class="line">    fn = drinks[<span class="string">&#x27;default&#x27;</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fn();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// called with &quot;dr pepper&quot;</span></span><br><span class="line"><span class="keyword">var</span> drink = getDrink(<span class="string">&#x27;dr pepper&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(drink); <span class="comment">// &#x27;Default item&#x27;</span></span><br></pre></td></tr></table></figure>

<p>我们可以简化上面的内容，if 并在表达式中 else 使用 or ||运算符：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDrink</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> drinks = &#123;</span><br><span class="line">    coke: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Coke&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    pepsi: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Pepsi&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    lemonade: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Lemonade&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">default</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;Default item&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> (drinks[type] || drinks[<span class="string">&#x27;default&#x27;</span>])();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这会将两个对象查找包装在括号内( )，将它们视为表达式。然后调用表达式的结果。如果 drinks[type]在查找中未找到，则默认为 drinks[‘default’]，简单！<br>我们不具备总是 return 里面的函数或者，我们可以改变引用任何变量然后返回它：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDrink</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> drink;</span><br><span class="line">  <span class="keyword">var</span> drinks = &#123;</span><br><span class="line">    coke: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      drink = <span class="string">&#x27;Coke&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    pepsi: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      drink = <span class="string">&#x27;Pepsi&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    lemonade: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      drink = <span class="string">&#x27;Lemonade&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">default</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      drink = <span class="string">&#x27;Default item&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// invoke it</span></span><br><span class="line">  (drinks[type] || drinks[<span class="string">&#x27;default&#x27;</span>])();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// return a String with chosen drink</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;The drink I chose was &#x27;</span> + drink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> drink = getDrink(<span class="string">&#x27;coke&#x27;</span>);</span><br><span class="line"><span class="comment">// The drink I chose was Coke</span></span><br><span class="line"><span class="built_in">console</span>.log(drink);</span><br></pre></td></tr></table></figure>

<p>这些是非常基本的解决方案，而 Object 字面量包含一个 function 返回 a 的值 String，在您只需要 a 的情况下 String，可以将 a String 用作键的值-在某些情况下，该函数将包含逻辑，该逻辑将从该函数返回。如果您要混合使用函数和字符串，则始终可以使用函数来保存查找 type 和调用（如果是函数）会更容易-我们不想尝试调用 String。</p>
<h2 id="对象字面量“告吹”"><a href="#对象字面量“告吹”" class="headerlink" title="对象字面量“告吹”"></a>对象字面量“告吹”</h2><p>对于 switch 案例，我们可以让它们失败（这意味着一个以上的案例可以应用于特定的代码段）：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> type = <span class="string">&#x27;coke&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> snack;</span><br><span class="line"><span class="keyword">switch</span> (type) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;coke&#x27;</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;pepsi&#x27;</span>:</span><br><span class="line">    snack = <span class="string">&#x27;Drink&#x27;</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;cookies&#x27;</span>:</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;crisps&#x27;</span>:</span><br><span class="line">    snack = <span class="string">&#x27;Food&#x27;</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    drink = <span class="string">&#x27;Unknown type!&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(snack); <span class="comment">// &#x27;Drink&#x27;</span></span><br></pre></td></tr></table></figure>

<p>让我们 coke 和 pepsi“贯穿”以不添加 break 语句。为 Object Literals 执行此操作非常简单且更具说明性 - 并且不易出错。我们的代码突然变得更加结构化，可读性和可重用性：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSnack</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> snack;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">isDrink</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (snack = <span class="string">&#x27;Drink&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">isFood</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (snack = <span class="string">&#x27;Food&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> snacks = &#123;</span><br><span class="line">    coke: isDrink,</span><br><span class="line">    pepsi: isDrink,</span><br><span class="line">    cookies: isFood,</span><br><span class="line">    crisps: isFood</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> snacks[type]();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> snack = getSnack(<span class="string">&#x27;coke&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(snack); <span class="comment">// &#x27;Drink&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Object 键值是 JavaScript 中流动的一种更自然的控制，switch 有点陈旧和笨重，并且容易出现调试错误。对象更具可扩展性，可维护性，我们可以更好地测试它们。它们也是设计模式的一部分，在日常的其他编程任务中非常常用。对象键值可以包含函数以及任何其他对象类型，这使它们非常灵活！键值中的每个函数也都有函数作用域，因此我们可以从我们调用的父函数 getDrink 返回闭包（在这种情况下返回闭包）。</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>技巧</tag>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】彻底理解cookie-session-token</title>
    <url>/posts/44111/</url>
    <content><![CDATA[<h2 id="发展史"><a href="#发展史" class="headerlink" title="发展史"></a>发展史</h2><p>1、很久很久以前，Web 基本上就是文档的浏览而已， 既然是浏览，作为服务器， 不需要记录谁在某一段时间里都浏览了什么文档，每次请求都是一个新的HTTP协议， 就是请求加响应， 尤其是我不用记住是谁刚刚发了HTTP请求， 每个请求对我来说都是全新的。这段时间很嗨皮</p>
<p>2、但是随着交互式Web应用的兴起，像在线购物网站，需要登录的网站等等，马上就面临一个问题，那就是要管理会话，必须记住哪些人登录系统， 哪些人往自己的购物车中放商品， 也就是说我必须把每个人区分开，这就是一个不小的挑战，因为HTTP请求是无状态的，所以想出的办法就是给大家发一个会话标识(session id), 说白了就是一个随机的字串，每个人收到的都不一样， 每次大家向我发起HTTP请求的时候，把这个字符串给一并捎过来， 这样我就能区分开谁是谁了</p>
<p>3、这样大家很嗨皮了，可是服务器就不嗨皮了，每个人只需要保存自己的session id，而服务器要保存所有人的session id ！ 如果访问服务器多了， 就得由成千上万，甚至几十万个。</p>
<p>这对服务器说是一个巨大的开销 ， 严重的限制了服务器扩展能力， 比如说我用两个机器组成了一个集群， 小F通过机器A登录了系统， 那session id会保存在机器A上， 假设小F的下一次请求被转发到机器B怎么办？ 机器B可没有小F的 session id啊。</p>
<p>有时候会采用一点小伎俩： session sticky ， 就是让小F的请求一直粘连在机器A上， 但是这也不管用， 要是机器A挂掉了， 还得转到机器B去。</p>
<p>那只好做session 的复制了， 把session id 在两个机器之间搬来搬去， 快累死了。</p>
<a id="more"></a>

<img src="/posts/44111/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A11.png" class="" title="负载均衡1">

<p>后来有个叫Memcached的支了招： 把session id 集中存储到一个地方， 所有的机器都来访问这个地方的数据， 这样一来，就不用复制了， 但是增加了单点失败的可能性， 要是那个负责session 的机器挂了， 所有人都得重新登录一遍， 估计得被人骂死。</p>
<img src="/posts/44111/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A12.png" class="" title="负载均衡2">

<p>也尝试把这个单点的机器也搞出集群，增加可靠性， 但不管如何， 这小小的session 对我来说是一个沉重的负担</p>
<p>4、于是有人就一直在思考， 我为什么要保存这可恶的session呢， 只让每个客户端去保存该多好？</p>
<p>可是如果不保存这些session id , 怎么验证客户端发给我的session id 的确是我生成的呢？ 如果不去验证，我们都不知道他们是不是合法登录的用户， 那些不怀好意的家伙们就可以伪造session id , 为所欲为了。</p>
<p>嗯，对了，关键点就是验证 ！</p>
<p>比如说， 小F已经登录了系统， 我给他发一个令牌(token)， 里边包含了小F的 user id， 下一次小F 再次通过Http 请求访问我的时候， 把这个token 通过Http header 带过来不就可以了。</p>
<p>不过这和session id没有本质区别啊， 任何人都可以可以伪造， 所以我得想点儿办法， 让别人伪造不了。</p>
<p>那就对数据做一个签名吧， 比如说我用HMAC-SHA256 算法，加上一个只有我才知道的密钥， 对数据做一个签名， 把这个签名和数据一起作为token ， 由于密钥别人不知道， 就无法伪造token了。</p>
<img src="/posts/44111/token%E7%AE%97%E6%B3%95.png" class="" title="token算法">

<p>这个token 我不保存， 当小F把这个token 给我发过来的时候，我再用同样的HMAC-SHA256 算法和同样的密钥，对数据再计算一次签名， 和token 中的签名做个比较， 如果相同， 我就知道小F已经登录过了，并且可以直接取到小F的user id , 如果不相同， 数据部分肯定被人篡改过， 我就告诉发送者： 对不起，没有认证。</p>
<img src="/posts/44111/token%E9%AA%8C%E8%AF%81.png" class="" title="token验证">

<p>Token 中的数据是明文保存的（虽然我会用Base64做下编码， 但那不是加密）， 还是可以被别人看到的， 所以我不能在其中保存像密码这样的敏感信息。</p>
<p>当然， 如果一个人的token 被别人偷走了， 那我也没办法， 我也会认为小偷就是合法用户， 这其实和一个人的session id 被别人偷走是一样的。</p>
<p>这样一来， 我就不保存session id 了， 我只是生成token , 然后验证token ， 我用我的CPU计算时间获取了我的session 存储空间 ！</p>
<p>解除了session id这个负担， 可以说是无事一身轻， 我的机器集群现在可以轻松地做水平扩展， 用户访问量增大， 直接加机器就行。 这种无状态的感觉实在是太好了！</p>
<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>cookie 是一个非常具体的东西，指的就是浏览器里面能永久存储的一种数据，仅仅是浏览器实现的一种数据存储功能。</p>
<p>cookie由服务器生成，发送给浏览器，浏览器把cookie以kv形式保存到某个目录下的文本文件内，下一次请求同一网站时会把该cookie发送给服务器。由于cookie是存在客户端上的，所以浏览器加入了一些限制确保cookie不会被恶意使用，同时不会占据太多磁盘空间，所以每个域的cookie数量是有限的。</p>
<h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><p>session 从字面上讲，就是会话。这个就类似于你和一个人交谈，你怎么知道当前和你交谈的是张三而不是李四呢？对方肯定有某种特征（长相等）表明他就是张三。</p>
<p>session 也是类似的道理，服务器要知道当前发请求给自己的是谁。为了做这种区分，服务器就要给每个客户端分配不同的“身份标识”，然后客户端每次向服务器发请求的时候，都带上这个“身份标识”，服务器就知道这个请求来自于谁了。至于客户端怎么保存这个“身份标识”，可以有很多种方式，对于浏览器客户端，大家都默认采用 cookie 的方式。</p>
<p>服务器使用session把用户的信息临时保存在了服务器上，用户离开网站后session会被销毁。这种用户信息存储方式相对cookie来说更安全，可是session有一个缺陷：如果web服务器做了负载均衡，那么下一个操作请求到了另一台服务器的时候session会丢失。</p>
<h2 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h2><p>在Web领域基于Token的身份验证随处可见。在大多数使用Web API的互联网公司中，tokens 是多用户下处理认证的最佳方式。</p>
<p>以下几点特性会让你在程序中使用基于Token的身份验证</p>
<ol>
<li>无状态、可扩展</li>
<li>支持移动设备</li>
<li>跨程序调用</li>
<li>安全</li>
</ol>
<p>那些使用基于Token的身份验证的大佬们</p>
<p>大部分你见到过的API和Web应用都使用tokens。例如Facebook, Twitter, Google+, GitHub等。</p>
<h3 id="Token的起源"><a href="#Token的起源" class="headerlink" title="Token的起源"></a>Token的起源</h3><p>在介绍基于Token的身份验证的原理与优势之前，不妨先看看之前的认证都是怎么做的。</p>
<h4 id="基于服务器的验证"><a href="#基于服务器的验证" class="headerlink" title="基于服务器的验证"></a>基于服务器的验证</h4><p>我们都是知道HTTP协议是无状态的，这种无状态意味着程序需要验证每一次请求，从而辨别客户端的身份。</p>
<p>在这之前，程序都是通过在服务端存储的登录信息来辨别请求的。这种方式一般都是通过存储Session来完成。</p>
<p>下图展示了基于服务器验证的原理</p>
<img src="/posts/44111/session.png" class="" title="session">

<p>随着Web，应用程序，已经移动端的兴起，这种验证的方式逐渐暴露出了问题。尤其是在可扩展性方面。</p>
<h4 id="基于服务器验证方式暴露的一些问题"><a href="#基于服务器验证方式暴露的一些问题" class="headerlink" title="基于服务器验证方式暴露的一些问题"></a>基于服务器验证方式暴露的一些问题</h4><ol>
<li>Session：每次认证用户发起请求时，服务器需要去创建一个记录来存储信息。当越来越多的用户发请求时，内存的开销也会不断增加。</li>
<li>可扩展性：在服务端的内存中使用Seesion存储登录信息，伴随而来的是可扩展性问题。</li>
<li>CORS(跨域资源共享)：当我们需要让数据跨多台移动设备上使用时，跨域资源的共享会是一个让人头疼的问题。在使用Ajax抓取另一个域的资源，就可以会出现禁止请求的情况。</li>
<li>CSRF(跨站请求伪造)：用户在访问银行网站时，他们很容易受到跨站请求伪造的攻击，并且能够被利用其访问其他的网站。</li>
</ol>
<p>在这些问题中，可扩展行是最突出的。因此我们有必要去寻求一种更有行之有效的方法。</p>
<h4 id="基于Token的验证原理"><a href="#基于Token的验证原理" class="headerlink" title="基于Token的验证原理"></a>基于Token的验证原理</h4><p>基于Token的身份验证是无状态的，我们不将用户信息存在服务器或Session中。</p>
<p>这种概念解决了在服务端存储信息时的许多问题</p>
<p>NoSession意味着你的程序可以根据需要去增减机器，而不用去担心用户是否登录。</p>
<p>基于Token的身份验证的过程如下:</p>
<ol>
<li>用户通过用户名和密码发送请求。</li>
<li>程序验证。</li>
<li>程序返回一个签名的token 给客户端。</li>
<li>客户端储存token,并且每次用于每次发送请求。</li>
<li>服务端验证token并返回数据。</li>
</ol>
<p>每一次请求都需要token。token应该在HTTP的头部发送从而保证了Http请求无状态。我们同样通过设置服务器属性Access-Control-Allow-Origin: *，让服务器能接受到来自所有域的请求。需要主要的是，在ACAO头部标明(designating)*时，不得带有像HTTP认证，客户端SSL证书和cookies的证书。</p>
<p>实现思路：</p>
<img src="/posts/44111/token%E6%B5%81%E7%A8%8B.png" class="" title="token流程">

<ol>
<li>用户登录校验，校验成功后就返回Token给客户端。</li>
<li>客户端收到数据后保存在客户端</li>
<li>客户端每次访问API是携带Token到服务器端。</li>
<li>服务器端采用filter过滤器校验。校验成功则返回请求数据，校验失败则返回错误码</li>
</ol>
<p>当我们在程序中认证了信息并取得token之后，我们便能通过这个Token做许多的事情。</p>
<p>我们甚至能基于创建一个基于权限的token传给第三方应用程序，这些第三方程序能够获取到我们的数据（当然只有在我们允许的特定的token）</p>
<h4 id="Tokens的优势"><a href="#Tokens的优势" class="headerlink" title="Tokens的优势"></a>Tokens的优势</h4><p><strong>无状态、可扩展</strong></p>
<p>在客户端存储的Tokens是无状态的，并且能够被扩展。基于这种无状态和不存储Session信息，负载负载均衡器能够将用户信息从一个服务传到其他服务器上。</p>
<p>如果我们将已验证的用户的信息保存在Session中，则每次请求都需要用户向已验证的服务器发送验证信息(称为Session亲和性)。用户量大时，可能会造成一些拥堵。</p>
<p>但是不要着急。使用tokens之后这些问题都迎刃而解，因为tokens自己hold住了用户的验证信息。</p>
<p><strong>安全性</strong></p>
<p>请求中发送token而不再是发送cookie能够防止CSRF(跨站请求伪造)。即使在客户端使用cookie存储token，cookie也仅仅是一个存储机制而不是用于认证。不将信息存储在Session中，让我们少了对session操作。</p>
<p>token是有时效的，一段时间之后用户需要重新验证。我们也不一定需要等到token自动失效，token有撤回的操作，通过token revocataion可以使一个特定的token或是一组有相同认证的token无效。</p>
<p><strong>可扩展性</strong></p>
<p>Tokens能够创建与其它程序共享权限的程序。例如，能将一个随便的社交帐号和自己的大号(Fackbook或是Twitter)联系起来。当通过服务登录Twitter(我们将这个过程Buffer)时，我们可以将这些Buffer附到Twitter的数据流上(we are allowing Buffer to post to our Twitter stream)。</p>
<p>使用tokens时，可以提供可选的权限给第三方应用程序。当用户想让另一个应用程序访问它们的数据，我们可以通过建立自己的API，得出特殊权限的tokens。</p>
<p><strong>多平台跨域</strong></p>
<p>我们提前先来谈论一下CORS(跨域资源共享)，对应用程序和服务进行扩展的时候，需要介入各种各种的设备和应用程序。</p>
<p>Having our API just serve data, we can also make the design choice to serve assets from a CDN. This eliminates the issues that CORS brings up after we set a quick header configuration for our application.</p>
<p>只要用户有一个通过了验证的token，数据和资源就能够在任何域上被请求到。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Access-Control-Allow-Origin: *</span><br></pre></td></tr></table></figure>

<h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p><a href="https://zhuanlan.zhihu.com/p/63061864">https://zhuanlan.zhihu.com/p/63061864</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>缓存</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】滚动视差-CSS不在话下</title>
    <url>/posts/56953/</url>
    <content><![CDATA[<p>掘金链接：<a href="https://juejin.im/post/5b6d0756e51d4562b31ad23c">https://juejin.im/post/5b6d0756e51d4562b31ad23c</a></p>
<p>github 链接：<a href="https://github.com/chokcoco/iCSS/issues/37">https://github.com/chokcoco/iCSS/issues/37</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>一些有用的npm包</title>
    <url>/posts/44396/</url>
    <content><![CDATA[<h2 id="runjs"><a href="#runjs" class="headerlink" title="runjs"></a>runjs</h2><blockquote>
<p>已改名为 tasksfile ，<code>npm install tasksfile</code> 代替</p>
</blockquote>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>一个小型构件工具</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install runjs -D</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>在根项目目录中创建 <code>runfile.js</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; run &#125; = <span class="built_in">require</span>(<span class="string">&#x27;runjs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params">name = <span class="string">&#x27;Mysterious&#x27;</span></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Hello <span class="subst">$&#123;name&#125;</span>!`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makedir</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  run(<span class="string">&#x27;mkdir somedir&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  hello,</span><br><span class="line">  makedir</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在你的终端中执行：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npx run hello Tommy</span></span><br><span class="line">Hello Tommy!</span><br><span class="line"><span class="meta">$</span><span class="bash"> npx run makedir</span></span><br><span class="line">mkdir somedir</span><br></pre></td></tr></table></figure>

<h2 id="chalk"><a href="#chalk" class="headerlink" title="chalk"></a>chalk</h2><h3 id="介绍-1"><a href="#介绍-1" class="headerlink" title="介绍"></a>介绍</h3><p>给 <code>终端</code> 字符串设置样式</p>
<h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install chalk</span><br></pre></td></tr></table></figure>

<h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">&#x27;chalk&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(chalk.blue(<span class="string">&#x27;Hello world!&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h2><h3 id="介绍-2"><a href="#介绍-2" class="headerlink" title="介绍"></a>介绍</h3><p>Connect 是一个可扩展的 HTTP 服务器框架，用于 node，使用称为中间件的“插件”。</p>
<h3 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install connect</span><br></pre></td></tr></table></figure>

<h3 id="使用-2"><a href="#使用-2" class="headerlink" title="使用"></a>使用</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">var connect = require(&#x27;connect&#x27;);</span><br><span class="line">var http = require(&#x27;http&#x27;);</span><br><span class="line"></span><br><span class="line">var app = connect();</span><br><span class="line"></span><br><span class="line">// gzip/deflate outgoing responses</span><br><span class="line">var compression = require(&#x27;compression&#x27;);</span><br><span class="line">app.use(compression());</span><br><span class="line"></span><br><span class="line">// store session state in browser cookie</span><br><span class="line">var cookieSession = require(&#x27;cookie-session&#x27;);</span><br><span class="line">app.use(cookieSession(&#123;</span><br><span class="line">    keys: [&#x27;secret1&#x27;, &#x27;secret2&#x27;]</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">// parse urlencoded request bodies into req.body</span><br><span class="line">var bodyParser = require(&#x27;body-parser&#x27;);</span><br><span class="line">app.use(bodyParser.urlencoded(&#123;extended: false&#125;));</span><br><span class="line"></span><br><span class="line">// respond to all requests</span><br><span class="line">app.use(function(req, res)&#123;</span><br><span class="line">  res.end(&#x27;Hello from Connect!\n&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//create node.js http server and listen on port</span><br><span class="line">http.createServer(app).listen(3000);</span><br></pre></td></tr></table></figure>

<h2 id="serve-static"><a href="#serve-static" class="headerlink" title="serve-static"></a>serve-static</h2><h3 id="介绍-3"><a href="#介绍-3" class="headerlink" title="介绍"></a>介绍</h3><p>一款静态资源管理器</p>
<h3 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install serve-static</span><br></pre></td></tr></table></figure>

<h3 id="使用-3"><a href="#使用-3" class="headerlink" title="使用"></a>使用</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>),</span><br><span class="line">  url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>),</span><br><span class="line">  fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> serveStatic = <span class="built_in">require</span>(<span class="string">&#x27;serve-static&#x27;</span>),</span><br><span class="line">  <span class="comment">//finalhandler 是 serveStatic 的依赖，不需要特意安装。</span></span><br><span class="line">  finalhandler = <span class="built_in">require</span>(<span class="string">&#x27;finalhandler&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置静态资源服务 (&quot;要静态化的文件路径&quot;,&#123;默认主页的配置&#125;);</span></span><br><span class="line"><span class="keyword">var</span> serve = serveStatic(<span class="string">&#x27;public&#x27;</span>, &#123; <span class="attr">index</span>: [<span class="string">&#x27;index.html&#x27;</span>, <span class="string">&#x27;index.htm&#x27;</span>] &#125;);</span><br><span class="line">http</span><br><span class="line">  .createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//路由清单</span></span><br><span class="line">    <span class="keyword">if</span> (req.url == <span class="string">&#x27;/music&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">//也让其显示 根目录public 下的主页</span></span><br><span class="line">      fs.readFile(<span class="string">&#x27;./public/index.html&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          res.end(<span class="string">&#x27;没有此文件!&#x27;</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">        res.end(data.toString());</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">//读取并呈递完毕之后,在路由中加上return,</span></span><br><span class="line">      <span class="comment">//否则下面的静态资源服务里面会一直寻找这个路由，</span></span><br><span class="line">      <span class="comment">//这个路由是虚拟出来的，因此不会呈递上面我们去读的文件</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用静态资源服务，一般放在中间件最下方，不至于遮蔽中间件的路由</span></span><br><span class="line">    serve(req, res, finalhandler(req, res));</span><br><span class="line">  &#125;)</span><br><span class="line">  .listen(<span class="number">8888</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;ok&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="mockjs"><a href="#mockjs" class="headerlink" title="mockjs"></a>mockjs</h2><h3 id="介绍-4"><a href="#介绍-4" class="headerlink" title="介绍"></a>介绍</h3><p>生成随机数据，拦截 Ajax 请求</p>
<h3 id="安装-4"><a href="#安装-4" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install mockjs</span><br></pre></td></tr></table></figure>

<h3 id="使用-4"><a href="#使用-4" class="headerlink" title="使用"></a>使用</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 使用 Mock</span></span><br><span class="line"><span class="keyword">var</span> Mock = <span class="built_in">require</span>(<span class="string">&#x27;mockjs&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> data = Mock.mock(&#123;</span><br><span class="line">  <span class="comment">// 属性 list 的值是一个数组，其中含有 1 到 10 个元素</span></span><br><span class="line">  <span class="string">&#x27;list|1-10&#x27;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// 属性 id 是一个自增数，起始值为 1，每次增 1</span></span><br><span class="line">      <span class="string">&#x27;id|+1&#x27;</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(data, <span class="literal">null</span>, <span class="number">4</span>));</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>构建工具</category>
        <category>npm</category>
      </categories>
      <tags>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】高性能前端架构解决方案</title>
    <url>/posts/10518/</url>
    <content><![CDATA[<p>来源：<a href="https://mp.weixin.qq.com/s/C4izhX-vMnw_dpUZ1uDM0A">高性能前端架构解决方案</a></p>
<p>这篇文章介绍了一些使前端应用程序加载更快并提供良好用户体验的技术。</p>
<p>我们将研究前端的总体架构，如何首先加载必需的资源，并最大化资源缓存的概率。</p>
<p>无论你的页面是否需要成为客户端应用程序，还是如何优化应用程序的渲染时间，我都不会说太多后端如何传递资源。</p>
<a id="more"></a>

<h2 id="总览"><a href="#总览" class="headerlink" title="总览"></a>总览</h2><p>我将把应用程序加载分为三个不同的阶段：</p>
<ul>
<li>初始渲染 – 用户看到任何东西之前需要多长时间？</li>
<li>应用程序加载 – 用户可以使用该应用程序需要多长时间？</li>
<li>下一页 – 导航到下一页需要多长时间？</li>
</ul>
<img src="/posts/10518/640-20200322202223114.png" class="" title="640-20200322202223114">

<h2 id="初始渲染"><a href="#初始渲染" class="headerlink" title="初始渲染"></a>初始渲染</h2><p>在浏览器的初始渲染之前，用户看不到任何东西。渲染页面至少需要加载 <code>HTML</code> 文件，但是大多数时候需要加载其他资源，例如 <code>CSS</code> 和 <code>JavaScript</code> 文件。一旦这些都加载完毕，浏览器就可以开始在屏幕上渲染。</p>
<p>在本文中，我将使用 <code>WebPageTest</code> 瀑布图。你网站的请求瀑布可能看起来像这样。</p>
<img src="/posts/10518/640-20200322202223159.png" class="" title="640-20200322202223159">

<p><code>HTML</code> 文档将加载一堆其他文件，并在这些文件加载后渲染页面。请注意， <code>CSS</code> 文件是并行加载的，因此每个其他请求不会增加明显的延迟。</p>
<p>（备注：<code>gov.uk</code> 启用了 <code>HTTP/2</code>，因此资产域可以重新使用与 <code>www.gov.uk</code> 的现有连接！我将在下面详细讨论服务器连接。）</p>
<h3 id="减少渲染阻塞的请求"><a href="#减少渲染阻塞的请求" class="headerlink" title="减少渲染阻塞的请求"></a>减少渲染阻塞的请求</h3><p><code>css</code> 和（默认情况下） <code>script</code> 文件会阻止其下方的任何内容渲染。</p>
<p>你可以通过以下几种方法来解决此问题：</p>
<ul>
<li>将脚本标签放在 <code>body</code> 标签的底部</li>
<li>使用 <code>async</code> 异步加载 <code>script</code></li>
<li>内联使用小型的 <code>JS</code> 或 <code>CSS</code> 代码段（如果需要同步加载）</li>
</ul>
<h3 id="避免顺序渲染阻塞请求链"><a href="#避免顺序渲染阻塞请求链" class="headerlink" title="避免顺序渲染阻塞请求链"></a>避免顺序渲染阻塞请求链</h3><p>让你的网站变慢的不一定是阻止渲染的请求数量。更重要的是每种资源的下载大小，以及浏览器发现需要加载资源的时间。</p>
<p>如果浏览器仅在另一个请求完成后才发现需要加载文件，则可以获取同步请求链。发生这种情况可能有多种原因：</p>
<ul>
<li><code>CSS</code> 中的 <code>@import</code> 规则</li>
<li><code>CSS</code> 文件中引用的 <code>Webfonts</code></li>
<li><code>JavaScript</code> 注入链接或脚本标签</li>
</ul>
<p>看一下这个例子：</p>
<img src="/posts/10518/640-20200322202223158.png" class="" title="640-20200322202223158">

<p>这个网站在它的某个 <code>CSS</code> 文件中使用 <code>@import</code> 加载 <code>Google Fonts</code>。这意味着浏览器需要一个接一个地发出这些请求：</p>
<ul>
<li>文件 <code>HTML</code></li>
<li>应用程序的 <code>CSS</code></li>
<li><code>Google</code> 字体 <code>CSS</code></li>
<li><code>Google Font Woff</code>文件（在瀑布图中未显示）</li>
</ul>
<p>要解决这个问题，首先需要将 <code>Google Fonts</code> 的 <code>CSS</code> 请求从 <code>@import</code> 移动到 <code>HTML</code> 中的 <code>link</code> 标记，这就切断了请求链条上的一个环节。</p>
<p>为了进一步加快速度，建议直接在 <code>HTML</code> 或 <code>CSS</code> 文件中内联 <code>Google Fonts CSS</code> 文件。</p>
<p>(记住，来自 <code>Google Fonts</code> 的 <code>CSS</code> 响应取决于用户代理。如果你用 <code>IE8</code> 发出请求，CSS 会引用一个 <code>EOT</code> 文件，<code>IE11</code> 会得到一个 <code>woff</code> 文件，而现在的浏览器会得到一个 <code>woff2</code> 文件。但是如果你不介意旧的浏览器使用系统字体，那么你可以复制粘贴 <code>CSS</code> 文件的内容。)</p>
<p>即使页面开始呈现后，用户仍可能无法对该页面执行任何操作，因为在加载字体之前，不会显示任何文本。可以通过 <code>font-display swap</code> 来避免这种情况，现在 <code>Google Fonts</code> 默认情况下已经开始支持。</p>
<p>有时，消除请求链是不可行的。在这些情况下，可以考虑使用 <code>preload</code> 或 <code>preconnect</code> 标记。例如，在实际的 <code>CSS</code> 请求发出之前，上面的网站可以连接到 <code>fonts.googleapis.com</code>。</p>
<h3 id="重复使用服务器连接以加快请求"><a href="#重复使用服务器连接以加快请求" class="headerlink" title="重复使用服务器连接以加快请求"></a>重复使用服务器连接以加快请求</h3><p>建立新的服务器连接通常需要在服务器的浏览器之间进行 3 次往返：</p>
<ul>
<li><code>DNS</code> 查询</li>
<li>建立 <code>TCP</code> 连接</li>
<li>建立 <code>SSL</code> 连接</li>
</ul>
<p>连接就绪后，至少需要再进行一次往返来发送请求并下载响应。</p>
<p>下面的瀑布显示连接已启动到四个不同的服务器：<code>hostgator.com，optimize.com，googletagmanager.com 和 googelapis.com</code>。</p>
<p>但是，对同一服务器的后续请求可以重新使用现有连接。因此，加载 <code>base.css</code>或 <code>index1.css</code> 的速度很快，因为它们也托管在 <code>hostgator.com</code> 上。</p>
<img src="/posts/10518/640-20200322202223164.png" class="" title="640-20200322202223164">

<h3 id="减小文件大小并使用-CDN"><a href="#减小文件大小并使用-CDN" class="headerlink" title="减小文件大小并使用 CDN"></a>减小文件大小并使用 CDN</h3><p>除了文件大小之外，还有两个其他因素会影响请求时间，这些因素都在你的控制范围内：资源大小和服务器位置。</p>
<p>向用户发送尽可能少的数据，并确保将其压缩（例如，使用 <code>brotli</code> 或 <code>gzip</code> ）。</p>
<p>内容交付网络在大量位置提供服务器，因此其中之一可能位于你的用户附近。用户可以连接到与其附近的 <code>CDN</code> 服务器，而不必连接到中央应用程序服务器。这意味着服务器的往返时间将大大缩短。这对于诸如 <code>CSS</code>，<code>JavaScript</code>和 <code>Image</code> 之类的静态资产特别方便，因为它们易于分发。</p>
<h3 id="使用-service-workers-跳过网络"><a href="#使用-service-workers-跳过网络" class="headerlink" title="使用 service workers 跳过网络"></a>使用 service workers 跳过网络</h3><p><code>service workers</code> 允许你在请求进入网络之前拦截它们。这意味着你可以实现瞬时首屏渲染!</p>
<p>当然，这只在你不需要网络发送响应时才有效。你需要已经缓存了响应，所以用户只有在第二次加载你的应用时才会受益。</p>
<p>下面的 <code>service workers</code> 缓存呈现页面所需的 HTML 和 CSS。当再次加载应用程序时，它会尝试为缓存的资源提供服务，如果资源不可用，则会返回到网络。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">self.addEventListener(<span class="string">&#x27;install&#x27;</span>, <span class="keyword">async</span> e =&gt; &#123;</span><br><span class="line">  caches.open(<span class="string">&#x27;v1&#x27;</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">cache</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cache.addAll([<span class="string">&#x27;/app&#x27;</span>, <span class="string">&#x27;/app.css&#x27;</span>]);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">self.addEventListener(<span class="string">&#x27;fetch&#x27;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">  event.respondWith(</span><br><span class="line">    caches.match(event.request).then(<span class="function"><span class="params">cachedResponse</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> cachedResponse || fetch(event.request);</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="应用加载"><a href="#应用加载" class="headerlink" title="应用加载"></a>应用加载</h2><p>好的，现在用户已经可以看到一些东西，然后他们在可以使用你的应用程序之前还需要什么？</p>
<ul>
<li>加载应用程序代码（JS 和 CSS）</li>
<li>加载页面的基本数据</li>
<li>加载其他数据和图像</li>
</ul>
<img src="/posts/10518/640-20200322202223220.png" class="" title="640-20200322202223220">

<p>请注意，不仅仅是延迟从网络加载数据会延迟渲染。加载代码后，浏览器将需要解析，编译和执行它。</p>
<h3 id="Bundle-split：仅加载必要的代码，并最大化缓存命中率"><a href="#Bundle-split：仅加载必要的代码，并最大化缓存命中率" class="headerlink" title="Bundle split：仅加载必要的代码，并最大化缓存命中率"></a>Bundle split：仅加载必要的代码，并最大化缓存命中率</h3><p><code>Bundle split</code> 允许只加载当前页面所需的代码，而不是加载整个应用程序。<code>Bundle split</code> 还意味着可以缓存其中的一部分，即使其他部分已经更改，需要重新加载。</p>
<p>通常，代码被分成三种不同类型的文件:</p>
<ul>
<li>网页本身专用代码</li>
<li>共享应用程序代码</li>
<li>很少更改的第三方模块（非常适合缓存！）</li>
</ul>
<p><code>Webpack</code> 可以使用 <code>optimization.splitChunks</code> 自动拆分共享代码以减少总下载量。确保启用运行时块，以使 <code>chunk</code> 哈希稳定，并从长期缓存中受益。</p>
<p>分离页面特定的代码不能自动完成，你需要识别可以单独加载的位。通常这是一个特定的路径或一组页面。使用动态导入来延迟加载代码。</p>
<p><code>Bundle split</code> 会导致更多的请求被发送来加载你的应用程序。但是只要请求是并行发送的，这就不是什么大问题，特别是当你的站点开启了 <code>HTTP/2</code> 服务的时候。你可以看到在这个瀑布的前三个请求:</p>
<img src="/posts/10518/640-20200322202223167.png" class="" title="640-20200322202223167">

<p>然而，这个瀑布图还显示了两个按顺序发出的请求。这些块只在这个页面中需要，并通过 <code>import()</code> 调用动态加载。</p>
<p>如果你知道需要这些块，你可以通过插入预加载链接标记来解决这个问题。</p>
<img src="/posts/10518/640-20200322203628249.png" class="" title="640-20200322203628249">

<p>但是，你会看到，与总页面加载时间相比，这样做的好处可能很小。</p>
<p>另外，使用预加载有时会适得其反，因为加载其他更重要的文件时可能会延迟。</p>
<h3 id="加载页面数据"><a href="#加载页面数据" class="headerlink" title="加载页面数据"></a>加载页面数据</h3><p>你的应用程序可能是用来显示一些数据的。下面是一些提示，你可以使用这些提示尽早加载数据并避免呈现延迟。</p>
<h4 id="在开始加载数据之前不要等待包"><a href="#在开始加载数据之前不要等待包" class="headerlink" title="在开始加载数据之前不要等待包"></a>在开始加载数据之前不要等待包</h4><p>这是一个顺序请求链的特殊情况:你加载应用程序包，然后代码请求页面数据。</p>
<p>有两种方法可以避免这种情况：</p>
<ul>
<li>将页面数据嵌入 HTML 文档中</li>
<li>通过文档中的内联脚本启动数据请求</li>
</ul>
<p>将数据嵌入 HTML 可以确保你的应用程序不必等待数据加载。这也降低了应用程序的复杂性，因为你不必处理加载状态。</p>
<p>但是，如果获取数据会大大延迟你的文档响应，那将不是一个好主意，因为这会延迟你的初始渲染。</p>
<p>在这种情况下，或者如果你通过服务工作者提供缓存的 HTML 文档，则可以将内联脚本嵌入到 HTML 中以加载此数据。你可以将其作为全局 <code>promise</code> 提供，如下所示：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.userDataPromise = fetch(<span class="string">&#x27;/me&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>然后，如果数据准备就绪，你的应用程序可以立即开始渲染，或者等到准备就绪。</p>
<p>对于这两种技术，你都需要知道在应用开始呈现之前页面必须加载哪些数据。对于与用户相关的数据（用户名，通知 …），这往往很容易，但是对于特定于页面的内容，则比较棘手。考虑确定最重要的页面并为这些页面编写自定义逻辑。</p>
<h4 id="等待非必需数据时不要阻塞渲染"><a href="#等待非必需数据时不要阻塞渲染" class="headerlink" title="等待非必需数据时不要阻塞渲染"></a>等待非必需数据时不要阻塞渲染</h4><p>有时生成页面数据需要缓慢的复杂后端逻辑。在这些情况下，如果足以使你的应用程序具有功能性和交互性，则可以首先加载较简单的数据版本。</p>
<p>例如，分析工具可以在加载图表数据之前首先加载所有图表的列表。这使用户可以立即查找他们感兴趣的图表，还可以帮助将后端请求分散到不同的服务器上。</p>
<img src="/posts/10518/640-20200322202223217.png" class="" title="640-20200322202223217">

<h4 id="避免顺序数据请求链"><a href="#避免顺序数据请求链" class="headerlink" title="避免顺序数据请求链"></a>避免顺序数据请求链</h4><p>这可能与我先前关于在第二个请求中加载非必需数据的观点相冲突，但是如果每个完成的请求都不会导致向用户显示更多信息，则避免顺序请求链。</p>
<p>与其先发出关于用户登录身份的请求，然后再请求其所属团队的列表，不如在用户信息旁边返回团队列表。你可以使用 <code>GraphQL</code> ，但自定义用户呢? <code>includeTeams=true endpoint</code> 也很有用。</p>
<p>与其首先请求用户登录为谁，然后请求他们所属的团队列表，</p>
<h3 id="服务端端渲染"><a href="#服务端端渲染" class="headerlink" title="服务端端渲染"></a>服务端端渲染</h3><p>服务端端渲染意味着在服务器上预渲染你的应用程序，并使用整页 HTML 响应文档请求。这意味着客户端可以看到完全呈现的页面，而不必等待加载其他代码或数据！</p>
<p>由于服务器只是将静态 HTML 发送给客户端，因此你的应用尚无法进行交互。需要加载应用程序，它需要重新运行呈现逻辑，然后将必要的事件侦听器附加到 DOM。</p>
<p>如果看到非交互式内容很有价值，请使用服务器呈现。如果你能够将呈现的 HTML 缓存在服务器上并将其提供给所有用户而又不会延迟初始文档请求，那么它也将有所帮助。例如，如果你使用 <code>React</code> 来渲染博客文章，则服务器渲染非常合适。</p>
<h2 id="下一页"><a href="#下一页" class="headerlink" title="下一页"></a>下一页</h2><p>在某个时候，用户将与你的应用进行交互并转到下一页。打开初始页面后，你可以控制浏览器中发生的事情，因此你可以准备进行下一次交互。</p>
<h3 id="预取资源"><a href="#预取资源" class="headerlink" title="预取资源"></a>预取资源</h3><p>如果你预加载了下一页所需的代码，则可以消除用户启动导航时的延迟。使用 <code>prefetch</code> 标记，或 <code>webpackPrefetch</code> 用于动态导入：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="comment">/* webpackPrefetch: true, webpackChunkName: &quot;todo-list&quot; */</span> <span class="string">&#x27;./TodoList&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>注意你使用了多少用户数据和带宽，特别是当他们使用移动连接时。如果他们使用的是你网站的移动版本，或者他们启用了保存数据模式，你可以减少预加载。</p>
<p>对于用户最可能需要的应用程序部分，要有策略。</p>
<h3 id="重用已经加载的数据"><a href="#重用已经加载的数据" class="headerlink" title="重用已经加载的数据"></a>重用已经加载的数据</h3><p>在应用程序中本地缓存 <code>Ajax</code> 数据，并使用它来避免未来的请求。如果用户从团队列表导航到“编辑团队”页面，你可以通过重用已经获取的数据来立即进行转换。</p>
<p>请注意，如果你的实体经常被其他用户编辑，并且你下载的数据可能已经过期，那么这种方法将不起作用。在这些情况下，在获取最新数据时，请首先考虑以只读方式显示现有数据。</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>本文介绍了许多因素，这些因素可能会在加载过程的不同时刻使你的页面速度减慢。使用 <code>Chrome DevTools</code>，<code>WebPageTest</code>和<code>Lighthouse</code>之类的工具来确定其中哪些适用于你的应用程序。</p>
<p>实际上，你几乎不可能在所有方面进行优化。找出对用户有最大影响的因素，并专注于此。</p>
<p>我在写这篇文章时意识到的一件事是，我根深蒂固地相信，发出许多单独的请求对性能不利。过去，当每个请求都需要一个单独的连接时，Thas 就是这样，而浏览器每个域只允许几个连接。但是，使用 <code>HTTP/2</code> 和现代浏览器已不再是这种情况。</p>
<p>并且有强烈的理由支持拆分请求。它允许仅加载必要的资源，并可以更好地利用缓存的内容，因为仅需要重新加载已更改的文件。</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>性能优化</category>
      </categories>
      <tags>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>三栏布局方案(圣杯_双飞翼)</title>
    <url>/posts/10370/</url>
    <content><![CDATA[<h2 id="圣杯布局"><a href="#圣杯布局" class="headerlink" title="圣杯布局"></a>圣杯布局</h2><h3 id="步骤一-HTML框架搭建-amp-初始化CSS"><a href="#步骤一-HTML框架搭建-amp-初始化CSS" class="headerlink" title="步骤一 - HTML框架搭建 &amp; 初始化CSS"></a>步骤一 - HTML框架搭建 &amp; 初始化CSS</h3><p>首先把基本框架搭起来（注意中间部分放最前面）：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span>&gt;</span>我是中间<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>我是左边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>我是右边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>接下来是初始化样式。left, right宽度分别设置为100px和200px；然后设置container的 <code>padding-left: 100px</code> + <code>padding-right: 200px</code> 来占据两侧填充；center宽度设为100%，这样能够自适应剩下的宽度。再让所有子元素左浮动。代码如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">200px</span> <span class="number">0</span> <span class="number">100px</span>; <span class="comment">/* 左边100， 右边200*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#e1e1e1</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>; <span class="comment">/* 为了看效果，给个300px把高度撑起来 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span>, <span class="selector-class">.center</span>, <span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">/* 占据父元素剩下的宽度*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: lightblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时的页面效果：</p>
<img src="/posts/10370/%E5%9C%A3%E6%9D%AFstep1.png" class="" title="圣杯step1">

<h3 id="步骤二-让left占据最左列"><a href="#步骤二-让left占据最左列" class="headerlink" title="步骤二 - 让left占据最左列"></a>步骤二 - 让left占据最左列</h3><p>为了让left能越过center，我们先给它设置一个 -100% 的左边距。这个100%是在container中的宽度，也就是center的宽度：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="comment">/*为了看left和center的重叠效果，暂时bgc设为半透明*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">204</span>,<span class="number">204</span>,.<span class="number">6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>页面效果：</p>
<img src="/posts/10370/%E5%9C%A3%E6%9D%AFstep2.png" class="" title="圣杯step2">

<p>此时，我们已经让left从“第二行”升到了“第一行”，为了让它靠到最左侧，不与center重叠，可以给它设置相对定位，然后给个 <code>left: -100px</code> ，让它定位到container最左侧：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="comment">/* 设置相对定位 */</span> </span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="comment">/* 靠到最左侧 */</span></span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>页面效果：</p>
<img src="/posts/10370/%E5%9C%A3%E6%9D%AFstep3.png" class="" title="圣杯step3">

<h3 id="步骤三-让right占据最右列"><a href="#步骤三-让right占据最右列" class="headerlink" title="步骤三 - 让right占据最右列"></a>步骤三 - 让right占据最右列</h3><p>定位好了left，也是时候让right呆在最右边来填充位置了，我们继续使用负margin：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: -<span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>页面效果：</p>
<img src="/posts/10370/%E5%9C%A3%E6%9D%AFstep4.png" class="" title="圣杯step4">

<h3 id="步骤四-给container设置min-width"><a href="#步骤四-给container设置min-width" class="headerlink" title="步骤四 - 给container设置min-width"></a>步骤四 - 给container设置min-width</h3><p>看起来已经实现了不是吗？但我们还差最后一步，给container设置一个 <code>min-width: 100px</code> （就是左列的宽度），否则当浏览器缩小到一定程度时，这个布局可能会被破坏。原因简单来讲就是：“由于设置了相对定位，所以当left原来的位置和right的位置产生重叠时，由于浮动的原因一行放不下就会换行”。所以布局就被打乱了。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#e1e1e1</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">200px</span> <span class="number">0</span> <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="完整代码-最终效果"><a href="#完整代码-最终效果" class="headerlink" title="完整代码 + 最终效果"></a>完整代码 + 最终效果</h3><p>这样，我们就实现了圣杯布局，完整代码和效果见下：</p>
<iframe height="265" scrolling="no" title="三栏布局 - 圣杯布局" src="https://codepen.io/JingW/embed/VRXYmz/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="双飞翼布局"><a href="#双飞翼布局" class="headerlink" title="双飞翼布局"></a>双飞翼布局</h2><p>如果上面圣杯布局你已经理解并自己实践了一遍，那么这里的双飞翼布局你也应该不再话下。跟着我一起撸一遍代码吧。</p>
<h3 id="步骤一-HTML框架搭建-amp-初始化CSS-1"><a href="#步骤一-HTML框架搭建-amp-初始化CSS-1" class="headerlink" title="步骤一 - HTML框架搭建 &amp; 初始化CSS"></a>步骤一 - HTML框架搭建 &amp; 初始化CSS</h3><p>首先搭建html，仔细观察下方代码你会发现，双飞翼布局在html上面有一点和圣杯布局有差别，那就是双飞翼在center里又套了一个div。到后面你就会知道这样设置的目的。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是中间<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>我是左边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>我是右边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后编写初始样式。left定宽100；right定宽200；left, right, center全部设置左浮动。其他例如设置颜色高度等等直接看下方代码：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#e1e1e1</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: lightblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span>, <span class="selector-class">.center</span>, <span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果如下：</p>
<img src="/posts/10370/%E5%8F%8C%E9%A3%9E%E7%BF%BCstep1.png" class="" title="双飞翼step1">

<h3 id="步骤二-设置center为100-宽"><a href="#步骤二-设置center为100-宽" class="headerlink" title="步骤二 - 设置center为100%宽"></a>步骤二 - 设置center为100%宽</h3><p>将center的宽度设为100%，这样会把left，right“挤”到第二行：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: lightblue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果如下：</p>
<img src="/posts/10370/%E5%8F%8C%E9%A3%9E%E7%BF%BCstep2.png" class="" title="双飞翼step2">

<h3 id="步骤三-分别让left-right回到最左边和最右边"><a href="#步骤三-分别让left-right回到最左边和最右边" class="headerlink" title="步骤三 - 分别让left,right回到最左边和最右边"></a>步骤三 - 分别让left,right回到最左边和最右边</h3><p>接着，给left设置 <code>margin-left: -100%</code> 回到最左边，给right设置 <code>margin-left: -200px</code> 回到最右边。此时center和left,right都有重叠区域，为了看效果，设置了半透明背景颜色。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果如下：</p>
<img src="/posts/10370/%E5%8F%8C%E9%A3%9E%E7%BF%BCstep3.png" class="" title="双飞翼step3">

<h3 id="步骤四-给center的子div设置左右margin"><a href="#步骤四-给center的子div设置左右margin" class="headerlink" title="步骤四 - 给center的子div设置左右margin"></a>步骤四 - 给center的子div设置左右margin</h3><p>其实上面的效果图已经实现了三栏布局中间自适应。但有个问题是center左右部分区域会被遮挡，这个时候在步骤一提到的center子div的作用就体现出来了，我们可以给它设置一个左右的margin值，分别等于left的宽和right的宽，消除掉重叠的副作用。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.center</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="comment">/* 左margin100，右margin200 */</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">200px</span> <span class="number">0</span> <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果如下：</p>
<img src="/posts/10370/%E5%8F%8C%E9%A3%9E%E7%BF%BCstep4.png" class="" title="双飞翼step4">

<h3 id="步骤五-给container设置min-width"><a href="#步骤五-给container设置min-width" class="headerlink" title="步骤五 - 给container设置min-width"></a>步骤五 - 给container设置min-width</h3><p>最后，给container设置一个min-width，让container最小宽度不小于left宽+right宽</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#e1e1e1</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>大功告成~</p>
<h3 id="完整代码-最终效果-1"><a href="#完整代码-最终效果-1" class="headerlink" title="完整代码 + 最终效果"></a>完整代码 + 最终效果</h3><iframe height="265" scrolling="no" title="三栏布局 - 双飞翼布局" src="https://codepen.io/JingW/embed/wOmBoY/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>布局</tag>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>两栏布局方案汇总</title>
    <url>/posts/44541/</url>
    <content><![CDATA[<p>记录下常见的两栏布局方式。</p>
<h2 id="左边定宽，右边自适应"><a href="#左边定宽，右边自适应" class="headerlink" title="左边定宽，右边自适应"></a>左边定宽，右边自适应</h2><h3 id="模拟table"><a href="#模拟table" class="headerlink" title="模拟table"></a>模拟table</h3><p>父元素 <code>display: table</code> ，子元素左右 <code>table-cell</code> ，左边定宽。</p>
<iframe height="460" scrolling="no" title="两栏布局（左定右自适应）模拟table" src="https://codepen.io/JingW/embed/zbWYMO/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<a id="more"></a>

<h3 id="左浮-右Margin"><a href="#左浮-右Margin" class="headerlink" title="左浮 + 右Margin"></a>左浮 + 右Margin</h3><p>子元素的左边浮动脱标，右边设置 <code>margin-left: 左边元素宽度</code></p>
<iframe height="460" scrolling="no" title="两栏布局（左定右自适应）子元素绝对定位" src="https://codepen.io/JingW/embed/bZvGRY/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="左浮-右BFC"><a href="#左浮-右BFC" class="headerlink" title="左浮 + 右BFC"></a>左浮 + 右BFC</h3><p>子元素左边设置浮动+定宽，右边子元素设置 <code>overflow: hidden</code> 触发自身BFC</p>
<iframe height="460" scrolling="no" title="两栏布局（左定右自适应）左浮 + 右BFC" src="https://codepen.io/JingW/embed/rRdNYR/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="子绝父相"><a href="#子绝父相" class="headerlink" title="子绝父相"></a>子绝父相</h3><p>子绝父相，左边 <code>top, left: 0</code>，右边 <code>top, right: 0</code>，left等于左边宽度。</p>
<iframe height="460" scrolling="no" title="两栏布局（左定右自适应）子绝父相" src="https://codepen.io/JingW/embed/gEeONo/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="flex布局"><a href="#flex布局" class="headerlink" title="flex布局"></a>flex布局</h3><p>父元素 <code>display: flex</code> ，左边定宽，右边 <code>flex: 1</code>。</p>
<iframe height="460" scrolling="no" title="两栏布局（左定右自适应）flex" src="https://codepen.io/JingW/embed/bZvNGx/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>布局</tag>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>使用Jekyll搭建GitHubPages博客</title>
    <url>/posts/63074/</url>
    <content><![CDATA[<h2 id="安装-Jekyll"><a href="#安装-Jekyll" class="headerlink" title="安装 Jekyll"></a>安装 Jekyll</h2><p>来源：<a href="https://jekyllrb.com/docs/installation/">https://jekyllrb.com/docs/installation/</a></p>
<h3 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a>macOS</h3><p>终端运行：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">xcode-select --install</span><br></pre></td></tr></table></figure>

<p>安装 Ruby：</p>
<p>Jekyll 依赖 Ruby v2.5.0+，如果你的 macOS 版本为 Catalina 10.15 或以上，则不需要再手动安装，因为系统自带 Ruby 2.6.3 。</p>
<a id="more"></a>

<blockquote>
<p>查看本地 Ruby 版本：<code>ruby -v</code></p>
<p>如果你的版本低于 10.15 则需要下载或更新你的 Ruby</p>
<p>具体下载or更新方案可查看：<a href="https://jekyllrb.com/docs/installation/macos/#install-ruby">https://jekyllrb.com/docs/installation/macos/#install-ruby</a></p>
</blockquote>
<p>安装 Jekyll：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gem install --user-install bundler jekyll</span><br></pre></td></tr></table></figure>

<p>选择你要安装博客的目录下运行：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">jekyll new 你博客名(随意，反正最后要全部移动到你的githubpages repo下)</span><br></pre></td></tr></table></figure>

<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>windows安装不再赘述，可查看官网文档安装：<a href="https://jekyllrb.com/docs/installation/windows/">https://jekyllrb.com/docs/installation/windows/</a></p>
<h2 id="安装-minimal-mistakes-jekyll-主题"><a href="#安装-minimal-mistakes-jekyll-主题" class="headerlink" title="安装 minimal-mistakes-jekyll 主题"></a>安装 minimal-mistakes-jekyll 主题</h2><p>github 链接：<a href="https://github.com/mmistakes/minimal-mistakes">https://github.com/mmistakes/minimal-mistakes</a></p>
<h3 id="编辑-Gemfile"><a href="#编辑-Gemfile" class="headerlink" title="编辑 Gemfile"></a>编辑 Gemfile</h3><p>替换你的 <code>Gemfile</code> 文件：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">source &quot;https://rubygems.org&quot;</span><br><span class="line"></span><br><span class="line"># Hello! This is where you manage which Jekyll version is used to run.</span><br><span class="line"># When you want to use a different version, change it below, save the</span><br><span class="line"># file and run `bundle install`. Run Jekyll with `bundle exec`, like so:</span><br><span class="line">#</span><br><span class="line">#     bundle exec jekyll serve</span><br><span class="line">#</span><br><span class="line"># This will help ensure the proper Jekyll version is running.</span><br><span class="line"># Happy Jekylling!</span><br><span class="line"></span><br><span class="line"># gem &quot;github-pages&quot;, group: :jekyll_plugins</span><br><span class="line"></span><br><span class="line"># To upgrade, run `bundle update`.</span><br><span class="line"></span><br><span class="line">gem &quot;github-pages&quot;, group: :jekyll_plugins</span><br><span class="line">gem &quot;minimal-mistakes-jekyll&quot;, :github =&gt; &quot;mmistakes/minimal-mistakes&quot;</span><br><span class="line"></span><br><span class="line"># The following plugins are automatically loaded by the theme-gem:</span><br><span class="line">#   gem &quot;jekyll-paginate&quot;</span><br><span class="line">#   gem &quot;jekyll-sitemap&quot;</span><br><span class="line">#   gem &quot;jekyll-gist&quot;</span><br><span class="line">#   gem &quot;jekyll-feed&quot;</span><br><span class="line">#   gem &quot;jekyll-include-cache&quot;</span><br><span class="line">#</span><br><span class="line"># If you have any other plugins, put them here!</span><br><span class="line">group :jekyll_plugins do</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>运行 <code>bundle install</code> 安装依赖。</p>
<h3 id="配置-config-yml"><a href="#配置-config-yml" class="headerlink" title="配置 _config.yml"></a>配置 _config.yml</h3><p>找到 <code>_config.yml</code> 文件并替换：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Welcome to Jekyll!</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># This config file is meant for settings that affect your whole blog, values</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">which</span> you are expected to <span class="built_in">set</span> up once and rarely edit after that. If you find</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> yourself editing this file very often, consider using Jekyll<span class="string">&#x27;s data files</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> feature <span class="keyword">for</span> the data you need to update frequently.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># For technical reasons, this file is *NOT* reloaded automatically when you use</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="string">&#x27;bundle exec jekyll serve&#x27;</span>. If you change this file, please restart the server process.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># If you need help with YAML syntax, here are some quick references for you:</span></span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> https://learn-the-web.algonquindesign.ca/topics/markdown-yaml-cheat-sheet/<span class="comment">#yaml</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> https://learnxinyminutes.com/docs/yaml/</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># Site settings</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> These are used to personalize your new site. If you look <span class="keyword">in</span> the HTML files,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> you will see them accessed via &#123;&#123; site.title &#125;&#125;, &#123;&#123; site.email &#125;&#125;, and so on.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> You can create any custom variable you would like, and they will be accessible</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">in</span> the templates via &#123;&#123; site.myvariable &#125;&#125;.</span></span><br><span class="line"></span><br><span class="line">title: Your awesome title</span><br><span class="line">email: your-email@example.com</span><br><span class="line">description: &gt;- # this means to ignore newlines until &quot;baseurl:&quot;</span><br><span class="line">  Write an awesome description for your new site here. You can edit this</span><br><span class="line">  line in _config.yml. It will appear in your document head meta (for</span><br><span class="line">  Google search results) and in your feed.xml site description.</span><br><span class="line">baseurl: &quot;&quot; # the subpath of your site, e.g. /blog</span><br><span class="line">url: &quot;https://evestorm.github.io&quot; # the base hostname &amp; protocol for your site, e.g. http://example.com</span><br><span class="line">repository: &quot;&#123;github_username&#125;/&#123;github_username&#125;.github.io&quot; # 把 &#123;github_username&#125; 替换成你github的username</span><br><span class="line">twitter_username: jekyllrb</span><br><span class="line">github_username:  lance # 你的username，随便填</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Build settings</span></span><br><span class="line">theme: minimal-mistakes-jekyll</span><br><span class="line">plugins:</span><br><span class="line">  - jekyll-feed</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Exclude from processing.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The following items will not be processed, by default.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Any item listed under the `exclude:` key here will be automatically added to</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> the internal <span class="string">&quot;default list&quot;</span>.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># Excluded items can be processed by explicitly listing the directories or</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> their entries<span class="string">&#x27; file path in the `include:` list.</span></span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># exclude:</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - .sass-cache/</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - .jekyll-cache/</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - gemfiles/</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - Gemfile</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - Gemfile.lock</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - node_modules/</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - vendor/bundle/</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - vendor/cache/</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - vendor/gems/</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   - vendor/ruby/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后执行 <code>bundle update</code>。</p>
<h3 id="替换和更改"><a href="#替换和更改" class="headerlink" title="替换和更改"></a>替换和更改</h3><ul>
<li><p>替换根目录下 <code>index.markdown</code> 为 <code>index.html</code>  ：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">layout: home</span><br><span class="line">author_profile: true</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
</li>
<li><p>找到 <code>_posts/0000-00-00-welcome-to-jekyll.md</code> 并替换 <code>layout: single</code></p>
</li>
<li><p>删除 <code>about.md</code> 文件</p>
</li>
</ul>
<p>最后执行： <code>bundle exec jekyll serve</code> 本地运行博客。</p>
]]></content>
      <categories>
        <category>教程</category>
        <category>博客</category>
      </categories>
      <tags>
        <tag>Jekyll</tag>
      </tags>
  </entry>
  <entry>
    <title>函数中的rest参数</title>
    <url>/posts/29820/</url>
    <content><![CDATA[<h2 id="什么是-REST-参数"><a href="#什么是-REST-参数" class="headerlink" title="什么是 REST 参数"></a>什么是 REST 参数</h2><p>REST参数翻译过来就是剩余参数，<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Rest_parameters">MDN</a>上的定义是：</p>
<blockquote>
<p>剩余参数语法允许我们将一个不定数量的参数表示为一个数组。</p>
</blockquote>
<a id="more"></a>

<h2 id="示例说明"><a href="#示例说明" class="headerlink" title="示例说明"></a>示例说明</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">...theArgs</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> theArgs.reduce(<span class="function">(<span class="params">previous, current</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> previous + current;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line"><span class="comment">// expected output: 6</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>));</span><br><span class="line"><span class="comment">// expected output: 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 下例中，剩余参数包含了从第二个到最后的所有实参，然后用第一个实参依次乘以它们</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">multiplier, ...theArgs</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> theArgs.map(<span class="function"><span class="keyword">function</span> (<span class="params">element</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> multiplier * element;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = multiply(<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); </span><br><span class="line"><span class="built_in">console</span>.log(arr);  <span class="comment">// [2, 4, 6]</span></span><br></pre></td></tr></table></figure>

<h2 id="rest-参数和-arguments-对象的区别"><a href="#rest-参数和-arguments-对象的区别" class="headerlink" title="rest 参数和 arguments 对象的区别"></a>rest 参数和 arguments 对象的区别</h2><p>剩余参数和 <code>arguments</code>对象之间的区别主要有三个：</p>
<ul>
<li><p>剩余参数只包含那些没有对应形参的实参，而 <code>arguments</code> 对象包含了传给函数的所有实参。</p>
</li>
<li><p><code>arguments</code>对象不是一个真正的数组，而剩余参数是真正的 <code>Array</code>实例，也就是说你能够在它上面直接使用所有的数组方法，比如 <code>sort</code>，<code>map</code>，<code>forEach</code>或<code>pop</code>。</p>
</li>
<li><pre><code>arguments
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">对象还有一些附加的属性 （如</span><br><span class="line"></span><br></pre></td></tr></table></figure>
callee</code></pre>
<p>属性）。</p>
<ul>
<li>arguments.callee 属性包含当前正在执行的函数。</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title>使用hexo搭建个人博客</title>
    <url>/posts/43303/</url>
    <content><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>利用 <a href="https://hexo.io/zh-cn/">Hexo</a> 在 <a href="https://baike.baidu.com/item/github/10145341?fr=aladdin">GitHub</a> 上搭建个人博客。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>你的电脑需要安装下面两个应用程序：</p>
<ul>
<li>NodeJS <a href="http://www.runoob.com/nodejs/nodejs-install-setup.html">如何安装</a></li>
<li>Git <a href="http://www.runoob.com/git/git-install-setup.html">如何安装</a></li>
</ul>
<p>或者直接查看hexo的<a href="https://hexo.io/zh-cn/docs/#%E5%AE%89%E8%A3%85%E5%89%8D%E6%8F%90">官方文档</a>查看安装教程。</p>
<a id="more"></a>

<h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><blockquote>
<p><a href="https://hexo.io/zh-cn/docs/">安装文档</a></p>
</blockquote>
<p>终端全局安装：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<h3 id="建站"><a href="#建站" class="headerlink" title="建站"></a>建站</h3><p>安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo init 你的站点文件夹</span><br><span class="line">cd 你的站点文件夹</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>

<h3 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h3><p>下方是三个常见命令，可以先执行前俩看看效果，最后一个部署命令待会再执行。</p>
<ul>
<li><code>hexo server -p 5000</code> 本地启动服务器，5000端口</li>
<li><code>hexo new &#39;你想要创建的文章名称&#39;</code> 创建文章</li>
<li><code>hexo clean &amp;&amp; hexo deploy</code> 部署网站</li>
</ul>
<h3 id="使用第三方主题"><a href="#使用第三方主题" class="headerlink" title="使用第三方主题"></a>使用第三方主题</h3><ul>
<li><a href="https://github.com/iissnan/hexo-theme-next">Next</a> 【推荐】</li>
<li><a href="https://github.com/litten/hexo-theme-yilia">Yilia</a></li>
</ul>
<h4 id="安装Next主题"><a href="#安装Next主题" class="headerlink" title="安装Next主题"></a>安装Next主题</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd 你的站点目录</span><br><span class="line">git clone https://github.com/next-theme/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="创建分类和标签"><a href="#创建分类和标签" class="headerlink" title="创建分类和标签"></a>创建分类和标签</h3><h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><p>运行：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new page &quot;categories&quot;</span><br></pre></td></tr></table></figure>

<p>p.s. 命名为 <code>categories</code> 原因是 <code>categories</code> 在next主题中是一个关键词对应着分类。</p>
<p>在主站根目录下,也就是你hexo的目录下找到 <code>/source/categories/index.md</code>，打开后的效果类似下方代码：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories  #本页标题</span><br><span class="line">date: 2018-03-13 23:02:50  #创建日期</span><br><span class="line">type: &quot;categories&quot; 	#分类属于</span><br><span class="line">comments: false  #如果有启用多说 或者 Disqus评论，默认页面也会带有评论。需要关闭的话，请添加字段 comments 并将值设置为 false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>接着在 themes 主题文件夹下找到 next 文件夹，修改 _config.yml 文件：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br></pre></td></tr></table></figure>

<p>然后在命令行输入添加文章命令：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo new &#39;你想要创建的文章名称&#39;</span><br></pre></td></tr></table></figure>

<p>根目录(主站目录下)/source/_posts/&lt;刚创建的文章名称&gt;.md，双击打开：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 文章标题</span><br><span class="line">date: 2018-03-13 23:13:23</span><br><span class="line">tags: html    #属于哪个标签</span><br><span class="line">categories: interview   #属于哪个分类</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h4 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h4><p>打开命令行，进入博客所在文件夹。执行命令：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure>

<p>成功后会有一个路径提示</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">INFO Created: ~/Documents/blog/source/tags/index.md</span><br></pre></td></tr></table></figure>

<p>找到对应的文件打开</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2018-03-14 00:02:05</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>添加type: “tags”到内容中，添加后是这样的：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2018-03-14 00:03:52</span><br><span class="line">type: &#x27;tags&#x27;</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>打开你的文章页面：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: jQuery对表单的操作及更多应用</span><br><span class="line">date: 2019-03-14 00:03:55</span><br><span class="line">categories: 前端</span><br><span class="line">tags: jQuery  #如果想要多个标签可以 tags: [jQuery, 表格, 表单验证] or</span><br><span class="line"><span class="bullet">-</span> jQuery</span><br><span class="line"><span class="bullet">-</span> 表格</span><br><span class="line"><span class="bullet">-</span> 表单验证</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>p.s. 如果想要实现父子分类，也和标签一样的格式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">categories:</span><br><span class="line">- IDE</span><br><span class="line">- VSCode</span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://hexo.io/zh-cn/docs/front-matter.html#%E5%88%86%E7%B1%BB%E5%92%8C%E6%A0%87%E7%AD%BE">分类和标签</a></p>
<h3 id="头像设置"><a href="#头像设置" class="headerlink" title="头像设置"></a>头像设置</h3><p>把头像放在站点根目录的 <code>source/uploads/</code> 下，然后在 <code>theme/next/_config.yml</code> 下修改配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">/uploads/avatar.png</span></span><br></pre></td></tr></table></figure>

<h3 id="侧边栏"><a href="#侧边栏" class="headerlink" title="侧边栏"></a>侧边栏</h3><h4 id="菜单"><a href="#菜单" class="headerlink" title="菜单"></a>菜单</h4><p>在 <code>theme/next/_config.yml</code> 下配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="comment">#about: /about/ || fa fa-user</span></span><br><span class="line">  <span class="comment">#tags: /tags/ || fa fa-tags</span></span><br><span class="line">  <span class="comment">#categories: /categories/ || fa fa-th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || fa fa-calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || fa fa-sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || fa fa-heartbeat</span></span><br></pre></td></tr></table></figure>

<h4 id="社交"><a href="#社交" class="headerlink" title="社交"></a>社交</h4><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="attr">GitHub:</span> <span class="string">https://github.com/yourname</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-github</span></span><br><span class="line">  <span class="attr">E-Mail:</span> <span class="string">mailto:yourname@gmail.com</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-envelope</span></span><br><span class="line">  <span class="attr">Weibo:</span> <span class="string">https://weibo.com/yourname</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-weibo</span></span><br><span class="line">  <span class="attr">Google:</span> <span class="string">https://plus.google.com/yourname</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-google</span></span><br><span class="line">  <span class="attr">Twitter:</span> <span class="string">https://twitter.com/yourname</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-twitter</span></span><br><span class="line">  <span class="attr">FB Page:</span> <span class="string">https://www.facebook.com/yourname</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-facebook</span></span><br><span class="line">  <span class="attr">StackOverflow:</span> <span class="string">https://stackoverflow.com/yourname</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-stack-overflow</span></span><br><span class="line">  <span class="attr">YouTube:</span> <span class="string">https://youtube.com/yourname</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-youtube</span></span><br><span class="line">  <span class="attr">Instagram:</span> <span class="string">https://instagram.com/yourname</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-instagram</span></span><br><span class="line">  <span class="attr">Skype:</span> <span class="string">skype:yourname?call|chat</span> <span class="string">||</span> <span class="string">fab</span> <span class="string">fa-skype</span></span><br></pre></td></tr></table></figure>

<h3 id="阅读更多"><a href="#阅读更多" class="headerlink" title="阅读更多"></a>阅读更多</h3><p>在文章想要截断的地方添加 <code>&lt;!-- more --&gt;</code> ，这样在文章列表中就会只展示到截断位置为止。</p>
<h2 id="第三方插件"><a href="#第三方插件" class="headerlink" title="第三方插件"></a>第三方插件</h2><h3 id="永久URL生成：hexo-abbrlink"><a href="#永久URL生成：hexo-abbrlink" class="headerlink" title="永久URL生成：hexo-abbrlink"></a>永久URL生成：hexo-abbrlink</h3><ul>
<li>用来生成每篇博客永久URL链接的</li>
<li>Repo: <a href="https://github.com/rozbo/hexo-abbrlink">https://github.com/rozbo/hexo-abbrlink</a></li>
<li>执行： <code>npm install hexo-abbrlink --save</code></li>
</ul>
<h3 id="部署到GitHub：hexo-deployer-git"><a href="#部署到GitHub：hexo-deployer-git" class="headerlink" title="部署到GitHub：hexo-deployer-git"></a>部署到GitHub：hexo-deployer-git</h3><ul>
<li>将本地博客部署到GitHub</li>
<li>Repo: <a href="https://hexo.io/zh-cn/docs/one-command-deployment">https://hexo.io/zh-cn/docs/one-command-deployment</a>)</li>
<li>执行： <code>npm install hexo-deployer-git --save</code></li>
</ul>
<p><strong>如何部署</strong></p>
<p>在 <code>_config.yml</code> 下配置：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">&quot;https://github.com/evestorm/evestorm.github.io&quot;</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">&quot;gh-pages&quot;</span></span><br></pre></td></tr></table></figure>

<p>然后在你的githubpages的repo下新建 <code>gh-pages</code> 分支，最后执行：<code>hexo clean &amp;&amp; hexo deploy</code> 即可部署。</p>
<h3 id="本地热更新：hexo-server"><a href="#本地热更新：hexo-server" class="headerlink" title="本地热更新：hexo-server"></a>本地热更新：hexo-server</h3><ul>
<li>服务器模块。在启动期间，Hexo 会监视文件变动并自动更新</li>
<li>Repo: <a href="https://github.com/hexojs/hexo-server">https://github.com/hexojs/hexo-server</a>)</li>
<li>执行： <code>npm install hexo-server –save</code></li>
</ul>
<h3 id="关键词搜索：LocalSearch"><a href="#关键词搜索：LocalSearch" class="headerlink" title="关键词搜索：LocalSearch"></a>关键词搜索：LocalSearch</h3><ul>
<li>本地搜索</li>
<li>Repo: <a href="https://github.com/theme-next/hexo-generator-searchdb">https://github.com/theme-next/hexo-generator-searchdb</a></li>
<li>执行：<code>npm install hexo-generator-searchdb --save</code></li>
</ul>
<p><strong>配置博客</strong></p>
<p>安装完成，编辑博客配置文件：<code>hexo/_config.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br></pre></td></tr></table></figure>

<p><strong>配置主题</strong></p>
<p>Next 主题自带搜索设置，编辑主题配置文件：<code>_config.yml</code></p>
<p>找到文件中 Local search 的相关配置，设为 <code>true</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Local search</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/next-theme/hexo-generator-searchdb</span></span><br><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If auto, trigger search by changing input.</span></span><br><span class="line">  <span class="comment"># If manual, trigger search by pressing enter key or search button.</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span></span><br><span class="line">  <span class="comment"># Show top n results per article, show all results by setting to -1</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># Unescape html strings to the readable one.</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Preload the search data when the page loads.</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>最后记得 hexo 重新部署。</p>
<h3 id="统计分析：busuanzi-count"><a href="#统计分析：busuanzi-count" class="headerlink" title="统计分析：busuanzi_count"></a>统计分析：busuanzi_count</h3><p>NexT 主题集成了不蒜子（busuanzi_count）统计功能，在 NexT 配置文件中找到关键词 <code>busuanzi_count:</code> ，把 enable 设置为 true</p>
<p>p.s. 除此之外，如果设置为true后仍然无效，且打开控制台显示js报错。有可能是不蒜子链接失效的原因，需要在Next主题配置文件位置：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">themes\next\layout\_third-party\analytics\busuanzi-counter.swig</span><br></pre></td></tr></table></figure>

<p>修改script链接为：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">&quot;https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="评论功能：ChangYan"><a href="#评论功能：ChangYan" class="headerlink" title="评论功能：ChangYan"></a>评论功能：ChangYan</h3><p>文档地址：<a href="https://theme-next.js.org/docs/third-party-services/comments.html#Changyan-China">https://theme-next.js.org/docs/third-party-services/comments.html#Changyan-China</a></p>
<ul>
<li><p>注册登录：<a href="https://changyan.kuaizhan.com/">https://changyan.kuaizhan.com/</a></p>
</li>
<li><p>获取 APP ID 和 APP KEY</p>
</li>
<li><p>设置 changyan enable: true:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># changyan</span></span><br><span class="line"><span class="attr">changyan:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">appid:</span></span><br><span class="line">  <span class="attr">appkey:</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="常用配置"><a href="#常用配置" class="headerlink" title="常用配置"></a>常用配置</h3><p><a href="https://blog.csdn.net/lewky_liu/article/details/81277337">Hexo瞎折腾系列(4) - 站点首页不显示文章全文</a></p>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// npm全局安装Hexo</span><br><span class="line">npm install -g hexo-cli</span><br><span class="line"></span><br><span class="line">// 新建Hexo项目</span><br><span class="line">hexo init &lt;folder&gt;</span><br><span class="line">cd &lt;folder&gt;</span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line">// 新建文章</span><br><span class="line">hexo new &#x27;文章名&#x27;</span><br><span class="line"></span><br><span class="line">// 启动服务器</span><br><span class="line">hexo server -p 5000</span><br><span class="line"></span><br><span class="line">// 生成静态文件</span><br><span class="line">hexo generate --watch</span><br><span class="line"></span><br><span class="line">// 部署</span><br><span class="line">hexo clean &amp;&amp; hexo deploy</span><br></pre></td></tr></table></figure>

<h2 id="相关配置及资源"><a href="#相关配置及资源" class="headerlink" title="相关配置及资源"></a>相关配置及资源</h2><ul>
<li><a href="https://juejin.im/post/5bcd2d395188255c3b7dc1db#heading-42">Hexo+NexT 打造一个炫酷博客</a></li>
<li><a href="https://me.idealli.com/post/e8d13fc.html">这应该是最全的hexo博客搭建以及next美化教程</a></li>
<li><a href="https://leancloud.cn/">LeanCloud</a></li>
<li><a href="https://eirunye.github.io/2018/09/15/Hexo%E6%90%AD%E5%BB%BAGitHub%E5%8D%9A%E5%AE%A2%E2%80%94%E6%89%93%E9%80%A0%E7%82%AB%E9%85%B7%E7%9A%84NexT%E4%B8%BB%E9%A2%98%E2%80%94%E9%AB%98%E7%BA%A7%E2%80%94%E5%9B%9B/">Hexo搭建GitHub博客—打造炫酷的NexT主题–高级(四)</a></li>
<li><a href="http://www.missfli.com/2018/06/19/github-hexo-next-08.html">Hexo NexT主题代码块添加复制功能</a></li>
<li><a href="https://ihaoming.top/archives/9a935f57.html">修改hexo博客next主题文章页面宽度</a></li>
<li><a href="https://hexo.io/zh-cn/docs/asset-folders.html">在Hexo中使用资源文件夹添加图片</a></li>
</ul>
]]></content>
      <categories>
        <category>教程</category>
        <category>博客</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>前端vscode插件配置</title>
    <url>/posts/11039/</url>
    <content><![CDATA[<h3 id="外观配置"><a href="#外观配置" class="headerlink" title="外观配置"></a>外观配置</h3><ul>
<li><strong>主题</strong>：<a href="https://marketplace.visualstudio.com/items?itemName=chriseckenrode.vscode-chester-atom">Chester Atom</a></li>
<li><strong>图标</strong>：<a href="https://marketplace.visualstudio.com/items?itemName=emmanuelbeziat.vscode-great-icons">VSCode Great Icons</a></li>
<li><strong>字体</strong>：<a href="https://github.com/tonsky/FiraCode/wiki">Fira Code</a></li>
</ul>
<a id="more"></a>

<h4 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h4><img src="/posts/11039/163001_02d3ddb2_1203301.png" class="" title="UI-Show">


<h4 id="用户设置（User-Settings）"><a href="#用户设置（User-Settings）" class="headerlink" title="用户设置（User Settings）"></a>用户设置（User Settings）</h4><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;editor.fontSize&quot;</span>: <span class="number">16</span>,</span><br><span class="line">    <span class="attr">&quot;workbench.colorTheme&quot;</span>: <span class="string">&quot;Chester Atom&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;editor.fontFamily&quot;</span>: <span class="string">&quot;Fira Code&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;emmet.triggerExpansionOnTab&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;editor.fontLigatures&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="风格检查"><a href="#风格检查" class="headerlink" title="风格检查"></a>风格检查</h3><ul>
<li><strong><a href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint">ESLint</a></strong></li>
<li><strong><a href="https://marketplace.visualstudio.com/items?itemName=shinnn.stylelint">StyleLint</a></strong></li>
<li><strong><a href="https://marketplace.visualstudio.com/items?itemName=DavidAnson.vscode-markdownlint">MarkdownLint</a></strong></li>
<li><strong><a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode">Prettier</a></strong></li>
</ul>
<h3 id="编码效率"><a href="#编码效率" class="headerlink" title="编码效率"></a>编码效率</h3><h4 id="代码片段"><a href="#代码片段" class="headerlink" title="代码片段"></a>代码片段</h4><ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=abusaidm.html-snippets">HTML Snippets</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=xabikos.JavaScriptSnippets">Javascript (ES6) Code Snippets</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=nikhilkumar80.js-patterns-snippets">Javascript Patterns Snippets</a></li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=joelday.docthis">Document This</a>，一键给代码中的类、函数加上注释，支持函数声明、函数表达式、箭头函数等；</li>
</ul>
<h4 id="自动补全"><a href="#自动补全" class="headerlink" title="自动补全"></a>自动补全</h4><ul>
<li><a href="https://link.juejin.im/?target=https://marketplace.visualstudio.com/items?itemName=formulahendry.auto-close-tag">Auto Close Tag</a>，在打开标签并且键入 <code>&lt;/</code> 的时候，能自动补全要闭合的标签；</li>
<li><a href="https://link.juejin.im/?target=https://marketplace.visualstudio.com/items?itemName=formulahendry.auto-rename-tag">Auto Rename Tag</a>，在修改标签名时，能在你修改开始（结束）标签的时候修改对应的结束（开始）标签。</li>
<li><a href="https://link.juejin.im/?target=https://marketplace.visualstudio.com/items?itemName=christian-kohler.path-intellisense">Path Intellisense</a>，文件路径补全，在你用任何方式引入文件系统中的路径时提供智能提示和自动完成。</li>
<li><a href="https://link.juejin.im/?target=https://marketplace.visualstudio.com/items?itemName=christian-kohler.npm-intellisense">NPM Intellisense</a>，NPM 依赖补全，在你引入任何 node_modules 里面的依赖包时提供智能提示和自动完成。</li>
<li><a href="https://link.juejin.im/?target=https://marketplace.visualstudio.com/items?itemName=Zignd.html-css-class-completion">IntelliSense for CSS class names</a>，CSS 类名补全，会自动扫描整个项目里面的 CSS 类名并在你输入类名时做智能提示。</li>
<li><a href="https://link.juejin.im/?target=https://emmet.io">Emmet</a>，VSCode 已经内置，官方介绍文档<a href="https://link.juejin.im/?target=https://code.visualstudio.com/docs/editor/emmet">参见</a>。</li>
</ul>
<h4 id="代码补全"><a href="#代码补全" class="headerlink" title="代码补全"></a>代码补全</h4><ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner">Code Runner</a><!-- [![Code Runner](前端vscode插件配置/162c15a64b468fd8.gif)](https://user-gold-cdn.xitu.io/2018/4/14/162c15a64b468fd8?imageslim) -->
<img src="/posts/11039/162c15a64b468fd8.gif" class="" title="Code-Runner">

</li>
</ul>
<h3 id="功能增强"><a href="#功能增强" class="headerlink" title="功能增强"></a>功能增强</h3><ul>
<li><a href="https://link.juejin.im/?target=https://marketplace.visualstudio.com/items?itemName=naumovs.color-highlight">Color Highlight</a>，识别代码中的颜色，包括各种颜色格式。</li>
<li><a href="https://link.juejin.im/?target=https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer">Bracket Pair Colorizer</a>，识别代码中的各种括号，并且标记上不同的颜色，方便你扫视到匹配的括号。</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=Shan.code-settings-sync">Settings Sync</a>，基于 Gist 实现 VSCode 用户配置、快捷键配置、已安装插件列表等的备份和恢复功能，配置过程有详细精确的操作步骤文档。生成的备份 Gist 默认是私密的，如果你想设置为共享的，也可以一键切换。</li>
</ul>
<h3 id="外观增强"><a href="#外观增强" class="headerlink" title="外观增强"></a>外观增强</h3><ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=wayou.vscode-todo-highlight">TODO Highlight</a><br>维护时间稍长的代码仓库免不了会有各种 TODO、FIXME、HACK 之类的标记，TODO Highlight 能够帮我们把这些关键词高亮出来，在你翻阅代码时非常醒目，就像是在大声提醒你尽快把他解决掉。支持自定义配置需要高亮的关键词，实际使用比较坑的地方是，TODO、FIXME 之类的后面必须加上冒号，否则无法高亮。<!-- [![TODO Highlight](前端vscode插件配置/1)](https://user-gold-cdn.xitu.io/2018/4/14/162c1592cecf92d8?imageView2/0/w/1280/h/960/format/webp/ignore-error/1) -->
<img src="/posts/11039/1.png" class="" title="TODO-Highlight"></li>
</ul>
]]></content>
      <categories>
        <category>工具</category>
        <category>IDE</category>
      </categories>
      <tags>
        <tag>VSCode</tag>
      </tags>
  </entry>
  <entry>
    <title>去除图片上下左右间隙</title>
    <url>/posts/31251/</url>
    <content><![CDATA[<h2 id="情景"><a href="#情景" class="headerlink" title="情景"></a>情景</h2><p>当在定宽父容器下有多张图片顺序排列时，图片的上下左右之间都有间隙：</p>
<iframe height="265" scrolling="no" title="KEBmRP" src="https://codepen.io/JingW/embed/KEBmRP/?height=265&amp;theme-id=0&amp;default-tab=html,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<a id="more"></a>

<h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><ul>
<li>左右：因为 img 是 inline-block 元素，元素代码之间有『换行（回车），空格，tab』时会产生左右间隙。</li>
<li>上下：行内元素默认与父容器基线对齐，而基线与父容器底部有一定间隙，所以上下图片间有间隙。</li>
</ul>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><ul>
<li>移除上下间隙：<ul>
<li>img本身设置 <code>display: block;</code></li>
<li>父元素设置 <code>font-size: 0;</code> （基线与字体大小有关，字体为零，基线间就没距离了）</li>
<li>img本身设置 <code>vertical-align: bottom;</code>（让inline-block 的 img 与每行的底部对齐）</li>
</ul>
</li>
<li>移除左右间距：<ul>
<li>行内元素间不要有换行，连成一行写消除间隙（阅读性差，不推荐）</li>
<li>第一行img结尾写上 <code>&lt;!--</code> ，第二行img开头跟上 <code>--&gt;</code> 。即利用注释消除间距</li>
<li>父元素 <code>font-size: 0</code></li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>布局</tag>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>垂直居中方案汇总</title>
    <url>/posts/12733/</url>
    <content><![CDATA[<p>这里汇总了常见的元素居中方案。</p>
<h2 id="水平居中"><a href="#水平居中" class="headerlink" title="水平居中"></a>水平居中</h2><h3 id="行内元素水平居中"><a href="#行内元素水平居中" class="headerlink" title="行内元素水平居中"></a>行内元素水平居中</h3><p>核心：给父元素添加 <code>text-align: center</code></p>
<iframe height="265" scrolling="no" title="行内元素水平居中" src="https://codepen.io/JingW/embed/mvaNXw/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<a id="more"></a>

<h3 id="块级元素水平居中"><a href="#块级元素水平居中" class="headerlink" title="块级元素水平居中"></a>块级元素水平居中</h3><p>核心：子元素自身 <code>margin: 0 auto;</code></p>
<iframe height="291" scrolling="no" title="块元素水平居中" src="https://codepen.io/JingW/embed/moxbxb/?height=291&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="多个div水平居中"><a href="#多个div水平居中" class="headerlink" title="多个div水平居中"></a>多个div水平居中</h3><h4 id="传统方案"><a href="#传统方案" class="headerlink" title="传统方案"></a>传统方案</h4><p>核心：父元素设置 <code>text-align: center</code> ，子元素设置 <code>inline-block</code></p>
<iframe height="265" scrolling="no" title="多个div水平居中 - 传统方案" src="https://codepen.io/JingW/embed/KEoPGq/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h4 id="Flex方案"><a href="#Flex方案" class="headerlink" title="Flex方案"></a>Flex方案</h4><p>核心：父元素 <code>display: flex</code> + <code>justify-content: center</code> + <code>align-items: center</code></p>
<iframe height="265" scrolling="no" title="多个div水平居中-flex" src="https://codepen.io/JingW/embed/XGEroY/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h2 id="水平垂直居中"><a href="#水平垂直居中" class="headerlink" title="水平垂直居中"></a>水平垂直居中</h2><h3 id="table自带水平垂直居中"><a href="#table自带水平垂直居中" class="headerlink" title="table自带水平垂直居中"></a>table自带水平垂直居中</h3><p>核心：使用 <code>table&gt;tr&gt;td</code> 布局</p>
<iframe height="460" scrolling="no" title="div水平垂直居中 - table" src="https://codepen.io/JingW/embed/xBWxwe/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="模拟table"><a href="#模拟table" class="headerlink" title="模拟table"></a>模拟table</h3><p>核心：父元素 <code>display: table</code> ，子元素 <code>display: table-cell</code> + <code>vertical-align: middle</code></p>
<iframe height="460" scrolling="no" title="div水平垂直居中 - 模拟table" src="https://codepen.io/JingW/embed/aMYbZx/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="子绝父相-子元素-margin-auto"><a href="#子绝父相-子元素-margin-auto" class="headerlink" title="子绝父相 + 子元素 margin:auto"></a>子绝父相 + 子元素 margin:auto</h3><p>核心：子元素相对于父元素绝对定位，<code>top</code>、<code>right</code>、<code>bottom</code>、<code>left</code> 都设为0，margi设为auto</p>
<iframe height="460" scrolling="no" title="div水平垂直居中 - 子绝父相 + Margin Auto" src="https://codepen.io/JingW/embed/PLRYrz/?height=460&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="子绝父相-负margin"><a href="#子绝父相-负margin" class="headerlink" title="子绝父相 + 负margin"></a>子绝父相 + 负margin</h3><p>核心：子元素相对于父元素绝对定位，<code>top</code>、<code>left</code>设为50%，margin相对自身宽/高一半</p>
<iframe height="460" scrolling="no" title="div水平垂直居中 - 子绝父相 + 负Margin" src="https://codepen.io/JingW/embed/oVqNvK/?height=460&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="子绝父相-translate"><a href="#子绝父相-translate" class="headerlink" title="子绝父相 + translate"></a>子绝父相 + translate</h3><p>核心：子元素相对于父元素绝对定位，<code>top</code>、<code>left</code>设为50%，此时子元素左上角在父元素中心，然后让子元素向左上角位移自身宽度的一半</p>
<iframe height="460" scrolling="no" title="div水平垂直居中 - 子绝父相 + translate" src="https://codepen.io/JingW/embed/EMExjr/?height=456&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<h3 id="Flex布局"><a href="#Flex布局" class="headerlink" title="Flex布局"></a>Flex布局</h3><p>父元素 <code>display: flex</code>，<code>justify-content</code> 和 <code>align-items</code> 都设为 center 实现垂直居中</p>
<iframe height="460" scrolling="no" title="div水平垂直居中 - flex" src="https://codepen.io/JingW/embed/rRdNyo/?height=265&amp;theme-id=0&amp;default-tab=css,result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>布局</tag>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】大屏上的全屏页面的自适应适配方案</title>
    <url>/posts/61674/</url>
    <content><![CDATA[<p>转载自：<a href="https://www.njleonzhang.com/2018/08/15/flexible-pc-full-screen.html">https://www.njleonzhang.com/2018/08/15/flexible-pc-full-screen.html</a></p>
<p>通常来说PC端的页面并不像移动端页面那样对屏幕大小和分别率有那么强的依赖。一般的页面都是取屏幕中间的一块宽度(1280px), 两边留白, 高度随着内容的长度滚动。这样无论窗口怎么变化，页面都是可用的。比如，我们的这个页面. 然而也有少数的页面，天生就是要在 pc 端全屏显示的，其中最为典型的代表就是全屏的 dashboard 页面。比如：</p>
<p>当然，如果 dashboard 页面是内嵌在一些管理页面里的，通常是允许滚动的。</p>
<img src="/posts/61674/ba7c9abd-2f10-3890-cfed-f8c389248b53.png" class="" title="admin_dashboard">

<p>但是，如果 dashboard 是用于官方宣传，比如在电视机或者广告屏上的展示的时候，通常是不允许滚动条出现的。比如:</p>
<img src="/posts/61674/0349a840-ed31-06be-207c-e748883522b7.png" class="" title="天猫">

<a id="more"></a>

<blockquote>
<p>这种 dashboard 有个帅气的名字叫数据可视化。</p>
</blockquote>
<h2 id="通常的做法"><a href="#通常的做法" class="headerlink" title="通常的做法"></a>通常的做法</h2><p>为了实现全屏的这种 dashboard, 通常的做法就是要对宽度和高度都做百分比（网格）来实现了。但是这种方案的缺点在于:</p>
<ul>
<li>实现太麻烦。设计师给的设计稿通常是 px 为单位标注的，我们需要仔细的计算宽度和高度的比例，然后小心处理页面的布局。</li>
<li>难以处理屏幕宽高比与设计图不符时，带来的元素变形。所以最后展示的屏幕不能和设计稿的屏幕的宽高比差距太大。</li>
</ul>
<p>比如，下面这个简单的页面就是用百分比方案来做的。设计师给的图的比例为 16: 9。</p>
<img src="/posts/61674/16-9.png" class="" title="16:9">

<img src="/posts/61674/1-1.png" class="" title="1:1">

<p>当窗口比例是 16 : 9 的时候黄色的长方形显示符合设计，当窗口变成正方形的时候，黄色部分也跟着变方了，这必然会影响显示效果。</p>
<p>可以在浏览器中打开，改变窗口大小页面来体验这个<a href="https://quellingblade.github.io/postcss-px-to-rem/percent.html">百分比方案</a>。</p>
<h2 id="理想的效果"><a href="#理想的效果" class="headerlink" title="理想的效果"></a>理想的效果</h2><p>我心目中的理想效果可能是像下面这个页面一样，无论窗口怎么变，我们的内容都保持原来的比例，并尽量占满窗口（类似 background contain 的效果）。</p>
<ul>
<li>屏幕尺寸和设计稿比例(16:9)一致时，占满屏幕</li>
</ul>
<img src="/posts/61674/full-screen.png" class="" title="full-screen">

<ul>
<li>屏幕尺寸比设计图比例瘦时，上下留白，左右占满，并上下居中, 显示的比例保持16：9</li>
</ul>
<img src="/posts/61674/square.png" class="" title="square">

<ul>
<li>屏幕尺寸比设计图比例胖时，左右留白，上下占满，并左右居中, 显示的比例保持16：9</li>
</ul>
<img src="/posts/61674/600-300.png" class="" title="600:300">

<p>可以在浏览器中打开，改变窗口大小页面来体验这个<a href="https://quellingblade.github.io/postcss-px-to-rem/percent.html">flexible方案</a></p>
<h2 id="rem-方案"><a href="#rem-方案" class="headerlink" title="rem 方案"></a>rem 方案</h2><p>熟悉移动端的自适应方案的朋友对 rem 适应方案，肯定不陌生，最出名的就是阿里的 <a href="https://github.com/amfe/lib-flexible">lib-flexible</a> 方案。可能你已经猜到，本文的这个方案肯定也是基于 rem 的。</p>
<p>rem (font size of the root element), 是 css3 的引入的一个大小单位。即相对于根元素的 font-size 值的大小。所谓根元素在网页里一般就是 html. 举例说明：下例中，<code>html 的 font-size 大小</code>是 20px, 那么 1.4rem 和 2.4 rem 就分别代表着 28px 和 48px 了。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123; <span class="attribute">font-size</span>: <span class="number">20px</span>; &#125;</span><br><span class="line"><span class="selector-tag">test1</span> &#123;</span><br><span class="line">  width: 1.4rem; //1.4 × 20px = 28px</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">test2</span> &#123;</span><br><span class="line">  height: 2.4rem; //2.4 × 20px = 48px</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>假设我们的设计稿其尺寸为 1920 * 1280 px，并且实际运行这个网页的屏幕分别率也是 1920 * 1280. 那么，这网页就好做了。简单粗暴地，按图中的元素的尺寸和位置，直接利用绝对定位把所有元素撸出来就行了。比如，设计稿中有这样一个元素:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.doughnut</span> &#123;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这不刚介绍了 rem, 我们试着用 rem 为单位来写一下 <code>doughnut</code> 元素的 css。我们把页面的 html 元素的 font-size 设置为 1920 / 10 = 192 px. 那么 <code>doughnut</code> 这个元素就应该写作：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.doughnut</span> &#123;</span><br><span class="line">  top:  .781rem;     // 150 / 192 = 0.781</span><br><span class="line">  left: .156rem;     // 30  / 192 = 0.156</span><br><span class="line">  width: 2.083rem;   // 400 / 192 = 2.083</span><br><span class="line">  height: 1.563rem;  // 300 / 192 = 1.564</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>恩。。。。这不是有病么？算成 rem，然后设置一下 html 的 font-size 让浏览器再算回去？显摆自己的数学好么？23333。</p>
<p>注意上上面有一个假设，<strong>屏幕大小正好是 1920 * 1280</strong>。这个假设真的很假，根本不可能，一旦用了 px，那么一切长宽都死了。这时你再看一眼 rem，真实的长度为：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">实际长度(px) = rootFontSize (html 的 font-size) * rem 长度</span><br></pre></td></tr></table></figure>

<p>那么这个实际长度必然有一下特点：</p>
<ul>
<li>所有长度的比例必然和设计图一致。</li>
<li>实际的显示长度完全由 <code>html 的 font-size</code> 值决定（线性关系）。</li>
</ul>
<p>我们来证明一下：</p>
<blockquote>
<p>设：设计稿上有任一1条线: A, A 的长度为 xx, <code>计算 rem 值的基准</code>为 zz<br>那么 css 里，A 的长度表示为 xzxz (rem)</p>
<p>设网页运行时的 html 的 font-size 值为 fsfs，</p>
<p>那么 A 的实际显示长度就分为 xfszxfsz (px)</p>
<p>所以：</p>
<ol>
<li>对于任意2条线，其实际长度的比例为 x1fszx1fsz ： x2fszx2fsz 就等于 他们在设计图上的比例 x1x1 : x2x2</li>
<li>对于任意一条线，xx 和 zz 是固定值，其实际值随着 fsfs 值线性关系变化的</li>
</ol>
</blockquote>
<p>我们取设计图的边框的4条线来分析, 那么<code>设计稿</code>，<code>真实显示（画布）</code>和 <code>显示窗口（全屏时，即为屏幕）</code>的关系如下图所示:</p>
<img src="/posts/61674/70ef9642-13d0-a15c-ff25-23feaef1029b.png" class="" title="70ef9642-13d0-a15c-ff25-23feaef1029b">

<ul>
<li>设计稿的宽高分别为 axax 和 ayay, 比例为 xx : yy.</li>
<li>实际显示的范围（我们称其为画布）比例和设计稿保持一致，所以可以设实际显示的画布的宽高为bx:bybx:by, 且所有线的实际显示长度是由 <code>html 的 font-size 值</code> fsfs 线性决定的。</li>
<li>屏幕的尺寸不确定，假设其宽度为 ww, 高度为 hh</li>
</ul>
<blockquote>
<p>小结一下，用了上面提到的 rem 来方案后，我们做出来的页面是一个<strong>和设计稿比例一致的</strong>，并且<strong>大小根据网页运行时的 html 的 font-size的值缩放</strong>的页面。</p>
</blockquote>
<p>既然页面的大小可以按<strong>html 的 font-size的值</strong>缩放，那么如果我希望<strong>画布的实际显示宽度</strong>始终和<strong>浏览器窗口宽度</strong>保持一致的话（即下图这样的状态），<strong>html 的 font-size的值</strong>应该如何设置呢？</p>
<img src="/posts/61674/19e45d16-534a-9ac3-578c-83bb3f01b45f.png" class="" title="19e45d16-534a-9ac3-578c-83bb3f01b45f">

<p>我们假设 <code>计算 rem 值的基准</code> 为设计稿宽度的 1q1q:</p>
<blockquote>
<p>假设，设计稿窗口宽为 axax，高为 ayay, 则<code>计算 rem 值的基准</code> zz 为 axqaxq</p>
<p>那么按上面的公式，浏览器中画布实际的<br>宽度为 axfsaxq=fsqaxfsaxq=fsq，<br>高度为 ayfsaxq=qyfsxayfsaxq=qyfsx</p>
<p>浏览器窗口的宽度 ww 要等于画布实际的宽度，即 w=fsqw=fsq，则 fs=wqfs=wq</p>
</blockquote>
<p>好的，从数学回到我们的工程中来，我们的设计稿尺寸是 1920 * 1280。我们取 qq 这个值为 10, 则 <code>计算 rem 值的基准</code> zz 为 axq=192010=192axq=192010=192. 然后我们把<strong>所有元素的长、宽、位置、字体大小等原来 <code>px</code> 单位都转换成 rem</strong>，网页加载后，我们<strong>用 js 去计算当前浏览器窗口的宽度，并设置 <code>html 的 font-size</code> fsfs 为<code>当前浏览器窗口的宽度</code> ww 的 1q1q，即 w10w10，这样我们就做出了一个100%宽度的、等比例缩放设计稿的页面</strong>了。</p>
<blockquote>
<p>通过这样的设置，我就得到了一个<strong>和设计稿比例一致的</strong>，<strong>宽度与窗口大小一致</strong>的页面。</p>
</blockquote>
<p>到此为止，就是现有 rem 方案的核心内容了。</p>
<p>说了半天，都是别人的方案，读者可能会问了，那博主你干了啥？</p>
<h2 id="我的方案"><a href="#我的方案" class="headerlink" title="我的方案"></a>我的方案</h2><p>回头想一下，我们要的是什么？现在这个方案，能满足我们的要求么？我们来逐条分析：</p>
<ul>
<li>屏幕（窗口）尺寸和设计稿比例(x:yx:y)一致时，占满屏幕</li>
</ul>
<img src="/posts/61674/327c8e32-cb68-0615-fa7f-b0bbec3dc4f1.png" class="" title="327c8e32-cb68-0615-fa7f-b0bbec3dc4f1">

<p>这种情况肯定没问题，屏幕和真实页面完美重合.</p>
<ul>
<li>屏幕（窗口）尺寸比设计图比例瘦时，上下留白，左右占满，并上下居中, 显示的比例保持(x:yx:y)</li>
</ul>
<img src="/posts/61674/19e45d16-534a-9ac3-578c-83bb3f01b45f(1).png" class="" title="19e45d16-534a-9ac3-578c-83bb3f01b45f(1)">

<p>这种情况也没问题，真实页面高度小于屏幕，然后页面内容上下居中就可以了。</p>
<ul>
<li>屏幕（窗口）尺寸比设计图比例胖时，左右留白，上下占满，并左右居中, 显示的比例保持(x:yx:y)</li>
</ul>
<img src="/posts/61674/c2b3b4d8-759c-14ce-2ffe-6ab2f59b15b4.png" class="" title="c2b3b4d8-759c-14ce-2ffe-6ab2f59b15b4">

<p>问题出现了，在这种场景下，页面的高度超出了屏幕的高度，这就会导致垂直滚动条了。这就是我的方案处理的地方了。在这种场景下，我们需要页面的高度缩小为屏幕的高度，当然为了保持比例页面的宽度等也要等比例缩小.换句话说我们要把所有的线的长度等比例缩小，缩小后画布的高度要等于屏幕的高度，即下图所示的状态:</p>
<img src="/posts/61674/d312b3ec-ded3-746f-9e59-7daa68811f30.png" class="" title="d312b3ec-ded3-746f-9e59-7daa68811f30">

<p>要等比例缩小所有的长度，那么操作 <code>html 的 font-size</code> fsfs 的值就能做到了。我们上面的分析中，我们已经计算了页面（画布）的真实高度</p>
<blockquote>
<p>那么按上面的公式，浏览器中页面（画布）的真实<br>高度为 ayfsaxq=qyfsx</p>
</blockquote>
<p>在此场景下，我们需要把画布真实高度值缩小到屏幕的高度,</p>
<blockquote>
<p>设窗口的高度为 hh,<br>设缩小比例为 ss, 则有 h=qyfsxsh=qyfsxs, 得 s=xhqyfss=xhqyfs<br>即我们需要在页面（画布）真实高度上 qyfsxqyfsx 乘上个缩小系数 xhqyfsxhqyfs，可以使 页面（画布）的真是高等于窗口的高度了<br>又因为 fs=wqfs=wq, 则这个缩小系数可变换为:<br>xhqywq=xhyw=xy/whxhqywq=xhyw=xy/wh, 即 设计稿宽高比窗口宽高比</p>
</blockquote>
<p>Bingo. 综上可知: 当窗口尺寸比设计图比例胖时，只要我们在原来 fsfs 值的基础上，乘上 设计稿宽高比窗口宽高比设计稿宽高比窗口宽高比 的缩小系数，就可以实现我们想要的效果了。</p>
<h2 id="工程应用"><a href="#工程应用" class="headerlink" title="工程应用"></a>工程应用</h2><p>好了，前面的理论，你看着头疼，我写着更头疼。终于到了喜闻乐见的运用环节了。</p>
<p>按照前面的一顿操作，应用这个方案，我们需要做2件事: （以设计稿的尺寸为 1920 * 1280 为例）</p>
<ol>
<li>在 css 表示长度的时候，用设计稿上的长度除以 192, 算得 rem 的值。</li>
<li>页面内写一段 js 代码，根据我们上面的公式去计算并设置 <code>html 元素的 font-size</code> 值。</li>
</ol>
<p>关于第1点：如果告诉你所有的长度你要自己算。。。可能这个方案马上就没人用了，因为真的要算死人。参照 <a href="https://github.com/amfe/lib-flexible">lib-flexible</a> 的方案，我写了一个 <a href="https://github.com/QuellingBlade/postcss-px-to-rem">post-css 插件</a>来帮助你做这个计算，效果就是你不用算了，图上是多少长度，你写多少就行了，这个 rem 的转换由<a href="https://github.com/QuellingBlade/postcss-px-to-rem">插件</a>完成。</p>
<p>关于第2点：这段 js 代码我已经为你写好了 <a href="https://github.com/QuellingBlade/lib-flexible-for-dashboard">lib-flexible-for-dashboard</a>, 直接嵌入你的 html 里就行。考虑到这段 js 代码，会计算 font-size 的值，这个值会决定所有的长度，所以这个值要优先计算出来，最好的方案就是把这段代码拷贝到 html 的 head 里去（这个操作被称为 inline）. 为了方便你使用webpack 和 npm 管理这个库，我们还为你准备了一个 <a href="https://github.com/QuellingBlade/html-webpack-inline-plugin">webpack 插件</a>，帮助你去做 inline.</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><blockquote>
<p>talk is cheap, show me the <a href="https://github.com/njleonzhang/flexible-pc-full-screen">code</a></p>
</blockquote>
<p>设计稿是这样的一个 1920 * 1280（16：9）的图:</p>
<img src="/posts/61674/562e47bd-abda-dae4-7765-68706b5a978e.png" class="" title="562e47bd-abda-dae4-7765-68706b5a978e">

<p>实现的[效果]在这：<a href="http://www.njleonzhang.com/flexible-pc-full-screen/">http://www.njleonzhang.com/flexible-pc-full-screen/</a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>我是站在巨人的肩膀上，针对全屏 pc 页面这一特别场景做出了一个个人比较满意的方案，希望能给有需要的朋友一些帮助。</p>
<p>相关项目：</p>
<ul>
<li><a href="https://github.com/njleonzhang/flexible-pc-full-screen">https://github.com/njleonzhang/flexible-pc-full-screen</a></li>
<li><a href="https://github.com/QuellingBlade/postcss-px-to-rem">https://github.com/QuellingBlade/postcss-px-to-rem</a></li>
<li><a href="https://github.com/QuellingBlade/lib-flexible-for-dashboard">https://github.com/QuellingBlade/lib-flexible-for-dashboard</a></li>
<li><a href="https://github.com/QuellingBlade/html-webpack-inline-plugin">https://github.com/QuellingBlade/html-webpack-inline-plugin</a></li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>转载</tag>
        <tag>大屏</tag>
      </tags>
  </entry>
  <entry>
    <title>奇妙的-webkit-background-clip</title>
    <url>/posts/12897/</url>
    <content><![CDATA[<p>github 链接：<a href="https://github.com/chokcoco/iCSS/issues/14">https://github.com/chokcoco/iCSS/issues/14</a></p>
<h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><iframe height="1449" scrolling="no" title="existential gradient buttons" src="https://codepen.io/JingW/embed/gObGjww?height=1449&amp;theme-id=default&amp;default-tab=result" frameborder="no" allowtransparency="true" allowfullscreen="true" style="width: 997.594px;"></iframe>

<p>原特效链接：<a href="https://codepen.io/cubeghost/pen/ByJGEN">A PEN BY alex baldwin</a></p>
<h2 id="相关资源"><a href="#相关资源" class="headerlink" title="相关资源"></a>相关资源</h2><ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-clip">MDN - background-clip</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/border-image-slice">MDN - border-image-slice</a></li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>转载</tag>
        <tag>CSS3</tag>
      </tags>
  </entry>
  <entry>
    <title>【转载】如何在Mac上配置一个本地Web服务器</title>
    <url>/posts/28116/</url>
    <content><![CDATA[<p>来源：<a href="https://shannonchenchn.github.io/2018/10/22/How-do-you-set-up-a-local-web-server-on-Mac/">https://shannonchenchn.github.io/2018/10/22/How-do-you-set-up-a-local-web-server-on-Mac/</a></p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li>我们为什么需要服务器？<ul>
<li><ol>
<li>本地文件 VS. 远程文件</li>
</ol>
</li>
<li><ol>
<li>直接访问本地文件时存在的问题</li>
</ol>
</li>
</ul>
</li>
<li>方法一、启动 Mac 自带的 Apache 服务器</li>
<li>方法二：使用 Python 的 SimpleHTTPServer 模块启动服务器</li>
</ul>
<a id="more"></a>

<h3 id="我们为什么需要服务器？"><a href="#我们为什么需要服务器？" class="headerlink" title="我们为什么需要服务器？"></a>我们为什么需要服务器？</h3><h4 id="1-本地文件-VS-远程文件"><a href="#1-本地文件-VS-远程文件" class="headerlink" title="1. 本地文件 VS. 远程文件"></a>1. 本地文件 VS. 远程文件</h4><p>通常情况下，你可以通过在浏览器中直接打开或者通过一个 URL 来访问一个文件。</p>
<p>使用浏览器访问本地文件时，一般地址是 <code>file://</code> 开头的本地文件地址。<br>而访问远程文件时，一般地址是 <code>http://</code> 或者 <code>https://</code> 开头的地址，表示这个文件通过 http 协议访问的。</p>
<h4 id="2-直接访问本地文件时存在的问题"><a href="#2-直接访问本地文件时存在的问题" class="headerlink" title="2. 直接访问本地文件时存在的问题"></a>2. 直接访问本地文件时存在的问题</h4><p>在有些情况下，你打开一个本地的 html 文件时，会出现运行错误。</p>
<p>导致这些错误的原因主要有以下两个：<br>（1） 其中包含了异步请求。 如果你直接打开本地文件运行，一些浏览器（包括 Chrome）将不会运行其中的异步请求（请参阅 从服务器获取数据）。 这是因为安全限制而导致的（更多关于 Web 安全的信息，请参阅<a href="https://developer.mozilla.org/en-US/docs/Learn/Server-side/First_steps/Website_security">Website security</a>）。</p>
<p>比如，你直接在浏览器中打开含有如下内容的文件：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> request = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      request.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(request);</span></span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="comment">// 发送请求:</span></span></span><br><span class="line"><span class="javascript">      request.open(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;./data.json&#x27;</span>);</span></span><br><span class="line">      request.send();</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML 测试页面<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>测试页面<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后，你会在 console 中看到这样的错误：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">index.html:12 Failed to load file:///Users/ShannonChen/Desktop/Playground/nodejs_example/data.json: Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension, https.</span><br></pre></td></tr></table></figure>

<p>（2） 执行文件中的代码时需要通过执行一些附加逻辑（如 PHP 或 Python）才能获得结果，而不仅仅是直接访问一个文件。</p>
<p>比如，我登录了京东网站后，查看购物车页面时，需要服务器返回的是包含我的购物车数据的页面，这个时候，就需要服务端在接收到请求后，跟我的用户信息（一般是 cookie）来返回匹配的数据。</p>
<h3 id="方法一、启动-Mac-自带的-Apache-服务器"><a href="#方法一、启动-Mac-自带的-Apache-服务器" class="headerlink" title="方法一、启动 Mac 自带的 Apache 服务器"></a>方法一、启动 Mac 自带的 Apache 服务器</h3><ol>
<li>运行 Apache <code>$ sudo apachectl start</code></li>
<li>退出 Apache <code>$ sudo apachectl stop</code></li>
<li>把工程文件夹放到以下位置中 <code>/Library/WebServer/Documents</code></li>
<li>在浏览器中访问：在地址栏中输入地址 <code>http://localhost/工程文件夹名称/</code>，回车。</li>
</ol>
<p><strong>注意：</strong> 不再需要使用后一定要记得退出，否则会消耗电脑性能。</p>
<p>Q：如何修改 Apache 的默认端口？<br>A：首先，找到 Apache 的配置文件，位于 <code>/etc/apache2</code> 下的 <code>httpd.conf</code>。<br>然后，找到 <code>Listen 80</code> 那一行，修改成你想要的端口即可。</p>
<h3 id="方法二：借助-Mac-系统自带的-Python，使用其中的-SimpleHTTPServer-模块启动服务器"><a href="#方法二：借助-Mac-系统自带的-Python，使用其中的-SimpleHTTPServer-模块启动服务器" class="headerlink" title="方法二：借助 Mac 系统自带的 Python，使用其中的 SimpleHTTPServer 模块启动服务器"></a>方法二：借助 Mac 系统自带的 Python，使用其中的 SimpleHTTPServer 模块启动服务器</h3><ol>
<li><p>安装 Python，其实 Mac 系统就自带了 Python2.7。</p>
</li>
<li><p>通过 <code>cd &lt;your-working-dir&gt;</code> 进入到你的工作目录下，也就是你要让别人访问的文件所在的目录。</p>
</li>
<li><p>在工作目录下执行下面的命令后，就可以启动服务了：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 如果你的 Python 版本是 3.X</span></span><br><span class="line">python3 -m http.server</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果你的 Python 版本是 2.X</span></span><br><span class="line">python -m SimpleHTTPServer</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认情况下，上面的操作将会在本地 Web 服务器上的端口 8000 上运行工作目录中的内容。您可以通过在浏览器中输入 URL <code>http://localhost:8000</code> 并回车，来访问此服务器。你会看到列出的目录的内容，点击就可以查看你想运行的 HTML 文件。</p>
</li>
</ol>
<p>Q：如何修改服务器的默认端口？<br>A：可以通过运行下面的命令来指定一个端口号：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 如果你的 Python 版本是 3.X</span></span><br><span class="line">python -m http.server &lt;your-port&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果你的 Python 版本是 2.X</span></span><br><span class="line">python -m SimpleHTTPServer &lt;your-port&gt;</span><br></pre></td></tr></table></figure>

<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>方法二相比方法一来说，更简单、方便，也更灵活，而且还可以随时在终端上看到服务器的状态。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/set_up_a_local_testing_server">How do you set up a local testing server? - Learn web development | MDN</a>（推荐阅读）</li>
<li><a href="https://www.jianshu.com/p/d006a34a343f">Mac OS X 启用 Web 服务器</a></li>
<li><a href="http://www.jianshu.com/p/90d5fa728861">Mac 自带的本地服务器的使用</a></li>
<li><a href="https://blog.csdn.net/seafishyls/article/details/44546809">Mac OS 原来自带了 apache，基本用法总结</a></li>
</ul>
]]></content>
      <categories>
        <category>后端</category>
        <category>服务器</category>
      </categories>
  </entry>
  <entry>
    <title>如何清除浮动</title>
    <url>/posts/12906/</url>
    <content><![CDATA[<h2 id="为什么要清除浮动"><a href="#为什么要清除浮动" class="headerlink" title="为什么要清除浮动"></a>为什么要清除浮动</h2><p>其实浮动（e.g. <code>float: left;</code>）本质上是用来做文字混排的，但却被我们拿来做布局，这个时候虽然实现了某些效果，但也带来了不少副作用。</p>
<p>由于浮动元素不再占有原文档流的位置，所以它会对后续元素的排版带来影响（无视浮动元素，就当它不存在过）。因此我们很多时候要做的，就是消除浮动元素造成的影响。清除浮动的本质主要是为了解决父元素因为子元素浮动造成的内部高度为0的问题。</p>
<a id="more"></a>

<h2 id="clear"><a href="#clear" class="headerlink" title="clear"></a>clear</h2><p>清除浮动的核心css属性是 clear ，基本语法如下：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">选择器: &#123;</span><br><span class="line">    <span class="attribute">clear</span>: 属性值;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">属性值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">left</td>
<td align="left">不允许左侧有浮动元素（清除左侧浮动的影响）</td>
</tr>
<tr>
<td align="left">right</td>
<td align="left">不允许右侧有浮动元素（清除右侧浮动的影响）</td>
</tr>
<tr>
<td align="left">both</td>
<td align="left">同时清除左右两侧浮动的影响</td>
</tr>
</tbody></table>
<h2 id="清除浮动常见方案"><a href="#清除浮动常见方案" class="headerlink" title="清除浮动常见方案"></a>清除浮动常见方案</h2><h3 id="额外标记法"><a href="#额外标记法" class="headerlink" title="额外标记法"></a>额外标记法</h3><p>在浮动元素后面添加一个空标签，例如：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;float: left;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;clear: both;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>优点：通俗易懂，书写方便<br>缺点：加入了过多的没有实际含义的额外标签，结构化差。</p>
<h3 id="父元素添加overflow"><a href="#父元素添加overflow" class="headerlink" title="父元素添加overflow"></a>父元素添加overflow</h3><p>通过触发BFC达到清除浮动的效果。（p.s. 对bfc不了解可以看<a href="https://evestorm.github.io/posts/9722/">这篇</a>文章）</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优点：代码简洁<br>缺点：超出的内容会被隐藏</p>
<h3 id="before和after双伪元素方案"><a href="#before和after双伪元素方案" class="headerlink" title="before和after双伪元素方案"></a>before和after双伪元素方案</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:before</span>,</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123; </span><br><span class="line">    <span class="attribute">content</span>:<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="attribute">display</span>: table;  <span class="comment">/* 触发BFC清除浮动 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">    <span class="attribute">*zoom</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>优点：代码简洁<br>缺点：IE6-7不支持:after，需要使用 <code>zoom: 1</code> 触发 <code>hasLayout</code></p>
<h3 id="使用after伪元素（我平常使用的）"><a href="#使用after伪元素（我平常使用的）" class="headerlink" title="使用after伪元素（我平常使用的）"></a>使用after伪元素（我平常使用的）</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">::after</span> &#123;  </span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;.&quot;</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">visibility</span>: hidden;</span><br><span class="line">    <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">    <span class="attribute">*zoom</span>: <span class="number">1</span>;</span><br><span class="line">&#125;   <span class="comment">/* IE6、7 专有 */</span></span><br></pre></td></tr></table></figure>

<p>使用方式：给浮动元素的父元素添加一个class类：<code>clearfix</code><br>优点：一次书写多处使用，并且符合闭合浮动思想，结构语义化正确<br>缺点：IE6-7不支持:after，需要使用 <code>zoom: 1</code> 触发 <code>hasLayout</code><br>注意：<code>content:&quot;.&quot;</code> 内容尽量不为空，可以跟一个小点，否则在firefox 7.0前的版本会生成空格</p>
<h2 id="after-和-after-的区别"><a href="#after-和-after-的区别" class="headerlink" title=":after 和 ::after 的区别"></a>:after 和 ::after 的区别</h2><p>:before、:after 在旧版本里是伪元素，CSS3的规范里 “:” 用来表示伪类，”::” 用来表示伪元素，但是在高版本浏览器下 :before、:after 会被自动识别为 ::before、::after ，这样做的目的是用来做兼容处理。</p>
<h3 id="相同点"><a href="#相同点" class="headerlink" title="相同点"></a>相同点</h3><p>伪类对象，用来设置对象前的内容<br>:before 和 ::before 写法是等效的</p>
<h3 id="不同点"><a href="#不同点" class="headerlink" title="不同点"></a>不同点</h3><p>:before 是 css2 的写法，::before 是 css3 的写法<br>:before 兼容性比 ::before要好</p>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>伪类元素必须要配合 content 属性一起使用，否则无效<br>伪类元素是css渲染层加入的，不能通过js来操作</p>
]]></content>
      <categories>
        <category>前端</category>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>布局</tag>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>如何解决0.1+0.2不等于0.3的问题</title>
    <url>/posts/21245/</url>
    <content><![CDATA[<h2 id="为何会出现此问题？"><a href="#为何会出现此问题？" class="headerlink" title="为何会出现此问题？"></a>为何会出现此问题？</h2><p>总结一句话：这是因为二进制模拟十进制进行运算时的精度问题。</p>
<p>具体可查看 <a href="https://juejin.im/post/5b90e00e6fb9a05cf9080dff">0.1 + 0.2 不等于 0.3？为什么 JavaScript 有这种“骚”操作？</a> 这篇掘金文章。</p>
<a id="more"></a>

<h2 id="如何解决"><a href="#如何解决" class="headerlink" title="如何解决"></a>如何解决</h2><h3 id="Number-EPSILON"><a href="#Number-EPSILON" class="headerlink" title="Number.EPSILON"></a>Number.EPSILON</h3><p>第一种方法是利用 <code>Number.EPSILON</code> ，这个值无限接近于 0。0.1+0.2 的精度误差在这个值的范围内：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numbersEqual</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.abs(a-b)&lt;<span class="built_in">Number</span>.EPSILON;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a=<span class="number">0.1</span>+<span class="number">0.2</span>， b=<span class="number">0.3</span>;</span><br><span class="line"><span class="built_in">console</span>.log(numbersEqual(a,b));    <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<h3 id="内置函数-toFixed"><a href="#内置函数-toFixed" class="headerlink" title="内置函数 toFixed"></a>内置函数 toFixed</h3><p>利用 <code>parseFloat</code> + 内置函数 toFixed：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatNum</span>(<span class="params">num, fixed = <span class="number">10</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// a.toFixed(fixed) 先转为小数点10位的字符串 &quot;0.3000000000&quot;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">parseFloat</span>(a.toFixed(fixed)); <span class="comment">// 然后通过parseFloat转为浮点数</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">0.1</span> + <span class="number">0.2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(formatNum(a)); <span class="comment">//0.3</span></span><br></pre></td></tr></table></figure>

<h3 id="内置函数-toPrecision"><a href="#内置函数-toPrecision" class="headerlink" title="内置函数 toPrecision"></a>内置函数 toPrecision</h3><p>我平常用此函数来计算精度，具体可参考 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Number/toPrecision">Number.prototype.toPrecision() | MDN</a>：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 内置函数toPrecision(中文：精确，精度)</span></span><br><span class="line"><span class="comment">// 参数是精度.比如5.1234，传2返回5.1，传1返回5；0.2+0.1传2返回0.30</span></span><br><span class="line">(<span class="number">0.1</span> + <span class="number">0.2</span>).toPrecision(<span class="number">10</span>) == <span class="number">0.3</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>技巧</tag>
      </tags>
  </entry>
  <entry>
    <title>字体侵权避坑指南</title>
    <url>/posts/9274/</url>
    <content><![CDATA[<h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p>本文摘录自：<a href="https://www.uisdc.com/avoiding-pits-in-font-copyright">https://www.uisdc.com/avoiding-pits-in-font-copyright</a></p>
<p><strong>初始设定：</strong>字体，微软雅黑。</p>
<p><strong>场景设定：</strong>因产品需要，客户希望在 windows 的客户端查看网站都能够和设计稿保持一致用微软雅黑。项目组给了两种前端解决方案：</p>
<ul>
<li>在 css 样式文件中：引用字体样式为微软雅黑。</li>
<li>在网站样式文件中，打包微软雅黑字体，客户打开网站会预加载微软雅黑字体。</li>
</ul>
<p>请问两种解决方案应该用哪一个？</p>
<a id="more"></a>

<p><strong>案例分析：</strong></p>
<p>应使用第一种方案，因为第一种方案，我们只是设定了如果载体有安装微软雅黑的字体的客户端，那网站显示字体，这个字体授权的控制单位在客户端那里。如果用第二种方案，我们预置了，不管任何客户端都加载微软雅黑字体，除非客户已经购买了微软雅黑所属的方正公司授权商用，否则即判定为字体侵权。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">font-family: &#x27;微软雅黑&#x27;;</span><br><span class="line"><span class="keyword">@font-face</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;MyFont&#x27;</span>; <span class="comment">/* 字体名称 */</span></span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;微软雅黑.ttf&#x27;</span>); <span class="comment">/*字体源文件*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="字体侵权情况"><a href="#字体侵权情况" class="headerlink" title="字体侵权情况"></a>字体侵权情况</h2><p>1 图片或视频中使用了版权字体。</p>
<ol start="2">
<li>网站本身引入了字体库文件（直接将整个字体库加载了，也就是说如果浏览者没有这个字体，则会下载这种）</li>
</ol>
]]></content>
      <categories>
        <category>设计</category>
        <category>平面</category>
      </categories>
      <tags>
        <tag>字体侵权</tag>
      </tags>
  </entry>
  <entry>
    <title>对this指向的判定</title>
    <url>/posts/33207/</url>
    <content><![CDATA[<h2 id="对-this-的理解"><a href="#对-this-的理解" class="headerlink" title="对 this 的理解"></a>对 this 的理解</h2><p>对于this指向的判定，时刻记住下面两点就好：</p>
<ul>
<li>普通函数的 this 指向是在函数的执行期间绑定的，换句话说 this 总是指向函数的<strong>直接</strong>调用者</li>
<li>箭头函数的 this 指向是在函数创建期间就绑定好了的，指向的是创建该箭头函数所在的作用域对象</li>
</ul>
<a id="more"></a>

<h2 id="普通函数中的this"><a href="#普通函数中的this" class="headerlink" title="普通函数中的this"></a>普通函数中的this</h2><p>这里直接引用 <a href="https://github.com/getify/You-Dont-Know-JS">You-Dont-Know-JS</a> 中对 this 的判定步骤：</p>
<ol>
<li>函数是通过 <code>new</code> 被调用的吗（<strong>new 绑定</strong>）？如果是，<code>this</code> 就是新构建的对象。<br><code>var bar = new foo()</code></li>
<li>函数是通过 <code>call</code> 或 <code>apply</code> 被调用（<strong>明确绑定</strong>），甚至是隐藏在 <code>bind</code> <em>硬绑定</em> 之中吗？如果是，<code>this</code> 就是那个被明确指定的对象。<br><code>var bar = foo.call( obj2 )</code></li>
<li>函数是通过环境对象（也称为拥有者或容器对象）被调用的吗（<strong>隐含绑定</strong>）？如果是，<code>this</code> 就是那个环境对象。<br><code>var bar = obj1.foo()</code></li>
<li>否则，使用默认的 <code>this</code>（<strong>默认绑定</strong>）。如果在 <code>strict mode</code> 下，就是 <code>undefined</code>，否则是 <code>global</code> 对象。<br><code>var bar = foo()</code></li>
</ol>
<h2 id="常见this指向"><a href="#常见this指向" class="headerlink" title="常见this指向"></a>常见this指向</h2><ul>
<li>普通函数中this ——&gt; window</li>
<li>构造函数中this ——&gt; new出来的实例对象</li>
<li>方法中的this ——&gt; 实例对象</li>
<li>原型中的方法中的this ——&gt; 实例对象</li>
<li>定时器中的this ——&gt; window</li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>this</tag>
      </tags>
  </entry>
  <entry>
    <title>对HTML语义化的理解</title>
    <url>/posts/2906/</url>
    <content><![CDATA[<h2 id="对HTML语义化的理解"><a href="#对HTML语义化的理解" class="headerlink" title="对HTML语义化的理解"></a>对HTML语义化的理解</h2><p>核心：用正确的标签做正确的事情</p>
<ol>
<li>利与开发：方便代码的阅读和维护</li>
<li>利于SEO：方便爬虫根据 语义标签 确定 页面结构 和 关键字 的权重</li>
</ol>
<a id="more"></a>

<h2 id="常见语义化标签"><a href="#常见语义化标签" class="headerlink" title="常见语义化标签"></a>常见语义化标签</h2><p>一图胜千言：</p>
<img src="/posts/2906/f8442d9e-e30d-11e6-85aa-3e3fb75f9695.jpg" class="" title="语义化demo">


<p>元素细节：</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/main">main</a> 存放每个页面独有的内容。每个页面上只能用一次 <code>&lt;main&gt;</code>，且直位于 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/body">``</a>中。最好不要把它嵌套进其它元素。</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/article">article</a> 包围的内容即一篇文章，与页面其它部分无关（比如一篇博文）。</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/section">section</a> 与 <code>&lt;article&gt;</code> 类似，但 <code>&lt;section&gt;</code> 更适用于组织页面使其按功能（比如迷你地图、一组文章标题和摘要）分块。一般的最佳用法是：以 <a href="https://developer.mozilla.org/en-US/Learn/HTML/Howto/Set_up_a_proper_title_hierarchy">标题</a> 作为开头；也可以把一篇 <code>&lt;article&gt;</code> 分成若干部分并分别置于不同的 <code>&lt;section&gt;</code> 中，也可以把一个区段 <code>&lt;section&gt;</code> 分成若干部分并分别置于不同的 <code>&lt;article&gt;</code> 中，取决于上下文。</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/aside">aside</a> 包含一些间接信息（术语条目、作者简介、相关链接，等等）。</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/header">header</a> 是简介形式的内容。如果它是 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/body">body</a> 的子元素，那么就是网站的全局页眉。如果它是 <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/article">article</a> 或<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/section">section</a> 的子元素，那么它是这些部分特有的页眉（此 <code>&lt;header&gt;</code> 非彼 <a href="https://developer.mozilla.org/zh-CN/docs/learn/HTML/Introduction_to_HTML/The_head_metadata_in_HTML#%E5%A2%9E%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%A0%87%E9%A2%98">标题</a>）。</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/nav">nav</a> 包含页面主导航功能。其中不应包含二级链接等内容。</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/footer">footer</a> 包含了页面的页脚部分。</li>
</ul>
<p>来源：<a href="https://developer.mozilla.org/zh-CN/docs/learn/HTML/Introduction_to_HTML/%E6%96%87%E4%BB%B6%E5%92%8C%E7%BD%91%E7%AB%99%E7%BB%93%E6%9E%84">文档与网站架构</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>HTML</category>
      </categories>
  </entry>
  <entry>
    <title>对闭包的理解</title>
    <url>/posts/29980/</url>
    <content><![CDATA[<h2 id="什么是闭包"><a href="#什么是闭包" class="headerlink" title="什么是闭包"></a>什么是闭包</h2><p>我一直认为，MDN是前端学习的在线指南。只要有不懂的语法，或者不懂的概念，查找资料的首选就应该是它。虽然早些年做iOS开发的时候就就接触过闭包，但如今已经忘得一干二净，所以在想要了解闭包的时候，第一件事就是在MDN中搜索。<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures">其中</a>给到了一个闭包的例子：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeFunc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">&quot;Mozilla&quot;</span>;    <span class="comment">// name 是一个被 init 创建的局部变量</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">displayName</span>(<span class="params"></span>) </span>&#123; <span class="comment">// displayName() 是内部函数,一个闭包</span></span><br><span class="line">        alert(name);         <span class="comment">// 使用了父函数中声明的变量</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> displayName;      <span class="comment">// 返回 displayName 这个函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myFunc = makeFunc();</span><br><span class="line">myFunc(); <span class="comment">// 当执行myFunc时，其实调用了displayName，会弹窗显示&quot;Mozilla&quot;</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p>在上面这个例子中，一个函数套了一个函数，且这个内部函数使用到了外部函数中的变量，这个时候就形成了闭包。有什么用呢？其中一个用处就如上面代码所示，能够让 makeFunc 函数外面也能访问 name 这个局部变量。换句话说，闭包缓存了数据，延长了作用域链。</p>
<p>Kyle Simpson编写的<a href="https://github.com/getify/You-Dont-Know-JS">You-Dont-Know-JS</a>中对闭包的总结我觉得很精髓：</p>
<blockquote>
<p>闭包就是当一个函数即使是在它的词法作用域之外被调用时，也可以记住并访问它的词法作用域。</p>
</blockquote>
<h2 id="闭包的特性"><a href="#闭包的特性" class="headerlink" title="闭包的特性"></a>闭包的特性</h2><ol>
<li>函数内再嵌套函数</li>
<li>内部函数可以引用外层的参数和变量</li>
<li>参数和变量不会被垃圾回收机制回收</li>
</ol>
<h2 id="闭包的用途"><a href="#闭包的用途" class="headerlink" title="闭包的用途"></a>闭包的用途</h2><h3 id="读取正确的值"><a href="#读取正确的值" class="headerlink" title="读取正确的值"></a>读取正确的值</h3><p>一个经典的例子，给 ul&gt;li 下面的每个 li 节点添加点击事件，让其弹出当前 li 元素的索引：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;ul id=<span class="string">&quot;testUL&quot;</span>&gt;</span><br><span class="line">    &lt;li&gt; index = <span class="number">0</span>&lt;/li&gt;</span><br><span class="line">    &lt;li&gt; index = <span class="number">1</span>&lt;/li&gt;</span><br><span class="line">    &lt;li&gt; index = <span class="number">2</span>&lt;/li&gt;</span><br><span class="line">    &lt;li&gt; index = <span class="number">3</span>&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">var</span> nodes = <span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nodes.length; i += <span class="number">1</span>) &#123;</span><br><span class="line">        nodes[i].onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<p>运行上述代码后就会发现，每次打印的结果都显示为4，而不是真正的索引值。这是因为点击事件的匿名函数发生在for循环之后，而for循环执行完毕时 i 的值就为4，所以点谁都是同样的结果。那么这个时候就能通过<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/%E7%AB%8B%E5%8D%B3%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%BC%8F">立即执行函数</a> + <strong>闭包</strong>的方法解决此问题：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> nodes = <span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;li&quot;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; nodes.length; i += <span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="javascript">        nodes[i].onclick = (<span class="function"><span class="keyword">function</span> (<span class="params">i</span>) </span>&#123; <span class="comment">// 1. IIFE创建一个函数作用域</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 4. 返回这个匿名函数，延长作用域链</span></span></span><br><span class="line"><span class="javascript">                <span class="comment">// 3. 内部嵌套的匿名函数使用到了IIFE的参数i，形成闭包</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(i);</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="javascript">        &#125;)(i); <span class="comment">// 2. 给IIFE传递每次for循环的i</span></span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个时候触发click事件，打印的值就是li元素的索引了。</p>
<h3 id="高级排他"><a href="#高级排他" class="headerlink" title="高级排他"></a>高级排他</h3><p>这个例子有点像上面的，现在我们要个需求：在一个 <code>ul li</code> 列表中，鼠标移入时高亮当前li标签，移除之前li标签的高亮状态。</p>
<p>常规写法如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 假设给li添加active类可以让标签高亮</span></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> list = <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;li&#x27;</span>)</span><br><span class="line">    <span class="comment">// 遍历每个标签</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> li = list[i]</span><br><span class="line">      li.onmouseover = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// mouseover触发后遍历整个列表，将所有标签class设为空</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; list.length; j++) &#123;</span><br><span class="line">          list[j].className = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 最后给当前li标签添加active</span></span><br><span class="line">        <span class="built_in">this</span>.className = <span class="string">&#x27;active&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>上面的代码能够实现功能，然而一旦列表非常长性能就不高，所以可以利用闭包来缓存li标签的索引，使其与标签一一对应：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> list = <span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;li&#x27;</span>)</span><br><span class="line">  <span class="comment">// 记录上一次选中的li标签的对应索引</span></span><br><span class="line">  <span class="keyword">let</span> preActiveIndex = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params">j</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> li = list[i]</span><br><span class="line">      li.onmouseover = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 清除上次li标签的高亮</span></span><br><span class="line">        list[preActiveIndex].className = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="comment">// 设置当前位高亮</span></span><br><span class="line">        <span class="built_in">this</span>.className = <span class="string">&#x27;active&#x27;</span></span><br><span class="line">        <span class="comment">// 赋值</span></span><br><span class="line">        preActiveIndex = j</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)(i)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="模块化开发"><a href="#模块化开发" class="headerlink" title="模块化开发"></a>模块化开发</h3><p>在团队开发中，为了避免命名冲突通常不同成员会把自己的代码单独封装起来，最后return一个对象出去，挂载到window上。这样其他人也可以使用，而且能在一定程度上避免命名冲突：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">w</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> money = <span class="number">1000</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    money *= <span class="number">10</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;赚了一笔钱，总资产：&quot;</span> + money + <span class="string">&quot;元&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    money--</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;花了一笔钱，总资产：&quot;</span> + money + <span class="string">&quot;元&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 向外暴露对象</span></span><br><span class="line">  w.myTools = &#123;</span><br><span class="line">    get,</span><br><span class="line">    set</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)(<span class="built_in">window</span>)</span><br></pre></td></tr></table></figure>

<h3 id="函数节流防抖"><a href="#函数节流防抖" class="headerlink" title="函数节流防抖"></a>函数节流防抖</h3><p>在日常开发中，我们也经常用到函数节流与防抖，通常我们会将它们封装为函数，这样可以在需要的地方直接调用使用，还不会污染全局：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>防抖节流<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 函数防抖 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, delay</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> timer = <span class="literal">null</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> ctx = <span class="built_in">this</span>,</span></span><br><span class="line"><span class="javascript">            args = <span class="built_in">arguments</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (timer) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">window</span>.clearTimeout(timer)</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        timer = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">          fn.apply(ctx, args)</span><br><span class="line"><span class="javascript">          timer = <span class="literal">null</span></span></span><br><span class="line">        &#125;, delay);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="comment">// 搜索框做函数防抖避免用户高频输入内容</span></span></span><br><span class="line"><span class="javascript">    input.addEventListener(<span class="string">&#x27;input&#x27;</span>, debounce(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(e.target.value)</span></span><br><span class="line">    &#125;, 500))</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 函数节流 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn, delay</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> canUse = <span class="literal">true</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> ctx = <span class="built_in">this</span>,</span></span><br><span class="line"><span class="javascript">            args = <span class="built_in">arguments</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (canUse) &#123;</span></span><br><span class="line">          fn.apply(ctx, args)</span><br><span class="line"><span class="javascript">          canUse = <span class="literal">false</span></span></span><br><span class="line"><span class="javascript">          <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            canUse = <span class="literal">true</span></span></span><br><span class="line">          &#125;, delay);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="javascript">    <span class="comment">// 对于像onresize这样的高频事件，可以使用函数节流让其回调函数中的代码隔一段时间再次执行</span></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.onresize = throttle(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      input.value = <span class="built_in">Math</span>.random() * <span class="number">100</span></span></span><br><span class="line">    &#125;, 1000)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="内存泄漏"><a href="#内存泄漏" class="headerlink" title="内存泄漏"></a>内存泄漏</h2><p>其实闭包并不会造成内存泄漏，现在的垃圾回收机制已经很成熟了。但早期的IE（ie4-ie6）版本里，对宿主对象（也就是document对象）采用是引用计数的<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Memory_Management">垃圾回收机制</a>，闭包导致内存泄漏的一个原因就是这个算法的一个缺陷。循环引用会导致没法回收，这个循环引用只限定于有宿主对象参与的循环引用，而js对象之间即使形成循环引用，也不会产生内存泄漏，因为对js对象的回收算法不是计数的方式：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">closure</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;oDiv&#x27;</span>);<span class="comment">//oDiv用完之后一直驻留在内存中</span></span><br><span class="line">    oDiv.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;oDiv.innerHTML&#x27;</span>);<span class="comment">//这里用oDiv导致内存泄露</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以上代码创建了一个作为 div 元素事件处理程序的闭包，而这个闭包则又创建了一个循环引用。</span></span><br><span class="line"><span class="comment">// 由于匿名函数保存了一个对closure()的活动对象的引用，因此就会导致无法减少 div 的引用数。</span></span><br><span class="line"><span class="comment">// 只要匿名函数存在，element 的引用数至少也是1，因此它所占用的内存就永远不会被回收</span></span><br><span class="line"></span><br><span class="line">closure();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//最后应将oDiv解除引用来避免内存泄露</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">closure</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> oDiv = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;oDiv&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> test = oDiv.innerHTML;</span><br><span class="line">    oDiv.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(test);</span><br><span class="line">    &#125;;</span><br><span class="line">    oDiv = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 解决办法: 把 oDiv.innerHTML 的一个副本保存在一个变量中，</span></span><br><span class="line"><span class="comment">// 从而消除闭包中该变量的循环引用,同时将 oDiv 变量设为null。</span></span><br></pre></td></tr></table></figure>

<p>所以我们要保持良好的编程习惯，在使用完闭包后记得释放内存：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">9999999999999</span>)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(arr)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fn2</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> f = fn1()</span><br><span class="line">f() <span class="comment">// 调用完后没有释放，arr就会一直在内存中占着，导致内存泄漏</span></span><br><span class="line"><span class="comment">// 记得释放</span></span><br><span class="line">f = <span class="literal">null</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
      <tags>
        <tag>闭包</tag>
      </tags>
  </entry>
  <entry>
    <title>常见排序算法</title>
    <url>/posts/59937/</url>
    <content><![CDATA[<h2 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h2><p>冒泡排序是一种交换排序，基本思想是：两两比较相邻记录的关键字，如果反序则交换，直到没有反序的记录为止。</p>
<h3 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h3><ol>
<li>比较相邻的元素。如果第一个比第二个大，就交换他们两个。</li>
<li>对每一对相邻元素作同样的工作，从开始第一对到结尾的最后一对。这步做完后，最后的元素会是最大的数。</li>
<li>针对所有的元素重复以上的步骤，除了最后一个。</li>
<li>持续每次对越来越少的元素重复上面的步骤，直到没有任何一对数字需要比较。</li>
</ol>
<h3 id="动图演示"><a href="#动图演示" class="headerlink" title="动图演示"></a>动图演示</h3><img src="/posts/59937/%E5%86%92%E6%B3%A1.gif" class="" title="冒泡">

<a id="more"></a>

<p>———— 动图来自《菜鸟教程》</p>
<p>说明：绿色表示当前正在比较的两个相邻元素；橘黄色表示已排完序的元素，不再参与后续的比较</p>
<h3 id="代码实现（JS）"><a href="#代码实现（JS）" class="headerlink" title="代码实现（JS）"></a>代码实现（JS）</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">36</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">48</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myBubbleSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length, temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123; <span class="comment">// 趟数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; len - <span class="number">1</span> - i; j++) &#123; <span class="comment">// 当前趟要比较的次数</span></span><br><span class="line">            <span class="keyword">if</span> (arr[j] &gt; arr[j+<span class="number">1</span>]) &#123;        <span class="comment">// 相邻元素两两比较</span></span><br><span class="line">                temp = arr[j];              <span class="comment">// 元素交换</span></span><br><span class="line">                arr[j] = arr[j+<span class="number">1</span>];</span><br><span class="line">                arr[j+<span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码与图片配合食用更加~</p>
<img src="/posts/59937/%E5%86%92%E6%B3%A12.png" class="" title="冒泡2">

<hr>
<h2 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h2><p>选择排序是一种简单直观的排序算法，无论什么数据进去都是 O(n²) 的时间复杂度。所以用到它的时候，数据规模越小越好。唯一的好处可能就是不占用额外的内存空间了吧。</p>
<h3 id="算法步骤-1"><a href="#算法步骤-1" class="headerlink" title="算法步骤"></a>算法步骤</h3><ol>
<li>首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置。</li>
<li>再从剩余未排序元素中继续寻找最小（大）元素，然后放到已排序序列的末尾。</li>
<li>重复第2步，直到所有元素均排序完毕。</li>
</ol>
<h3 id="动图演示-1"><a href="#动图演示-1" class="headerlink" title="动图演示"></a>动图演示</h3><img src="/posts/59937/%E9%80%89%E6%8B%A9.gif" class="" title="选择">

<h3 id="代码实现（JS）-1"><a href="#代码实现（JS）-1" class="headerlink" title="代码实现（JS）"></a>代码实现（JS）</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">36</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">48</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mySelectionSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length;</span><br><span class="line">    <span class="keyword">var</span> minIndex, temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++) &#123;       <span class="comment">// 第 i 轮选择</span></span><br><span class="line">        minIndex = i;                         <span class="comment">// 每轮开始假设起始元素为最小值</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = i + <span class="number">1</span>; j &lt; len; j++) &#123;   <span class="comment">// 遍历剩余未排序元素</span></span><br><span class="line">            <span class="keyword">if</span> (arr[j] &lt; arr[minIndex]) &#123;     <span class="comment">// 寻找最小的数</span></span><br><span class="line">                minIndex = j;                 <span class="comment">// 将最小数的索引保存</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        temp = arr[i];                         <span class="comment">// 交换起始元素与真正的最小值</span></span><br><span class="line">        arr[i] = arr[minIndex];</span><br><span class="line">        arr[minIndex] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配图：</p>
<img src="/posts/59937/%E9%80%89%E6%8B%A92.png" class="" title="选择2">

<hr>
<h2 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h2><p>插入排序的原理应该是最容易理解的，因为只要你打过扑克牌就应该能秒懂。插入排序是一种最简单直观的排序算法，它的工作原理是通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。</p>
<h3 id="算法步骤-2"><a href="#算法步骤-2" class="headerlink" title="算法步骤"></a>算法步骤</h3><ol>
<li>从第一个元素开始，该元素可以认为已经被排序；</li>
<li>取出下一个元素，在已经排序的元素序列中从后向前扫描；</li>
<li>如果该元素（已排序）大于新元素，将该元素移到下一位置；</li>
<li>重复步骤3，直到找到已排序的元素小于或者等于新元素的位置；</li>
<li>将新元素插入到该位置后；</li>
<li>重复步骤2~5。</li>
</ol>
<h3 id="动图演示-2"><a href="#动图演示-2" class="headerlink" title="动图演示"></a>动图演示</h3><img src="/posts/59937/%E6%8F%92%E5%85%A5.gif" class="" title="插入">

<h3 id="代码实现（JS）-2"><a href="#代码实现（JS）-2" class="headerlink" title="代码实现（JS）"></a>代码实现（JS）</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">36</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">48</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myInsertSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length;</span><br><span class="line">    <span class="keyword">var</span> insertItem; <span class="comment">// 要插入的元素</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从数组的第二个元素开始循环将数组中的元素插入</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; len; i++) &#123;</span><br><span class="line">        insertItem = arr[i]; <span class="comment">// 设置数组中的第2个元素为第一次遍历要插入的数据</span></span><br><span class="line">        <span class="keyword">var</span> j = i - <span class="number">1</span>;       <span class="comment">// 已排序好数组的最后一个元素的索引</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将已排好序的元素从最后一个往前依次与待插入元素比较，</span></span><br><span class="line">        <span class="keyword">while</span> (j &gt;= <span class="number">0</span> &amp;&amp; insertItem &lt; arr[j]) &#123;</span><br><span class="line">            <span class="comment">// 如果要插入的元素小于第j个元素,就将第j个元素向后移动</span></span><br><span class="line">            arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 直到要插入的元素不小于第j个元素,将insertNote插入到数组中</span></span><br><span class="line">        arr[j + <span class="number">1</span>] = insertItem;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 例如for循环中 i 等于 2 时，已排序完毕的元素为[3,44]，进入for循环</span></span><br><span class="line">    <span class="comment">// 待插入元素为 arr[2]，也就是38;</span></span><br><span class="line">    <span class="comment">// j=i-1也就是2-1等于1</span></span><br><span class="line">    <span class="comment">// while循环比较，待插入元素38是小于arr[j]（j=1）44 的 =&gt; 条件成立</span></span><br><span class="line">        <span class="comment">// arr[j+1]要等于arr[j] =&gt; arr[2]要等于arr[1] =&gt; arr[2]=44 =&gt; 此刻数组前三个元素：[3,44,44]</span></span><br><span class="line">        <span class="comment">// j-- =&gt; j=1-1也就是0</span></span><br><span class="line">    <span class="comment">// 再来一轮while比较，待插入元素38现在不小于arr[j] 也就是arr[0]的3，所以直接退出while循环</span></span><br><span class="line">    <span class="comment">// arr[j+1]=insertItem =&gt; arr[1]=38 =&gt; 数组前三排序完毕：[3,38,44]</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h2><p>希尔排序也是一种插入排序，它是简单插入排序的一个改进版，也称为缩小增量排序，同时该算法是冲破O(n2）的第一批算法之一。本文会以图解的方式详细介绍希尔排序的基本思想及其代码实现。</p>
<p>希尔排序是把记录按下标的一定增量分组，对每组使用直接插入排序算法排序；随着增量逐渐减少，每组包含的关键词越来越多，当增量减至1时，整个文件恰被分成一组，算法便终止。</p>
<h3 id="算法步骤-示例"><a href="#算法步骤-示例" class="headerlink" title="算法步骤(示例)"></a>算法步骤(示例)</h3><p>在此我们选择增量 <code>gap=数组长度length/2</code>，缩小增量继续以 <code>gap = gap/2</code> 的方式，这种增量选择我们可以用一个序列来表示：<code>&#123;n/2,(n/2)/2...1&#125;</code>，称为增量序列。当然，希尔排序的增量序列有很多种，这里采用的是比较常用的一种作为示例：</p>
<img src="/posts/59937/%E5%B8%8C%E5%B0%94.png" class="" title="希尔排序">

<p>在上面这幅图中：</p>
<p>初始时，有一个大小为 10 的无序序列。</p>
<p>在第一趟排序中，我们设 gap1 = 10 / 2 = 5，即相隔距离为 5 的元素组成一组，可以分为 5 组。接下来，按照直接插入排序的方法对每个组进行排序。</p>
<p>在第二趟排序中，我们把上次的 gap 缩小一半，即 gap2 = gap1 / 2 = 2 (取整)。这样每相隔距离为 2 的元素组成一组，可以分为 2 组。按照直接插入排序的方法对每个组进行排序。</p>
<p>在第三趟排序中，再次把 gap 缩小一半，即gap3 = gap2 / 2 = 1。 这样相隔距离为 1 的元素组成一组，即只有一组。按照直接插入排序的方法对每个组进行排序。此时，排序已经结束。</p>
<p><strong>注意</strong>：图中有两个相等数值的元素 5 和 5 。我们可以清楚的看到，在排序过程中，两个元素位置交换了。<br>所以，希尔排序是不稳定的算法。</p>
<h3 id="代码演示（JS）"><a href="#代码演示（JS）" class="headerlink" title="代码演示（JS）"></a>代码演示（JS）</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">36</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">48</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myShellSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> gap = <span class="built_in">Math</span>.floor(arr.length / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span> &lt;= gap) &#123;</span><br><span class="line">        <span class="comment">// 把距离为 gap 的元素编为一个组，扫描所有组</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = gap; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">var</span> j = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> temp = arr[i];</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 对距离为 gap 的元素组进行排序</span></span><br><span class="line">            <span class="keyword">for</span> (j = i - gap; j &gt;= <span class="number">0</span> &amp;&amp; temp &lt; arr[j]; j = j - gap) &#123;</span><br><span class="line">                arr[j + gap] = arr[j];</span><br><span class="line">            &#125;</span><br><span class="line">            arr[j + gap] = temp;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`gap = <span class="subst">$&#123;gap&#125;</span>`</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(arr);</span><br><span class="line">        gap = <span class="built_in">Math</span>.floor(gap / <span class="number">2</span>); <span class="comment">// 减小增量</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h2><p>归并排序是利用归并的思想实现的排序方法，该算法采用经典的分治策略（分治法将问题分成一些小的问题然后递归求解，而治的阶段则将分的阶段得到的各答案”修补”在一起，即分而治之)。</p>
<img src="/posts/59937/%E5%BD%92%E5%B9%B6.png" class="" title="分而治之">

<p>可以看到这种结构很像一棵完全二叉树，下面的归并排序代码将会采用递归去实现（你也可采用迭代的方式去实现）。<strong>分</strong>阶段可以理解为就是递归拆分子序列的过程，递归深度为logn。</p>
<h3 id="算法步骤-3"><a href="#算法步骤-3" class="headerlink" title="算法步骤"></a>算法步骤</h3><ol>
<li>申请空间，使其大小为两个已经排序序列之和，该空间用来存放合并后的序列</li>
<li>设定两个指针，最初位置分别为两个已经排序序列的起始位置</li>
<li>比较两个指针所指向的元素，选择相对小的元素放入到合并空间，并移动指针到下一位置</li>
<li>重复步骤 3 直到某一指针达到序列尾</li>
<li>将另一序列剩下的所有元素直接复制到合并序列尾</li>
</ol>
<h3 id="图片演示"><a href="#图片演示" class="headerlink" title="图片演示"></a>图片演示</h3><img src="/posts/59937/%E5%BD%92%E5%B9%B62.png" class="" title="归并排序">

<p>图片来自博客<a href="https://www.cnblogs.com/chengxiao/p/6194356.html">《图解排序算法之归并排序》</a></p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">36</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">48</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSort</span>(<span class="params">arr</span>) </span>&#123; <span class="comment">// 采用自上而下的递归方法</span></span><br><span class="line">    <span class="keyword">var</span> len = arr.length;</span><br><span class="line">    <span class="keyword">if</span> (len &lt; <span class="number">2</span>) <span class="keyword">return</span> arr;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">var</span> middle = <span class="built_in">Math</span>.floor(len / <span class="number">2</span>), <span class="comment">// 将未排序数组拆分成两半分而治之</span></span><br><span class="line">        left = arr.slice(<span class="number">0</span>, middle),</span><br><span class="line">        right = arr.slice(middle);</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> merge(mergeSort(left), mergeSort(right));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">left, right</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (left.length &amp;&amp; right.length) &#123;</span><br><span class="line">      	<span class="comment">// 两边的起始元素相互比较，始终将小的一方的头元素弹出，并push到准备好的容器result中</span></span><br><span class="line">        <span class="keyword">if</span> (left[<span class="number">0</span>] &lt;= right[<span class="number">0</span>]) &#123;</span><br><span class="line">            result.push(left.shift());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result.push(right.shift());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (left.length)</span><br><span class="line">        result.push(left.shift());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (right.length)</span><br><span class="line">        result.push(right.shift());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h2><p>快速排序的基本思想是：通过一趟排序将待排记录分割成独立的两部分，其中一部分记录的元素均比另一部分记录的元素小，继而再分别对这两部分记录递归的进行同样的排序操作。</p>
<h3 id="算法步骤-4"><a href="#算法步骤-4" class="headerlink" title="算法步骤"></a>算法步骤</h3><ol>
<li>把数组中第一个元素当做一个基准值，称为“基准”（Pivot）</li>
</ol>
<img src="/posts/59937/%E5%BF%AB%E6%8E%92.png" class="" title="快排">

<ol>
<li>重新排序数列，把所有比基准值小的元素摆放在基准前面，所有比基准值大元素摆放在基准后面。在这个分区退出之后，该基准就处于数列的中间位置。这个称为分区（partition）操作；</li>
</ol>
<img src="/posts/59937/%E5%BF%AB%E6%8E%922.png" class="" title="快排2">

<img src="/posts/59937/%E5%BF%AB%E6%8E%923.png" class="" title="快排3">

<ol>
<li>递归地把小于基准值元素的子数列和大于基准值元素的子数列排序；</li>
</ol>
<img src="/posts/59937/%E5%BF%AB%E6%8E%924.png" class="" title="快排4">

<h3 id="分区（Partition）思路"><a href="#分区（Partition）思路" class="headerlink" title="分区（Partition）思路"></a>分区（Partition）思路</h3><p>首先把未排序数组的第一个（最左边）元素设置为基准，把它的位置叫做 <code>l</code> ：</p>
<img src="/posts/59937/%E5%BF%AB%E6%8E%925.png" class="" title="快排5">

<p>然后依次向后查看所有元素，在查看过程中，不断的调整后面元素的位置，使得后面的元素分为两部分，一部分都小于 v ；一部分都大于 v 。</p>
<p>我们用 <code>j</code> 来不断记录这两部分的分割线位置。而 e 就是我们要判断的下一个元素，用索引 <code>i</code> 来表示，<code>i</code> 会遍历每一个元素，来看该如何调整这个元素。</p>
<p>在下图中，我们用 <code>arr[l+1 ... j]</code> 来表示小于 v 的橙色部分，用 <code>arr[j+1 ... i-1]</code> 来表示大于 v 的紫色部分。</p>
<img src="/posts/59937/%E5%BF%AB%E6%8E%926.png" class="" title="快排6">

<p>接下来就要看如何来调整下一个元素 e 的位置。分情况讨论：</p>
<p><strong>当 e 大于 v 时</strong>，我们直接让 e 融入大于 v 的部分，并让 <code>i++</code></p>
<img src="/posts/59937/%E5%BF%AB%E6%8E%927.png" class="" title="快排7">

<img src="/posts/59937/%E5%BF%AB%E6%8E%928.png" class="" title="快排8">


<p><strong>当 e 小于 v 时</strong>，我们让 e 和大于 v 部分的第一个元素交换位置。</p>
<img src="/posts/59937/%E5%BF%AB%E6%8E%929.png" class="" title="快排9">

<img src="/posts/59937/%E5%BF%AB%E6%8E%9210.png" class="" title="快排10">

<p>把 e 融入到小于 v 的部分。此时就需要让分隔线的索引位置 <code>j++</code> ，相应的，索引 <code>i</code> 的位置也要 <code>i++</code> 以便查看下一个元素。</p>
<img src="/posts/59937/%E5%BF%AB%E6%8E%9211.png" class="" title="快排11">

<img src="/posts/59937/%E5%BF%AB%E6%8E%9212.png" class="" title="快排12">

<p>以这样的步骤我们就能遍历完整个数组，如下图所示</p>
<img src="/posts/59937/%E5%BF%AB%E6%8E%9213.png" class="" title="快排13">


<p>现在还差最后一个步骤，那就是把基准值 v ，与小于 v 部分的最后一个元素交换位置。此刻 v 左边都小于它，v 右边都大于它，而 <code>j</code> 指向的就是基准值所在的位置。这样我们就完成了分区（Partition）操作。</p>
<img src="/posts/59937/%E5%BF%AB%E6%8E%9214.png" class="" title="快排14">

<h3 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">36</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">48</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSort</span>(<span class="params">arr, left, right</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length,</span><br><span class="line">        partitionIndex,         <span class="comment">// 分区索引</span></span><br><span class="line">        left = <span class="keyword">typeof</span> left != <span class="string">&#x27;number&#x27;</span> ? <span class="number">0</span> : left,</span><br><span class="line">        right = <span class="keyword">typeof</span> right != <span class="string">&#x27;number&#x27;</span> ? len - <span class="number">1</span> : right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (left &gt;= right) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过分区找到分隔点，再分别快排左右两部分</span></span><br><span class="line">    partitionIndex = partition(arr, left, right);</span><br><span class="line">    quickSort(arr, left, partitionIndex - <span class="number">1</span>);</span><br><span class="line">    quickSort(arr, partitionIndex + <span class="number">1</span>, right);</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partition</span>(<span class="params">arr, left, right</span>) </span>&#123; <span class="comment">// 分区操作</span></span><br><span class="line">    <span class="keyword">var</span> v = left,   <span class="comment">// 设定基准值（pivot）</span></span><br><span class="line">        j = left;  <span class="comment">// arr[l+1...j] ; arr[j+1...i]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = j + <span class="number">1</span>; i &lt;= right; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i] &lt; arr[v]) &#123; <span class="comment">// 当前要判断元素 小于 基准元素时</span></span><br><span class="line">            j++; <span class="comment">// 分隔点右移</span></span><br><span class="line">            swap(arr, i, j);   <span class="comment">// 让 当前元素 与大于 v 部分的第一个元素交换位置</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 此处不用写 else ，因为当大于基准元素时，直接i++就好，</span></span><br><span class="line">        <span class="comment">// 而i++，for循环已经帮我们做了</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 循环完毕后，交换基准值和小于v部分的最后一个元素的位置</span></span><br><span class="line">    swap(arr, v, j);</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">swap</span>(<span class="params">arr, i, j</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temp = arr[i];</span><br><span class="line">    arr[i] = arr[j];</span><br><span class="line">    arr[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(quickSort(arr, <span class="number">0</span>, arr.length));</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="计数排序"><a href="#计数排序" class="headerlink" title="计数排序"></a>计数排序</h2><p>计数排序不是基于比较的排序算法，其核心在于将输入的数据值转化为键存储在额外开辟的数组空间中。 作为一种线性时间复杂度的排序，计数排序要求输入的数据必须是有确定范围的整数。</p>
<h3 id="算法步骤-5"><a href="#算法步骤-5" class="headerlink" title="算法步骤"></a>算法步骤</h3><ol>
<li>找出待排序的数组中最大和最小的元素；</li>
<li>统计数组中每个值为 i 的元素出现的次数，存入数组 Count 的第 i 项；</li>
<li>对所有的计数累加（从 Count 中的第一个元素开始，每一项和前一项相加）；</li>
<li>反向填充目标数组：将每个元素 i 放在新数组的第 Count(i) 项，每放一个元素就将 Count(i) 减去1。</li>
</ol>
<h3 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">36</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">48</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">countingSort</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> len = arr.length,</span><br><span class="line">        Result = [],</span><br><span class="line">        Count = [],</span><br><span class="line">        min = max = arr[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查找最大最小值,并将arr数置入Count数组中,统计出现次数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        min = min &lt;= arr[i] ? min : arr[i];</span><br><span class="line">        max = max &gt;= arr[i] ? max : arr[i];</span><br><span class="line">        Count[arr[i]] = Count[arr[i]] ? Count[arr[i]] + <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从最小值-&gt;最大值,将计数逐项相加</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = min; j &lt; max; j++) &#123;</span><br><span class="line">        Count[j + <span class="number">1</span>] = (Count[j + <span class="number">1</span>] || <span class="number">0</span>) + (Count[j] || <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Count中,下标为arr数值,数据为arr数值出现次数;反向填充数据进入Result数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k = len - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--) &#123;</span><br><span class="line">        <span class="comment">// Result[位置] = arr数据</span></span><br><span class="line">        Result[Count[arr[k]] - <span class="number">1</span>] = arr[k];</span><br><span class="line">        <span class="comment">// 减少Count数组中保存的计数</span></span><br><span class="line">        Count[arr[k]]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(countingSort(arr));</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>后端</category>
        <category>算法</category>
      </categories>
  </entry>
  <entry>
    <title>【转载】常见正则表达式合集</title>
    <url>/posts/40424/</url>
    <content><![CDATA[<p>转载来源：<a href="http://obkoro1.com/web_accumulate/codeBlack/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%94%B6%E9%9B%86.html#%E5%B8%B8%E8%A7%81%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%90%88%E9%9B%86">常见正则表达式合集</a></p>
<p>为了避免用户胡乱输入就通过验证，很多时候我们都会采用正则表达式来验证一下用户输入的信息是否符合规范。这部分的内容基本上是在网上收集来的，这里跟大家一起分享一下，有需要的可以记在自己的有道云笔记里面。</p>
<a id="more"></a>

<h3 id="如何验证？"><a href="#如何验证？" class="headerlink" title="如何验证？"></a>如何验证？</h3><p>验证的方式当然是很多了，这里推荐采用<a href="http://www.w3school.com.cn/js/jsref_test_regexp.asp">test()</a>方法来验证。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = RegExpObject.test(string);<span class="comment">// RegExpObject为正则 string是要检测的字符串</span></span><br><span class="line"><span class="comment">// 如果字符串 string 中含有与 RegExpObject 匹配的文本，则返回 true，否则返回 false。</span></span><br><span class="line"><span class="keyword">if</span> (isTrue)&#123;</span><br><span class="line">    <span class="comment">//验证成功 do something</span></span><br><span class="line">&#125;elseP&#123;</span><br><span class="line">    <span class="comment">//验证失败</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="身份证号码正则表达式："><a href="#身份证号码正则表达式：" class="headerlink" title="身份证号码正则表达式："></a>身份证号码正则表达式：</h3><p>第一代身份证只有 15 位数，第二代身份证有 18 位数，各位按照需求来选择表达式。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第二代身份证号码正则</span></span><br><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^[1-9]\d&#123;5&#125;(18|19|20)\d&#123;2&#125;((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d&#123;3&#125;[0-9Xx]$/</span>;</span><br><span class="line"><span class="comment">//第一代身份证正则表达式(15位)</span></span><br><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^[1-9]\d&#123;7&#125;((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d&#123;3&#125;$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="手机号码正则表达式："><a href="#手机号码正则表达式：" class="headerlink" title="手机号码正则表达式："></a>手机号码正则表达式：</h3><p>时间截止为：2018 年 1 月 11 日</p>
<ul>
<li>移动号段：134 135 136 137 138 139 147 148 150 151 152 157 158 159 172 178 182 183 184 187 188 198</li>
<li>联通号段：130 131 132 145 146 155 156 166 171 175 176 185 186</li>
<li>电信号段：133 149 153 173 174 177 180 181 189 199</li>
<li>虚拟运营商：170</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^(13[0-9]|14[5-9]|15[012356789]|166|17[0-8]|18[0-9]|19[8-9])[0-9]&#123;8&#125;$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="邮箱正则表达式："><a href="#邮箱正则表达式：" class="headerlink" title="邮箱正则表达式："></a>邮箱正则表达式：</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^([A-Za-z0-9_\-\.\u4e00-\u9fa5])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]&#123;2,8&#125;)$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="用户名正则"><a href="#用户名正则" class="headerlink" title="用户名正则:"></a>用户名正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//用户名正则，4到16位（字母，数字，下划线，减号）</span></span><br><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^[a-zA-Z0-9_-]&#123;4,16&#125;$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="密码正则"><a href="#密码正则" class="headerlink" title="密码正则:"></a>密码正则:</h3><p>密码正则，以字母开头，长度在 6~18 之间，只能包含字母、数字和下划线</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue =^[a-zA-Z]\w&#123;<span class="number">5</span>,<span class="number">17</span>&#125;$;</span><br></pre></td></tr></table></figure>

<p>强密码正则，最少 6 位，包括至少 1 个大写字母，1 个小写字母，1 个数字，1 个特殊字符</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^.*(?=.&#123;6,&#125;)(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&amp;*? ]).*$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="QQ-号码正则"><a href="#QQ-号码正则" class="headerlink" title="QQ 号码正则:"></a>QQ 号码正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^[1-9][0-9]&#123;4,10&#125;$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="微信号码正则"><a href="#微信号码正则" class="headerlink" title="微信号码正则:"></a>微信号码正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//微信号正则，6至20位，以字母开头，字母，数字，减号，下划线</span></span><br><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^[a-zA-Z]([-_a-zA-Z0-9]&#123;5,19&#125;)+$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="特殊字符检测正则"><a href="#特殊字符检测正则" class="headerlink" title="特殊字符检测正则:"></a>特殊字符检测正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/[&quot;&#x27;&lt;&gt;%;)(&amp;+]+-!！@#$~/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="域名正则"><a href="#域名正则" class="headerlink" title="域名正则:"></a>域名正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue=[a-zA-Z0-<span class="number">9</span>][-a-zA-Z0-<span class="number">9</span>]&#123;<span class="number">0</span>,<span class="number">62</span>&#125;(<span class="regexp">/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/</span>.?;</span><br></pre></td></tr></table></figure>

<h3 id="车牌号码正则"><a href="#车牌号码正则" class="headerlink" title="车牌号码正则:"></a>车牌号码正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]&#123;1&#125;[A-Z]&#123;1&#125;[A-Z0-9]&#123;4&#125;[A-Z0-9挂学警港澳]&#123;1&#125;$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="包含中文正则"><a href="#包含中文正则" class="headerlink" title="包含中文正则:"></a>包含中文正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/[\u4E00-\u9FA5]/</span>;</span><br><span class="line"><span class="comment">//这个可以用于验证用户的真实姓名。</span></span><br></pre></td></tr></table></figure>

<h3 id="护照正则"><a href="#护照正则" class="headerlink" title="护照正则:"></a>护照正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^(P\d&#123;7&#125;|G\d&#123;7,8&#125;|TH\d&#123;7,8&#125;|S\d&#123;7,8&#125;|A\d&#123;7,8&#125;|L\d&#123;7,8&#125;|\d&#123;9&#125;|D\d+|1[4,5]\d&#123;7&#125;)$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="固定电话正则："><a href="#固定电话正则：" class="headerlink" title="固定电话正则："></a>固定电话正则：</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue=(\(\d&#123;<span class="number">3</span>,<span class="number">4</span>&#125;\)|\d&#123;<span class="number">3</span>,<span class="number">4</span>&#125;-|\s)?\d&#123;<span class="number">8</span>&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="IP-地址正则"><a href="#IP-地址正则" class="headerlink" title="IP 地址正则:"></a>IP 地址正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue=\d+\.\d+\.\d+\.\d+;</span><br></pre></td></tr></table></figure>

<h3 id="邮政编码正则"><a href="#邮政编码正则" class="headerlink" title="邮政编码正则:"></a>邮政编码正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> isTrue=[<span class="number">1</span>-<span class="number">9</span>]&#123;<span class="number">1</span>&#125;(\d+)&#123;<span class="number">5</span>&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="经纬度正则"><a href="#经纬度正则" class="headerlink" title="经纬度正则:"></a>经纬度正则:</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//经度正则</span></span><br><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^(\-|\+)?(((\d|[1-9]\d|1[0-7]\d|0&#123;1,3&#125;)\.\d&#123;0,6&#125;)|(\d|[1-9]\d|1[0-7]\d|0&#123;1,3&#125;)|180\.0&#123;0,6&#125;|180)$/</span>;</span><br><span class="line"><span class="comment">//纬度正则</span></span><br><span class="line"><span class="keyword">let</span> isTrue = <span class="regexp">/^(\-|\+)?([0-8]?\d&#123;1&#125;\.\d&#123;0,6&#125;|90\.0&#123;0,6&#125;|[0-8]?\d&#123;1&#125;|90)$/</span>;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>前端</category>
        <category>正则</category>
      </categories>
      <tags>
        <tag>转载</tag>
      </tags>
  </entry>
  <entry>
    <title>数组的遍历方法</title>
    <url>/posts/64478/</url>
    <content><![CDATA[<p>下面是总结的数组遍历的常见方法</p>
<h2 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h2><ul>
<li>标准for循环</li>
<li>forEach((当前值, 当前索引, 当前数组) =&gt; {…}, [, 绑定的this])`<ul>
<li>无法中途退出循环，只能用 return 退出本次回调，进行下一次回调</li>
<li>它总是返回 undefined 值，即使你 return 了一个值</li>
</ul>
</li>
<li>for…in（不推荐）会把继承链的对象属性都会遍历一遍，而且数组遍历不一定按次序<ul>
<li>for-in 循环返回的是所有能通过对象访问的、可枚举的属性</li>
</ul>
</li>
<li>for (variable of iterable)（ES6）可迭代Array，Map，Set，String等（迭代的是值value）<ul>
<li>在 for..of 中如果遍历中途要退出，可以使用 break 退出循环</li>
</ul>
</li>
</ul>
<a id="more"></a>

<h2 id="ES5"><a href="#ES5" class="headerlink" title="ES5"></a>ES5</h2><ul>
<li><p>map (不改变原数组) 会给原数组中的每个元素都按顺序调用一次 callback 函数</p>
</li>
<li><p>reduce (不改变原数组) 数组中的前项和后项做某种计算,并累计最终值。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 语法：</span></span><br><span class="line"><span class="comment">// arr.reduce(function(total, currentValue, currentIndex, arr), initialValue)</span></span><br><span class="line"><span class="comment">// callback 参数</span></span><br><span class="line"><span class="comment">// (累积器, 当前元素, 当前元素索引, 当前数组)</span></span><br><span class="line"><span class="comment">// initialValue:指定第一次回调 的第一个参数</span></span><br><span class="line"><span class="keyword">var</span> wallets = [<span class="number">4</span>, <span class="number">7.8</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">var</span> totalMoney = wallets.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">countedMoney, curMoney</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> countedMoney + curMoney;</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>filter (不改变原数组)</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="keyword">var</span> morearr = arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">number</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> number &gt; <span class="number">3</span></span><br><span class="line">&#125;) <span class="comment">// [4,5,6]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>every (不改变原数组) 测试数组的所有元素是否都通过了指定函数的测试</p>
<ul>
<li>如果数组中检测到有一个元素不满足，则整个表达式返回 false ，且剩余的元素不会再进行检测</li>
<li>如果所有元素都满足条件，则返回 true</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> result = arr.every(<span class="function"><span class="keyword">function</span> (<span class="params">item, index</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">2</span></span><br><span class="line">&#125;) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>some (不改变原数组) 测试是否至少有一个元素通过 callback 中的条件。对于放在空数组上的任何条件，此方法返回 false</p>
<ul>
<li>如果有一个元素满足条件，则表达式返回true, 剩余的元素不会再执行检测</li>
<li>如果没有满足条件的元素，则返回false</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// some(callback, thisArg)</span></span><br><span class="line"><span class="comment">// callback:</span></span><br><span class="line"><span class="comment">//    (当前元素, 当前索引, 调用some的数组)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"><span class="keyword">var</span> result = arr.some(<span class="function"><span class="keyword">function</span> (<span class="params">item,index</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> item &gt; <span class="number">3</span></span><br><span class="line">&#125;) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><ul>
<li><p>find() &amp; findIndex() 根据条件找到数组成员</p>
<ul>
<li>find 定义：用于找出第一个符合条件的数组成员，并返回该成员，如果没有符合条件的成员，则返回 undefined</li>
<li>findIndex 定义：返回第一个符合条件的数组成员的位置，如果所有成员都不符合条件，则返回-1</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 语法</span></span><br><span class="line"><span class="keyword">let</span> new_array = arr.find(<span class="function"><span class="keyword">function</span>(<span class="params">currentValue, index, arr</span>), <span class="title">thisArg</span>)</span></span><br><span class="line"><span class="function"><span class="title">let</span> <span class="title">new_array</span> = <span class="title">arr</span>.<span class="title">findIndex</span>(<span class="params"><span class="keyword">function</span>(currentValue, index, arr), thisArg</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 这两个方法都可以识别<span class="title">NaN</span>,弥补了<span class="title">indexOf</span>的不足</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="title">find</span></span></span><br><span class="line"><span class="function"><span class="title">let</span> <span class="title">a</span> = [1, 4, -5, 10].<span class="title">find</span>(<span class="params">(n) =&gt; n &lt; <span class="number">0</span></span>)</span>; <span class="comment">// 返回元素-5</span></span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">1</span>, <span class="number">4</span>, -<span class="number">5</span>, <span class="number">10</span>,<span class="literal">NaN</span>].find(<span class="function">(<span class="params">n</span>) =&gt;</span> <span class="built_in">Object</span>.is(<span class="literal">NaN</span>, n));  <span class="comment">// 返回元素NaN</span></span><br><span class="line"><span class="comment">// findIndex</span></span><br><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">4</span>, -<span class="number">5</span>, <span class="number">10</span>].findIndex(<span class="function">(<span class="params">n</span>) =&gt;</span> n &lt; <span class="number">0</span>); <span class="comment">// 返回索引2</span></span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">1</span>, <span class="number">4</span>, -<span class="number">5</span>, <span class="number">10</span>,<span class="literal">NaN</span>].findIndex(<span class="function">(<span class="params">n</span>) =&gt;</span> <span class="built_in">Object</span>.is(<span class="literal">NaN</span>, n));  <span class="comment">// 返回索引4</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>keys() &amp; values() &amp; entries() 遍历键名、遍历键值、遍历键名+键值</p>
<ul>
<li>三个方法都返回一个新的 Array Iterator 对象，对象根据方法不同包含不同的值</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 语法</span></span><br><span class="line">array.keys()   array.values()   array.entries()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> index <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].keys()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0</span></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> elem <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &#x27;a&#x27;</span></span><br><span class="line"><span class="comment">// &#x27;b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [index, elem] <span class="keyword">of</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>].entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(index, elem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 0 &quot;a&quot;</span></span><br><span class="line"><span class="comment">// 1 &quot;b&quot;</span></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>JS</category>
      </categories>
  </entry>
  <entry>
    <title>有序表查找之二分查找</title>
    <url>/posts/39853/</url>
    <content><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>二分查找又名折半查找。它的前提是所操作的数据集是一个有序的数据集。它的基本思想是：开始时，先找出有序集合中间的那个元素。如果此元素比要查找的元素大，就接着在较小的一个半区进行查找；反之，如果此元素比要找的元素小，就在较大的一个半区进行查找。在每个更小的数据集中重复这个查找过程，直到找到要查找的元素或者数据集不能再分割。</p>
<h2 id="图解"><a href="#图解" class="headerlink" title="图解"></a>图解</h2><img src="/posts/39853/1556938076685-7ebcf60f-aaf7-4f4c-ba78-0f4d7b9a3099.png" class="" title="二分查找">

<a id="more"></a>

<h2 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h2><p>二分查找可以应用于任何类型的数据，但前提是这些数据是按某种规则进行排序的。这使得它在处理那些频繁插入和删除操作的数据集时不太高效。因为执行完插入和删除操作后，无法保证数据集的有序性，在查找前还得先维护一个有序数据集，从而导致查找过程代价太高。此外，元素必须存储在连续的空间中。</p>
<p>因此，当待搜索的集合是相对静态的数据集时，此时使用二分查找是最好的选择。</p>
<h2 id="代码示例（JS）"><a href="#代码示例（JS）" class="headerlink" title="代码示例（JS）"></a>代码示例（JS）</h2><blockquote>
<p>非递归实现</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">4</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">33</span>, <span class="number">46</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">77</span>, <span class="number">101</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binary_search</span>(<span class="params">arr, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> min = <span class="number">0</span>,</span><br><span class="line">        max = arr.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (min &lt;= max) &#123;</span><br><span class="line">        <span class="keyword">var</span> mid = <span class="built_in">parseInt</span>((min + max) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (target === arr[mid]) &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target &gt; arr[mid]) &#123;</span><br><span class="line">            min = mid + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            max = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(binary_search(arr, <span class="number">33</span>));</span><br></pre></td></tr></table></figure>

<blockquote>
<p>递归实现</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">4</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">33</span>, <span class="number">46</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">77</span>, <span class="number">101</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">binary_search</span>(<span class="params">arr, min, max, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (min &gt; max) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> mid = <span class="built_in">parseInt</span>((min + max) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (target === arr[mid]) &#123;</span><br><span class="line">        <span class="keyword">return</span> mid;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target &gt; arr[mid]) &#123;</span><br><span class="line">        min = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> binary_search(arr, min, max, target);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        max = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> binary_search(arr, min, max, target);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(binary_search(arr, <span class="number">0</span>, arr.length - <span class="number">1</span>, <span class="number">33</span>));</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>后端</category>
        <category>算法</category>
      </categories>
  </entry>
  <entry>
    <title>用JS实现翻转二叉树</title>
    <url>/posts/50491/</url>
    <content><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>翻转二叉树就是把二叉树每一层的左右顺序颠倒过来。</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><blockquote>
<p>输入</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">     <span class="number">4</span></span><br><span class="line">   /   \</span><br><span class="line">  <span class="number">2</span>     <span class="number">7</span></span><br><span class="line"> / \   / \</span><br><span class="line"><span class="number">1</span>   <span class="number">3</span> <span class="number">6</span>   <span class="number">9</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>输出</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">     <span class="number">4</span></span><br><span class="line">   /   \</span><br><span class="line">  <span class="number">7</span>     <span class="number">2</span></span><br><span class="line"> / \   / \</span><br><span class="line"><span class="number">9</span>   <span class="number">6</span> <span class="number">3</span>   <span class="number">1</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h2 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h2><p>如果根节点不为空，那么将左右子结点交换，然后将左右子结点进行递归调用。</p>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> invertTree = <span class="function"><span class="keyword">function</span>(<span class="params">root</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (root !== <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> temp = root.left;</span><br><span class="line">    root.left = root.right;</span><br><span class="line">    root.right = temp;</span><br><span class="line">    invertTree(root.left);</span><br><span class="line">    invertTree(root.right);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> root;</span><br><span class="line"> </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>后端</category>
        <category>算法</category>
      </categories>
  </entry>
  <entry>
    <title></title>
    <url>/posts/0/</url>
    <content><![CDATA[<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Personal Blog</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1"
          name="viewport" />

    <link href="css/Style.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="navbar">
                <a herf="index.html">Home</a>
                <a herf="post.html">Post</a>
                <input type="text" placeholder="Search..">
            </div>
            <hr>
            <h1 class="name">Abrar's Cooking Recipes Blog</h1>
        </div>
        <div class=" sidebar">
            <section class=" about-me"> 
                <img src="image/me.jpg" />
                <h2>Abrar Alharbi</h2>
                <p>
                    Hi welcome to my blog, I am a foodie that like to discover and try food recipes from around the world. Here I share my favorite recipes that I like the most. Enjoy :)
                </p>
                <h2>Contact</h2>
                <div class="social">
                    <i class="fab fa-instagram fa-1x"></i>
                    <i class="fab fa-twitter fa-1x"></i>
                    <i class="fab fa-facebook fa-1x"></i>
                    <i class="fab fa-linkedin fa-1x"></i>
                </div>
            </section>
        </div>
        <div class="content">
            <div class="nestGrid">

                <div class="card">
                    <img src="image/coffee.jpg"  alt="Dalgona Coffee Recipe" />
                    <div class="card-content">
                        <h5 class="meal">Drinks</h5>
                        <h3>Dalgona Coffee</h3>
                        <h6 class="date">7 Apr</h6>
                        <p> A three ingredient, pantry friendly way to have a picture perfect coffee when you can’t go out to a cute cafe. </p>
                        <p><em>Authored by:</em><strong>JUNE XIE</strong></p>
                        <button name="button" onClick="location.href='post.html'">Continue reading</button>
                    </div>
                </div>


                <div class="card">
                    <img src="image/pancake.jpg"  alt="Japanese Pancakese Recipe" />
                    <div class="card-content">
                        <h5 class="meal">Brunch</h5>
                        <h3>Japanese Pancakese</h3>
                        <h6 class="date">21 Aug</h6>
                        <p> Want fluffy Japanese pancakes but can't fly to Tokyo? This recipe is for you! </p>
                        <p><em>Authored by:</em><strong>Stephanie</strong></p>
                        <button name="button" onClick="location.href='post.html'">Continue reading</button>
                    </div>
                </div>


                <div class="card">
                    <img src="image/ball.jpg"  alt="Swedish Meatballs Recipe" />
                    <div class="card-content">
                        <h5 class="meal">Dinner</h5>
                        <h3>Swedish Meatballs</h3>
                        <h6 class="date">27 Nov</h6>
                        <p> Real deal Swedish meatballs, just like in Sweden. </p>
                        <p><em>Authored by:</em><strong>Stephanie</strong></p>
                        <button name="button" onClick="location.href='post.html'">Continue reading</button>
                    </div>
                </div>


                <div class="card">
                    <img src="image/sweet.jpg"  alt="Coconut Macaroonse Recipe" />
                    <div class="card-content">
                        <h5 class="meal">Sweets</h5>
                        <h3>Coconut Macaroonse</h3>
                        <h6 class="date">8 Dec</h6>
                        <p>This year for the holiday season I’m gifting little boxes of macaroons, the perfect sweet treat! </p>
                        <p><em>Authored by:</em><strong>Stephanie</strong></p>
                        <button name="button" onClick="location.href='post.html'">Continue reading</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <footer class="footer">
        <h1>Abrar's Cooking Recipes Blog</h1>
        <h5>Created for Udacity NanoDegree by Abrar Alharbi</h5>
    </footer>

</body>
</html>]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/posts/1/</url>
    <content><![CDATA[<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Personal Blog</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1"
          name="viewport" />

    <link href="css/Style.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="navbar">
                <a herf="index.html">Home</a>
                <a herf="post.html">Post</a>
                <input type="text" placeholder="Search..">
            </div>
            <hr>
            <h1 class="name">Abrar's Cooking Recipes Blog</h1>
        </div>
        <div class=" sidebar">
            <section class=" about-me">
                <img src="image/me.jpg" />
                <h2>Abrar Alharbi</h2>
                <p>
                    Hi welcome to my blog, I am a foodie that like to discover and try food recipes from around the world. Here I share my favorite recipes that I like the most. Enjoy :)
                </p>

                <h2>Contact</h2>
                <div class="social">
                    <i class="fab fa-instagram fa-1x"></i>
                    <i class="fab fa-twitter fa-1x"></i>
                    <i class="fab fa-facebook fa-1x"></i>
                    <i class="fab fa-linkedin fa-1x"></i>
                </div>
            </section>
        </div>
        <div class="content">
            <h1>Dalgona Coffee</h1>
            <h3>So fluffy. So creamy.</h3>
            <h6>
                by JUNE XIE  Apr 7, 2020
            </h6>
            <p><u>Dalgona coffee</u> it started as a Tik Tok trend and has now exploded all over the internet as the It-Drink of the moment. Is it worth the hype? Only one way to find out.</p>
            <blockquote>If you've got instant coffee, sugar, and water on hand, you can make this. It'll go by faster if you have a hand mixer, but a humble regular whisk, one powerful arm, and a good dose of patience and endurance will get you there too—just make sure you're ready to feel the burn in your triceps and biceps and you'll be rewarded with a nice tall glass of cold, creamy coffee that's sweetened just right. Depending on how much of a caffeine rush you want, this recipe makes enough dalgona fluff for one or two servings. It's delicious but very strong: drink at your own discretion!</blockquote>
            <h2>Ingredients</h2>
            <ul>
                <li>2 tbsp. granulated sugar</li>
                <li>2 tbsp. instant coffee</li>
                <li>2 tbsp. cold water</li>
                <li>Ice, for serving</li>
                <li>Milk, for serving</li>
            </ul>
            <h2>Directions</h2>
            <ol>
                <li>In a medium bowl, combine sugar, coffee, and water. Using a hand mixer or a whisk, vigorously whisk until mixture turns silky smooth and shiny, then continue whisking until it thickens and holds its lofty, foamy shape. (If whisking by hand, it will take 8 to 12 minutes to get to optimal fluffiness.)</li>
                <li>Fill a glass most of the way full with ice and milk, then dollop and swirl the whipped coffee mixture on top, mixing before drinking, if desired.</li>
            </ol>
            <figure>

                <img src="image/dalgona-coffee1.jpg" />
                <figcaption>Fig.1 Combine all the ingredients</figcaption>

                <img src="image/dalgona-coffee2.jpg" />
                <figcaption>Fig.2 The desired foam shape</figcaption>
            </figure>
            
            <button name="button" onClick="location.href='index.html'">Back</button>       

        </div>
    </div>

    <footer class="footer">
        <h1>Abrar's Cooking Recipes Blog</h1>
        <h5>Created for Udacity NanoDegree by Abrar Alharbi</h5>
    </footer>


</body>
</html>]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/posts/2/</url>
    <content><![CDATA[

@import url('nav.css');
@import url('layout.css');
@import url('card.css');


.container {
    display: flex;
    width:100%;
    flex-direction:column;
    flex:1;
    border-radius: 15px;
    padding-bottom: 25px;
    margin-top: 25px;
}

.social {
    margin: 5px;
}

.about-me > img {
    width: 50%;
    border-radius: 50%;
    justify-content: center;
    text-align: center;
}


.sidebar {
  
    display: block;
    justify-content: center;
    text-align: center;
    margin-bottom: 1em;
}

.content {
  
    padding: 0 1.5em;
}

h1.name {
    justify-content: center;
    text-align: center;
}
.content > img {
    border-radius: 15px 15px 0 0;
    width: 100%
}



@media screen and (min-width: 900px) {
    .container {
        display: grid;
        grid-template-columns: repeat(5,1fr);
        grid-template-rows: 200px 1fr;
        grid-template-areas: "hd hd hd hd hd hd hd" "sd main main main main main main";
        justify-content: center;
        border-radius: 15px;
        margin-top: 25px;
    }

    .header {
        grid-area: hd;
    }

    .sidebar {
        grid-area: sd;
        display: block;
        justify-content: center;
        text-align: center;
        margin-bottom: 1em;
    }

    .content {
        grid-area: main;
        padding: 0 1.5em;
    }

    .nestGrid {
        display: grid;
        grid-template-columns: 50% 50%;
        grid-template-rows: 50% 50%;
        margin-bottom: 15px;
    }

    .navbar a {
        padding: 1em 1em;
        font-size: 1.25em;
    }

    .navbar input[type=text] {
        padding-right: 0em;
        padding-left: 1em;
        font-size: 1.25em;
    }
}

@media screen and (min-width: 3000px) {
    .container {
        display: grid;
        grid-template-rows: 180px 1fr;
        grid-template-areas: "hd hd hd hd hd hd hd" "sd sd main main main main main";
        justify-content: center;
        border-radius: 15px;
        margin-top: 25px;
    }
}]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/posts/3/</url>
    <content><![CDATA[.card {
    background-color: #e9e9e9;
    transition: 0.3s;
    border-radius: 15px; /* 5px rounded corners */
    margin: 5px;
    padding-bottom: 0.5em;
}

    .card > img {
        border-radius: 15px 15px 0 0;
        width: 100%
    }

.card-content > button {
    margin: 0 auto;
    display: block;
}

.card-content > p {
    font-weight: bold;
    justify-content: center;
}

.card-content > h3 {
    font-size: 1.75em;
    margin-top: 0em;
    margin-bottom: 0em;
}

.card-content > h5 {
    font-size: 1.25em;
    font-weight: 500;
    margin-top: 0em;
    margin-bottom: 0em;
}

.card-content > h6 {
    font-size: 1em;
    font-weight: 500;
    margin-top: 0em;
    margin-bottom: 0.5em;
}

.card:hover {
    transform: scale(1.025);
    box-shadow: 0 5px 5px 0 rgba(0,0,0,0.25);
}

.card-content {
    margin: 0.5em;
}
]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/posts/4/</url>
    <content><![CDATA[


@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Roboto:ital,wght@0,400;0,700;1,400&display=swap');
/* Body */

body {
    max-width: 1200px;
    margin: auto;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* Text Elements */

h1, h2, h3, h4, h5, h6, p, a {
      font-family: sans-serif;
}

h1 {
    font-size: 2.25em;
    font-family: 'Montserrat', sans-serif;
    font-weight: 700;
    margin-top: 1em;
    margin-bottom: 0.5em;
}

h2 {
    font-size: 2em;
    font-family: 'Montserrat', sans-serif;
    font-weight: 700;
    margin-top: 1em;
    margin-bottom: 1em;
}

h3 {
    font-size: 1.75em;
    font-family: 'Montserrat', sans-serif; 
    font-weight: 700;
    margin-top: 1em;
    margin-bottom: 1em;
}

h4 {
    font-size: 1.5em;
    font-family: 'Montserrat', sans-serif;
    margin-top: 1em;
    margin-bottom: 1em;
}

h5 {
    font-size: 1.25em;
    font-family: 'Montserrat', sans-serif;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 1em;
}

h6 {
    font-size: 1em;
    font-family: 'Montserrat', sans-serif;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 1em;
}

a , p {
    font-family: 'Roboto', sans-serif; 
}

blockquote {
    font-family: 'Roboto', sans-serif;
    font-style: italic;
}

figcaption {
    font-family: 'Roboto', sans-serif;
    color:gray;
}

i {
    margin-right: 25px;
    justify-content: center;
}

/*  Button*/

button {
   
    border-radius: 50px;
    font-weight: bold;
    border-color: red;
    justify-content: center;
    align-items: center;
    font-size: 1.25em;
}

    button:hover {
        border-radius: 50px;
        font-weight: bold;
        background-color: #ff2222;
        color: #e9e9e9;
    }

    button > a {
        font-weight: bold;
        border-color: red;
        text-decoration: none;
    }

    button:hover > a {
        font-weight: bold;
        background-color: #ff2222;
        color: #e9e9e9;
        text-decoration: none;
    }

/*  Link */

a {
    color: #000;
}

    a:hover {
        color: #ff2222;
        
    }

    figure > img{
        width:100%;
    }

/* Footer */

footer {
    height: auto;
    margin-top: 15px;
    margin-bottom: 15px;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
    flex: 1;
    background-color: #e9e9e9;
    border-radius: 15px;
}
]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/posts/5/</url>
    <content><![CDATA[

/* Add a black background color to the top navigation bar */
.navbar {
    overflow: hidden;
    background-color: #e9e9e9;
}

    /* Style the links inside the navigation bar */
    .navbar a {
        float: left;
        display: block;
        color: black;
        padding:1em;
        text-align: center;
        text-decoration: none;
        font-size: 1em;
    }

        /* Change the color of links on hover */
    .navbar a:hover {
    background-color: #ddd;
    color: #ff2222;
    
    }

      

    /* Style the search box inside the navigation bar */
    .navbar input[type=text] {
        float: right;
        margin-top: 1em;
        margin-right: 1em;
        border: none;
        font-size: 1em;
    }
]]></content>
  </entry>
  <entry>
    <title>CSS布局面试题（面试系列）</title>
    <url>/posts/51111/</url>
    <content><![CDATA[<h2 id="如何居中-div？"><a href="#如何居中-div？" class="headerlink" title="如何居中 div？"></a>如何居中 div？</h2><h3 id="行内元素水平居中"><a href="#行内元素水平居中" class="headerlink" title="行内元素水平居中"></a>行内元素水平居中</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="单个-div（块级元素）水平居中"><a href="#单个-div（块级元素）水平居中" class="headerlink" title="单个 div（块级元素）水平居中"></a>单个 div（块级元素）水平居中</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="多个-div-水平居中"><a href="#多个-div-水平居中" class="headerlink" title="多个 div 水平居中"></a>多个 div 水平居中</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 传统方案 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* flex 布局方案 */</span></span><br><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="绝对定位的-div-居中（已知宽高）"><a href="#绝对定位的-div-居中（已知宽高）" class="headerlink" title="绝对定位的 div 居中（已知宽高）"></a>绝对定位的 div 居中（已知宽高）</h3><h4 id="子绝父相-margin"><a href="#子绝父相-margin" class="headerlink" title="子绝父相 + margin"></a>子绝父相 + margin</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: auto; <span class="comment">/* 0 auto 水平居中；auto 水平垂直居中 */</span></span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: pink; <span class="comment">/* 方便看效果 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="子绝父相-负边距"><a href="#子绝父相-负边距" class="headerlink" title="子绝父相 + 负边距"></a>子绝父相 + 负边距</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: -<span class="number">150px</span> <span class="number">0</span> <span class="number">0</span> -<span class="number">250px</span>; <span class="comment">/* 外边距为自身宽高的一半 */</span></span><br><span class="line">  <span class="attribute">background-color</span>: pink; <span class="comment">/* 方便看效果 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="当被居中的元素是-inline-or-inline-block-元素"><a href="#当被居中的元素是-inline-or-inline-block-元素" class="headerlink" title="当被居中的元素是 inline or inline-block 元素"></a>当被居中的元素是 inline or inline-block 元素</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="任意元素（未知宽高）"><a href="#任意元素（未知宽高）" class="headerlink" title="任意元素（未知宽高）"></a>任意元素（未知宽高）</h3><h4 id="子绝父相-translate"><a href="#子绝父相-translate" class="headerlink" title="子绝父相 + translate"></a>子绝父相 + translate</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 利用transform */</span></span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="flex（需考虑兼容性）"><a href="#flex（需考虑兼容性）" class="headerlink" title="flex（需考虑兼容性）"></a>flex（需考虑兼容性）</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-flex; <span class="comment">/* Safari仍旧需要使用特定的浏览器前缀 */</span></span><br><span class="line">  <span class="attribute">align-items</span>: center; <span class="comment">/* 垂直居中 */</span></span><br><span class="line">  <span class="attribute">justify-content</span>: center; <span class="comment">/* 水平居中 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: pink; <span class="comment">/* 方便看效果 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="请解释一下-CSS3-的-Flexbox（弹性盒布局模型）-以及适用场景？"><a href="#请解释一下-CSS3-的-Flexbox（弹性盒布局模型）-以及适用场景？" class="headerlink" title="请解释一下 CSS3 的 Flexbox（弹性盒布局模型）,以及适用场景？"></a>请解释一下 CSS3 的 Flexbox（弹性盒布局模型）,以及适用场景？</h2><p>该布局模型的目的是提供一种更加高效的方式来对容器中的条目进行布局、对齐和分配空间。</p>
<p>在传统的布局方式中:</p>
<ul>
<li>block 布局是把块在垂直方向从上到下依次排列的；</li>
<li>inline 布局则是在水平方向来排列。</li>
<li>flex 弹性盒布局并没有这样内在的方向限制，可以由开发人员自由操作。</li>
</ul>
<p>适用场景：弹性布局适合于移动前端开发，在 Android 和 iOS 上也完美支持。</p>
<p>参考：<a href="http://www.w3cplus.com/css3/flexbox-basics.html">http://www.w3cplus.com/css3/flexbox-basics.html</a></p>
<h3 id="如何使用-flex-实现三列等宽布局"><a href="#如何使用-flex-实现三列等宽布局" class="headerlink" title="如何使用 flex 实现三列等宽布局"></a>如何使用 flex 实现三列等宽布局</h3><p>父元素 display: flex，子元素 flex: 1</p>
<h4 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h4><p>子元素的设置等同于：flex: 1 1 auto</p>
<p>flex 的默认值是：0 1 auto</p>
<p>意思是项目默认有剩余空间也不放大（0），但空间不足会缩小（1）</p>
<p>现在改为了值 1 ，就可以放大了，所以三栏可以平分宽度</p>
<p>阅读：<a href="https://segmentfault.com/q/1010000004080910">flex 设置成 1 和 auto 有什么区别</a></p>
<h3 id="如何使用-flex-实现下列布局"><a href="#如何使用-flex-实现下列布局" class="headerlink" title="如何使用 flex 实现下列布局"></a>如何使用 flex 实现下列布局</h3><img src="/posts/51111/flex-left.png" class="" title="flex">

<blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box box1&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box box2&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box box3&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box box4&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box box5&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>margin-right: auto<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: flex-end;</span><br><span class="line">  <span class="attribute">background-color</span>: lightyellow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">75px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: springgreen;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box1</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>摘自：<a href="https://juejin.im/post/5bde54ce51882516e840a8af">css flex 布局中妙用 margin: auto</a></p>
<h2 id="用纯-CSS-创建一个三角形的原理是什么？"><a href="#用纯-CSS-创建一个三角形的原理是什么？" class="headerlink" title="用纯 CSS 创建一个三角形的原理是什么？"></a>用纯 CSS 创建一个三角形的原理是什么？</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 把上、左、右三条边隐藏掉（颜色设为 transparent）*/</span></span><br><span class="line"><span class="selector-id">#demo</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border-color</span>: transparent transparent red transparent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="css-多列等高如何实现？"><a href="#css-多列等高如何实现？" class="headerlink" title="css 多列等高如何实现？"></a>css 多列等高如何实现？</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>利用 <code>padding-bottom|margin-bottom</code> 正负值相抵；</p>
<p>设置父容器设置超出隐藏（overflow:hidden），这样子父容器的高度就还是它里面的列没有设定 padding-bottom 时的高度， 当它里面的任一列高度增加了，则父容器的高度被撑到里面最高那列的高度， 其他比这列矮的列则会用它们的 padding-bottom 来补偿这部分高度差。</p>
<p>因为背景是可以用在 padding 占用的空间里的，而且边框也是跟随 padding 变化的，所以就成功的完成了一个障眼法。</p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;Article&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;js-equalheight&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">      一家将客户利益置于首位的经纪商，</span><br><span class="line">      为客户提供专业的交易工具一家将客户利益置于首位的经纪商</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;js-equalheight&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>一家将客户利益置于首位的经纪商，为客户提供专业的交易工具<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;js-equalheight&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>一家将客户利益置于首位的经纪商<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.Article</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Article</span> &gt; <span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span> -<span class="number">9999px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">9999px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#4577dc</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Article</span> &gt; <span class="selector-tag">li</span> &gt; <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="有一个高度自适应的-div-，里面有两个-div-，一个高度-100px-，希望另一个填满剩下的高度。"><a href="#有一个高度自适应的-div-，里面有两个-div-，一个高度-100px-，希望另一个填满剩下的高度。" class="headerlink" title="有一个高度自适应的 div ，里面有两个 div ，一个高度 100px ，希望另一个填满剩下的高度。"></a>有一个高度自适应的 div ，里面有两个 div ，一个高度 100px ，希望另一个填满剩下的高度。</h2><blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;A&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;B&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<h3 id="方案-1"><a href="#方案-1" class="headerlink" title="方案 1"></a>方案 1</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.A</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.B</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blue;</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100vh</span> - <span class="number">100px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方案-2"><a href="#方案-2" class="headerlink" title="方案 2"></a>方案 2</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  利用border-box将padding包含在高度内；</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">100px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">background-color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  用负margin值将A子容器顶到页面顶部</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-class">.A</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: -<span class="number">100px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#bbe8f2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  剩下的高度100%-100px就是B容器所谓的100%高了</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-class">.B</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#d9c666</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方案-3"><a href="#方案-3" class="headerlink" title="方案 3"></a>方案 3</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">100px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  绝对定</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-class">.A</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#bbe8f2</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.B</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#d9c666</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方案-4"><a href="#方案-4" class="headerlink" title="方案 4"></a>方案 4</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.A</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#bbe8f2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.B</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#d9c666</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方案-5"><a href="#方案-5" class="headerlink" title="方案 5"></a>方案 5</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">background</span>: red;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">display</span>: -webkit-flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">-webkit-flex-direction</span>: row;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.A</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.B</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: blue;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rem-布局知道吗？原理是什么？"><a href="#rem-布局知道吗？原理是什么？" class="headerlink" title="rem 布局知道吗？原理是什么？"></a>rem 布局知道吗？原理是什么？</h2><p>rem 是个相对单位，相对的是 html 根元素的 font-size 大小。这样一来我们就可以通过 html 上的字体大小来控制页面上所有以 rem 为单位的元素尺寸。</p>
<p><strong>示例代码</strong></p>
<p>例如在 vue 项目的 index.html 页中动态计算根元素字体大小</p>
<blockquote>
<p>index.html</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    &lt;meta</span><br><span class="line">      name=&quot;viewport&quot;</span><br><span class="line">      content=&quot;width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span>...<span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      (<span class="function"><span class="keyword">function</span> (<span class="params">doc, win</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> docEl = doc.documentElement;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> resizeEvt =</span></span><br><span class="line"><span class="javascript">          <span class="string">&#x27;orientationchange&#x27;</span> <span class="keyword">in</span> <span class="built_in">window</span> ? <span class="string">&#x27;orientationchange&#x27;</span> : <span class="string">&#x27;resize&#x27;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> recalc = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">const</span> clientWidth = docEl.clientWidth;</span></span><br><span class="line"><span class="javascript">          <span class="comment">// 把屏幕宽度划分成10份，那么每一份的宽度就等于1rem</span></span></span><br><span class="line"><span class="javascript">          docEl.style.fontSize = clientWidth / <span class="number">10</span> + <span class="string">&#x27;px&#x27;</span>;</span></span><br><span class="line">        &#125;;</span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (!doc.addEventListener) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="javascript">        win.addEventListener(resizeEvt, recalc, <span class="literal">false</span>);</span></span><br><span class="line"><span class="javascript">        doc.addEventListener(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, recalc, <span class="literal">false</span>);</span></span><br><span class="line">        recalc();</span><br><span class="line"><span class="javascript">      &#125;)(<span class="built_in">document</span>, <span class="built_in">window</span>);</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后利用 css 预处理器定义一个 mixin 函数（下方用的 stylus），用来将设计稿上的 px 转为对应的 rem 值</p>
<p>计算公式为：</p>
<p>页面元素的 rem 值 = 设计稿元素值（px）/（屏幕宽度 / 划分的份数）</p>
<blockquote>
<p>mixin.stylus</p>
</blockquote>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 把px转为rem */</span></span><br><span class="line"><span class="selector-tag">px2rem</span>(<span class="selector-tag">designpx</span>)</span><br><span class="line">  $rem = 750 / 10;</span><br><span class="line">  return (designpx / $rem)rem</span><br></pre></td></tr></table></figure>

<p>最后在 css 中使用</p>
<blockquote>
<p>某 vue 组件的 style 标签中</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 375设计稿上100%宽以及50高的导航条（iPhone6的dpr为2，所以px值得都乘以2） */</span></span><br><span class="line"><span class="selector-tag">header</span></span><br><span class="line">  <span class="selector-tag">width</span> <span class="selector-tag">px2rem</span>(750)</span><br><span class="line">  <span class="selector-tag">height</span> <span class="selector-tag">px2rem</span>(100)</span><br></pre></td></tr></table></figure>

<h3 id="rem-布局的优缺点"><a href="#rem-布局的优缺点" class="headerlink" title="rem 布局的优缺点"></a>rem 布局的优缺点</h3><p>优点：</p>
<p>能维持能整体的布局效果，移动端兼容性好，不用写多个 css 代码，而且还可以利用@media 进行优化。</p>
<p>缺点：</p>
<p>开头要引入一段 js 代码，单位都要改成 rem（ font-size 可以用 px ），计算 rem 比较麻烦(可以引用预处理器，但是增加了编译过程，相对麻烦了点)。PC 和 Mobile 要分开。</p>
<p>参考：</p>
<ul>
<li><a href="https://www.cnblogs.com/qieguo/p/5386565.html">用 rem 实现 WebApp 自适应的优劣分析</a></li>
<li>[CSS3 的字体大小单位<a href="https://www.zhihu.com/question/21504656">rem]到底好在哪？</a></li>
<li><a href="https://segmentfault.com/a/1190000010211016">总结个人使用过的移动端布局方法</a></li>
</ul>
<h2 id="慎用-em-的原因"><a href="#慎用-em-的原因" class="headerlink" title="慎用 em 的原因"></a>慎用 em 的原因</h2><p><strong>em 会叠加计算。</strong>在这个机制下太容易犯错了，因为你不知道这段<code>css</code>指定的字号具体是多少。</p>
<blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">  abc</span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>def<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  abc</span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.5em</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实际效果：</p>
<img src="/posts/51111/1549344767634-006a0ce5-2c0c-4087-97c3-c8e77933009d.png" class="" title="abc">

<p>先要搞清楚 <code>em</code> 的计算原理，它是根据<strong>当前元素的字号</strong>按比例计算的。</p>
<p>外层 <code>span</code> 的字号是 <code>16px</code>（浏览器默认值），所以 <code>1.5em</code> 之后是 <code>24px</code> 。由于字号是继承的，导致内层 <code>span</code> 的字号继承过来是 <code>24px</code> ，再经过 <code>1.5em</code> 之后就成了 <code>36px</code> 。</p>
<p>所以，就算要用 <code>em</code> 的话，尽量不要用在继承属性（<code>font-size</code>）上，除非你真的清楚你在做什么！</p>
<h2 id="两列布局（左列定宽，右列自适应）"><a href="#两列布局（左列定宽，右列自适应）" class="headerlink" title="两列布局（左列定宽，右列自适应）"></a>两列布局（左列定宽，右列自适应）</h2><blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左列定宽<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右列自适应<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-利用-float-margin"><a href="#1-利用-float-margin" class="headerlink" title="1. 利用 float + margin"></a>1. 利用 float + margin</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">100px</span>; <span class="comment">/*设置间隔，大于等于#left的宽度*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">原理：<span class="selector-id">#left</span>左浮动，脱离文档流，<span class="selector-id">#right</span>为了不被<span class="selector-id">#left</span>挡住，</span><br><span class="line">设置<span class="selector-tag">margin-left</span>大于等于<span class="selector-id">#left</span>的宽度达到视觉上的两栏布局</span><br></pre></td></tr></table></figure>

<h3 id="2-使用-float-overflow（触发-bfc）"><a href="#2-使用-float-overflow（触发-bfc）" class="headerlink" title="2. 使用 float + overflow（触发 bfc）"></a>2. 使用 float + overflow（触发 bfc）</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden; <span class="comment">/*触发bfc达到自适应*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">原理：<span class="selector-id">#left</span>左浮动，<span class="selector-id">#right</span>触发<span class="selector-tag">bfc</span>达到自适应</span><br></pre></td></tr></table></figure>

<h3 id="3-使用-table-实现"><a href="#3-使用-table-实现" class="headerlink" title="3. 使用 table 实现"></a>3. 使用 table 实现</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: table;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*利用单元格自动分配宽度*/</span></span><br><span class="line"><span class="selector-id">#left</span>,</span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-使用-position-实现"><a href="#4-使用-position-实现" class="headerlink" title="4. 使用 position 实现"></a>4. 使用 position 实现</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125; <span class="comment">/*父相*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute; <span class="comment">/*子绝*/</span></span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute; <span class="comment">/*子绝*/</span></span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">100px</span>; <span class="comment">/*值大于等于#left的宽度*/</span></span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-使用-flex-实现"><a href="#5-使用-flex-实现" class="headerlink" title="5. 使用 flex 实现"></a>5. 使用 flex 实现</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>; <span class="comment">/*均分了父元素剩余空间*/</span></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="两列布局（一列不定宽，一列自适应）"><a href="#两列布局（一列不定宽，一列自适应）" class="headerlink" title="两列布局（一列不定宽，一列自适应）"></a>两列布局（一列不定宽，一列自适应）</h2><h3 id="1-float-overflow"><a href="#1-float-overflow" class="headerlink" title="1. float + overflow"></a>1. float + overflow</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">float</span>: left;  <span class="comment">/*只设置浮动,不设宽度*/</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;  <span class="comment">/*触发bfc*/</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">原理：<span class="selector-id">#left</span>不设宽度左浮动，<span class="selector-id">#right</span>触发 <span class="selector-tag">bfc</span> 达到自适应</span><br></pre></td></tr></table></figure>

<h3 id="2-flex-布局"><a href="#2-flex-布局" class="headerlink" title="2. flex 布局"></a>2. flex 布局</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="comment">/*不设宽度*/</span></span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>; <span class="comment">/*均分#parent剩余的部分*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="三列布局（左中定宽，右侧自适应）"><a href="#三列布局（左中定宽，右侧自适应）" class="headerlink" title="三列布局（左中定宽，右侧自适应）"></a>三列布局（左中定宽，右侧自适应）</h2><blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左列定宽<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;center&quot;</span>&gt;</span>中间定宽<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右列自适应<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-float-margin"><a href="#1-float-margin" class="headerlink" title="1. float + margin"></a>1. float + margin</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">310px</span>;</span><br><span class="line">&#125; <span class="comment">/*100+10+200,防止宽度不够,子元素换行*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">10px</span>; <span class="comment">/*#left和#center间隔*/</span></span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eeff2b</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">320px</span>; <span class="comment">/*等于#left和#center的宽度之和加上间隔,多出来的就是#right和#center的间隔*/</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-float-overflow"><a href="#2-float-overflow" class="headerlink" title="2. float + overflow"></a>2. float + overflow</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">320px</span>;</span><br><span class="line">&#125; <span class="comment">/*100+10+200+20,防止宽度不够,子元素换行*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">10px</span>; <span class="comment">/*间隔*/</span></span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">10px</span>; <span class="comment">/*在此定义和#right的间隔*/</span></span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eeff2b</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden; <span class="comment">/*触发bfc*/</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-利用-position"><a href="#3-利用-position" class="headerlink" title="3. 利用 position"></a>3. 利用 position</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125; <span class="comment">/*父相*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute; <span class="comment">/*子绝*/</span></span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute; <span class="comment">/*子绝*/</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">100px</span>; <span class="comment">/*对应#left的width值*/</span></span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eeff2b</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute; <span class="comment">/*子绝*/</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">300px</span>; <span class="comment">/*对应#left和#center的width值之和*/</span></span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-利用-table"><a href="#4-利用-table" class="headerlink" title="4. 利用 table"></a>4. 利用 table</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">520px</span>; <span class="comment">/*抵消上下间距10*2的高度影响*/</span></span><br><span class="line">  <span class="attribute">margin</span>: -<span class="number">10px</span> <span class="number">0</span>; <span class="comment">/*抵消上下边间距10的位置影响*/</span></span><br><span class="line">  <span class="attribute">display</span>: table;</span><br><span class="line">  <span class="comment">/*左右两边间距无法消除,子元素改用padding设置盒子间距就没有这个问题*/</span></span><br><span class="line">  <span class="attribute">border-spacing</span>: <span class="number">10px</span>; <span class="comment">/*关键!!!设置间距*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eeff2b</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-利用-flex"><a href="#5-利用-flex" class="headerlink" title="5. 利用 flex"></a>5. 利用 flex</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#parent</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#left</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">10px</span>; <span class="comment">/*间距*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#center</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">10px</span>; <span class="comment">/*间距*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eeff2b</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#right</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>; <span class="comment">/*均分#parent剩余的部分达到自适应*/</span></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="三列布局（两侧定宽，中间自适应）"><a href="#三列布局（两侧定宽，中间自适应）" class="headerlink" title="三列布局（两侧定宽，中间自适应）"></a>三列布局（两侧定宽，中间自适应）</h2><h3 id="圣杯布局-详解"><a href="#圣杯布局-详解" class="headerlink" title="圣杯布局 详解"></a>圣杯布局 <a href="https://blog.csdn.net/konglei1996/article/details/50881391?utm_source=blogxgwz4">详解</a></h3><blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span>&gt;</span>中间<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 让中间第一，这样浮动的时候它会先占据100%宽 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">400px</span>; <span class="comment">/* 左边w*2+右边w */</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">100px</span> <span class="number">0</span> <span class="number">150px</span>; <span class="comment">/* 1. 父容器左右留出固定padding */</span></span><br><span class="line">  <span class="attribute">background-color</span>: gray;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">100%</span>; <span class="comment">/* 4.1 让被挤到center下方的left左移整个容器的宽度，此时左上角与center重叠 */</span></span><br><span class="line">  <span class="attribute">position</span>: relative; <span class="comment">/* 4.2 为了让left移到最左边,设置相对定位 */</span></span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">150px</span>; <span class="comment">/* 4.3 然后相对自己左移自已宽度的单位，使自己移动到最左边 */</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">float</span>: left; <span class="comment">/* 2.1 左浮动 */</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">233</span>, <span class="number">233</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">/* 3. 让center占据剩下父容器的100%宽 */</span></span><br><span class="line">  <span class="attribute">float</span>: left; <span class="comment">/* 2.1 左浮动 */</span></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">165</span>, <span class="number">12</span>, <span class="number">23</span>, <span class="number">0.4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">margin-right</span>: -<span class="number">100px</span>; <span class="comment">/* 5. 给在第二行的right设置一个负自己宽度的margin-right。让其最右边 */</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">float</span>: left; <span class="comment">/* 2.1 左浮动 */</span></span><br><span class="line">  <span class="attribute">background-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="双飞翼布局方法-详情"><a href="#双飞翼布局方法-详情" class="headerlink" title="双飞翼布局方法 详情"></a>双飞翼布局方法 <a href="http://m.10qianwan.com/web/350789.html">详情</a></h3><blockquote>
<p>HTML</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>中间<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span>左边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span>右边<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">/* 1. 整个容器宽100%自适应 */</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">500px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: gray;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>; <span class="comment">/* 3.1 设置定宽 */</span></span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">100%</span>; <span class="comment">/* 5. 左移容器宽度100%个单位，就把自己排在了center前面 */</span></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">233</span>, <span class="number">233</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">/* 4. 中间容器100%，此时会把左右挤到第二行 */</span></span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">165</span>, <span class="number">12</span>, <span class="number">23</span>, <span class="number">0.4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.center</span> <span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">150px</span> <span class="number">0</span> <span class="number">100px</span>;</span><br><span class="line">  <span class="comment">/* 7. 此时center的左右分别有100和150宽与left，right重叠。所以让center子容器左右margin抵消 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>; <span class="comment">/* 3.2 设置定宽 */</span></span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">150px</span>; <span class="comment">/* 6. 同样左移自身宽度的单位，让right也回到第一行 */</span></span><br><span class="line">  <span class="attribute">background-color</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span>,</span><br><span class="line"><span class="selector-class">.center</span>,</span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">float</span>: left; <span class="comment">/*2. 子容器全部左浮动 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="布局的几种方式"><a href="#布局的几种方式" class="headerlink" title="布局的几种方式"></a>布局的几种方式</h2><ol>
<li>伸缩布局 flex</li>
<li>流式布局 百分比</li>
<li>响应式布局 媒体查询（超小屏设备时：流式布局）<br>&lt;!- 以上布局共同点：元素只能做到宽度的适配（排除图片）-&gt;</li>
<li>rem 布局 宽度和高度都能做到适配（等比适配）</li>
</ol>
<h2 id="Flex"><a href="#Flex" class="headerlink" title="Flex"></a>Flex</h2><h3 id="flex-布局和传统布局的优势？"><a href="#flex-布局和传统布局的优势？" class="headerlink" title="flex 布局和传统布局的优势？"></a>flex 布局和传统布局的优势？</h3><p>该布局模型的目的是提供一种更加高效的方式来对容器中的条目进行布局、对齐和分配空间。</p>
<p>在传统的布局方式中:</p>
<ul>
<li>block 布局是把块在垂直方向从上到下依次排列的</li>
<li>inline 布局则是在水平方向来排列</li>
<li>flex 弹性盒布局并没有这样内在的方向限制，可以由开发人员自由操作</li>
</ul>
<h2 id="如何解决移动端-Retina-屏-1px-像素问题"><a href="#如何解决移动端-Retina-屏-1px-像素问题" class="headerlink" title="如何解决移动端 Retina 屏 1px 像素问题"></a>如何解决移动端 Retina 屏 1px 像素问题</h2><h3 id="原理：媒体查询-变换缩放"><a href="#原理：媒体查询-变换缩放" class="headerlink" title="原理：媒体查询 + 变换缩放"></a>原理：媒体查询 + 变换缩放</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width,initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span></span><br><span class="line">      * &#123;</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-id">#test</span> &#123;</span></span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 1px;</span><br><span class="line">        margin-top: 50px;</span><br><span class="line">        background: black;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">-webkit-device-pixel-ratio:</span> <span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-id">#test</span> &#123;</span></span><br><span class="line">          transform: scaleY(0.5);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="keyword">@media</span> <span class="keyword">only</span> screen <span class="keyword">and</span> (<span class="attribute">-webkit-device-pixel-ratio:</span> <span class="number">3</span>) &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-id">#test</span> &#123;</span></span><br><span class="line">          transform: scaleY(0.333333333333333333);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="stylus-实现方案"><a href="#stylus-实现方案" class="headerlink" title="stylus 实现方案"></a>stylus 实现方案</h3><blockquote>
<p>stylus</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copy&#x2F;* 给 dpr 1.5 的设备设置 0.7 的缩放 *&#x2F;</span><br><span class="line">@media (-webkit-min-device-pixel-ratio: 1.5), (min-device-pixel-ratio: 1.5)</span><br><span class="line">.border1px</span><br><span class="line"> &amp;::after</span><br><span class="line">   -webkit-transform: scaleY(.7)</span><br><span class="line">   transform: scaleY(.7)</span><br><span class="line">&#x2F;* 给 dpr 2.0 的设备设置 0.5 的缩放 *&#x2F;</span><br><span class="line">@media (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2)</span><br><span class="line">.border1px</span><br><span class="line"> &amp;::after</span><br><span class="line">   -webkit-transform: scaleY(.5)</span><br><span class="line">   transform: scaleY(.5)</span><br><span class="line"></span><br><span class="line">&#x2F;* 给需要1px下边框的元素添加一个伪元素，</span><br><span class="line">使其宽100%；高为用户自定义 *&#x2F;</span><br><span class="line">border1px($color)</span><br><span class="line">position: relative</span><br><span class="line">&amp;:after</span><br><span class="line"> display: block</span><br><span class="line"> position: absolute</span><br><span class="line"> left: 0</span><br><span class="line"> bottom: 0</span><br><span class="line"> width: 100%</span><br><span class="line"> border-top: 1px solid $color</span><br><span class="line"> content: &#39; &#39;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>html</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1. 给需要添加1像素边框的元素设置一个类作为标识，让媒体查询能够识别 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">&quot;border1px&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;stylus&quot;</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line">  header</span><br><span class="line">    ...</span><br><span class="line"><span class="css">    <span class="selector-tag">border1px</span>(<span class="selector-tag">black</span>) <span class="comment">/* 2. 通过border1px设置边框 */</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><h3 id="实现不使用-border-画出-1px-高的线，在不同浏览器的标准模式与怪异模式下都能保持一致的效果。"><a href="#实现不使用-border-画出-1px-高的线，在不同浏览器的标准模式与怪异模式下都能保持一致的效果。" class="headerlink" title="实现不使用 border 画出 1px 高的线，在不同浏览器的标准模式与怪异模式下都能保持一致的效果。"></a>实现不使用 border 画出 1px 高的线，在不同浏览器的标准模式与怪异模式下都能保持一致的效果。</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;height:1px;overflow:hidden;background:red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="已知如下代码，如何修改才能让图片宽度为-300px-？注意下面代码不可修改"><a href="#已知如下代码，如何修改才能让图片宽度为-300px-？注意下面代码不可修改" class="headerlink" title="已知如下代码，如何修改才能让图片宽度为 300px ？注意下面代码不可修改"></a>已知如下代码，如何修改才能让图片宽度为 300px ？注意下面代码不可修改</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;1.jpg&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:480px!important;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>答案：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 方法一：max-width覆盖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;1.jpg&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:480px!important; max-width: 300px&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 方法二：scale按比例缩放 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;1.jpg&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:480px!important; transform: scale(0.625, 1);&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 方法三：相同属性直接覆盖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;1.jpg&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:480px!important; width:300px!important;&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 方法四：css动画样式优先级高于important特性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">  img &#123;</span><br><span class="line">    animation: test 0s forwards;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="keyword">@keyframes</span> test &#123;</span></span><br><span class="line">    from &#123;</span><br><span class="line">      width: 300px;</span><br><span class="line">    &#125;</span><br><span class="line">    to &#123;</span><br><span class="line">      width: 300px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>题目来源：<a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/105">Daily-Interview-Question 第 60 题</a></p>
]]></content>
      <categories>
        <category>前端</category>
        <category>面试</category>
      </categories>
      <tags>
        <tag>面试</tag>
      </tags>
  </entry>
  <entry>
    <title>CSS知识点（面试系列）</title>
    <url>/posts/40707/</url>
    <content><![CDATA[<h2 id="盒模型"><a href="#盒模型" class="headerlink" title="盒模型"></a>盒模型</h2><p>标准盒模型（W3C 标准）：</p>
<p>一个块的总宽度 = <strong>内容宽度</strong> + margin(左右) + padding(左右) + border(左右)</p>
<p>怪异盒模型（IE 标准）：</p>
<p>一个块的总宽度 = <strong>width（包含 padding 和 border）</strong> + margin(左右)</p>
<a id="more"></a>

<h3 id="怪异盒模型触发条件"><a href="#怪异盒模型触发条件" class="headerlink" title="怪异盒模型触发条件"></a>怪异盒模型触发条件</h3><p>如果 html 文件最顶部 doctype 缺失，则在 ie6、7、8 将会触发怪异模式(quirks);</p>
<h3 id="通过-css-来设置盒模型"><a href="#通过-css-来设置盒模型" class="headerlink" title="通过 css 来设置盒模型"></a>通过 css 来设置盒模型</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">box-sizing</span>: <span class="selector-tag">content-box</span>; <span class="comment">/* 标准模型 */</span></span><br><span class="line">            <span class="selector-tag">border-box</span>;  <span class="comment">/* IE模型 */</span></span><br><span class="line">            <span class="selector-tag">inherit</span>;     <span class="comment">/* 从父元素继承 */</span></span><br></pre></td></tr></table></figure>

<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><ul>
<li>怪异盒模型（border-box）</li>
</ul>
<blockquote>
<p>比如我们想做一个内边距 10px ，边框为 2px ，最终包括边框宽度为 100px 的 div ，之前的做法是先算出内容宽 <code>width</code> 。但有点繁琐，需要人算。此时我们可以把 div 的 box-sizing 设置为 border-box ，我们就可以直接把 width 设置为 100px ，其余的 padding 和 border 按照给定好的值一一填入，就可以完成这一切工作，省去了人为的计算内容宽 content 的过程，减少计算量的同时减少了错误率。</p>
</blockquote>
<h2 id="CSS-选择符有哪些？哪些属性可以继承？"><a href="#CSS-选择符有哪些？哪些属性可以继承？" class="headerlink" title="CSS 选择符有哪些？哪些属性可以继承？"></a>CSS 选择符有哪些？哪些属性可以继承？</h2><ol>
<li>id 选择器（ #my-id ）</li>
<li>类选择器（ .my-class-name ）</li>
<li>标签选择器（ div, h1, p ）</li>
<li>相邻选择器（ h1 + p 紧贴在 h1 后面的第一个 p 标签。同级标签，之间不能有其他标签 ）</li>
<li>子代选择器（ ul &gt; li ul 标签下的下一个层级的 li ，并不是所有 ）</li>
<li>后代选择器（ li a ）</li>
<li>通配符选择器（ * ）</li>
<li>属性选择器（ a[rel = “external”] ）</li>
<li>伪类选择器（ a:hover, li:nth-child ）</li>
</ol>
<h3 id="可继承属性"><a href="#可继承属性" class="headerlink" title="可继承属性"></a>可继承属性</h3><p>font-size font-family color, UL LI DL DD DT;</p>
<h3 id="不可继承属性"><a href="#不可继承属性" class="headerlink" title="不可继承属性"></a>不可继承属性</h3><p>border padding margin width height</p>
<h2 id="CSS-优先级算法如何计算？"><a href="#CSS-优先级算法如何计算？" class="headerlink" title="CSS 优先级算法如何计算？"></a>CSS 优先级算法如何计算？</h2><ul>
<li>写在后面的覆盖写在前面的</li>
<li>描述越具体优先级越高 (div , div[class=’restart’])</li>
<li>同权重 行内样式 &gt; 内嵌样式 &gt; 外部样式</li>
<li>!important 优先级最高</li>
</ul>
<h2 id="CSS3-新增伪类有那些？"><a href="#CSS3-新增伪类有那些？" class="headerlink" title="CSS3 新增伪类有那些？"></a>CSS3 新增伪类有那些？</h2><ul>
<li><code>p:first-of-type</code> 属于其父元素的特定类型首个子元素 等同于 <code>:nth-of-type(1)</code></li>
<li><code>p:last-of-type</code> 属于其父元素的特定类型的最后一个子元素 等同于 <code>:nth-last-of-type(1)</code></li>
<li><code>::after</code> 在元素之前添加内容,也可以用来做清除浮动。</li>
<li><code>::before</code> 在元素之后添加内容</li>
<li><code>:enabled/:disabled</code> 控制表单控件的禁用状态。</li>
<li><code>:checked</code> 单选框或复选框被选中。</li>
</ul>
<h2 id="display-none、visibility：hidden-和-opacity-0-的区别？"><a href="#display-none、visibility：hidden-和-opacity-0-的区别？" class="headerlink" title="display:none、visibility：hidden 和 opacity: 0 的区别？"></a>display:none、visibility：hidden 和 opacity: 0 的区别？</h2><ul>
<li>display：none （不占空间，不能点击）（回流+重绘）</li>
<li>visibility：hidden （占据空间，不可点击）（重绘）</li>
<li>opacity: 0（占据空间，可以点击）（重建图层，性能较高）</li>
</ul>
<p>更多：<a href="https://github.com/Advanced-Frontend/Daily-Interview-Question/issues/100">分析比较 opacity: 0、visibility: hidden、display: none 优劣和适用场景</a></p>
<h2 id="position-跟-display-、float-这些特性相互叠加后会怎么样？"><a href="#position-跟-display-、float-这些特性相互叠加后会怎么样？" class="headerlink" title="position 跟 display 、float 这些特性相互叠加后会怎么样？"></a>position 跟 display 、float 这些特性相互叠加后会怎么样？</h2><ul>
<li>position 属性规定元素的定位类型</li>
<li>display 属性规定元素应该生成的框的类型</li>
<li>float 属性是一种布局方式，定义元素在哪个方向浮动。</li>
</ul>
<p>优先级机制：position：absolute/fixed 优先级最高，有他们在时，float 不起作用，display 值需要调整。float 或者 absolute 定位的元素，只能是块元素或表格。</p>
<h2 id="讲一讲-position-属性中的各种值"><a href="#讲一讲-position-属性中的各种值" class="headerlink" title="讲一讲 position 属性中的各种值"></a>讲一讲 position 属性中的各种值</h2><table>
<thead>
<tr>
<th align="left"><strong>值</strong></th>
<th align="left"><strong>是否脱标占有位置</strong></th>
<th align="left"><strong>可使用边偏移</strong></th>
<th align="left"><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">static</td>
<td align="left">不脱标，正常模式</td>
<td align="left">不可以</td>
<td align="left">自动（没有）定位（默认定位方式）</td>
</tr>
<tr>
<td align="left">relative(自恋)</td>
<td align="left">不脱标，占有位置</td>
<td align="left">可以</td>
<td align="left">相对定位，相对于其原文档流的位置进行定位</td>
</tr>
<tr>
<td align="left">absolute(拼爹)</td>
<td align="left">完全脱标，不占位置</td>
<td align="left">可以</td>
<td align="left">绝对定位，相对于其上一个已经定位（不为 static）的父元素进行定位</td>
</tr>
<tr>
<td align="left">fixed(浏览器)</td>
<td align="left">完全脱标，不占位置</td>
<td align="left">可以</td>
<td align="left">固定定位，相对于浏览器窗口进行定位（老 IE 不支持）</td>
</tr>
<tr>
<td align="left">inherit</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">规定从父元素继承 position 属性的值</td>
</tr>
</tbody></table>
<h2 id="CSS3-有哪些新特性？"><a href="#CSS3-有哪些新特性？" class="headerlink" title="CSS3 有哪些新特性？"></a>CSS3 有哪些新特性？</h2><h3 id="过渡"><a href="#过渡" class="headerlink" title="过渡"></a>过渡</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 语法 */</span></span><br><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">CSS</span>属性，过渡时间，效果曲线（默认<span class="selector-tag">ease</span>），延迟时间（默认0）</span><br><span class="line"></span><br><span class="line"><span class="comment">/* demo1 */</span></span><br><span class="line"><span class="comment">/*宽度从原始值到制定值的一个过渡，运动曲线ease,运动时间0.5秒，0.2秒后执行过渡*/</span></span><br><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">width</span> .5<span class="selector-tag">s</span> <span class="selector-tag">ease</span> .2<span class="selector-tag">s</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* demo2 */</span></span><br><span class="line"><span class="comment">/* 分开写 */</span></span><br><span class="line"><span class="selector-tag">transition-property</span>: <span class="selector-tag">width</span>;</span><br><span class="line"><span class="selector-tag">transition-duration</span>: 1<span class="selector-tag">s</span>;</span><br><span class="line"><span class="selector-tag">transition-timing-function</span>: <span class="selector-tag">linear</span>;</span><br><span class="line"><span class="selector-tag">transition-delay</span>: 2<span class="selector-tag">s</span>;</span><br></pre></td></tr></table></figure>

<h3 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 语法 */</span></span><br><span class="line"><span class="selector-tag">animation</span>：动画名称，动画时间，运动曲线（默认<span class="selector-tag">ease</span>），动画延迟（默认0），播放次数（默认1），</span><br><span class="line">是否反向播放动画（默认<span class="selector-tag">normal</span>），是否暂停动画（默认<span class="selector-tag">running</span>）</span><br><span class="line"></span><br><span class="line"><span class="comment">/* demo1 */</span></span><br><span class="line"><span class="comment">/* 执行一次logo2-line动画，运动时间2秒，运动曲线为 linear */</span></span><br><span class="line"><span class="selector-tag">animation</span>: <span class="selector-tag">logo2-line</span> 2<span class="selector-tag">s</span> <span class="selector-tag">linear</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* demo2 */</span></span><br><span class="line"><span class="comment">/* 2秒后开始执行一次 logo2-line 动画，运动时间2秒，运动曲线为 linear */</span></span><br><span class="line"><span class="selector-tag">animation</span>: <span class="selector-tag">logo2-line</span> 2<span class="selector-tag">s</span> <span class="selector-tag">linear</span> 2<span class="selector-tag">s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* demo3 */</span></span><br><span class="line"><span class="comment">/*无限执行 logo2-line 动画，每次运动时间2秒，运动曲线为 linear，并且执行反向动画*/</span></span><br><span class="line"><span class="selector-tag">animation</span>: <span class="selector-tag">logo2-line</span> 2<span class="selector-tag">s</span> <span class="selector-tag">linear</span> <span class="selector-tag">alternate</span> <span class="selector-tag">infinite</span>;</span><br><span class="line"></span><br><span class="line">还有一个重要属性：用来指定在动画执行之前和之后如何给动画的目标应用样式。</span><br><span class="line">animation-fill-mode: none | forwards | backwards | both;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">动画分为 初始状态 等待期 动画执行期 完成期 四个阶段。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">- none 表示 等待期和完成期，元素样式都为初始状态样式，不受动画定义（@keyframes）的影响</span></span><br><span class="line"><span class="comment">- forwards 表示等待期保持初始样式，完成期间保持最后一帧样式</span></span><br><span class="line"><span class="comment">- backwards 表示等待期为第一帧样式，完成期跳转为初始样式</span></span><br><span class="line"><span class="comment">- both 表示 等待期样式为第一帧样式，完成期保持最后一帧样式</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://segmentfault.com/q/1010000003867335">如何理解 animation-fill-mode 及其使用？</a></p>
<h3 id="形状转换"><a href="#形状转换" class="headerlink" title="形状转换"></a>形状转换</h3><p>transform: 适用于 2D 或 3D 转换的元素 <a href="https://www.zhangxinxu.com/wordpress/2012/09/css3-3d-transform-perspective-animate-transition/">(3d 看这里)</a><br>transform-origin: 转换元素的位置（围绕那个点进行转换,默认中心）。默认 x, y, z ： 50%, 50%, 0 对应 left, top</p>
<ul>
<li>缩放 scale</li>
<li>位移 translate</li>
<li>旋转 rotate</li>
<li>倾斜 skew</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">rotate</span>(30<span class="selector-tag">deg</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">translate</span>(30<span class="selector-tag">px</span>, 30<span class="selector-tag">px</span>);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scale</span>(0.8);</span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">skew</span>(10<span class="selector-tag">deg</span>, 10<span class="selector-tag">deg</span>);</span><br><span class="line"><span class="selector-tag">transform-origin</span>: <span class="selector-tag">left</span> <span class="selector-tag">top</span>; <span class="comment">/* 左上（默认中心）【改变元素变形的原点】 */</span></span><br></pre></td></tr></table></figure>

<h4 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h4><p>对 transition 、animation 和 transform 这块儿内容不熟的同学可以参考我的博客简单上手教程，基本上每个属性都有相应的 demo 展示：<a href="https://evestorm.github.io/categories/%E5%89%8D%E7%AB%AF/CSS/">Lance 的个人博客-css 分类</a></p>
<p>另外，上面的知识点参考于下方资源，可自取：</p>
<ul>
<li><a href="https://segmentfault.com/a/1190000010780991">个人总结（css3 新特性）</a></li>
<li><a href="http://cubic-bezier.com/#.42,0,.58,1">cubic-bezier 贝塞尔在线预览</a></li>
<li><a href="https://cssreference.io/property/transition-timing-function/">transition-timing-function | cssreference</a></li>
<li><a href="https://www.smashingmagazine.com/2014/04/understanding-css-timing-functions/">Understanding The CSS3 transition-timing-function Property</a></li>
<li><a href="https://segmentfault.com/a/1190000011019534">翻译 | 深入理解 CSS 时序函数</a></li>
<li><a href="http://koala.ink/posts/86be452a/">css3 动画详解【推荐】</a></li>
</ul>
<h3 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h3><h4 id="属性选择器"><a href="#属性选择器" class="headerlink" title="属性选择器"></a>属性选择器</h4><ul>
<li>div[index] { background: red } 表示 div 下面带 index 属性的背景为红色</li>
<li>div[index=a] { background: red } 表示 div 下面的自定义属性 index=a 的 div 的颜色变成红色。</li>
<li>div[index~=a] { background: red } 只要 div 中 index 属性带 a 这个单词的就生效。[a 这个单词必须独立存在]<ul>
<li>p[class~=’lance’] 只会匹配到 class=”xxx lance”，而不会匹配 class=”xxlancexx”</li>
</ul>
</li>
<li>div[index*=a] { background: red } 只要 div 里面的 index 属性带 a 字母的就生效。</li>
<li>div[index^=a] { background: red } 以 a 开头的</li>
<li>div[index$=a] { background: red } 以 a 结尾</li>
<li>div[index|=a] { background:red } 只要以 a- 开头的</li>
</ul>
<p>当需要多个的时候： div[key1=value1][key2=value2][key3=value3]…. { background:red }</p>
<h4 id="结构性伪类选择器"><a href="#结构性伪类选择器" class="headerlink" title="结构性伪类选择器"></a>结构性伪类选择器</h4><p>前提：假如 div 是下面 p 标签的父元素</p>
<ul>
<li><pre><code>p:nth-child(n)
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  div 下类型为 p 的第 n 个子元素，下标从 1 开始！！</span><br><span class="line"></span><br><span class="line">  - &#96;:nth-child(odd)&#96; 奇数</span><br><span class="line">  - &#96;:nth-child(even)&#96; 偶数</span><br><span class="line"></span><br><span class="line">- &#96;p:nth-last-child(n)&#96; 从倒数，div 下类型为 p 的第 n 个子元素</span><br><span class="line"></span><br><span class="line">- &#96;p:last-child&#96; div 下最后一个子元素如果是 p ，则生效，否则不生效</span><br><span class="line"></span><br><span class="line">- &#96;p:first-child&#96; div 下第一个子元素如果是 p ，则生效，否则不生效【css2 的】</span><br><span class="line"></span><br><span class="line">- &#96;p:first-of-type&#96; div 下第一个类型为 p 的子元素【不需要 p 是这个 div 下的第一个子元素】</span><br><span class="line"></span><br><span class="line">- &#96;p:last-of-type&#96; div 下最后一个类型为 p 的子元素</span><br><span class="line"></span><br><span class="line">参考：[css 选择器中:first-child 与:first-of-type 的区别](https:&#x2F;&#x2F;www.cnblogs.com&#x2F;2050&#x2F;p&#x2F;3569509.html)</span><br><span class="line"></span><br><span class="line">#### 伪元素选择器</span><br><span class="line"></span><br><span class="line">1. &#96;::first-letter&#96; 文本的第一个单词或字（如中文、日文、韩文等）</span><br><span class="line">2. &#96;::first-line&#96; 文本第一行；</span><br><span class="line">3. &#96;::selection&#96; 可改变选中文本的样式；</span><br><span class="line">4. &#96;::before&#96; 和 &#96;::after&#96; 在元素内部的开始火结束为止创建一个元素，该元素为行内元素，必须结合 content 属性使用 div::before &#123; content: ‘开始’ &#125;</span><br><span class="line"></span><br><span class="line">#### 目标伪类选择器</span><br><span class="line"></span><br><span class="line">&#96;:target&#96; 目标伪类选择器， &#96;:&#96; 选择器可用于选取当前活动的目标元素</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;css</span><br><span class="line">:target &#123;</span><br><span class="line">  color: red;</span><br><span class="line">  font-size: 30px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<h3 id="阴影"><a href="#阴影" class="headerlink" title="阴影"></a>阴影</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* x偏移量 | y偏移量 | 阴影模糊半径 | 阴影扩散半径 | 阴影颜色 */</span></span><br><span class="line"><span class="selector-tag">box-shadow</span>: 2<span class="selector-tag">px</span> 2<span class="selector-tag">px</span> 2<span class="selector-tag">px</span> 1<span class="selector-tag">px</span> <span class="selector-tag">rgba</span>(0, 0, 0, 0.2);</span><br></pre></td></tr></table></figure>

<h3 id="边框"><a href="#边框" class="headerlink" title="边框"></a>边框</h3><ul>
<li><p>边框图片 border-image</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">border-image</span>: <span class="selector-tag">image-source</span> <span class="selector-tag">image-height</span> <span class="selector-tag">image-width</span> <span class="selector-tag">image-repeat</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>圆角边框 border-radius</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">border-radius</span>: 左上角，右上角，右下角，左下角;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="CSS-弹性布局（flex）"><a href="#CSS-弹性布局（flex）" class="headerlink" title="CSS 弹性布局（flex）"></a>CSS 弹性布局（flex）</h3><h4 id="Flex-容器属性"><a href="#Flex-容器属性" class="headerlink" title="Flex 容器属性"></a>Flex 容器属性</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">copy主轴方向：水平排列（默认） | 水平反向排列 | 垂直排列 | 垂直反向排列</span><br><span class="line">flex-direction: row | row-reverse | column | column-reverse;</span><br><span class="line"></span><br><span class="line">换行：不换行（默认） | 换行 | 反向换行(第一行在最后面)</span><br><span class="line">flex-wrap: nowrap | wrap | wrap-reverse;</span><br><span class="line"></span><br><span class="line">flex-direction属性和flex-wrap属性的简写形式，默认值为row nowrap</span><br><span class="line">flex-flow: &lt;flex-direction&gt; || &lt;flex-wrap&gt;;</span><br><span class="line"></span><br><span class="line">主轴对齐方式：起点对齐（默认） | 终点对齐 | 居中对齐 | 两端对齐 | 分散对齐</span><br><span class="line">justify-content: flex-start | flex-end | center | space-between | space-around;</span><br><span class="line"></span><br><span class="line">交叉轴对齐方式：拉伸对齐（默认） | 起点对齐 | 终点对齐 | 居中对齐 | 第一行文字的基线对齐</span><br><span class="line">align-items: stretch | flex-start | flex-end | center | baseline;</span><br><span class="line"></span><br><span class="line">多根轴线对齐方式：拉伸对齐（默认） | 起点对齐 | 终点对齐 | 居中对齐 | 两端对齐 | 分散对齐</span><br><span class="line">align-content: stretch | flex-start | flex-end | center | space-between | space-around;</span><br></pre></td></tr></table></figure>

<h4 id="Flex-项目属性"><a href="#Flex-项目属性" class="headerlink" title="Flex 项目属性"></a>Flex 项目属性</h4><figure class="highlight"><table><tr><td class="code"><pre><span class="line">顺序：数值越小越靠前，默认为0</span><br><span class="line"><span class="selector-tag">order</span>: &lt;<span class="selector-tag">number</span>&gt;;</span><br><span class="line"></span><br><span class="line">放大比例：默认为0，如果有剩余空间也不放大，值为1则放大，2是1的双倍大小，以此类推</span><br><span class="line"><span class="selector-tag">flex-grow</span>: &lt;<span class="selector-tag">number</span>&gt;;</span><br><span class="line"></span><br><span class="line">缩小比例：默认为1，如果空间不足则会缩小，值为0不缩小</span><br><span class="line"><span class="selector-tag">flex-shrink</span>: &lt;<span class="selector-tag">number</span>&gt;;</span><br><span class="line"></span><br><span class="line">项目自身大小：默认<span class="selector-tag">auto</span>，为原来的大小，可设置固定值 50<span class="selector-tag">px</span>/50%</span><br><span class="line">flex-basis: &lt;length&gt; | auto;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">flex-grow</span>, <span class="selector-tag">flex-shrink</span> 和 <span class="selector-tag">flex-basis</span> 的简写，默认值为0 1 <span class="selector-tag">auto</span></span><br><span class="line">两个快捷值：<span class="selector-tag">auto</span> (1 1 <span class="selector-tag">auto</span>) 和 <span class="selector-tag">none</span> (0 0 <span class="selector-tag">auto</span>)</span><br><span class="line">flex:none | [ &lt;&#x27;flex-grow&#x27;&gt; &lt;&#x27;flex-shrink&#x27;&gt;? || &lt;&#x27;flex-basis&#x27;&gt; ]</span><br><span class="line"></span><br><span class="line">项目自身对齐：继承父元素（默认） | 起点对齐 | 终点对齐 | 居中对齐 | 基线对齐 | 拉伸对齐</span><br><span class="line">align-self: auto | flex-start | flex-end | center | baseline | stretch;</span><br></pre></td></tr></table></figure>

<h4 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h4><p>左右分栏、上下分栏。（检验下自己如何完成下列布局）</p>
<img src="/posts/40707/%E4%B8%8A%E4%B8%8B%E5%88%86%E6%A0%8F.png" class="" title="上下分栏">

<img src="/posts/40707/%E5%B7%A6%E5%8F%B3%E5%88%86%E6%A0%8F.png" class="" title="左右分栏">

<img src="/posts/40707/%E5%86%85%E5%AE%B9%E7%BB%93%E6%9E%84%E6%9D%BF%E5%9D%97.png" class="" title="内容结构板块">

<p>对 flex 不熟悉的同学可以参考下面网站进行学习：</p>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/25303493">30 分钟学会 Flex 布局</a></li>
<li><a href="http://www.deathghost.cn/article/css/38">flex 网页布局首选方案 灵活应用 flex 弹性布局快速构建 web 结构</a></li>
</ul>
<p>不愿意看长篇大论的可以通过这个塔防游戏来学习：<a href="http://www.flexboxdefense.com/">Flexbox Defense</a></p>
<h2 id="li-与-li-之间有看不见的空白间隔是什么原因引起的？有什么解决办法？"><a href="#li-与-li-之间有看不见的空白间隔是什么原因引起的？有什么解决办法？" class="headerlink" title="li 与 li 之间有看不见的空白间隔是什么原因引起的？有什么解决办法？"></a>li 与 li 之间有看不见的空白间隔是什么原因引起的？有什么解决办法？</h2><h3 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h3><blockquote>
<p>有时，在写页面的时候，会需要将</p>
<p>这个块状元素横排显示，此时就需要将 display 属性设置为 inline-block ，此时问题出现了，在两个</p>
<p>元素之间会出现大约 8px 左右的空白间隙</p>
</blockquote>
<h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>浏览器的默认行为是把 inline 元素间的空白字符（空格换行 tab ）渲染成一个空格，也就是我们上面的代码</p>
<p>换行后会产生换行字符，而它会变成一个空格，当然空格就占用一个字符的宽度。</p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>给 ul 标签设置 <code>font-size: 0;</code> 并为 li 元素重新设置 <code>font-size: xxpx;</code></p>
<h2 id="BFC-块级格式化上下文：block-formatting-context"><a href="#BFC-块级格式化上下文：block-formatting-context" class="headerlink" title="BFC(块级格式化上下文：block formatting context)"></a>BFC(块级格式化上下文：block formatting context)</h2><h3 id="理解"><a href="#理解" class="headerlink" title="理解"></a>理解</h3><p>BFC 就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素。反之也如此。我们可以利用这些特性解决特定环境下的布局问题。</p>
<h3 id="常见-BFC-应用"><a href="#常见-BFC-应用" class="headerlink" title="常见 BFC 应用"></a>常见 BFC 应用</h3><h4 id="清除元素内部浮动"><a href="#清除元素内部浮动" class="headerlink" title="清除元素内部浮动"></a>清除元素内部浮动</h4><blockquote>
<p>计算 BFC 的高度时，自然也会检测浮动或者定位的盒子高度。</p>
</blockquote>
<p>只要把父元素设为 BFC 就可以清理子元素的浮动了，最常见的用法就是在父元素上设置 <code>overflow: hidden</code> 样式，对于 IE6 加上 <code>zoom: 1</code> 就可以了。</p>
<img src="/posts/40707/float.png" class="" title="float">

<h4 id="解决外边距合并问题"><a href="#解决外边距合并问题" class="headerlink" title="解决外边距合并问题"></a>解决外边距合并问题</h4><blockquote>
<p>盒子垂直方向的距离由 margin 决定。属于同一个 BFC 的两个相邻盒子的 margin 会发生重叠</p>
</blockquote>
<p>属于同一个 BFC 的两个相邻盒子的 margin 会发生重叠，那么我们创建不属于同一个 BFC ，就不会发生 margin 重叠了。</p>
<img src="/posts/40707/margin.png" class="" title="margin">

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container4 green&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 500px;&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 给其中一个 div 外面包一个 div ，然后通过触发外面这个 div 的 BFC ，就可以阻止这两个 div 的 margin 重叠 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;overflow: hidden;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;blue w100 h100&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom: 20px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;red w200 h200&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-top: 20px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="两栏布局，实现左定宽-右宽自适应"><a href="#两栏布局，实现左定宽-右宽自适应" class="headerlink" title="两栏布局，实现左定宽+右宽自适应"></a>两栏布局，实现左定宽+右宽自适应</h4><blockquote>
<p>普通流体元素 BFC 后，为了和浮动元素不产生任何交集，顺着浮动边缘形成自己的封闭上下文</p>
</blockquote>
<img src="/posts/40707/%E5%8F%B3%E6%B5%AE%E5%8A%A8.png" class="" title="右浮动">

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 300px; background-color: red;&quot;</span>&gt;</span></span><br><span class="line">  &lt;div</span><br><span class="line">    style=&quot;width: 100px; height: 100px; float: left; background-color: blue;&quot;</span><br><span class="line">  &gt;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;overflow: hidden; background-color: green;&quot;</span>&gt;</span></span><br><span class="line">    我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容我是右边内容</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 给右侧div添加 overflow: hidden即可 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：设置浮动后，<strong>div 会被 float 覆盖，而文本却不会被 float 覆盖</strong>，是因为 <strong>float 当初设计的时候</strong>就是为了<strong>使文本围绕在浮动对象的周围</strong>。</p>
</blockquote>
<p>参考: [<a href="https://juejin.im/post/5909db2fda2f60005d2093db">布局概念] 关于 CSS-BFC 深入理解</a></p>
<h2 id="请解释一下为什么需要清除浮动？清除浮动的方式"><a href="#请解释一下为什么需要清除浮动？清除浮动的方式" class="headerlink" title="请解释一下为什么需要清除浮动？清除浮动的方式"></a>请解释一下为什么需要清除浮动？清除浮动的方式</h2><p>浮动本质是用来做一些文字混排效果的，但是被我们拿来做布局用，则会有很多的问题出现。</p>
<p>由于浮动元素不再占用原文档流的位置，所以它会对后面的元素排版产生影响，为了解决这些问题，此时就需要在该元素中清除浮动。准确地说，并不是清除浮动，而是<strong>清除浮动后造成的影响</strong></p>
<h3 id="本质"><a href="#本质" class="headerlink" title="本质"></a>本质</h3><p>清除浮动主要为了解决父级元素因为子级浮动引起内部高度为 0 的问题。</p>
<h3 id="如何清除"><a href="#如何清除" class="headerlink" title="如何清除"></a>如何清除</h3><p>设置一个 clearfix 类，在出现浮动问题的父元素上添加此类即可：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">  <span class="attribute">*zoom</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="什么是外边距合并？"><a href="#什么是外边距合并？" class="headerlink" title="什么是外边距合并？"></a>什么是外边距合并？</h2><p>外边距合并指的是，当两个垂直外边距相遇时，它们将形成一个外边距。 合并后的外边距的高度等于两个发生合并的外边距的高度中的较大者。</p>
<blockquote>
<p>当一个元素出现在另一个元素上面时，第一个元素的下外边距与第二个元素的上外边距会发生合并：</p>
</blockquote>
<img src="/posts/40707/%E5%90%88%E5%B9%B6margin.png" class="" title="合并margin">

<blockquote>
<p>当一个元素包含在另一个元素中时（假设没有内边距或边框把外边距分隔开），它们的上和/或下外边距也会发生合并：</p>
</blockquote>
<img src="/posts/40707/%E5%90%88%E5%B9%B6margin2.png" class="" title="合并margin2">

<blockquote>
<p>尽管看上去有些奇怪，但是外边距甚至可以与自身发生合并。</p>
<p>假设有一个空元素，它有外边距，但是</p>
<p>没有边框或填充</p>
<p>。在这种情况下，上外边距与下外边距就碰到了一起，它们会发生合并：</p>
</blockquote>
<img src="/posts/40707/hebing.png" class="" title="hebing">

<blockquote>
<p>如果这个外边距遇到另一个元素的外边距，它还会发生合并：</p>
</blockquote>
<img src="/posts/40707/hebing2.png" class="" title="hebing2">

<p><strong>注释：</strong>只有普通文档流中块框的垂直外边距才会发生外边距合并。<strong>行内框、浮动框或绝对定位</strong>之间的外边距不会合并。</p>
<h2 id="浏览器是怎样解析-CSS-选择器的？"><a href="#浏览器是怎样解析-CSS-选择器的？" class="headerlink" title="浏览器是怎样解析 CSS 选择器的？"></a>浏览器是怎样解析 CSS 选择器的？</h2><p>从右向左的，这样会提高查找选择器所对应的元素的效率</p>
<ol>
<li>样式系统从关键选择器开始匹配，然后左移查找规则选择器的祖先元素。</li>
<li>只要选择器的子树一直在工作，样式系统就会持续左移，直到和规则匹配，或者是因为不匹配而放弃该规则。</li>
</ol>
<h2 id="抽离样式模块怎么写，说出思路，有无实践经验？"><a href="#抽离样式模块怎么写，说出思路，有无实践经验？" class="headerlink" title="抽离样式模块怎么写，说出思路，有无实践经验？"></a>抽离样式模块怎么写，说出思路，有无实践经验？</h2><p>我们按照 CSS 的性质和用途，将 CSS 文件分成 「公共型样式」、「特殊型样式」、「皮肤型样式」，并以此顺序引用（按需求决定是否添加版本号）。</p>
<ol>
<li>公共型样式：包括了以下几个部分：“标签的重置和设置默认值”、“统一调用背景图和清除浮动或其他需统一处理的长样式”、“网站通用布局”、“通用模块和其扩展”、“元件和其扩展”、“功能类样式”、“皮肤类样式”。</li>
<li>特殊型样式：当某个栏目或页面的样式与网站整体差异较大或者维护率较高时，可以独立引用一个样式：“特殊的布局、模块和元件及扩展”、“特殊的功能、颜色和背景”，也可以是某个大型控件或模块的独立样式。</li>
<li>皮肤型样式：如果产品需要换肤功能，那么我们需要将颜色、背景等抽离出来放在这里。</li>
</ol>
<p>参考：<a href="http://nec.netease.com/standard/css-sort.html">CSS 规范 - 分类方法</a></p>
<h2 id="元素竖向的百分比设定是相对于父容器的高度吗？"><a href="#元素竖向的百分比设定是相对于父容器的高度吗？" class="headerlink" title="元素竖向的百分比设定是相对于父容器的高度吗？"></a>元素竖向的百分比设定是相对于父容器的高度吗？</h2><ul>
<li>对于 height 属性来说是的。</li>
<li>对于 margin-top/bottom(padding-top/bottom) 来讲不是，而是相对于容器的宽度计算的</li>
</ul>
<h2 id="什么是响应式设计？响应式设计的基本原理是什么？如何兼容低版本的-IE？"><a href="#什么是响应式设计？响应式设计的基本原理是什么？如何兼容低版本的-IE？" class="headerlink" title="什么是响应式设计？响应式设计的基本原理是什么？如何兼容低版本的 IE？"></a>什么是响应式设计？响应式设计的基本原理是什么？如何兼容低版本的 IE？</h2><p>响应式网站设计（Responsive Web design）是一个网站能够兼容多个终端，而不是为每一个终端做一个特定的版本。<br>基本原理是通过媒体查询检测不同的设备屏幕尺寸做处理。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width:</span> <span class="number">990px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: orange;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* &lt;head&gt;里边 &lt;link rel=”stylesheet” href=”xxx.css” media=”only screen and (max-width:480px)”&gt; */</span></span><br></pre></td></tr></table></figure>

<p>页面头部必须有 meta 声明的 viewport ：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&lt;meta</span><br><span class="line">  name=&quot;viewport&quot;</span><br><span class="line">  content=&quot;width=device-width, initial-scale=1.0, user-scalable=no&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

<p>兼容 ie6-8 方案：使用 respond.js 插件：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--[if lte IE 8]&gt;</span></span><br><span class="line"><span class="comment">  &lt;script src=&quot;https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">&lt;![endif]--&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="响应式和自适应设计的区别"><a href="#响应式和自适应设计的区别" class="headerlink" title="响应式和自适应设计的区别"></a>响应式和自适应设计的区别</h2><p>其实 RWD 和 AWD 都是响应式设计，从外观上很难分辨，但他们自己运行机理不同，</p>
<p>RWD 是主动式的响应设计，AWD 是被动式的响应式设计。</p>
<ul>
<li>RWD 不管用户使用的是什么设备都是在服务器把数据推送到浏览器后，脚本或 CSS 自行侦测屏幕大小后执行对应的样式表内容，并且一直通过本地脚本在监听屏幕大小的变化，随时做出样式响应的变化，所以是主动的。</li>
<li>AWD 是用户通过浏览器发送请求后，服务器根据请求中用户设备信息（request headers 的 user-agent）做出判断，调用已经在服务器里准备好的，适应对应设备样式文件+HTML 内容+JS，返回给浏览器以这种方式响应不同设备。</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> deviceAgent = request.headers[<span class="string">&#x27;user-agent&#x27;</span>].toLowerCase();</span><br><span class="line"><span class="keyword">var</span> agentID = deviceAgent.match(<span class="regexp">/(iphone|ipod|ipad|android)/</span>);</span><br><span class="line"><span class="keyword">if</span> (agentID) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;手机访问&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;电脑访问&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/posts/40707/rwdawd.png" class="" title="rwdawd">

<h2 id="你对-line-height-是如何理解的？如何单行文本垂直居中？多行文本呢？"><a href="#你对-line-height-是如何理解的？如何单行文本垂直居中？多行文本呢？" class="headerlink" title="你对 line-height 是如何理解的？如何单行文本垂直居中？多行文本呢？"></a>你对 line-height 是如何理解的？如何单行文本垂直居中？多行文本呢？</h2><p>行高是指一行文字的高度，具体说是两行文字间基线的距离。CSS 中起高度作用的是 height 和 line-height ，没有定义 height 属性，最终其表现作用一定是 line-height 。</p>
<h3 id="单行文本垂直居中：（行高-元素高度）"><a href="#单行文本垂直居中：（行高-元素高度）" class="headerlink" title="单行文本垂直居中：（行高 == 元素高度）"></a>单行文本垂直居中：（行高 == 元素高度）</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">height</span>: 40<span class="selector-tag">px</span>;</span><br><span class="line"><span class="selector-tag">line-height</span>: 40<span class="selector-tag">px</span>; <span class="comment">/* 行高==高 */</span></span><br></pre></td></tr></table></figure>

<h3 id="多行文本垂直居中：（父容器-table，子容器-table-cell-vertical-align-middle）"><a href="#多行文本垂直居中：（父容器-table，子容器-table-cell-vertical-align-middle）" class="headerlink" title="多行文本垂直居中：（父容器 table，子容器 table-cell+vertical-align:middle）"></a>多行文本垂直居中：（父容器 table，子容器 table-cell+vertical-align:middle）</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>啊实打实大苏打啊实打实大师大师的啊实打实大苏打<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">div &#123; width: 300px; height: 200px; display: table; background-color: pink; &#125;</span><br><span class="line">span &#123; display: table-cell; vertical-align: middle; &#125;</span><br></pre></td></tr></table></figure>

<h2 id="设置元素浮动后，该元素的-display-值是多少？"><a href="#设置元素浮动后，该元素的-display-值是多少？" class="headerlink" title="设置元素浮动后，该元素的 display 值是多少？"></a>设置元素浮动后，该元素的 display 值是多少？</h2><p>自动变成了 display: block</p>
<h2 id="让页面里的字体变清晰，变细用-CSS-怎么做？"><a href="#让页面里的字体变清晰，变细用-CSS-怎么做？" class="headerlink" title="让页面里的字体变清晰，变细用 CSS 怎么做？"></a>让页面里的字体变清晰，变细用 CSS 怎么做？</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">-webkit-font-smoothing</span>: <span class="selector-tag">antialiased</span>;</span><br></pre></td></tr></table></figure>

<h2 id="overflow-scroll-时不能平滑滚动的问题怎么处理？"><a href="#overflow-scroll-时不能平滑滚动的问题怎么处理？" class="headerlink" title="overflow: scroll 时不能平滑滚动的问题怎么处理？"></a>overflow: scroll 时不能平滑滚动的问题怎么处理？</h2><p>一个 div 使用了 <code>overflow:scroll;</code> ，在移动端可以滚动，但是无法平滑滚动（就像浏览网页那样）</p>
<p>开启滚动硬件加速：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">-webkit-overflow-scrolling</span>: <span class="selector-tag">touch</span>;</span><br></pre></td></tr></table></figure>

<h2 id="什么是-CSS-预处理器-后处理器？"><a href="#什么是-CSS-预处理器-后处理器？" class="headerlink" title="什么是 CSS 预处理器 / 后处理器？"></a>什么是 CSS 预处理器 / 后处理器？</h2><h3 id="CSS-预处理器"><a href="#CSS-预处理器" class="headerlink" title="CSS 预处理器"></a>CSS 预处理器</h3><p>CSS 预处理器定义了一种新的语言，其基本思想是，用一种专门的编程语言，为 CSS 增加了一些编程的特性，将 CSS 作为目标生成文件，然后开发者就只要使用这种语言进行编码工作。通俗的说，CSS 预处理器用一种专门的编程语言，进行 Web 页面样式设计，然后再编译成正常的 CSS 文件</p>
<blockquote>
<p>Sass（SCSS）、LESS</p>
</blockquote>
<h3 id="CSS-后处理器"><a href="#CSS-后处理器" class="headerlink" title="CSS 后处理器"></a>CSS 后处理器</h3><p>CSS 后处理器 是对 CSS 进行处理，并最终生成 CSS 的 预处理器，它属于广义上的 CSS 预处理器。</p>
<p>我们很久以前就在用 CSS 后处理器 了，最典型的例子是 CSS 压缩工具（如 clean-css），只不过以前没单独拿出来说过。还有最近比较火的 Autoprefixer，以 Can I Use 上的 浏览器支持数据 为基础，自动处理兼容性问题。</p>
<blockquote>
<p>Rework、PostCSS</p>
</blockquote>
<p>参考：<a href="https://blog.csdn.net/yushuangyushuang/article/details/79209752">CSS 预处理器和后处理器</a></p>
<h2 id="图片为什么有左右上下间隙-怎么去除："><a href="#图片为什么有左右上下间隙-怎么去除：" class="headerlink" title="图片为什么有左右上下间隙,怎么去除："></a>图片为什么有左右上下间隙,怎么去除：</h2><p>原因：</p>
<ul>
<li>左右：因为 img 是 inline-block 行内元素，行内元素之间有『换行（回车），空格，tab』时会产生左右间隙</li>
<li>上下：行内元素默认与父容器基线对齐，而基线与父容器底部有一定间隙，所以上下图片间有间隙</li>
</ul>
<p>解决办法：</p>
<ul>
<li>移除上下间隙：<ul>
<li>img 本身设置 display: block;</li>
<li>父元素设置 font-size: 0; （基线与字体大小有关，字体为零，基线间就没距离了）</li>
<li>img 本身设置 vertical-align: bottom;（让 inline-block 的 img 与每行的底部对齐）</li>
</ul>
</li>
<li>移除左右间距：<ul>
<li>行内元素间不要有换行，连成一行写消除间隙</li>
<li>第一行结尾写上 <code>&lt;!-- ，第二行开头跟上 --&gt;</code> 。即利用注释消除间距</li>
<li>父元素 font-size 设置 0</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>面试</category>
      </categories>
      <tags>
        <tag>面试</tag>
      </tags>
  </entry>
  <entry>
    <title>Event Loop、计时器、nextTick（转载）</title>
    <url>/posts/61492/</url>
    <content><![CDATA[<p>这是一篇转载文章，源地址是方应杭在掘金上发表的一篇译文：<a href="https://juejin.im/post/5ab7677f6fb9a028d56711d0">Event Loop、计时器、nextTick</a></p>
<p>原文：<a href="https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/">https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/</a></p>
<p>以下是译文：</p>
<h2 id="什么是事件循环（Event-Loop，注意空格）"><a href="#什么是事件循环（Event-Loop，注意空格）" class="headerlink" title="什么是事件循环（Event Loop，注意空格）"></a>什么是事件循环（Event Loop，注意空格）</h2><p>JavaScript 是单线程的，有了 event loop 的加持，Node.js 才可以非阻塞地执行 I/O 操作，把这些操作尽量转移给操作系统来执行。</p>
<p>我们知道大部分现代操作系统都是多线程的，这些操作系统可以在后台执行多个操作。当某个操作结束了，操作系统就会通知 Node.js，然后 Node.js 就（可能）会把对应的回调函数添加到 poll（轮询）队列，最终这些回调函数会被执行。下文中我们会阐述其细节。</p>
<a id="more"></a>

<h2 id="Event-Loop-详解"><a href="#Event-Loop-详解" class="headerlink" title="Event Loop 详解"></a>Event Loop 详解</h2><p>当 Node.js 启动时，会做这几件事</p>
<ol>
<li>初始化 event loop</li>
<li>开始执行脚本（或者进入 REPL，本文不涉及 REPL）。这些脚本有可能会调用一些异步 API、设定计时器或者调用 process.nextTick()</li>
<li>开始处理 event loop</li>
</ol>
<p>如何处理 event loop 呢？下图给出了一个简单的概览：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">   ┌───────────────────────┐</span><br><span class="line">┌─&gt;│        timers         │</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">│  │     I&#x2F;O callbacks     │</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">│  │     idle, prepare     │</span><br><span class="line">│  └──────────┬────────────┘      ┌───────────────┐</span><br><span class="line">│  ┌──────────┴────────────┐      │   incoming:   │</span><br><span class="line">│  │         poll          │&lt;─────┤  connections, │</span><br><span class="line">│  └──────────┬────────────┘      │   data, etc.  │</span><br><span class="line">│  ┌──────────┴────────────┐      └───────────────┘</span><br><span class="line">│  │        check          │</span><br><span class="line">│  └──────────┬────────────┘</span><br><span class="line">│  ┌──────────┴────────────┐</span><br><span class="line">└──┤    close callbacks    │</span><br><span class="line">   └───────────────────────┘</span><br></pre></td></tr></table></figure>

<p>其中每个方框都是 event loop 中的一个阶段。</p>
<p>每个阶段都有一个「先入先出队列」，这个队列存有要执行的回调函数（译注：存的是函数地址）。不过每个阶段都有其特有的使命。一般来说，当 event loop 达到某个阶段时，会在这个阶段进行一些特殊的操作，然后执行这个阶段的队列里的所有回调。 什么时候停止执行这些回调呢？下列两种情况之一会停止：</p>
<ol>
<li>队列的操作全被执行完了</li>
<li>执行的回调数目到达指定的最大值 然后，event loop 进入下一个阶段，然后再下一个阶段。</li>
</ol>
<p>一方面，上面这些操作都有可能添加计时器；另一方面，操作系统会向 poll 队列中添加新的事件，当 poll 队列中的事件被处理时可能会有新的 poll 事件进入 poll 队列。结果，耗时较长的回调函数可以让 event loop 在 poll 阶段停留很久，久到错过了计时器的触发时机。你可以在下文的 timers 章节和 poll 章节详细了解这其中的细节。</p>
<p>注意，Windows 的实现和 Unix/Linux 的实现稍有不同，不过对本文内容影响不大。本文囊括了 event loop 最重要的部分，不同平台可能有七个或八个阶段，但是上面的几个阶段是我们真正关心的阶段，而且是 Node.js 真正用到的阶段。</p>
<h2 id="各阶段概览"><a href="#各阶段概览" class="headerlink" title="各阶段概览"></a>各阶段概览</h2><ul>
<li>timers 阶段：这个阶段执行 setTimeout 和 setInterval 的回调函数。</li>
<li>I/O callbacks 阶段：不在 timers 阶段、close callbacks 阶段和 check 阶段这三个阶段执行的回调，都由此阶段负责，这几乎包含了所有回调函数。</li>
<li>idle, prepare 阶段（译注：看起来是两个阶段，不过这不重要）：event loop 内部使用的阶段（译注：我们不用关心这个阶段）</li>
<li>poll 阶段：获取新的 I/O 事件。在某些场景下 Node.js 会阻塞在这个阶段。</li>
<li>check 阶段：执行 setImmediate() 的回调函数。</li>
<li>close callbacks 阶段：执行关闭事件的回调函数，如 socket.on(‘close’, fn) 里的 fn。</li>
</ul>
<p>一个 Node.js 程序结束时，Node.js 会检查 event loop 是否在等待异步 I/O 操作结束，是否在等待计时器触发，如果没有，就会关掉 event loop。</p>
<h2 id="各阶段详解"><a href="#各阶段详解" class="headerlink" title="各阶段详解"></a>各阶段详解</h2><h3 id="timers-阶段"><a href="#timers-阶段" class="headerlink" title="timers 阶段"></a>timers 阶段</h3><p>计时器实际上是在指定多久以后可以执行某个回调函数，而不是指定某个函数的确切执行时间。当指定的时间达到后，计时器的回调函数会尽早被执行。如果操作系统很忙，或者 Node.js 正在执行一个耗时的函数，那么计时器的回调函数就会被推迟执行。</p>
<p>注意，从原理上来说，poll 阶段能控制计时器的回调函数什么时候被执行。</p>
<p>举例来说，你设置了一个计时器在 100 毫秒后执行，然后你的脚本用了 95 毫秒来异步读取了一个文件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">someAsyncOperation</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 假设读取这个文件一共花费 95 毫秒</span></span><br><span class="line">  fs.readFile(<span class="string">&#x27;/path/to/file&#x27;</span>, callback);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> timeoutScheduled = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> delay = <span class="built_in">Date</span>.now() - timeoutScheduled;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;delay&#125;</span>毫秒后执行了 setTimeout 的回调`</span>);</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行一个耗时 95 毫秒的异步操作</span></span><br><span class="line">someAsyncOperation(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> startCallback = <span class="built_in">Date</span>.now();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行一个耗时 10 毫秒的同步操作</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="built_in">Date</span>.now() - startCallback &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    <span class="comment">// 什么也不做</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>当 event loop 进入 poll 阶段，发现 poll 队列为空（因为文件还没读完），event loop 检查了一下最近的计时器，大概还有 100 毫秒时间，于是 event loop 决定这段时间就停在 poll 阶段。在 poll 阶段停了 95 毫秒之后，fs.readFile 操作完成，一个耗时 10 毫秒的回调函数被系统放入 poll 队列，于是 event loop 执行了这个回调函数。执行完毕后，poll 队列为空，于是 event loop 去看了一眼最近的计时器（译注：event loop 发现卧槽，已经超时 95 + 10 - 100 = 5 毫秒了），于是经由 check 阶段、close callbacks 阶段绕回到 timers 阶段，执行 timers 队列里的那个回调函数。这个例子中，100 毫秒的计时器实际上是在 105 毫秒后才执行的。</p>
<p>注意：为了防止 poll 阶段占用了 event loop 的所有时间，libuv（Node.js 用来实现 event loop 和所有异步行为的 C 语言写成的库）对 poll 阶段的最长停留时间做出了限制，具体时间因操作系统而异。</p>
<h3 id="I-O-callbacks-阶段"><a href="#I-O-callbacks-阶段" class="headerlink" title="I/O callbacks 阶段"></a>I/O callbacks 阶段</h3><p>这个阶段会执行一些系统操作的回调函数，比如 TCP 报错，如果一个 TCP socket 开始连接时出现了 ECONNREFUSED 错误，一些 *nix 系统就会（向 Node.js）通知这个错误。这个通知就会被放入 I/O callbacks 队列。</p>
<h3 id="poll-阶段（轮询阶段）"><a href="#poll-阶段（轮询阶段）" class="headerlink" title="poll 阶段（轮询阶段）"></a>poll 阶段（轮询阶段）</h3><p>poll 阶段有两个功能：</p>
<ol>
<li>如果发现计时器的时间到了，就绕回到 timers 阶段执行计时器的回调。</li>
<li>然后再，执行 poll 队列里的回调。</li>
</ol>
<p>当 event loop 进入 poll 阶段，如果发现没有计时器，就会：</p>
<ol>
<li>如果 poll 队列不是空的，event loop 就会依次执行队列里的回调函数，直到队列被清空或者到达 poll 阶段的时间上限。</li>
<li>如果 poll 队列是空的，就会：<ol>
<li>如果有 setImmediate() 任务，event loop 就结束 poll 阶段去往 check 阶段。</li>
<li>如果没有 setImmediate() 任务，event loop 就会等待新的回调函数进入 poll 队列，并立即执行它。</li>
</ol>
</li>
</ol>
<p>一旦 poll 队列为空，event loop 就会检查计时器有没有到期，如果有计时器到期了，event loop 就会回到 timers 阶段执行计时器的回调。</p>
<h3 id="check-阶段"><a href="#check-阶段" class="headerlink" title="check 阶段"></a>check 阶段</h3><p>这个阶段允许开发者在 poll 阶段结束后立即执行一些函数。如果 poll 阶段空闲了，同时存在 setImmediate() 任务，event loop 就会进入 check 阶段。</p>
<p>setImmediate() 实际上是一种特殊的计时器，有自己特有的阶段。它是通过 libuv 里一个能将回调安排在 poll 阶段之后执行的 API 实现的。</p>
<p>一般来说，当代码执行后，event loop 最终会达到 poll 阶段，等待新的连接、新的请求等。但是如果一个回调是由 setImmediate() 发出的，同时 poll 阶段空闲下来了，event loop 就会结束 poll 阶段进入 check 阶段，不再等待新的 poll 事件。</p>
<p>（译注：感觉同样的话说了三遍）</p>
<h3 id="close-callbacks-阶段"><a href="#close-callbacks-阶段" class="headerlink" title="close callbacks 阶段"></a>close callbacks 阶段</h3><p>如果一个 socket 或者 handle 被突然关闭（比如 socket.destroy()），那么就会有一个 close 事件进入这个阶段。否则（译注：我没看到这个否则在否定什么，是在否定「突然」吗？），这个 close 事件就会进入 process.nextTick()。</p>
<h2 id="setImmediate-vs-setTimeout"><a href="#setImmediate-vs-setTimeout" class="headerlink" title="setImmediate() vs setTimeout()"></a>setImmediate() vs setTimeout()</h2><p>setImmediate 和 setTimeout 很相似，但是其回调函数的调用时机却不一样。</p>
<p>setImmediate() 的作用是在当前 poll 阶段结束后调用一个函数。 setTimeout() 的作用是在一段时间后调用一个函数。 这两者的回调的执行顺序取决于 setTimeout 和 setImmediate 被调用时的环境。</p>
<p>如果 setTimeout 和 setImmediate 都是在主模块（main module）中被调用的，那么回调的执行顺序取决于当前进程的性能，这个性能受其他应用程序进程的影响。</p>
<p>举例来说，如果在主模块中运行下面的脚本，那么两个回调的执行顺序是无法判断的：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// timeout_vs_immediate.js</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;timeout&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">setImmediate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;immediate&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$ node timeout_vs_immediate.js</span><br><span class="line">timeout</span><br><span class="line">immediate</span><br><span class="line"></span><br><span class="line">$ node timeout_vs_immediate.js</span><br><span class="line">immediate</span><br><span class="line">timeout</span><br></pre></td></tr></table></figure>

<p>但是，如果把上面代码放到 I/O 操作的回调里，setImmediate 的回调就总是优先于 setTimeout 的回调：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// timeout_vs_immediate.js</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">fs.readFile(__filename, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;timeout&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">  setImmediate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;immediate&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>运行结果如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$ node timeout_vs_immediate.js</span><br><span class="line">immediate</span><br><span class="line">timeout</span><br><span class="line"></span><br><span class="line">$ node timeout_vs_immediate.js</span><br><span class="line">immediate</span><br><span class="line">timeout</span><br></pre></td></tr></table></figure>

<p>setImmediate 的主要优势就是，如果在 I/O 操作的回调里，setImmediate 的回调总是比 setTimeout 的回调先执行。（译者注：怎么总是把一个道理翻来覆去地说）</p>
<h2 id="process-nextTick"><a href="#process-nextTick" class="headerlink" title="process.nextTick()"></a>process.nextTick()</h2><p>你可能发现 process.nextTick() 这个重要的异步 API 没有出现在任何一个阶段里，那是因为从技术上来讲 process.nextTick() 并不是 event loop 的一部分。实际上，不管 event loop 当前处于哪个阶段，nextTick 队列都是在当前阶段后就被执行了。</p>
<p>回过头来看我们的阶段图，你在任何一个阶段调用 process.nextTick(回调)，回调都会在当前阶段继续运行前被调用。这种行为有的时候会造成不好的结果，因为你可以递归地调用 process.nextTick()，这样 event loop 就会一直停在当前阶段不走……无法进入 poll 阶段。</p>
<p>为什么 Node.js 要这样设计 process.nextTick 呢？</p>
<p>因为有些异步 API 需要保证一致性，即使可以同步完成，也要保证异步操作的顺序，看下面代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">apiCall</span>(<span class="params">arg, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> arg !== <span class="string">&#x27;string&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> process.nextTick(</span><br><span class="line">      callback,</span><br><span class="line">      <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&#x27;argument should be string&#x27;</span>)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码检查了参数的类型，如果类型不是 string，就会将 error 传递给 callback。</p>
<p>这段代码保证 apiCall 调用之后的同步代码能在 callback 之前运行。用于用到了 process.nextTick()，所以 callback 会在 event loop 进入下一个阶段前执行。为了做到这一点，JS 的调用栈可以先 unwind 再执行 nextTick 的回调，这样无论你递归调用多少次 process.nextTick() 都不会造成调用栈溢出（V8 里对应 RangeError: Maximum call stack size exceeded）。</p>
<p>如果不这样设计，会造成一些潜在的问题，比如下面的代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> bar;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是一个异步 API，但是却同步地调用了 callback</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">someAsyncApiCall</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  callback();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//`someAsyncApiCall` 在执行过程中就调用了回调</span></span><br><span class="line">someAsyncApiCall(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 此时 bar 还没有被赋值为 1</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;bar&#x27;</span>, bar); <span class="comment">// undefined</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">bar = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>开发者虽然把 someAsyncApiCall 命名得像一个异步函数，但是实际上这个函数是同步执行的。当 someAsyncApiCall 被调用时，回调也在同一个 event loop 阶段被调用了。结果回调中就无法得到 bar 的值。因为赋值语句还没被执行。</p>
<p>如果把回调放在 process.nextTick() 中执行，后面的赋值语句就可以先执行了。而且 process.nextTick() 的回调会在 eventLoop 进入下一个阶段前调用。（译注：又是把一个道理翻来覆去地讲）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> bar;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">someAsyncApiCall</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  process.nextTick(callback);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">someAsyncApiCall(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;bar&#x27;</span>, bar); <span class="comment">// 1</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">bar = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>一个更符合现实的例子是这样的：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> server = net.createServer(<span class="function">() =&gt;</span> &#123;&#125;).listen(<span class="number">8080</span>);</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">&#x27;listening&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>

<p>.listen(8080) 这句话是同步执行的。问题在于 listening 回调无法被触发，因为 listening 的监听代码在 .listen(8080) 的后面。</p>
<p>为了解决这个问题，.listen() 函数可以使用 process.nextTick() 来执行 listening 事件的回调。</p>
<h2 id="process-nextTick-vs-setImmediate"><a href="#process-nextTick-vs-setImmediate" class="headerlink" title="process.nextTick() vs setImmediate()"></a>process.nextTick() vs setImmediate()</h2><p>这两个函数功能很像，而且名字也很令人疑惑。</p>
<p>process.nextTick() 的回调会在当前 event loop 阶段「立即」执行。 setImmediate() 的回调会在后续的 event loop 周期（tick）执行。</p>
<p>（译注：看起来名字叫反了）</p>
<p>二者的名字应该互换才对。process.nextTick() 比 setImmediate() 更 immediate（立即）一些。</p>
<p>这是一个历史遗留问题，而且为了保证向后兼容性，也不太可能得到改善。所以就算这两个名字听起来让人很疑惑，也不会在未来有任何变化。</p>
<p>我们推荐开发者在任何情况下都使用 setImmediate()，因为它的兼容性更好，而且它更容易理解。</p>
<h2 id="什么时候用-process-nextTick-？"><a href="#什么时候用-process-nextTick-？" class="headerlink" title="什么时候用 process.nextTick()？"></a>什么时候用 process.nextTick()？</h2><p>There are two main reasons: 使用的理由有两个：</p>
<ol>
<li>让开发者处理错误、清除无用的资源，或者在 event loop 当前阶段结束前尝试重新请求资源</li>
<li>有时候有必要让一个回调在调用栈 unwind 之后，event loop 进入下阶段之前执行</li>
</ol>
<p>为了让代码更合理，我们可能会写这样的代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> server = net.createServer();</span><br><span class="line">server.on(<span class="string">&#x27;connection&#x27;</span>, <span class="function"><span class="params">conn</span> =&gt;</span> &#123;&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">8080</span>);</span><br><span class="line">server.on(<span class="string">&#x27;listening&#x27;</span>, <span class="function">() =&gt;</span> &#123;&#125;);</span><br></pre></td></tr></table></figure>

<p>假设 listen() 在 event loop 一启动的时候就执行了，而 listening 事件的回调被放在了 setImmediate() 里，listen 动作是立即发生的，如果想要 event loop 执行 listening 回调，就必须先经过 poll 阶段，当时 poll 阶段有可能会停留，以等待连接，这样一来就有可能出现 connect 事件的回调比 listening 事件的回调先执行。（译注：这显然不合理，所以我们需要用 process.nextTick）</p>
<p>再举一个例子，一个类继承了 EventEmitter，而且想在实例化的时候触发一个事件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">&#x27;events&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyEmitter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  EventEmitter.call(<span class="built_in">this</span>);</span><br><span class="line">  <span class="built_in">this</span>.emit(<span class="string">&#x27;event&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">util.inherits(MyEmitter, EventEmitter);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myEmitter = <span class="keyword">new</span> MyEmitter();</span><br><span class="line">myEmitter.on(<span class="string">&#x27;event&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;an event occurred!&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>你不能直接在构造函数里执行 this.emit(‘event’)，因为这样的话后面的回调就永远无法执行。把 this.emit(‘event’) 放在 process.nextTick() 里，后面的回调就可以执行，这才是我们预期的行为：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">&#x27;events&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;util&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyEmitter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  EventEmitter.call(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// use nextTick to emit the event once a handler is assigned</span></span><br><span class="line">  process.nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.emit(<span class="string">&#x27;event&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">util.inherits(MyEmitter, EventEmitter);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myEmitter = <span class="keyword">new</span> MyEmitter();</span><br><span class="line">myEmitter.on(<span class="string">&#x27;event&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;an event occurred!&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>后端</category>
        <category>Node</category>
      </categories>
      <tags>
        <tag>转载</tag>
        <tag>Node</tag>
        <tag>EventLoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Sequelize框架入门</title>
    <url>/posts/1183/</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>平常写前端项目时，为了更方便的获取“真实”的动态数据，也会新建几个数据库表来作支撑。但每每需要用Node搭建后端服务时，数据库的查询真的让人头疼，难倒不难，就是特别繁琐，即使封装了个查询sql用工具模块，在遇到稍复杂的查询语句时还是得写完整SQL。</p>
<p>我又是个比较懒的人，在经历了几次痛苦折磨后，我开始google有没有谁帮我们解决了数据库表字段与对象之间的关系映射。也就是我们通常所说的 <a href="https://baike.baidu.com/item/ORM/3583252?fr=aladdin">ORM</a> 。经过几番搜索，我找到了 <a href="http://docs.sequelizejs.com/">Sequelize</a> 框架。在了解它之前，我们先简单介绍下什么是 <code>ORM</code> ：（我知道不少人是不会点击上面链接查看详情的 :)）</p>
<a id="more"></a>

<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><h3 id="ORM"><a href="#ORM" class="headerlink" title="ORM"></a>ORM</h3><p>ORM 全称 Object Relational Mapping，翻译成中文就是 <code>对象关系映射</code> 。是对 SQL 查询语句的封装，让我们可以用面向对象的方式操作数据库，来更加优雅的生成安全、可维护的 SQL 代码。说白了，就是通过对象来映射和操作数据库。</p>
<h3 id="Sequelize"><a href="#Sequelize" class="headerlink" title="Sequelize"></a>Sequelize</h3><p>而今天的主角 <code>Sequelize</code> 则是一个基于 promise 的 Node.js 异步ORM框架。它能够支持多种数据库，包含但不限于 PostgreSQL, MySQL 和 MSSQL 。</p>
<blockquote>
<p>官网地址：<a href="http://docs.sequelizejs.com/">http://docs.sequelizejs.com/</a><br>github：<a href="https://github.com/sequelize/sequelize">https://github.com/sequelize/sequelize</a></p>
</blockquote>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h3><p>在本地新建文件夹，例如 <code>sequelize-demo</code> ，然后在项目根目录下运行命令行命名 <code>npm init -y</code>。运行完该命令后项目tree如下：</p>
<img src="/posts/1183/npminit-y.png" class="" title="npminit-y">

<p>接着使用 npm 安装 <code>sequelize</code>：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i sequelize</span><br></pre></td></tr></table></figure>



<h3 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h3><p>完成上述步骤以后，我们在根目录下新建一个 <code>app.js</code> 文件来使用 <code>sequelize</code> ，代码如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入 sequelize</span></span><br><span class="line"><span class="keyword">const</span> Sequelize = <span class="built_in">require</span>(<span class="string">&#x27;sequelize&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新建 sequelize 实例</span></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> Sequelize(<span class="string">&#x27;数据库名称&#x27;</span>, <span class="string">&#x27;数据库用户名&#x27;</span>, <span class="string">&#x27;数据库密码&#x27;</span>, &#123;</span><br><span class="line">    <span class="comment">// 其他的数据库连接配置</span></span><br><span class="line">    host: <span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="comment">// 主机，默认 localhost</span></span><br><span class="line">    port: <span class="number">8889</span>,        <span class="comment">// 端口，默认 3306</span></span><br><span class="line">    dialect: <span class="string">&#x27;mysql&#x27;</span>,  <span class="comment">// 数据库类型， 默认 mysql 【必填】</span></span><br><span class="line">    timezone: <span class="string">&#x27;+08:00&#x27;</span> <span class="comment">// 时区，默认会根据系统当前所在时区进行设置，格式：&#x27;+08:00&#x27; 或字符串格式 &#x27;Asia/Shanghai&#x27; 参考：http://php.net/manual/zh/timezones.php 【使用场景：一般情况下默认配置就好，但如果服务器在美国，但想存储中国时区，就需要明确指定 &#x27;+08:00&#x27; 了】</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试数据库的连接（返回的是一个Promise，记得 catch 捕获错误）</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    sequelize.authenticate();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;数据库连接成功!&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;连接失败&#x27;</span>);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时你可以尝试运行 <code>app.js</code> 文件，即在根目录下运行 <code>node app.js</code> 命令。正常情况下你会收到报错信息，类似这样：</p>
<img src="/posts/1183/error-mysql2.png" class="" title="mysql2">

<p>意思是你需要安装 <code>mysql2</code> ，这是因为 <code>sequelize</code> 虽然依赖了 <code>mysql2</code> ，但却没有内置安装。所以接下来你得在项目根目录下运行如下代码来安装 <code>mysql2</code>：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i mysql2</span><br></pre></td></tr></table></figure>



<p>安装完毕后再次运行 <code>app.js</code> ，就能连接数据库成功了：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">node app.js</span><br><span class="line">Executing (default): SELECT 1+1 AS result</span><br><span class="line">数据库连接成功!</span><br></pre></td></tr></table></figure>



<h3 id="定义模型（Model）"><a href="#定义模型（Model）" class="headerlink" title="定义模型（Model）"></a>定义模型（Model）</h3><blockquote>
<p>所谓模型，就是用来描述数据库表字段信息的对象，每一个模型对象表示数据库中的一个表，后续对数据库的操作都是用过对应的模型对象来完成的。</p>
</blockquote>
<p>接下来我们就要定义数据的模型了。在此之前，你还需要做一些准备工作。以我为例，我在数据库中新建了一个 <code>users</code> 表，表字段和类型如下：</p>
<img src="/posts/1183/table-property.png" class="" title="表字段">

<p>然后定义出对应此表的数据模型：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 定义模型（用对象的方式来描述数据库中的表）</span></span><br><span class="line"><span class="keyword">const</span> UserModel = sequelize.define(<span class="string">&#x27;User&#x27;</span>, &#123;</span><br><span class="line">    <span class="comment">// 描述表中对应的字段信息</span></span><br><span class="line">    id: &#123; <span class="comment">// 每一个字段的信息</span></span><br><span class="line">        type: Sequelize.INTEGER(<span class="number">11</span>), <span class="comment">// 字段类型</span></span><br><span class="line">        allowNull: <span class="literal">false</span>,            <span class="comment">// 不允许为空</span></span><br><span class="line">        autoIncrement: <span class="literal">true</span>,         <span class="comment">// id自增长</span></span><br><span class="line">        primaryKey: <span class="literal">true</span>,            <span class="comment">// 设为主键</span></span><br><span class="line">    &#125;,</span><br><span class="line">    username: &#123;</span><br><span class="line">        type: Sequelize.STRING(<span class="number">50</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="string">&#x27;&#x27;</span>,            <span class="comment">// 设置字段默认值</span></span><br><span class="line">    &#125;,</span><br><span class="line">    age: &#123;</span><br><span class="line">        type: Sequelize.TINYINT(<span class="number">3</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    gender: &#123;</span><br><span class="line">        type: Sequelize.ENUM([<span class="string">&#x27;men&#x27;</span>, <span class="string">&#x27;women&#x27;</span>, <span class="string">&#x27;other&#x27;</span>]), <span class="comment">// 这是个枚举类型字段，表示性别只能为“男”，“女”，“保密”中的其中一个，传入 ENUM 中的可以是逗号隔开的字符串，也可以是个数组：ENUM([&#x27;men&#x27;, &#x27;women&#x27;]) or ENUM(&#x27;men&#x27;, &#x27;women&#x27;, &#x27;other&#x27;)</span></span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="string">&#x27;men&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;, &#123; <span class="comment">// 用来设置字段以外的其他信息</span></span><br><span class="line">    timestamps: <span class="literal">false</span>, <span class="comment">// 是否给每条记录添加 createAt 和 updateAt 字段，并在添加新数据和更新数据的时候自动设置这两个字段的值，默认为 true</span></span><br><span class="line">    tableName: <span class="string">&#x27;users&#x27;</span>, <span class="comment">// 该模型映射的真实表名</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p><strong>注意：</strong>在定义模型时，字段名称可以和数据库表中的字段名称不相同，但如果你想另起一个别名，则需要在字段信息设置中加入 <code>field</code> 来关联真正的表字段名称。例如：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">userName: &#123; <span class="comment">// &lt;-- 你起的别名</span></span><br><span class="line">    type: Sequelize.STRING(<span class="number">50</span>),</span><br><span class="line">    allowNull: <span class="literal">false</span>,</span><br><span class="line">    field: <span class="string">&#x27;username&#x27;</span>, <span class="comment">// 关联数据库表中真正的字段名</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<h3 id="数据查询"><a href="#数据查询" class="headerlink" title="数据查询"></a>数据查询</h3><h4 id="查询所有"><a href="#查询所有" class="headerlink" title="查询所有"></a>查询所有</h4><p>完成表模型的定义以后，我们就可以通过 <code>findAll</code> 来查询表数据了：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 查询 users 表中所有数据</span></span><br><span class="line">UserModel.findAll().then(<span class="function"><span class="params">users</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 返回的 users 是个数组</span></span><br><span class="line">    users.forEach(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 循环的每个 user 都是个 Model 实例</span></span><br><span class="line">        <span class="comment">// 该 Model 实例包含 get 方法，我们能通过它获取 username</span></span><br><span class="line">        <span class="built_in">console</span>.log(user.get(<span class="string">&#x27;username&#x27;</span>));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p>写完上面代码后，再次运行 <code>app.js</code> ，你就应该能够查询到数据了~<br>p.s. 查询之前别忘了在数据库中插入一些数据。</p>
<h4 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h4><p>除了查询全部数据，我们还可以使用 <code>where</code> 查询指定的数据：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这次不用 .then 形式，而采用 async + await</span></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 查找 username 为 &#x27;李元芳&#x27; 的唯一数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findOne(&#123;</span><br><span class="line">        where: &#123;</span><br><span class="line">            username: <span class="string">&#x27;李元芳&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.dir(res);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<p>而类似大于小于这样的查询会稍显麻烦一点。例如我们来编写查询 users 表中年龄大于某个值的代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 查找满足 age &gt; 24 的所有数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        where: &#123;</span><br><span class="line">            age: &#123;</span><br><span class="line">                [Sequelize.Op.gt]: <span class="number">24</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印出符合条件的用户的 username</span></span><br><span class="line">    <span class="built_in">console</span>.dir(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<h4 id="多条件查询"><a href="#多条件查询" class="headerlink" title="多条件查询"></a>多条件查询</h4><p>除了单一条件查询，我们还可以通过嵌套 or 或 and 运算符的集合来生成复杂条件语句。例如我们来查询 <code>年龄小于25 或者 性别为男</code> 的所有数据：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; Op &#125; = Sequelize;</span><br><span class="line">    <span class="comment">// 查找满足 age &lt; 25 或 gender = &#x27;men&#x27; 的所有数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        where: &#123;</span><br><span class="line">            [Op.or]: [</span><br><span class="line">                &#123;</span><br><span class="line">                    age: &#123;</span><br><span class="line">                        [Sequelize.Op.lt]: <span class="number">25</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    gender: <span class="string">&#x27;men&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印出符合条件的用户的 username</span></span><br><span class="line">    <span class="built_in">console</span>.dir(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<p>从上面几组查询语句我们可以看出，<code>where</code> 通常用 <code>attribute: value</code> 键值对获取一个对象，其中 <code>value</code> 可以是匹配等式的<strong>数据</strong>或其他运算符的<strong>键值对象</strong>。更多查询语法可在下方链接查询：</p>
<ul>
<li><a href="http://docs.sequelizejs.com/manual/querying.html">Sequelize - Querying</a></li>
<li><a href="https://demopark.github.io/sequelize-docs-Zh-CN/querying.html">Sequelize - Querying（中文文档）</a></li>
</ul>
<h4 id="查询限制-limit-offset"><a href="#查询限制-limit-offset" class="headerlink" title="查询限制 limit, offset"></a>查询限制 limit, offset</h4><p>我们还能限制查询的数量：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 只从表中查询两条数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        limit: <span class="number">2</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<p>跳过前2条数据：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        offset: <span class="number">2</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<p>跳过前2条数据并获取3条：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        offset: <span class="number">2</span>,</span><br><span class="line">        limit: <span class="number">3</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<h4 id="查询排序"><a href="#查询排序" class="headerlink" title="查询排序"></a>查询排序</h4><p>我们还可以将查询数据进行排序：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 查询的结果按年龄高到低排序</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        order: [</span><br><span class="line">            [<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;desc&#x27;</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<h4 id="查询记录"><a href="#查询记录" class="headerlink" title="查询记录"></a>查询记录</h4><p>有些时候我们可能只是想单纯的查询数据表中有多少条数据，这时可以用 <code>count()</code> 方法：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="comment">// 查询 users 表中有多少条数据</span></span><br><span class="line">  <span class="keyword">let</span> count = <span class="keyword">await</span> UserModel.count();</span><br><span class="line">  <span class="built_in">console</span>.log(count);</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者使用 `findAndCountAll()` 方法在数据库中搜索多条记录，它能返回给我们**数据和总计数**：</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 查询 users 表中的前两条数据，并返回 users 表中总记录数</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAndCountAll(&#123;</span><br><span class="line">        limit: <span class="number">2</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<p>查询结果的格式如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123; </span><br><span class="line">    count: 总记录数,</span><br><span class="line">    rows: [ </span><br><span class="line">        &#123;第一条记录&#125;, &#123;第二条记录&#125;, ...</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>这个方法对我们为前端提供分页功能很方便，count是符合条件的总记录数，而rows中可以是当前页数下的记录数。</p>
<h3 id="数据增加"><a href="#数据增加" class="headerlink" title="数据增加"></a>数据增加</h3><p>既然能查，当然就能往数据库插入数据，在 <code>sequelize</code> 中，插入数据可以用 <code>build</code> 方法：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 新建一条数据（除了build外，还可以通过 new UserModel(&#123;&#125;) 的形式创建一条记录）</span></span><br><span class="line"><span class="keyword">let</span> wangwu = UserModel.build(&#123;</span><br><span class="line">    username: <span class="string">&#x27;王五&#x27;</span>,</span><br><span class="line">    age: <span class="number">22</span>,</span><br><span class="line">    gender: <span class="string">&#x27;men&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// **注意：** 通过 new 或 build 出来的对象不会立即同步到数据库中，</span></span><br><span class="line"><span class="comment">// 需要使用后续的一些方法（例如 save ）来同步</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 你还可以修改这条数据</span></span><br><span class="line">wangwu.set(<span class="string">&#x27;age&#x27;</span>, <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最后别忘了保存才能成功插入数据</span></span><br><span class="line">wangwu.save();</span><br></pre></td></tr></table></figure>


<p>如果运行后没报错，去数据库刷新表吧，数据已经成功的插入到 <code>users</code> 表了~</p>
<h3 id="数据修改"><a href="#数据修改" class="headerlink" title="数据修改"></a>数据修改</h3><p>实际开发中修改数据是再平常不过的了，比如修改一篇博客，更新自己的个人信息… 在 <code>sequelize</code> 中，我们这样修改数据：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 查询id为2的用户数据</span></span><br><span class="line">UserModel.findByPk(<span class="number">2</span>).then(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 查询到以后修改其 age 字段为 99</span></span><br><span class="line">    user.set(<span class="string">&#x27;age&#x27;</span>, <span class="number">99</span>);</span><br><span class="line">    <span class="comment">// 修改后别忘了保存</span></span><br><span class="line">    user.save();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p><strong>注意：</strong> 在 Sequelize v5 版本以前，通过id查询数据的方法名为 <code>findById</code> ，从 v5 版本开始，更改为 <code>findByPk</code> 。其实想一下这样非常合理，以前的 <code>findById</code> 太主观了，要知道不一定每个表的主键都为 id ，所以更改为 <code>findByPk</code> 后，表示通过<strong>主键（Pk -&gt; PrimaryKey）</strong>查找，<code>sequelize</code> 会自动通过你在创建表模型时定义的主键字段查找。例如我们一开始在定义 <code>User</code> 模型时，就给 <code>id</code> 字段添加了 <code>primaryKey: true,</code> 属性。</p>
<p>除了 set + update 来更新数据以外，还可以使用 <code>update()</code> 方法做相同的事情：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 先查询</span></span><br><span class="line">    <span class="keyword">let</span> xiaohong = <span class="keyword">await</span> UserModel.findByPk(<span class="number">3</span>);</span><br><span class="line">    <span class="comment">// update方法相当于 set + save</span></span><br><span class="line">    <span class="keyword">await</span> xiaohong.update(&#123;</span><br><span class="line">        age: <span class="number">22</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<h3 id="数据删除"><a href="#数据删除" class="headerlink" title="数据删除"></a>数据删除</h3><p>如果想要删除一条数据，可以使用 <code>destroy</code> 方法：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 先查询</span></span><br><span class="line">    <span class="keyword">let</span> wangwu = <span class="keyword">await</span> UserModel.findByPk(<span class="number">4</span>);</span><br><span class="line">    <span class="comment">// 对查询到的数据进行删除</span></span><br><span class="line">    wangwu.destroy();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>



<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Sequelize = <span class="built_in">require</span>(<span class="string">&#x27;sequelize&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sequelize = <span class="keyword">new</span> Sequelize(<span class="string">&quot;miaov&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>, &#123;</span><br><span class="line">  <span class="comment">// 其他的数据库连接配置</span></span><br><span class="line">  host: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="comment">// 主机</span></span><br><span class="line">  port: <span class="number">8889</span>, <span class="comment">// 端口</span></span><br><span class="line">  dialect: <span class="string">&quot;mysql&quot;</span> <span class="comment">// 数据库类型</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试连接</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    sequelize.authenticate();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;数据库连接成功!&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;连接失败&#x27;</span>);    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义模型（用对象的方式来描述数据库中的表）</span></span><br><span class="line"><span class="keyword">const</span> UserModel = sequelize.define(<span class="string">&#x27;User&#x27;</span>, &#123;</span><br><span class="line">    <span class="comment">// 定义字段</span></span><br><span class="line">    id: &#123; <span class="comment">// 对字段属性的定义</span></span><br><span class="line">        type: Sequelize.INTEGER(<span class="number">11</span>), <span class="comment">// 字段类型</span></span><br><span class="line">        allowNull: <span class="literal">false</span>,            <span class="comment">// 不允许为空</span></span><br><span class="line">        autoIncrement: <span class="literal">true</span>,         <span class="comment">// id自增长</span></span><br><span class="line">        primaryKey: <span class="literal">true</span>,            <span class="comment">// 设为主键</span></span><br><span class="line">    &#125;,</span><br><span class="line">    username: &#123;</span><br><span class="line">        type: Sequelize.STRING(<span class="number">50</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="string">&#x27;&#x27;</span>,            <span class="comment">// 设置字段默认值</span></span><br><span class="line">    &#125;,</span><br><span class="line">    age: &#123;</span><br><span class="line">        type: Sequelize.TINYINT(<span class="number">3</span>),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    gender: &#123;</span><br><span class="line">        type: Sequelize.ENUM([<span class="string">&#x27;men&#x27;</span>, <span class="string">&#x27;women&#x27;</span>, <span class="string">&#x27;other&#x27;</span>]),</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="string">&#x27;men&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;, &#123; <span class="comment">// 用来设置字段以外的其他信息</span></span><br><span class="line">    timestamps: <span class="literal">false</span>,  <span class="comment">// 是否给每条记录添加 createAt 和 updateAt 字段，并在添加新数据和更新数据的时候自动设置这两个字段的值，默认为 true</span></span><br><span class="line">    tableName: <span class="string">&#x27;users&#x27;</span>, <span class="comment">// 该模型映射的真实表名</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为了方便学习，使用一个函数包裹一组代码</span></span><br><span class="line"><span class="comment">// 这样代码就不会运行了，从而避免干扰其他代码的执行</span></span><br><span class="line"><span class="comment">// 如果想要此函数中代码执行，添加 `()` 就好</span></span><br><span class="line"><span class="comment">// (function()&#123;...&#125;)();  &lt;-- 加上括号</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 查询 users 表中所有数据</span></span><br><span class="line">    UserModel.findAll().then(<span class="function"><span class="params">users</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 返回的 users 是个数组</span></span><br><span class="line">        users.forEach(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 循环的每个 user 都是个 Model 实例</span></span><br><span class="line">            <span class="comment">// 该 Model 实例包含 get 方法，我们能通过它获取 username</span></span><br><span class="line">            <span class="built_in">console</span>.log(user.get(<span class="string">&#x27;username&#x27;</span>));</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 新建一条数据（除了build外，还可以通过 new UserModel() 的形式创建一条记录）</span></span><br><span class="line">    <span class="keyword">let</span> liyuanfang = UserModel.build(&#123;</span><br><span class="line">        username: <span class="string">&#x27;李元芳&#x27;</span>,</span><br><span class="line">        age: <span class="number">09</span>,</span><br><span class="line">        gender: <span class="string">&#x27;men&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 修改数据</span></span><br><span class="line">    liyuanfang.set(<span class="string">&#x27;age&#x27;</span>, <span class="number">25</span>);</span><br><span class="line">    <span class="comment">// 别忘了保存</span></span><br><span class="line">    <span class="keyword">await</span> liyuanfang.save();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 查询id为2的用户数据</span></span><br><span class="line">    UserModel.findByPk(<span class="number">2</span>).then(<span class="function"><span class="params">user</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 查询到以后修改其 age 字段为 99</span></span><br><span class="line">        user.set(<span class="string">&#x27;age&#x27;</span>, <span class="number">99</span>);</span><br><span class="line">        <span class="comment">// 修改后别忘了保存</span></span><br><span class="line">        user.save();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 先查询</span></span><br><span class="line">    <span class="keyword">let</span> xiaohong = <span class="keyword">await</span> UserModel.findByPk(<span class="number">3</span>);</span><br><span class="line">    <span class="comment">// update方法相当于 set + save</span></span><br><span class="line">    <span class="keyword">await</span> xiaohong.update(&#123;</span><br><span class="line">        age: <span class="number">18</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 先查询</span></span><br><span class="line">    <span class="keyword">let</span> wangwu = <span class="keyword">await</span> UserModel.findByPk(<span class="number">4</span>);</span><br><span class="line">    <span class="comment">// 对查询到的数据进行删除</span></span><br><span class="line">    wangwu.destroy();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 查找 username 为 &#x27;李元芳&#x27; 的唯一数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findOne(&#123;</span><br><span class="line">        where: &#123;</span><br><span class="line">            username: <span class="string">&#x27;李元芳&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.dir(res);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 查找满足 age &gt; 24 的所有数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        where: &#123;</span><br><span class="line">            age: &#123;</span><br><span class="line">                [Sequelize.Op.gt]: <span class="number">24</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印出符合条件的用户的 username</span></span><br><span class="line">    <span class="built_in">console</span>.dir(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; Op &#125; = Sequelize;</span><br><span class="line">    <span class="comment">// 查找满足 age &lt; 25 或 gender = &#x27;men&#x27; 的所有数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        where: &#123;</span><br><span class="line">            [Op.or]: [</span><br><span class="line">                &#123;</span><br><span class="line">                    age: &#123;</span><br><span class="line">                        [Sequelize.Op.lt]: <span class="number">25</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    gender: <span class="string">&#x27;men&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印出符合条件的用户的 username</span></span><br><span class="line">    <span class="built_in">console</span>.dir(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 只从表中查询两条数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        limit: <span class="number">2</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 跳过前2条数据</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        offset: <span class="number">2</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 跳过前2条数据并获取3条</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        offset: <span class="number">2</span>,</span><br><span class="line">        limit: <span class="number">3</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 查询的结果按年龄高到低排序</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAll(&#123;</span><br><span class="line">        order: [</span><br><span class="line">            [<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;desc&#x27;</span>]</span><br><span class="line">        ]</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res.map(<span class="function"><span class="params">r</span> =&gt;</span> r.get(<span class="string">&#x27;username&#x27;</span>)));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 查询的结果按年龄高到低排序</span></span><br><span class="line">    <span class="keyword">let</span> count = <span class="keyword">await</span> UserModel.count();</span><br><span class="line">    <span class="built_in">console</span>.log(count);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// 查询 users 表中的前两条数据，并返回 users 表中总记录数</span></span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> UserModel.findAndCountAll(&#123;</span><br><span class="line">        limit: <span class="number">2</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h2 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h2><p>安装的 sequelize 和 mysql2 的版本为：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;mysql2&quot;</span>: <span class="string">&quot;^1.6.5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sequelize&quot;</span>: <span class="string">&quot;^5.3.1&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><ul>
<li><a href="http://docs.sequelizejs.com/">Sequelize Docs</a></li>
<li><a href="https://demopark.github.io/sequelize-docs-Zh-CN/">Sequelize Docs 中文版</a></li>
</ul>
]]></content>
      <categories>
        <category>后端</category>
        <category>SQL</category>
      </categories>
      <tags>
        <tag>Sequelize</tag>
      </tags>
  </entry>
  <entry>
    <title>基于sequelize的数据库迁移</title>
    <url>/posts/16051/</url>
    <content><![CDATA[<h2 id="数据库迁移"><a href="#数据库迁移" class="headerlink" title="数据库迁移"></a>数据库迁移</h2><p>有时候我们也希望能够跟踪数据库的更改，像 git 一样在各个不同时期的数据库状态之间进行切换。或者能通过一套工具将数据库迁移到本机，让我们在家也能进行测试开发，而不用依赖公司的测试环境。这些特性，作为今天的主角 <code>sequelize-cli</code> 都能提供给我们。</p>
<blockquote>
<p>npm链接请 <a href="https://www.npmjs.com/package/sequelize-cli">点击这里</a>。</p>
</blockquote>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>首先创建项目，项目名随意，创建完毕后cd到项目根目录，老规矩命令行 <code>npm init -y</code> 创建 <code>package.json</code> ，然后输入安装一步到位：<code>npm i sequelize mysql2 sequelize-cli</code> 。</p>
<a id="more"></a>

<p><strong>注意：</strong> <code>sequelize-cli</code> 依赖 <code>sequelize</code>，<code>sequelize</code> 依赖 <code>mysql2</code></p>
<p>安装完毕后我们可以测试下是否可用，根目录命令行输入：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize</span><br></pre></td></tr></table></figure>

<p>看见命令行输出类似下方提示代表安装成功：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sequelize [命令]</span><br><span class="line"></span><br><span class="line">命令：</span><br><span class="line">  sequelize db:migrate                        Run pending migrations</span><br><span class="line">  sequelize db:migrate:schema:timestamps:add  Update migration table to have timestamps</span><br><span class="line">  sequelize db:migrate:status                 List the status of all migrations</span><br><span class="line">  sequelize db:migrate:undo                   Reverts a migration</span><br><span class="line">  sequelize db:migrate:undo:all               Revert all migrations ran</span><br><span class="line">  sequelize db:seed                           Run specified seeder</span><br><span class="line">  sequelize db:seed:undo                      Deletes data from the database</span><br><span class="line">  sequelize db:seed:all                       Run every seeder</span><br><span class="line">  sequelize db:seed:undo:all                  Deletes data from the database</span><br><span class="line">  sequelize db:create                         Create database specified by configuration</span><br><span class="line">  sequelize db:drop                           Drop database specified by configuration</span><br><span class="line">  sequelize init                              Initializes project</span><br><span class="line">  sequelize init:config                       Initializes configuration</span><br><span class="line">  sequelize init:migrations                   Initializes migrations</span><br><span class="line">  sequelize init:models                       Initializes models</span><br><span class="line">  sequelize init:seeders                      Initializes seeders</span><br><span class="line">  sequelize migration:generate                Generates a new migration file     [aliases: migration:create]</span><br><span class="line">  sequelize model:generate                    Generates a model and its migration    [aliases: model:create]</span><br><span class="line">  sequelize seed:generate                     Generates a new seed file               [aliases: seed:create]</span><br><span class="line"></span><br><span class="line">选项：</span><br><span class="line">  --help     显示帮助信息                                                                             [布尔]</span><br><span class="line">  --version  显示版本号                                                                               [布尔]</span><br></pre></td></tr></table></figure>

<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>目前我们项目的树形结构为：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── node_modules</span><br><span class="line">├── package-lock.json</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure>

<p>接着根目录命令行输入 <code>./node_modules/.bin/sequelize init</code> 来初始化 sequelize 项目，该命令会帮我们创建如下目录：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">.</span><br><span class="line">├── config              # 包含数据库的配置文件</span><br><span class="line">├── migrations          # 包含所有迁移文件（e.g. 数据库、表的创建，字段的增加）跟数据库结构有关的操作都存放在这里</span><br><span class="line">├── models              # 包含项目中的所有模型（e.g. Users, Message）</span><br><span class="line">├── node_modules</span><br><span class="line">├── seeders             # 包含所有种子文件（e.g. 表中的数据）</span><br><span class="line">├── package-lock.json</span><br><span class="line">└── package.json</span><br></pre></td></tr></table></figure>



<h2 id="config"><a href="#config" class="headerlink" title="config"></a>config</h2><p>首先我们来看下 <code>config</code> 目录下的 <code>config.json</code> 文件。它里面包含了数据库的的基本配置，默认分为 <code>development（开发）</code> 、<code>test（测试）</code> 和 <code>production（生产）</code> 环境。当然你也可以删除或新增环境，比如新增一个在家编写代码所使用的 <code>home</code> 环境。</p>
<h3 id="db-create"><a href="#db-create" class="headerlink" title="db:create"></a>db:create</h3><p><code>sequelize-cli</code> 默认读取 <code>development</code> 模式下的数据库配置来创建数据库，所以接下来就用它来配置：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;development&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;root&quot;</span>, <span class="comment">// 数据库用户名</span></span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;root&quot;</span>, <span class="comment">// 数据库密码</span></span><br><span class="line">    <span class="string">&quot;database&quot;</span>: <span class="string">&quot;database_development&quot;</span>, <span class="comment">// 需要创建的数据库名</span></span><br><span class="line">    <span class="string">&quot;host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>, <span class="comment">// 主机</span></span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="number">8889</span>,       <span class="comment">// 端口号</span></span><br><span class="line">    <span class="string">&quot;dialect&quot;</span>: <span class="string">&quot;mysql&quot;</span>  <span class="comment">// 使用的数据库类型</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<p>配置完毕后在根目录下的命令行输入 <code>./node_modules/.bin/sequelize db:create</code><br>。当你看到如下输出就代表创建数据库成功：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Loaded configuration file &quot;config/config.json&quot;.</span><br><span class="line">Using environment &quot;development&quot;.</span><br><span class="line">Database sw_sequelize_development created.</span><br></pre></td></tr></table></figure>



<h3 id="db-drop"><a href="#db-drop" class="headerlink" title="db:drop"></a>db:drop</h3><p>能添加就能删除，我们可以键入 <code>./node_modules/.bin/sequelize db:drop</code> 命令来删除数据库。当你看到命令行输出下面内容就代表删除成功：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Loaded configuration file &quot;config/config.json&quot;.</span><br><span class="line">Using environment &quot;development&quot;.</span><br><span class="line">Database sw_sequelize_development dropped.</span><br></pre></td></tr></table></figure>



<h3 id="模式切换"><a href="#模式切换" class="headerlink" title="模式切换"></a>模式切换</h3><p>前面已经说了，<code>sequelize-cli</code> 默认读取 <code>development</code> 模式下的数据库配置。那如果我现在想切到 <code>test</code> 模式下该怎么办呢？</p>
<h4 id="变更环境变量"><a href="#变更环境变量" class="headerlink" title="变更环境变量"></a>变更环境变量</h4><p>首先得切换服务器环境变量，MacOS下（其他系统切换命令见下方链接）使用 <code>export NODE_ENV=test</code> 来切换到 <code>test</code> 模式，然后使用 <code>echo $NODE_ENV</code> 查看是否已经切换成功，接着就可以再次执行 <code>./node_modules/.bin/sequelize db:create</code> 命令，创建 <code>test</code> 模式下的数据库了：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">export</span> NODE_ENV=<span class="built_in">test</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$NODE_ENV</span></span></span><br><span class="line">test</span><br><span class="line"></span><br><span class="line">./node_modules/.bin/sequelize db:create</span><br><span class="line"></span><br><span class="line">Sequelize CLI [Node: 9.0.0, CLI: 5.4.0, ORM: 5.3.3]</span><br><span class="line"></span><br><span class="line">Loaded configuration file &quot;config/config.json&quot;.</span><br><span class="line">Using environment &quot;test&quot;.</span><br><span class="line">Database sw_sequelize_test created.</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="http://sorex.cnblogs.com/p/6200940.html">各系统下NodeJS环境变量修改</a></p>
</blockquote>
<h4 id="还原环境变量"><a href="#还原环境变量" class="headerlink" title="还原环境变量"></a>还原环境变量</h4><p>如果想回到默认的 <code>development</code> 模式，MacOS下直接键入命令 <code>export NODE_ENV=</code> 就OK啦。</p>
<h2 id="models"><a href="#models" class="headerlink" title="models"></a>models</h2><h3 id="创建模型"><a href="#创建模型" class="headerlink" title="创建模型"></a>创建模型</h3><p>我们通过 <code>model:generate</code> 或者 <code>model:create</code> 来创建模型文件，它一共需要两个参数，分别是：</p>
<ul>
<li>–name: 模型名称（必须）</li>
<li>–attributes: 字段列表（必须）</li>
</ul>
<p>回到我们的项目，在根目录执行下面命令来创建一个 User 模型文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize model:create --name User --attributes username:STRING</span><br></pre></td></tr></table></figure>

<p>执行完毕后命令行会有类似下方输出：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Sequelize CLI [Node: 9.0.0, CLI: 5.4.0, ORM: 5.3.3]</span><br><span class="line"></span><br><span class="line">New model was created at .../你的项目名/models/user.js .</span><br><span class="line">New migration was created at .../你的项目名/migrations/20190316035632-User.js</span><br></pre></td></tr></table></figure>



<p>所以 <code>model:create</code> 命令执行后帮我们创建了两个文件，一个是用来定义 User 模型的文件 user.js :</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">sequelize, DataTypes</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> User = sequelize.define(<span class="string">&#x27;User&#x27;</span>, &#123;</span><br><span class="line">    username: DataTypes.STRING</span><br><span class="line">  &#125;, &#123;&#125;);</span><br><span class="line">  User.associate = <span class="function"><span class="keyword">function</span>(<span class="params">models</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// associations can be defined here</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> User;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>一个是 <code>migrations</code> 迁移文件夹下的 <code>用来创建 User 表</code> 的文件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  up: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//   创建名为 Users 的数据表</span></span><br><span class="line">    <span class="keyword">return</span> queryInterface.createTable(<span class="string">&#x27;Users&#x27;</span>, &#123;</span><br><span class="line">      id: &#123;</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        autoIncrement: <span class="literal">true</span>,</span><br><span class="line">        primaryKey: <span class="literal">true</span>,</span><br><span class="line">        type: Sequelize.INTEGER</span><br><span class="line">      &#125;,</span><br><span class="line">      username: &#123;</span><br><span class="line">        type: Sequelize.STRING</span><br><span class="line">      &#125;,</span><br><span class="line">      createdAt: &#123;</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        type: Sequelize.DATE</span><br><span class="line">      &#125;,</span><br><span class="line">      updatedAt: &#123;</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        type: Sequelize.DATE</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  down: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> queryInterface.dropTable(<span class="string">&#x27;Users&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>其中 <code>models</code> 文件夹下文件，例如生成的 <code>user.js</code> 模型文件是给程序用的；<code>migrations</code> 和 <code>seeders</code> 文件夹下的文件是个 <code>cli</code> 用的。</p>
<p>总结下来，<code>model:create</code> 命令帮我们做了两件事情：</p>
<ul>
<li>创建 User 模型</li>
<li>创建跟模型对应的 Users 数据表文件，方便用此文件在数据库中创建 Users 表</li>
</ul>
<h2 id="migrations"><a href="#migrations" class="headerlink" title="migrations"></a>migrations</h2><p>刚刚我们已经创建了一个 User 模型和用来创建 Users 表的脚本执行文件。下面就可以开始执行迁移了。首先我们重温何为执行迁移：</p>
<blockquote>
<p>所谓迁移，就是对数据库进行结构的创建、升级（修改）等操作</p>
</blockquote>
<h3 id="执行迁移"><a href="#执行迁移" class="headerlink" title="执行迁移"></a>执行迁移</h3><h4 id="db-migrate"><a href="#db-migrate" class="headerlink" title="db:migrate"></a>db:migrate</h4><p>执行迁移的命令为 <code>db:migrate</code>，我们直接在项目根目录下运行：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize db:migrate</span><br></pre></td></tr></table></figure>

<p>（如果在此之前你运行过 db:drop 命令来删除数据库，记得再重新执行一次 db:create，否则会导致创建表失败）。执行成功的输出类似下面文字：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Sequelize CLI [Node: 9.0.0, CLI: 5.4.0, ORM: 5.3.3]</span><br><span class="line"></span><br><span class="line">Loaded configuration file &quot;config/config.json&quot;.</span><br><span class="line">Using environment &quot;development&quot;.</span><br><span class="line">== 20190316035632-create-user: migrating =======</span><br><span class="line">== 20190316035632-create-user: migrated (0.047s)</span><br></pre></td></tr></table></figure>

<p>此时刷新下你的本地数据库，就会发现之前空空如也的数据库中多了个 <code>users</code> 表和 <code>sequelizemeta</code> 表：</p>
<img src="/posts/16051/create-users.png" class="" title="create-users">

<p><code>users</code> 表被创建出来我们能理解，重点说一下这个 <code>sequelizemeta</code> 表，其实它是用来记录已经被执行过的迁移脚本的，避免我们重复执行已经执行过的脚本。</p>
<h4 id="db-migrate-status"><a href="#db-migrate-status" class="headerlink" title="db:migrate:status"></a>db:migrate:status</h4><p>我们可以通过 <code>db:migrate:status</code> 命令来查看当前迁移脚本的执行状态：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize db:migrate:status</span><br></pre></td></tr></table></figure>

<p>执行完毕后的打印结果为：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Loaded configuration file &quot;config/config.json&quot;.</span><br><span class="line">Using environment &quot;development&quot;.</span><br><span class="line">up 20190316035632-create-user.js</span><br></pre></td></tr></table></figure>

<p>这个 up ，表示我们已经执行该脚本。此时我们可以删掉 <code>sequelizemeta</code> 表中的记录，然后再次执行 <code>db:migrate:status</code> ，会发现输出的 <code>up</code> 已变为 <code>down</code> ，表示我们从未执行过该脚本。由此可知 <code>db:migrate:status</code> 会通过 <code>sequelizemeta</code> 表中的记录来判断脚本是否被执行过。而当我们已经执行过某些脚本后再次执行 <code>db:migrate</code> ，那些已经执行过的脚本就不会再次重复执行了：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Loaded configuration file &quot;config/config.json&quot;.</span><br><span class="line">Using environment &quot;development&quot;.</span><br><span class="line">No migrations were executed, database schema was already up to date.</span><br></pre></td></tr></table></figure>

<h4 id="db-migrate-undo"><a href="#db-migrate-undo" class="headerlink" title="db:migrate:undo"></a>db:migrate:undo</h4><p>除了上面的新增数据表操作，我们还可以进行撤销操作。执行 <code>./node_modules/.bin/sequelize db:migrate:status</code> 命令后 <code>sequelize-cli</code> 会帮我们撤销掉上一次（最近一次）的迁移操作，比如我们的 <code>sequelizemeta</code><br>表中记录了两条迁移操作（假设创建了 user 和 message 表）：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">20190316035632</span>-create-user.js</span><br><span class="line"><span class="number">20190316035921</span>-create-message.js</span><br></pre></td></tr></table></figure>

<p>那么执行 <code>undo</code> 后就会把最近的一次迁移，也就是 <code>*-message.js</code> 从表中移除，并且在数据库中删除 <code>message</code> 表。而这个删除操作，其实是执行了迁移文件下对应表的删除代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">down: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> queryInterface.dropTable(<span class="string">&#x27;Messages&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="db-migrate-undo-all"><a href="#db-migrate-undo-all" class="headerlink" title="db:migrate:undo:all"></a>db:migrate:undo:all</h4><p>当执行 <code>./node_modules/.bin/sequelize db:migrate:undo:all</code> 命令后，能帮我们撤销所有的迁移操作。</p>
<h4 id="db-migrate-undo-–name"><a href="#db-migrate-undo-–name" class="headerlink" title="db:migrate:undo: –name"></a>db:migrate:undo: –name</h4><p>此命令能帮我们撤销具体指定的迁移脚本，例如执行下面命令会撤销名称为 <code>20190316035632-create-user</code> 的脚本操作：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize db:migrate:undo --name 20190316035632-create-user</span><br></pre></td></tr></table></figure>



<p>执行完毕后再来刷新我们的数据库，就会发现 <code>user</code> 表已被删除，只留下了 <code>message</code> 表。</p>
<h3 id="字段添加与删除"><a href="#字段添加与删除" class="headerlink" title="字段添加与删除"></a>字段添加与删除</h3><p>随着业务的增长，我们很有可能需要扩充数据表的字段。例如我们需要给 <code>user</code> 表添加一个 <code>username</code> 字段，那么我们就可以键入以下命令来创建一个 <code>migration</code> :</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize migration:create --name UserAddAge</span><br></pre></td></tr></table></figure>

<p>执行完上述操作后我们能在 <code>migrations</code> 文件夹中看到新创建的 <code>UserAddAge</code> 文件，打开后代码如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  up: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Add altering commands here.</span></span><br><span class="line"><span class="comment">      Return a promise to correctly handle asynchronicity.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      Example:</span></span><br><span class="line"><span class="comment">      return queryInterface.createTable(&#x27;users&#x27;, &#123; id: Sequelize.INTEGER &#125;);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  down: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Add reverting commands here.</span></span><br><span class="line"><span class="comment">      Return a promise to correctly handle asynchronicity.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      Example:</span></span><br><span class="line"><span class="comment">      return queryInterface.dropTable(&#x27;users&#x27;);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>我们要做的，就是在 <code>up</code> 和 <code>down</code> 方法中填入数据库操作逻辑的代码，<code>up</code> 方法中有注释作提示，让我们返回一个类型为 <code>Promise</code> 的对象，还给出了示例。因为我们要给数据表添加字段，所以使用 <code>addColumn</code> 方法：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> queryInterface.addColumn(</span><br><span class="line">    <span class="string">&#x27;users&#x27;</span>,                        <span class="comment">// 被添加字段的表名称</span></span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>,                          <span class="comment">// 需要添加的字段名称</span></span><br><span class="line">    &#123;</span><br><span class="line">        type: Sequelize.TINYINT,</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="number">0</span>,</span><br><span class="line">    &#125;,                              <span class="comment">// 字段属性</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>这样我们就可以给 <code>user</code> 表添加上 <code>age</code> 字段了。</p>
<p>p.s. 之所以代码中填写 <code>users</code> ，是因为 <code>sequelize-cli</code> 帮我们创建表是会自动给表名称加 <code>s</code> 。</p>
<hr>
<p>能添加就能删除，删除操作我们在 <code>down</code> 方法中编写：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> queryInterface.removeColumn(</span><br><span class="line">    <span class="string">&#x27;users&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><code>UserAddAge.js</code> 文件完整代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  up: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Add altering commands here.</span></span><br><span class="line"><span class="comment">      Return a promise to correctly handle asynchronicity.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      Example:</span></span><br><span class="line"><span class="comment">      return queryInterface.createTable(&#x27;users&#x27;, &#123; id: Sequelize.INTEGER &#125;);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">return</span> queryInterface.addColumn(</span><br><span class="line">      <span class="string">&#x27;users&#x27;</span>, </span><br><span class="line">      <span class="string">&#x27;age&#x27;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        type: Sequelize.TINYINT,</span><br><span class="line">        allowNull: <span class="literal">false</span>,</span><br><span class="line">        defaultValue: <span class="number">0</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  down: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Add reverting commands here.</span></span><br><span class="line"><span class="comment">      Return a promise to correctly handle asynchronicity.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      Example:</span></span><br><span class="line"><span class="comment">      return queryInterface.dropTable(&#x27;users&#x27;);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">return</span> queryInterface.removeColumn(</span><br><span class="line">      <span class="string">&#x27;users&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;age&#x27;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>编写完毕后我们运行 <code>./node_modules/.bin/sequelize db:migrate</code> 来重新执行一遍所有迁移，刷新 <code>user</code> 表后就能看见新增字段 <code>age</code> 了。</p>
<p>最后你还可以执行 <code>./node_modules/.bin/sequelize db:migrate:undo</code> 来确认 <code>down</code> 方法正常工作，从而让 <code>user</code> 表删除刚刚添加的 <code>age</code> 字段。</p>
<p>文档参考：<a href="http://docs.sequelizejs.com/class/lib/query-interface.js~QueryInterface.html">更多 QueryInterface 操作</a></p>
<h2 id="seeders"><a href="#seeders" class="headerlink" title="seeders"></a>seeders</h2><p>除了数据库结构的添加修改删除操作以外，我们通常还会给各种表批量添加一些假数据。这个时候就要用到 seeders 里的种子文件了。比方说现在要给 <code>user</code> 表批量添加一些数据，则可以执行下面代码：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize seed:create --name userTest</span><br></pre></td></tr></table></figure>



<p>执行完毕后你会发现在 <code>seeders</code> 文件夹下多了一个类似 <code>20190316090425-userTest.js</code> 的文件。</p>
<h3 id="批量添加"><a href="#批量添加" class="headerlink" title="批量添加"></a>批量添加</h3><p>我们可以在里面编写代码让 <code>cli</code> 帮助我们批量添加数据：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  up: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Add altering commands here.</span></span><br><span class="line"><span class="comment">      Return a promise to correctly handle asynchronicity.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      Example:</span></span><br><span class="line"><span class="comment">      return queryInterface.bulkInsert(&#x27;People&#x27;, [&#123;</span></span><br><span class="line"><span class="comment">        name: &#x27;John Doe&#x27;,</span></span><br><span class="line"><span class="comment">        isBetaMember: false</span></span><br><span class="line"><span class="comment">      &#125;], &#123;&#125;);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">      <span class="keyword">return</span> queryInterface.bulkInsert(<span class="string">&#x27;users&#x27;</span>, [</span><br><span class="line">        &#123;</span><br><span class="line">          username: <span class="string">&#x27;狄仁杰&#x27;</span>,</span><br><span class="line">          age: <span class="number">56</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          username: <span class="string">&#x27;李元芳&#x27;</span>,</span><br><span class="line">          age: <span class="number">27</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  down: <span class="function">(<span class="params">queryInterface, Sequelize</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Add reverting commands here.</span></span><br><span class="line"><span class="comment">      Return a promise to correctly handle asynchronicity.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      Example:</span></span><br><span class="line"><span class="comment">      return queryInterface.bulkDelete(&#x27;People&#x27;, null, &#123;&#125;);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">return</span> queryInterface.bulkDelete(<span class="string">&#x27;users&#x27;</span>, <span class="literal">null</span>, &#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>种子文件的执行方式有两种：</p>
<ul>
<li><code>db:seed 种子文件名</code> 来运行指定种子文件</li>
<li><code>db:seed:all</code> 来运行所有种子文件</li>
</ul>
<p>知道执行方法后我们来运行下面命令：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize db:seed:all</span><br></pre></td></tr></table></figure>

<p>执行成功后刷新我们的 <code>user</code> 表，就会发现数据已经被批量添加进去了。</p>
<h3 id="批量删除"><a href="#批量删除" class="headerlink" title="批量删除"></a>批量删除</h3><p>命令行输入并执行： <code>./node_modules/.bin/sequelize db:seed:undo:all</code> 便可以批量删除刚刚添加进 <code>user</code> 表中的数据。</p>
<h3 id="记录种子数据的存储"><a href="#记录种子数据的存储" class="headerlink" title="记录种子数据的存储"></a>记录种子数据的存储</h3><p>我们知道 <code>migrations</code> 迁移是会被记录的（数据库的 <code>sequelizemeta</code> 表中），但默认情况下，种子数据的存储不会被记录下来。但官方同样提供了 <a href="http://docs.sequelizejs.com/manual/migrations.html#seed-storage">方法</a> 来记录种子数据的存储。我们可以通过在配置文件中使用 <code>seederStorage</code> 来记录存储：</p>
<h4 id="JSON记录"><a href="#JSON记录" class="headerlink" title="JSON记录"></a>JSON记录</h4><blockquote>
<p>config/config.json</p>
</blockquote>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;development&quot;: &#123;</span><br><span class="line">    ...</span><br><span class="line">    &quot;seederStorage&quot;: &quot;json&quot;, // 存储类型</span><br><span class="line">    &quot;seederStoragePath&quot;: &quot;userTestData.json&quot; // 存储路径（当前项目根目录下）</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>p.s. 上方注释在 copy 到自己项目时需要删除，否则报错。</p>
<p>接着我们执行 <code>./node_modules/.bin/sequelize db:seed:undo:all</code> 先删除数据表中数据，然后再执行 <code>./node_modules/.bin/sequelize db:seed:all</code> 重新添加一次种子数据。你就会发现项目根目录下多出来了一个叫做 <code>userTestData.json</code> 的文件，里面记录了已经执行过的种子文件名：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">  <span class="string">&quot;20190316090425-userTest.js&quot;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>



<h4 id="sequelize记录"><a href="#sequelize记录" class="headerlink" title="sequelize记录"></a>sequelize记录</h4><p>p.s. 如果你已经用上面json记录的方式记录过种子文件的存储，再想要尝试用sequelize玩一遍的话，首先得执行一遍 <code>./node_modules/.bin/sequelize db:seed:undo:all</code> 哦。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;development&quot;: &#123;</span><br><span class="line">    ...</span><br><span class="line">    &quot;seederStorage&quot;: &quot;sequelize&quot;, // 存储类型</span><br><span class="line">    &quot;seederStoragePath&quot;: &quot;userTestData.json&quot;, // 存储路径（当前项目根目录下）</span><br><span class="line">    &quot;seederStorageTableName&quot;: &quot;userTestData&quot; // 存储的表名</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>编写完上述代码后你可以执行下面命令：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./node_modules/.bin/sequelize db:seed:all</span><br></pre></td></tr></table></figure>

<p>执行完毕后刷新数据库，就能在数据库中发现 <code>userTestData</code> 表，里面记录了已经执行完毕的种子文件 <code>20190316090425-userTest.js</code></p>
<h2 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h2><p>安装的 sequelize 和 mysql2 的版本为：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;sequelize&quot;: &quot;^5.3.3&quot;,</span><br><span class="line">    &quot;sequelize-cli&quot;: &quot;^5.4.0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><ul>
<li><a href="http://docs.sequelizejs.com/class/lib/query-interface.js~QueryInterface.html">QueryInterface 操作</a></li>
</ul>
]]></content>
      <categories>
        <category>后端</category>
        <category>SQL</category>
      </categories>
      <tags>
        <tag>Sequelize</tag>
      </tags>
  </entry>
  <entry>
    <title>&lt;大话数据结构&gt;笔记</title>
    <url>/posts/51696/</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前对算法和数据结构没有一个系统的学习，从今天开始抽空啃啃书吧。就从这本程杰老师的《大话数据结构》起步。</p>
<p>p.s. 原笔记是存放在幕布上的，文字版看着不舒服可以 <a href="https://mubu.com/doc/bnO4e_64Ti">点击这里</a> 看思维导图版。</p>
<a id="more"></a>

<ul>
<li><p>数据结构绪论</p>
<ul>
<li>基本概念和术语<ul>
<li>数据<ul>
<li>定义：是描述客观事物的符号，是计算机中可以操作的对象，是能被计算机识别，并输入给计算机处理的集合符号。</li>
<li>总结：数据即符号，必备条件：<ul>
<li>可以输入到计算机中</li>
<li>能被计算机程序处理</li>
</ul>
</li>
<li>举例：<ul>
<li>MP3是声音数据</li>
<li>图片是图像数据</li>
</ul>
</li>
<li>#数据对象<ul>
<li>定义：是性质相同的数据元素的集合，是数据的子集</li>
<li>举例：<ul>
<li>人（都有姓名、生日等相同的数据项）</li>
</ul>
</li>
<li>#数据元素<ul>
<li>定义：是组成数据的、有一定意义的基本单位，在计算机中通常作为整体处理。也被成为记录。</li>
<li>举例：<ul>
<li>人类中的人</li>
<li>畜类中的牛马羊</li>
</ul>
</li>
<li>#数据项<ul>
<li>定义：一个数据元素可以由若干个数据项组成</li>
<li>举例：<ul>
<li>人的姓名、年龄、性别</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>数据结构<ul>
<li>定义：是相互之间存在一种或多种特定关系的数据元素的集合</li>
<li>#逻辑结构<ul>
<li>定义：指数据对象中数据元素之间的相互关系</li>
<li>类型<ul>
<li>#集合结构<ul>
<li>同属于一个集合的数据元素<ul>
<li><img src="/posts/51696/e754fe1c-d4ec-4359-bb69-876f4ef61bc9-3051986.jpg" class="" title="e754fe1c-d4ec-4359-bb69-876f4ef61bc9-3051986"></li>
</ul>
</li>
</ul>
</li>
<li>#线性结构<ul>
<li>数据元素之间是一对一的关系<ul>
<li><img src="/posts/51696/5a4b6a6e-dff2-4608-96bc-77a924fac8fa-3051986.jpg" class="" title="5a4b6a6e-dff2-4608-96bc-77a924fac8fa-3051986"></li>
</ul>
</li>
</ul>
</li>
<li>#树形结构<ul>
<li>数据元素之间存在一对多的层次关系<ul>
<li><img src="/posts/51696/7f8cad6a-31f2-40e8-9193-47d0e8a52b41-3051986.jpg" class="" title="7f8cad6a-31f2-40e8-9193-47d0e8a52b41-3051986"></li>
</ul>
</li>
</ul>
</li>
<li>#图形结构<ul>
<li>数据元素是多对多的关系<ul>
<li><img src="/posts/51696/c0f99e81-3222-4fe4-8575-04e5e924cd49-3051986.jpg" class="" title="c0f99e81-3222-4fe4-8575-04e5e924cd49-3051986"></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>用示意图表示数据逻辑结构时的注意点：<ul>
<li>每个数据元素是一个结点，用圆圈表示</li>
<li>元素之间的逻辑关系用连线表示，如果此关系是有方向的，那么用箭头连线表示</li>
</ul>
</li>
</ul>
</li>
<li>#物理结构<ul>
<li>定义：是指数据的逻辑结构在计算机中的存储形式</li>
<li>#顺序存储结构<ul>
<li>定义：是把数据元素存放在地址连续的存储单元里，其数据间的逻辑关系和物理关系是一致的<ul>
<li><img src="/posts/51696/b9a920bc-1728-4c8c-b0dd-c4b34c11e9e4-3051986.jpg" class="" title="b9a920bc-1728-4c8c-b0dd-c4b34c11e9e4-3051986"></li>
</ul>
</li>
</ul>
</li>
<li>#链式存储结构<ul>
<li>定义：是把数据元素存放在任意的存储单元里，这组存储单元可以使连续的，也可以是不连续的。<ul>
<li><img src="/posts/51696/0987f1e7-fdea-4404-bce6-c377ed05532d-3051986.jpg" class="" title="0987f1e7-fdea-4404-bce6-c377ed05532d-3051986"></li>
</ul>
</li>
<li>注意：数据元素的存储关系并不能反映其逻辑关系，因此需要用一个指针存放数据元素的地址，这样通过地址就可以找到相关联数据元素的位置</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>算法</p>
<ul>
<li>基本特性：输入、输出、有穷性、确定性和可行性</li>
<li>设计要求：正确性、可读性、健壮性、高效和低存储量</li>
<li>度量方法：事后统计（不科学、不准确）、事前分析估算 ✅</li>
<li>时间复杂度<ul>
<li>概念<ul>
<li>计算公式：T(n) = O(f(n))<ul>
<li>T(n)： 语句总的执行次数</li>
<li>n： 问题规模</li>
<li>f(n)： 问题规模 n 的某个函数</li>
</ul>
</li>
<li>表示随问题规模 n 的增大，算法执行时间的增长率和 f(n) 的增长率相同</li>
</ul>
</li>
<li>大O记法<ul>
<li>定义：用大写O()来体现时间复杂度，简称为大O记法</li>
<li>推导大O阶方法：<ul>
<li>\1. 用常数 1 取代运行时间中的所有加法常数</li>
<li>\2. 在修改后的运行次数函数中，只保留最高阶项</li>
<li>\3. 如果最高阶项存在且不是 1，则去除与这个项相乘的常数</li>
<li>\4. 得到的结果就是大 O 阶</li>
</ul>
</li>
</ul>
</li>
<li>常数阶<ul>
<li>举例：高斯算法<ul>
<li><img src="/posts/51696/e2affafd-97aa-4ee5-a37f-07bf1a7150d7-3051986.jpg" class="" title="e2affafd-97aa-4ee5-a37f-07bf1a7150d7-3051986"></li>
<li>此算法运行次数函数是 f(n)=3</li>
<li>推导：把常数项 3 改为 1 =&gt; 它没有最高阶 =&gt; 复杂度：O(1)</li>
</ul>
</li>
</ul>
</li>
<li>线性阶<ul>
<li><img src="/posts/51696/69be2ab0-b14f-4f40-976c-0f3ed54b2ffd-3051986.jpg" class="" title="69be2ab0-b14f-4f40-976c-0f3ed54b2ffd-3051986"></li>
<li>推导：循环体中代码需要执行 n 次 =&gt; 复杂度：O(n)</li>
</ul>
</li>
<li>对数阶<ul>
<li><img src="/posts/51696/972276a7-aeac-4f91-8337-a26f1e93dd8a-3051986.jpg" class="" title="972276a7-aeac-4f91-8337-a26f1e93dd8a-3051986"></li>
<li>推导：每次 count 乘以 2 后，就距离 n 更近一分。换句话说，有多少个 2 相乘后大于 n，则会退出循环。由 2^x=n 得到 x=log(2)n。所以此循环复杂度：O(logn)</li>
</ul>
</li>
<li>平方阶<ul>
<li>举例1<ul>
<li><img src="/posts/51696/7b6c8e16-5c79-4ef3-b066-95eace17bf19-3051986.jpg" class="" title="7b6c8e16-5c79-4ef3-b066-95eace17bf19-3051986"></li>
<li>推导：两层循环，每层循环 n 次 =&gt; 复杂度：O(n^2)</li>
<li>如果把外层 n 改为 m，则复杂度：O(m✘n)</li>
</ul>
</li>
<li>举例2<ul>
<li><img src="/posts/51696/3f60f9ca-4e93-4cf5-b69c-dbc8e189892d-3051986.jpg" class="" title="3f60f9ca-4e93-4cf5-b69c-dbc8e189892d-3051986"></li>
<li>复杂度：O(n^2)</li>
</ul>
</li>
</ul>
</li>
<li>常见时间复杂度<ul>
<li><img src="/posts/51696/f30d6524-ce51-470e-9f30-f624a72b6131-3051986.jpg" class="" title="f30d6524-ce51-470e-9f30-f624a72b6131-3051986"></li>
<li>常见时间复杂度所耗费的时间从小到大：<ul>
<li><img src="/posts/51696/621fb24b-7010-4e37-a761-0f178a4c0091-3051986.jpg" class="" title="621fb24b-7010-4e37-a761-0f178a4c0091-3051986"></li>
</ul>
</li>
<li></li>
</ul>
</li>
</ul>
</li>
<li>空间复杂度<ul>
<li>概念<ul>
<li>计算公式：S(n) = O(f(n))<ul>
<li>S(n)：计算算法所耗的存储空间</li>
<li>n： 问题规模</li>
<li>f(n)： 问题规模 n 所占存储空间的函数</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>当不用限定词地使用“复杂度”时，指的都是时间复杂度</li>
<li>心得<ul>
<li>明白算法的时间复杂度估算很重要，不要以“CPU越来越快，不用考虑算法优劣”为借口。愚公移山固然可敬，但发明炸药和推土机更加实在和聪明</li>
</ul>
</li>
</ul>
</li>
<li><p>线性表</p>
<ul>
<li>定义：零个或多个数据元素的有限序列<ul>
<li>关键点：<ul>
<li>是一个<em>有顺序</em>的序列</li>
<li>若元素存在多个，则第一个无前驱，最后一个无后继，中间部分都有且只有一个前驱和后继</li>
<li>线性表是有限的</li>
</ul>
</li>
</ul>
</li>
<li>举例：<ul>
<li>幼儿园小朋友按次序排队，各自都知道他前面人是谁，方便清点人数，知道谁不在</li>
<li>一年的星座列表</li>
</ul>
</li>
<li>顺序存储结构<ul>
<li>定义：用一段地址连续的存储单元一次存储线性表的数据元素<ul>
<li><img src="/posts/51696/0da7720c-5c75-4a5c-ad5a-1323aa7dc388-3051986.jpg" class="" title="0da7720c-5c75-4a5c-ad5a-1323aa7dc388-3051986"></li>
</ul>
</li>
<li>三个重要属性：<ul>
<li>存储空间的起始位置</li>
<li>线性表的最大存储容量</li>
<li>线性表的当前长度</li>
</ul>
</li>
<li>数据长度与线性表长度区别<ul>
<li>数据长度：（例如一个数组的长度）是存放线性表的存储空间的长度，一般不变</li>
<li>线性表长度：是线性表中数据元素的个数，随着插入与删除，这个量是可变的</li>
<li>在任意时刻，线性表长度应该 小于等于 数据长度</li>
</ul>
</li>
<li>时间复杂度：<ul>
<li>插入或删除最后一个元素为 O(1)</li>
<li>插入或删除第一个元素为O(n)</li>
</ul>
</li>
<li>优缺点<ul>
<li>优点：<ul>
<li>无需为了表示表中元素之间的逻辑关系而增加额外的存储空间</li>
<li>可以快速地存取表中任意位置的元素</li>
</ul>
</li>
<li>缺点：<ul>
<li>插入和删除操作需要移动大量元素</li>
<li>当线性表长度变化较大时，难以确定存储空间的容量</li>
<li>造成存储空间的“碎片”</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>链式存储结构<ul>
<li>定义：是把数据元素存放在任意的存储单元里，这组存储单元可以使连续的，也可以是不连续的。<ul>
<li><img src="/posts/51696/90e595e5-f1a5-4c67-a6e3-d27a59d629b6-3051986.jpg" class="" title="90e595e5-f1a5-4c67-a6e3-d27a59d629b6-3051986"></li>
</ul>
</li>
<li>与顺序结构不同，在链式结构中，除了要存储数据信息外，还要存储它后继元素的存储地址</li>
<li>单链表<ul>
<li>定义：一个链式结构的，每个结点中只包含一个指针域的链表叫做单链表<ul>
<li><img src="/posts/51696/43f9bf59-0141-4902-80b2-1ee623ce6bc9-3051986.jpg" class="" title="43f9bf59-0141-4902-80b2-1ee623ce6bc9-3051986"></li>
</ul>
</li>
<li>单链表结构与顺序存储结构的优缺点<ul>
<li>对比：<ul>
<li>存储分配方式：<ul>
<li>顺序存储结构用一段连续的存储单元依次存储线性表的数据元素</li>
<li>单链表采用链式存储结构，用一组任意的存储单元存放线性表的元素</li>
</ul>
</li>
<li>时间性能：<ul>
<li>查找：<ul>
<li>顺序存储结构 O(1)</li>
<li>单链表 O(n)</li>
</ul>
</li>
<li>插入与删除：<ul>
<li>顺序存储结构需要移动表长一半的元素，时间为 O(n)</li>
<li>单链表在找出某位置的指针后，插入和删除时间仅为 O(1)</li>
</ul>
</li>
<li>空间性能：<ul>
<li>顺序存储结构需要预分配存储空间，分大了浪费，分小了容易溢出</li>
<li>单链表不需要分配存储空间，只要有就可以分配，元素个数也不受限制</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>结论：<ul>
<li>若线性表需要频繁查找，很少进行插入和删除操作，宜采用顺序存储结构</li>
<li>若需要频繁插入和删除，宜采用单链表结构</li>
<li>当线性表中的元素个数变化较大或根本不知道多大时，宜采用单链表结构，这样不用考虑存储空间的大小问题。</li>
<li>若事先知道大致长度，比如一年12个月，一周7天，宜采用顺序存储结构</li>
</ul>
</li>
<li>实际应用：<ul>
<li>用户注册的个人信息，除了注册时插入数据外，绝大多数情况都是读取，所以宜采用顺序存储结构</li>
<li>游戏中玩家的武器装备列表，随着游戏推进，玩家可能随时增加或删除，所以宜采用单链表结构</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>静态链表<ul>
<li>背景：有些编程高级语言（e.g. Basic, Fortran）没有指针，这样链表结构就没法实现。</li>
<li>解决方案：用数组来代替指针，来描述单链表</li>
<li>实现：让数组元素都由两个数据域组成，data和cur。data用来存储数据元素，cur（游标）相当于单链表中的next指针，存放该元素的后继在数组中的下标。</li>
<li>定义：这种用数组描述的链表叫做静态链表。这种描述方法起名为游标实现法。<ul>
<li><img src="/posts/51696/bcbf36b2-6c2b-49a8-a3bc-08ecb8935a01-3051986.jpg" class="" title="bcbf36b2-6c2b-49a8-a3bc-08ecb8935a01-3051986"></li>
</ul>
</li>
<li>举例：<ul>
<li>将 “甲乙丙丁戊己庚”存入静态链表：<ul>
<li><img src="/posts/51696/60412d31-4595-4bee-a252-ccdcac7e333a-3051986.jpg" class="" title="60412d31-4595-4bee-a252-ccdcac7e333a-3051986"></li>
</ul>
</li>
<li>优缺点：<ul>
<li>优点：<ul>
<li>再插入和删除操作时，只需要修改游标，不需要移动元素，从而改进了在顺序存储结构中的插入和删除操作需要移动大量元素的缺点。</li>
</ul>
</li>
<li>缺点：<ul>
<li>没有解决连续存储分配带来的表长难以确定的问题</li>
<li>失去了顺序存储结构随机存储的特性</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>循环链表<ul>
<li>定义：将单链表中终端节点的指针端由空指针改为指向头结点，就使整个单链表形成一个环，这种头尾相接的单链表称为单循环链表，简称循环链表。</li>
</ul>
</li>
<li>双向链表<ul>
<li>定义：双向链表是在单链表的每个结点中，再设置一个指向其前驱结点的指针域。所以在双向链表中的结点都有两个指针域，一个指向直接后继，另一个指向直接前驱。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>栈与队列</p>
<ul>
<li><p>栈</p>
<ul>
<li>定义：栈是限定仅在表尾进行插入和删除操作的线性表</li>
<li>描述：我们把允许插入和删除的一端称为栈顶，另一端称为栈底，不含任何数据元素的栈称为空栈。栈又称为后进先出（Last In First Out）的线性表，简称 LIFO 结构。</li>
<li>举例：浏览器的前进后退，Photoshop 的前进撤销。</li>
<li>栈的顺序存储结构<ul>
<li>操作：<ul>
<li>栈的插入操作（push 压），叫作进栈，也称压栈、入栈。类似子弹入弹夹。<ul>
<li><img src="/posts/51696/8f921c05-7deb-4104-96cb-f293de081246-3051986.jpg" class="" title="8f921c05-7deb-4104-96cb-f293de081246-3051986"></li>
</ul>
</li>
<li>栈的删除操作（pop 弹），叫作出栈，也称弹栈。类似子弹出夹。<ul>
<li><img src="/posts/51696/6e22676a-6c14-446d-b330-2c459da99634-3051986.jpg" class="" title="6e22676a-6c14-446d-b330-2c459da99634-3051986"></li>
</ul>
</li>
</ul>
</li>
<li>两栈共享空间<ul>
<li>理解：两个相同类型的栈，为它们各自开辟了数组空间，极有可能第一个栈满，再进栈就溢出了，而另一个栈还有很多存储空间空闲。所以我们完全可以用一个数组来存储两个栈。<ul>
<li><img src="/posts/51696/55e0d735-25b7-4c18-8a8f-624eaa16cd8d-3051986.jpg" class="" title="55e0d735-25b7-4c18-8a8f-624eaa16cd8d-3051986"></li>
</ul>
</li>
<li>做法：数组的两个端点，让一个栈的栈底为数组的始端（下标0），另一个栈为栈的末端（n-1）。两栈如果增加元素，就是两端向中间延伸。</li>
<li>关键思路：<ul>
<li>\1. 两个top是数组两端的栈顶指针，只要它俩不见面，两个栈就都可以一直使用。</li>
<li>\2. 栈1为空时，就是top1等于-1时；当top2等于n时，即是栈2为空时。</li>
<li>\3. 何时栈满：top1等于n-1时栈1满；top2等于0时，栈2满，所以推导出，top1+1==top2为栈满</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>栈的链式存储结构<ul>
<li>栈顶存放位置：<ul>
<li>由于单链表有头指针，而栈顶指针也是必须的，所以把它俩合二为一，将栈顶放在单链表的头部。</li>
</ul>
</li>
<li>不需要头结点：<ul>
<li>都已经有了栈顶在头部，所以单链表的头结点也失去了意义，所以不需要头结点。</li>
</ul>
</li>
<li>示意图：<ul>
<li><img src="/posts/51696/aa59ece6-46d3-42de-8ccf-302713f41f0a-3051986.jpg" class="" title="aa59ece6-46d3-42de-8ccf-302713f41f0a-3051986"></li>
</ul>
</li>
</ul>
</li>
<li>栈的应用<ul>
<li>#递归</li>
<li>#四则运算表达式求值</li>
</ul>
</li>
</ul>
</li>
<li><p>队列</p>
<ul>
<li><p>定义：队列是只允许在一端进行插入操作、而在另一端进行删除操作的线性表</p>
</li>
<li><p>描述：队列是一种先进先出（First In First Out）的线性表，简称 FIFO。允许插入的一端称为队尾，允许删除的一端称为队头。</p>
</li>
<li><p>举例：键盘的输入，记事本上的输出。</p>
</li>
<li><p>队列的顺序存储结构</p>
<ul>
<li><p>缺点：</p>
<ul>
<li><p>由于从队头出，导致后面元素都得向前移动，时间复杂度 O(n)</p>
<img src="/posts/51696/ce01c75c-c53a-49c7-b4b4-0e2fb3e4bfa6-3051986.jpg" class="" title="ce01c75c-c53a-49c7-b4b4-0e2fb3e4bfa6-3051986">
</li>
</ul>
</li>
<li><p>解决：</p>
<ul>
<li>循环队列<ul>
<li>让头尾相接</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>队列的链式存储结构</p>
</li>
<li><p>顺序存储和链式存储的选择</p>
<ul>
<li>可以确定队列长度最大值时，建议循环队列</li>
<li>无法预估队列长度时，使用链队列</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>串</p>
<ul>
<li>定义：是由零个或多个字符组成的有限序列，又名字符串</li>
<li>算法<ul>
<li>朴素的模式匹配算法<ul>
<li>从头开始依次往后比较【不推荐】</li>
</ul>
</li>
<li>KMP模式匹配算法</li>
</ul>
</li>
</ul>
</li>
<li><p>数</p>
<ul>
<li><p>定义：</p>
<ul>
<li>树是 n(n&gt;=0) 个结点的有限集。n=0 时称为空树。在任意一棵非空树中：<ul>
<li>\1. 有且仅有一个特定的称为根（Root）的结点</li>
<li>\2. 当 n &gt; 1 时，其余结点可分为 m(m &gt; 0) 个互不相交的有限集 T1、T2 … 、Tm，其中每一个集合本身又是一棵树，并且称为根的子树（SubTree）</li>
</ul>
</li>
<li><img src="/posts/51696/aea04c1e-15b7-4692-8504-7d049e7ea05e-3051986.jpg" class="" title="aea04c1e-15b7-4692-8504-7d049e7ea05e-3051986">
</li>
</ul>
</li>
<li><p>结点分类</p>
<ul>
<li>定义：结点拥有的子树数称为结点的度。度为 0 的结点称为叶结点或终端结点；度不为 0 的结点称为非终端结点或分支结点。除根结点外，分支结点也称为内部结点。树的度是树内各结点的度的最大值。下面树结点的度的最大值是结点 D 的度，为 3，所以树的度也为 3 。<ul>
<li><img src="/posts/51696/e31ad7c9-0003-435a-bf98-3c7c03764720-3051986.jpg" class="" title="e31ad7c9-0003-435a-bf98-3c7c03764720-3051986">
</li>
</ul>
</li>
</ul>
</li>
<li><p>结点间关系</p>
<ul>
<li><img src="/posts/51696/63d4fff0-5e45-428e-a32c-14b972b93e2b-3051986.jpg" class="" title="63d4fff0-5e45-428e-a32c-14b972b93e2b-3051986">
</li>
</ul>
</li>
<li><p>树的其他相关概念</p>
<ul>
<li><p>结点的层次</p>
<ul>
<li><p>从根开始定义起，根为第一层。</p>
<ul>
<li><p>树中结点的最大层次称为树的深度或高度，下图树深度为 4</p>
<img src="/posts/51696/5fd0623d-6956-447b-9125-48a3eaf0a977-3051986.jpg" class="" title="5fd0623d-6956-447b-9125-48a3eaf0a977-3051986">
</li>
</ul>
</li>
</ul>
</li>
<li><p>树与线性表结构的对比</p>
<ul>
<li><img src="/posts/51696/a277b277-b5ef-4306-b89b-477e49fa9bf7-3051986.jpg" class="" title="a277b277-b5ef-4306-b89b-477e49fa9bf7-3051986">
</li>
</ul>
</li>
<li><p>阿萨德</p>
</li>
</ul>
</li>
<li><p>二叉树</p>
<ul>
<li><p>定义：二叉树是 n(n&gt;=0)个结点的有限集合，该集合或为空集（称为空二叉树），或由一个根节点和两棵互不相交的、分别称为根节点的左子树和右子树的二叉树组成。</p>
<ul>
<li><img src="/posts/51696/1d2f3500-70e1-4aed-adbb-4007c27125af-3051986.jpg" class="" title="1d2f3500-70e1-4aed-adbb-4007c27125af-3051986">
</li>
</ul>
</li>
<li><p>特点：</p>
<ul>
<li>每个结点最多有两棵子树</li>
<li>左子树和右子树是有顺序的，次序不能任意颠倒</li>
<li>即使树中某结点只有一棵树，也要区分左右子树</li>
</ul>
</li>
<li><p>特殊二叉树</p>
<ul>
<li><p>#斜树</p>
<ul>
<li>定义：<ul>
<li>所有结点都在左子树的二叉树叫左斜树<ul>
<li><img src="/posts/51696/34668592-d9a6-4e01-b13c-1eec6b8fca42-3051986.jpg" class="" title="34668592-d9a6-4e01-b13c-1eec6b8fca42-3051986"></li>
</ul>
</li>
<li>所有结点都在右子树的二叉树叫右斜树<ul>
<li><img src="/posts/51696/3e52b0f5-6d81-43bd-8e35-33b203ccd3af-3051986.jpg" class="" title="3e52b0f5-6d81-43bd-8e35-33b203ccd3af-3051986"></li>
</ul>
</li>
</ul>
</li>
<li>这种特殊树和线性表结构一样，所以线性表结构可以理解为是树的一种特殊形式</li>
</ul>
</li>
<li><p>#满二叉树</p>
<ul>
<li><img src="/posts/51696/e13bdddf-2d7b-4f94-b17f-b539f7200efa-3051986.jpg" class="" title="e13bdddf-2d7b-4f94-b17f-b539f7200efa-3051986">
</li>
</ul>
</li>
<li><p>#完全二叉树</p>
<ul>
<li><p>定义：对一棵具有 n 个结点的二叉树按层序编号，如果编号为 i (i &lt;= i &lt;= n) 的结点与同样深度的满二叉树中编号为 i 的结点在二叉树中的位置完全相同，则这课二叉树称为完全二叉树。</p>
<ul>
<li><img src="/posts/51696/d0842d6b-122e-48c2-91f1-9ce55d73028e-3051986.jpg" class="" title="d0842d6b-122e-48c2-91f1-9ce55d73028e-3051986">
</li>
</ul>
</li>
<li><p>如何判定：在看树时，心中默默给每个结点按照满<em>二叉树</em>的结构<em>逐层顺序</em>编号，如果编号出现空挡，就说明不是完全二叉树，否则就是。</p>
<ul>
<li><p>下面几个都不是：</p>
<ul>
<li><p>9跟11之间有空挡</p>
<img src="/posts/51696/d055bd00-8c52-4da4-983e-baf9c1d65abe-3051986.jpg" class="" title="d055bd00-8c52-4da4-983e-baf9c1d65abe-3051986">
</li>
<li><p>5跟8，9之间有空挡</p>
<img src="/posts/51696/821f0e91-4700-495e-a657-a372965a7027-3051986.jpg" class="" title="821f0e91-4700-495e-a657-a372965a7027-3051986">
</li>
<li><p>9跟12之间有空挡</p>
<img src="/posts/51696/130be6af-5ac2-403e-a196-60a3534664eb-3051986.jpg" class="" title="130be6af-5ac2-403e-a196-60a3534664eb-3051986">
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>存储结构</p>
<ul>
<li>二叉树顺序存储结构（适用于完全二叉树）</li>
<li>二叉链表</li>
</ul>
</li>
<li><p>遍历二叉树</p>
<ul>
<li><p>#二叉树遍历方法</p>
<ul>
<li><p>前序遍历</p>
<ul>
<li><p>遍历顺序：ABDGHCEIF</p>
<img src="/posts/51696/bcef9e8a-1e6a-4f9e-97ac-d0aa5d29d6ce-3051986.jpg" class="" title="bcef9e8a-1e6a-4f9e-97ac-d0aa5d29d6ce-3051986">
</li>
</ul>
</li>
<li><p>中序遍历</p>
<ul>
<li><p>遍历顺序：GDHBAEICF</p>
<img src="/posts/51696/53c8f72e-58fb-4c13-8ee6-110c000a497c-3051986.jpg" class="" title="53c8f72e-58fb-4c13-8ee6-110c000a497c-3051986">
</li>
</ul>
</li>
<li><p>后序遍历</p>
<ul>
<li><p>遍历顺序：GHDBIEFCA</p>
<img src="/posts/51696/76154ad4-d5f9-4db5-a8f7-06c0e36b29de-3051986.jpg" class="" title="76154ad4-d5f9-4db5-a8f7-06c0e36b29de-3051986">
</li>
</ul>
</li>
<li><p>层序遍历</p>
<ul>
<li><p>遍历顺序：ABCDEFGHI</p>
<img src="/posts/51696/ca020d5e-541d-47d2-b72f-fdaf25b5fba1-3051986.jpg" class="" title="ca020d5e-541d-47d2-b72f-fdaf25b5fba1-3051986">
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>图</p>
</li>
</ul>
]]></content>
      <categories>
        <category>后端</category>
        <category>算法</category>
      </categories>
  </entry>
  <entry>
    <title>如何使用webpack4</title>
    <url>/posts/47462/</url>
    <content><![CDATA[<h2 id="为什么要使用-webpack"><a href="#为什么要使用-webpack" class="headerlink" title="为什么要使用 webpack"></a>为什么要使用 webpack</h2><h3 id="网页中引用的常见静态资源"><a href="#网页中引用的常见静态资源" class="headerlink" title="网页中引用的常见静态资源"></a>网页中引用的常见静态资源</h3><table>
<thead>
<tr>
<th align="left">类型</th>
<th align="left">静态资源</th>
</tr>
</thead>
<tbody><tr>
<td align="left">JS</td>
<td align="left">.js .jsx .coffee .ts（TypeScript 类 C# 语言）</td>
</tr>
<tr>
<td align="left">CSS</td>
<td align="left">.css .less .sass .scss</td>
</tr>
<tr>
<td align="left">Images</td>
<td align="left">.jpg .png .gif .bmp .svg</td>
</tr>
<tr>
<td align="left">字体文件（Fonts）</td>
<td align="left">.svg .ttf .eot .woff .woff2</td>
</tr>
<tr>
<td align="left">模板文件</td>
<td align="left">.ejs .jade .vue【这是在webpack中定义组件的方式，推荐这么用】</td>
</tr>
</tbody></table>
<a id="more"></a>

<h3 id="引入过多静态资源有什么问题？"><a href="#引入过多静态资源有什么问题？" class="headerlink" title="引入过多静态资源有什么问题？"></a>引入过多静态资源有什么问题？</h3><ol>
<li>网页加载速度慢， 因此我们要发起很多的二次请求</li>
<li>还要处理错综复杂的依赖关系</li>
</ol>
<h3 id="如何解决上述两个问题"><a href="#如何解决上述两个问题" class="headerlink" title="如何解决上述两个问题"></a>如何解决上述两个问题</h3><ol>
<li>合并、压缩、精灵图、图片的 Base64 编码</li>
<li>可以使用 requireJS、也可以使用 webpack 来解决各个包之间的复杂依赖关系</li>
</ol>
<h3 id="如何完美实现上述的2种解决方案"><a href="#如何完美实现上述的2种解决方案" class="headerlink" title="如何完美实现上述的2种解决方案"></a>如何完美实现上述的2种解决方案</h3><ol>
<li>使用 Gulp， 基于 task 任务</li>
<li>使用 webpack， 基于整个项目进行构建<ul>
<li>借助于 webpack 这个前端自动化构建工具，可以完美实现资源的合并、打包、压缩、混淆等诸多功能</li>
</ul>
</li>
</ol>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>webpack 是基于 Node.js 开发出来的一个前端项目打包工具。</p>
<h2 id="安装-amp-初步使用"><a href="#安装-amp-初步使用" class="headerlink" title="安装 &amp; 初步使用"></a>安装 &amp; 初步使用</h2><ol>
<li><p>如果第一次安装，需要全局安装 『 webpack &amp;&amp; webpack-cli 』:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -g webpack webpack-cli</span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化项目</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建文件夹</span></span><br><span class="line">mkdir webpack4-demo</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入</span></span><br><span class="line">cd webpack4-demo</span><br><span class="line"><span class="meta">#</span><span class="bash"> 初始化</span></span><br><span class="line">npm init -y</span><br></pre></td></tr></table></figure>
</li>
<li><p>以下面的目录结构创建文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">├── package.json</span><br><span class="line">└── src</span><br><span class="line">    ├── css</span><br><span class="line">    │   └── index.css</span><br><span class="line">    ├── images</span><br><span class="line">    │   └── temp.png</span><br><span class="line">    ├── index.html</span><br><span class="line">    ├── js</span><br><span class="line">    │   ├── a.js</span><br><span class="line">    │   ├── b.js</span><br><span class="line">    │   └── index.js</span><br><span class="line">    └── main.js</span><br></pre></td></tr></table></figure>

<blockquote>
<p>index.css</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">   <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">2px</span> <span class="number">2px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">31</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">0.05</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>index.html</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>js/a.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> b <span class="keyword">from</span> <span class="string">&#x27;./b&#x27;</span></span><br><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">&#x27;jquery&#x27;</span></span><br><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">   <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;我是 a 模块，现在被初始化了&quot;</span>)</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="function"><span class="title">binit</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      b.init()</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> a</span><br></pre></td></tr></table></figure>

<blockquote>
<p>js/b.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> b = &#123;</span><br><span class="line">   <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;我是 b 模块，现在被初始化了&quot;</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> b</span><br></pre></td></tr></table></figure>

<blockquote>
<p>js/index.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">&#x27;jquery&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> index = &#123;</span><br><span class="line">   <span class="comment">// init后执行隔行变色的代码</span></span><br><span class="line">   <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="comment">// 设置偶数行背景色，索引从0开始，0是偶数</span></span><br><span class="line">      $(<span class="string">&#x27;#list li:even&#x27;</span>).css(<span class="string">&#x27;backgroundColor&#x27;</span>, <span class="string">&#x27;lightblue&#x27;</span>)</span><br><span class="line">      <span class="comment">// 设置奇数行背景色</span></span><br><span class="line">      $(<span class="string">&#x27;#list li:odd&#x27;</span>).css(<span class="string">&#x27;backgroundColor&#x27;</span>, <span class="string">&#x27;pink&#x27;</span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> index</span><br></pre></td></tr></table></figure>

<blockquote>
<p>main.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> a <span class="keyword">from</span> <span class="string">&#x27;./js/a&#x27;</span></span><br><span class="line"><span class="keyword">import</span> b <span class="keyword">from</span> <span class="string">&#x27;./js/b&#x27;</span></span><br><span class="line"><span class="keyword">import</span> index <span class="keyword">from</span> <span class="string">&#x27;./js/index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./css/index.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> main = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">&#x27;入口函数 main 被调用了&#x27;</span>)</span><br><span class="line">   a.init()</span><br><span class="line">   a.binit()</span><br><span class="line">   b.init()</span><br><span class="line">   index.init()</span><br><span class="line">&#125;</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
</li>
<li><p>项目根文件夹下执行命令 <code>npm i webpack webpack-cli -D</code></p>
</li>
<li><p>使用 <code>npm i jquery</code> 安装 jQuery 类库</p>
</li>
<li><p>直接在页面上引用 <code>main.js</code> 会报错，因为浏览器不认识 <code>import $ from &#39;jquery&#39;</code> 这种JS语法，需要使用 webpack 进行处理，webpack 默认会把这种高级的语法转换为低级的浏览器能识别的语法：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 直接引入会报错 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>webpack 入口文件路径 模式</code> 运行 <code>main.js</code> 入口文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">webpack src/main.js --mode development # 开发环境</span><br><span class="line">或者</span><br><span class="line">webpack src/main.js --mode production  # 生产环境</span><br></pre></td></tr></table></figure>
</li>
<li><p>不过每次都要输入这个命令，非常麻烦，我们可以在<code>package.json</code>的<code>scripts</code>中加入两个指令成员：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">   &quot;dev&quot;: &quot;webpack src/main.js --mode development&quot;,</span><br><span class="line">   &quot;build&quot;: &quot;webpack src/main.js --mode production&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>以后只需要在命令行执行 <code>npm run dev</code> 便相当于执行 <code>webpack --mode development</code> ，执行 <code>npm run build</code> 便相当于执行 <code>webpack --mode production</code>。</p>
</li>
</ol>
<h2 id="使用配置文件简化打包命令"><a href="#使用配置文件简化打包命令" class="headerlink" title="使用配置文件简化打包命令"></a>使用配置文件简化打包命令</h2><ol>
<li><p>在项目根目录中创建 <code>webpack.config.js</code></p>
</li>
<li><p>由于运行 webpack 命令的时候，webpack 需要指定入口文件和输出文件的路径，所以我们需要在 <code>webpack.config.js</code> 中配置这两个路径：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入处理路径的模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出一个配置对象，将来 webpack 在启动的时候，</span></span><br><span class="line"><span class="comment">// 会默认来查找 webpack.config.js ，</span></span><br><span class="line"><span class="comment">// 并读取这个文件中导出的配置对象，来进行打包处理</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">   <span class="comment">// 配置入口文件，表示要使用 webpack 打包哪个文件</span></span><br><span class="line">   <span class="comment">// 若不配置 webpack 将自动查找 src 目录下的 index.js 文件</span></span><br><span class="line">   entry: &#123;</span><br><span class="line">      main: path.join(__dirname, <span class="string">&#x27;./src/main.js&#x27;</span>)</span><br><span class="line">   &#125;,</span><br><span class="line">   output: &#123;</span><br><span class="line">      filename: <span class="string">&quot;[name].bundle.[hash].js&quot;</span>, <span class="comment">//输出文件名，[name]表示入口文件js名，[hash]会在后面生成随机hash值</span></span><br><span class="line">      path: path.join(__dirname, <span class="string">&quot;./dist&quot;</span>) <span class="comment">//输出文件路径</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>由于此时已经配置了入口文件，<code>package.json</code> 中的脚本命令就可简化为：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;dev&quot;: &quot;webpack --mode development&quot;,</span><br><span class="line">&quot;build&quot;: &quot;webpack --mode production&quot;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="实现-webpack-实时打包构建"><a href="#实现-webpack-实时打包构建" class="headerlink" title="实现 webpack 实时打包构建"></a>实现 webpack 实时打包构建</h2><p>webpack 提供了一个可选的本地开发服务器，这个本地服务器基于 node.js 构建，它是一个单独的插件，叫做 <code>webpack-dev-server</code> ，在 webpack 中进行配置之前需要单独安装它作为项目依赖。</p>
<p>devServer 作为 webpack 配置选项中的一项，以下是它的一些配置选项:</p>
<ul>
<li><code>contentBase</code> ：设置服务器所读取文件的目录，当前我们设置为”./dist”</li>
<li><code>port</code> ：设置端口号，如果省略，默认为<code>8080</code></li>
<li><code>inline</code> ：设置为<code>true</code>，当源文件改变时会自动刷新页面</li>
<li><code>historyApiFallback</code> ：设置为<code>true</code>，所有的跳转将指向<code>index.html</code></li>
</ul>
<ol>
<li><p>由于每次重新修改代码之后，都需要手动运行 webpack 打包的命令，比较麻烦，所以使用 <code>webpack-dev-server</code> 来实现代码实时打包编译，当修改代码之后，会自动进行打包构建。</p>
</li>
<li><p>运行 <code>npm i webpack-dev-server -D</code> 安装到开发依赖</p>
</li>
<li><p>安装完成之后，修改之前在 <code>package.json</code> 中添加的 dev 指令：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;dev&quot;: &quot;webpack-dev-server --mode development&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行指令 <code>npm run dev</code> ，发现可以进行实时打包，但是 dist 目录下并没有生成 <code>main.bundle.js</code> 文件，这是因为 <code>webpack-dev-server</code> 将打包好的文件放在了内存中。</p>
<ul>
<li><p>把 <code>bundle.js</code> 放在内存中的好处是：由于需要实时打包编译，所以放在内存中速度会非常快</p>
</li>
<li><p>这个时候访问 webpack-dev-server 启动的 <code>http://localhost:8080/</code> 网站，发现是一个文件夹的面板，需要点击到 src 目录下，才能打开我们的 index 首页，此时引用不到 <code>main.bundle.js</code> 文件，需要修改 index.html 中 script 的 src 属性为:<code>&lt;script src=&quot;../main.bundle.js&quot;&gt;&lt;/script&gt;</code></p>
</li>
<li><p>为了能在访问 <code>http://localhost:8080/</code> 的时候直接访问到 index 首页，可以使用 <code>--contentBase src</code> 指令来修改dev指令，指定启动的根目录：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;dev&quot;: &quot;webpack-dev-server --mode development --contentBase src&quot;,</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ol>
<h2 id="插件（Plugins）"><a href="#插件（Plugins）" class="headerlink" title="插件（Plugins）"></a>插件（Plugins）</h2><p>插件（Plugins）是用来拓展 webpack 功能的，它们会在整个构建过程中生效，执行相关的任务。<br>Loaders 和 Plugins 常常被弄混，但是它们其实是完全不同的东西，可以这么来说，loaders 是在打包构建过程中用来处理源文件的（JSX，Scss，Less..），一次处理一个，插件并不直接操作单个文件，它直接对整个构建过程其作用。</p>
<h3 id="使用-html-webpack-plugin-插件配置启动页面"><a href="#使用-html-webpack-plugin-插件配置启动页面" class="headerlink" title="使用 html-webpack-plugin 插件配置启动页面"></a>使用 <code>html-webpack-plugin</code> 插件配置启动页面</h3><p>由于使用 <code>--contentBase</code> 指令的过程比较繁琐，需要指定启动的目录，同时还需要修改 index.html 中 script 标签的 src 属性，所以推荐使用 <code>html-webpack-plugin</code> 插件配置启动页面。</p>
<ol>
<li><p>运行 <code>npm i html-webpack-plugin -D</code> 安装到开发依赖</p>
</li>
<li><p>修改 <code>webpack.config.js</code> 配置文件如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入处理路径的模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入自动生成HTMl文件的插件</span></span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出一个配置对象，将来 webpack 在启动的时候，</span></span><br><span class="line"><span class="comment">// 会默认来查找 webpack.config.js ，</span></span><br><span class="line"><span class="comment">// 并读取这个文件中导出的配置对象，来进行打包处理</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// 配置入口文件，表示要使用 webpack 打包哪个文件</span></span><br><span class="line">    <span class="comment">// 若不配置 webpack 将自动查找 src 目录下的 index.js 文件</span></span><br><span class="line">    entry: &#123;</span><br><span class="line">        main: path.join(__dirname, <span class="string">&#x27;./src/main.js&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">&quot;[name].bundle.js&quot;</span>, <span class="comment">//输出文件名，[name]表示入口文件js名</span></span><br><span class="line">        path: path.join(__dirname, <span class="string">&quot;./dist&quot;</span>) <span class="comment">//输出文件路径</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [ <span class="comment">// 添加plugins节点配置插件</span></span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            template: path.join(__dirname, <span class="string">&#x27;./src/index.html&#x27;</span>), <span class="comment">//模板路径</span></span><br><span class="line">            filename: <span class="string">&#x27;index.html&#x27;</span>, <span class="comment">//自动生成的HTML文件的名称</span></span><br><span class="line">            minify: &#123; <span class="comment">// 压缩HTML文件</span></span><br><span class="line">               removeComments: <span class="literal">true</span>, <span class="comment">// 移除HTML中的注释</span></span><br><span class="line">               collapseWhitespace: <span class="literal">true</span>, <span class="comment">// 删除空白符与换行符</span></span><br><span class="line">               minifyCSS: <span class="literal">true</span> <span class="comment">// 压缩内联css</span></span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>撤销 <code>package.json</code> 中 <code>script</code> 节点中的 dev 指令为：<br><code>dev&quot;: &quot;webpack-dev-server --mode development&quot;</code></p>
</li>
<li><p>将 index.html 中 script 标签注释掉，因为 <code>html-webpack-plugin</code> 插件会自动把 main.bundle.js 注入到 index.html 页面中。</p>
</li>
</ol>
<h3 id="实现自动打开浏览器、热更新和配置浏览器的默认端口号"><a href="#实现自动打开浏览器、热更新和配置浏览器的默认端口号" class="headerlink" title="实现自动打开浏览器、热更新和配置浏览器的默认端口号"></a>实现自动打开浏览器、热更新和配置浏览器的默认端口号</h3><h4 id="方式1："><a href="#方式1：" class="headerlink" title="方式1："></a>方式1：</h4><p>修改 <code>package.json</code> 的 script 节点如下，其中 <code>--open</code> 表示自动打开浏览器， <code>--port 4321</code> 表示打开的端口号为 4321 ，<code>--hot</code> 表示启用浏览器热更新：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;dev&quot;: &quot;webpack-dev-server --open --port 4321 --hot  --mode development&quot;,</span><br></pre></td></tr></table></figure>

<h4 id="方式2：-个人推荐"><a href="#方式2：-个人推荐" class="headerlink" title="方式2：(个人推荐)"></a>方式2：(个人推荐)</h4><ol>
<li><p>修改 <code>webpack.config.js</code> 文件，新增 <code>devServer</code> 节点如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">     inline: <span class="literal">true</span>, <span class="comment">//打包后加入一个 websocket 客户端</span></span><br><span class="line">     hot: <span class="literal">true</span>, <span class="comment">// 启用热更新 的 第1步</span></span><br><span class="line">     open: <span class="literal">true</span>, <span class="comment">// 自动打开浏览器</span></span><br><span class="line">     contentBase: path.resolve(__dirname, <span class="string">&#x27;dist&#x27;</span>), <span class="comment">// 指定托管的根目录，不注释的话，无法访问 src 以外的资源，比如 node_modules</span></span><br><span class="line">     host: <span class="string">&#x27;localhost&#x27;</span>, <span class="comment">// 主机地址</span></span><br><span class="line">     port: <span class="number">4321</span>, <span class="comment">// 设置启动时候的运行端口</span></span><br><span class="line">     compress: <span class="literal">true</span> <span class="comment">// 开发服务器是否启动gzip等压缩</span></span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>在头部引入 <code>webpack</code> 模块：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 启用热更新的 第2步</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 <code>plugins</code> 节点下新增：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 启用热更新的第 3 步</span></span><br><span class="line"><span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="Loaders"><a href="#Loaders" class="headerlink" title="Loaders"></a>Loaders</h2><p>loaders 是 webpack 最强大的功能之一，通过不同的 loader ，webpack 有能力调用外部的脚本或工具，实现对不同格式的文件的处理，例如把 <code>scss</code> 转为 <code>css</code> ，将 ES6 、ES7 等语法转化为当前浏览器能识别的语法，将 JSX 转化为 js 等多项功能。</p>
<p>loaders 需要单独安装并且需要在 <code>webpack.config.js</code> 中的 <code>modules</code> 配置项下进行配置，Loaders的配置包括以下几方面：</p>
<ul>
<li><code>test</code>：一个用以匹配 loaders 所处理文件的拓展名的正则表达式（必须）</li>
<li><code>loader</code>：loader的名称（必须）</li>
<li><code>include/exclude</code>：手动添加必须处理的文件（文件夹）或屏蔽不需要处理的文件（文件夹）（可选）；</li>
<li><code>options</code>：为loaders提供额外的设置选项（可选）</li>
</ul>
<h3 id="打包-css-文件"><a href="#打包-css-文件" class="headerlink" title="打包 css 文件"></a>打包 css 文件</h3><ol>
<li><p>运行<code>npm i style-loader css-loader --D</code></p>
</li>
<li><p>修改 <code>webpack.config.js</code> 这个配置文件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line">    rules: [ <span class="comment">// 文件的匹配规则</span></span><br><span class="line">        &#123;</span><br><span class="line">            test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">            use: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">        &#125; <span class="comment">//处理css文件的规则</span></span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>注意：<code>use</code> 表示使用哪些模块来处理 <code>test</code> 所匹配到的文件；<code>use</code> 中相关 loader 模块的调用顺序是从后向前调用的。</p>
</li>
</ol>
<h3 id="打包-less-文件"><a href="#打包-less-文件" class="headerlink" title="打包 less 文件"></a>打包 less 文件</h3><ol>
<li><p>如果你习惯使用 less ，可以执行命令 <code>npm i less-loader less -D</code> 来安装 less-loader 。</p>
</li>
<li><p>修改 <code>webpack.config.js</code> 配置文件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">    use: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;less-loader&#x27;</span>]</span><br><span class="line">&#125;, <span class="comment">//配置处理 .less 文件的第三方 loader 规则</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="打包-sass-文件"><a href="#打包-sass-文件" class="headerlink" title="打包 sass 文件"></a>打包 sass 文件</h3><ol>
<li><p>例如我平常习惯用 scss，所以会安装 sass-loader ：执行命令 <code>npm i sass-loader node-sass --D</code></p>
</li>
<li><p>在 <code>webpack.config.js</code> 中添加处理 sass 文件的 loader 模块：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   test: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">   use: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>, <span class="string">&#x27;sass-loader&#x27;</span>]</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 配置处理 .scss 文件的 第三方 loader 规则（npm i sass-loader后还需要 npm i node-sass，否则编译报错）</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="处理-css-中的图片路径"><a href="#处理-css-中的图片路径" class="headerlink" title="处理 css 中的图片路径"></a>处理 css 中的图片路径</h3><blockquote>
<p>预备工作：</p>
<ol>
<li>在 src/css/index.css 文件中给 body 添加：background-image: url(“../images/temp.png”);</li>
<li>此时保存会编译报错，因为 webpack 无法处理 css 中的路径（此案例中为——图片资源）</li>
</ol>
</blockquote>
<ol>
<li><p>运行 <code>npm i url-loader file-loader --D</code></p>
</li>
<li><p>在 <code>webpack.config.js</code> 中添加处理 url 路径的 loader 模块：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.(jpg|png|bmp|gif|jpeg)$/</span>,</span><br><span class="line">    use:[&#123;</span><br><span class="line">       loader:<span class="string">&#x27;url-loader&#x27;</span>,</span><br><span class="line">       options:&#123;</span><br><span class="line">          outputPath:<span class="string">&#x27;images/&#x27;</span>,<span class="comment">//输出到images文件夹</span></span><br><span class="line">          <span class="comment">//是把小于500B的文件打成 Base64 的格式，写入JS</span></span><br><span class="line">          <span class="comment">// 如果不小于，url-loader 就会使用 file-loader 处理图片</span></span><br><span class="line">          <span class="comment">// 所以必须安装file-loader</span></span><br><span class="line">          limit:<span class="number">500</span></span><br><span class="line">       &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;, <span class="comment">// 配置图片路径</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="处理-Bootstrap-字体的加载"><a href="#处理-Bootstrap-字体的加载" class="headerlink" title="处理 Bootstrap 字体的加载"></a>处理 Bootstrap 字体的加载</h3><p>**重要(更新)**：webpack4后的 bootstrap 字体加载已经不能使用下面该方法，如何使用可以参考这篇博客：<a href="https://blog.csdn.net/hyt941026/article/details/82870466">webpack 4.X版本的简单使用(处理js/css/less/scss/url(图片)/字体文件)</a></p>
<blockquote>
<p>预备工作：</p>
<p>index.html 写入</p>
<p>来展示字体图片</p>
<p>main.js 导入 import ‘bootstrap/dist/css/bootstrap.css’</p>
<p>此时报错</p>
</blockquote>
<p>在 <code>webpack.config.js</code> 中添加处理字体文件的 loader 模块：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.(ttf|eot|svg|woff|woff2)$/</span>,</span><br><span class="line">    use: <span class="string">&#x27;url-loader&#x27;</span></span><br><span class="line">&#125;, <span class="comment">// 处理 字体文件的 loader</span></span><br></pre></td></tr></table></figure>

<h3 id="提取css文件（插件！）"><a href="#提取css文件（插件！）" class="headerlink" title="提取css文件（插件！）"></a>提取css文件（插件！）</h3><p>先安装 mini-css-extract-plugin 包：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install mini-css-extract-plugin -D</span><br></pre></td></tr></table></figure>

<p>然后在 <code>webpack.config.js</code> 中修改对css文件处理的配置：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 提取css</span></span><br><span class="line"><span class="keyword">var</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">&quot;mini-css-extract-plugin&quot;</span>)</span><br><span class="line"></span><br><span class="line">rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">            process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span> ? <span class="string">&#x27;style-loader&#x27;</span> : MiniCssExtractPlugin.loader,</span><br><span class="line">            <span class="string">&#x27;css-loader&#x27;</span>] <span class="comment">//处理css</span></span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">]</span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">        filename: <span class="string">&#x27;style.css&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="添加浏览器css前缀"><a href="#添加浏览器css前缀" class="headerlink" title="添加浏览器css前缀"></a>添加浏览器css前缀</h3><p>首先下载 loader ：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i postcss-loader autoprefixer -D</span><br></pre></td></tr></table></figure>

<p>然后根目录添加 <code>postcss.config.js</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: &#123;</span><br><span class="line">        <span class="string">&#x27;autoprefixer&#x27;</span>: &#123;</span><br><span class="line">            browsers: <span class="string">&#x27;last 5 version&#x27;</span> <span class="comment">// 代表意思为每个主流浏览器的最后5个版本</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后在 <code>webpack.config.js</code> 中添加配置：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">            process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span> ? <span class="string">&#x27;style-loader&#x27;</span> : MiniCssExtractPlugin.loader,</span><br><span class="line">            &#123;</span><br><span class="line">                loader: <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    importLoaders: <span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;postcss-loader&quot;</span></span><br><span class="line">        ] <span class="comment">//处理css</span></span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="使用-babel-处理高级-JS-语法"><a href="#使用-babel-处理高级-JS-语法" class="headerlink" title="使用 babel 处理高级 JS 语法"></a>使用 babel 处理高级 JS 语法</h3><ol>
<li><p>在 main.js 文件中添加 ES6 代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// class 关键字，是ES6中提供的新语法，是用来 实现 ES6 中面向对象编程的方式</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 使用 static 关键字，可以定义静态属性</span></span><br><span class="line">    <span class="comment">// 所谓的静态属性，就是 可以直接通过 类名， 直接访问的属性</span></span><br><span class="line">    <span class="comment">// 实例属性： 只能通过类的实例，来访问的属性，叫做实例属性</span></span><br><span class="line">    <span class="keyword">static</span> info = &#123;</span><br><span class="line">        name: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">        age: <span class="number">20</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问 Person 类身上的  info 静态属性</span></span><br><span class="line"><span class="built_in">console</span>.log(Person.info)</span><br><span class="line"><span class="comment">// 在 webpack 中，默认只能处理 一部分 ES6 的新语法，一些更高级的ES6语法或者 ES7 语法，webpack 是处理不了的；这时候，就需要 借助于第三方的 loader，来帮助webpack 处理这些高级的语法，当第三方loader 把 高级语法转为 低级的语法之后，会把结果交给 webpack 去打包到 bundle.js 中</span></span><br><span class="line"><span class="comment">// 通过 Babel ，可以帮我们将 高级的语法转换为 低级的语法</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>运行如下两套命令，安装两套包，去安装 Babel 相关的loader功能：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// 【相当于转换工具】</span><br><span class="line">npm i -D @babel/core babel-loader @babel/plugin-transform-runtime @babel/runtime @babel/plugin-proposal-class-properties</span><br><span class="line">// 【相当于字典】</span><br><span class="line">npm i -D @babel/preset-env</span><br><span class="line"></span><br><span class="line">// =====&gt; 「转换工具」根据「字典」将 es6 转换</span><br></pre></td></tr></table></figure>
</li>
<li><p>打开 webpack 的配置文件，在 module 节点下的 rules 数组中，添加一个新的匹配规则：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    use: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">    exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">&#125; <span class="comment">// 配置 Babel 来转换高级的ES语法</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.2</p>
<p>注意： 在配置 babel 的 loader 规则的时候，必须 把 node_modules 目录，通过 exclude 选项排除掉：原因有俩：</p>
<p>2.2.1</p>
<p>如果 不排除 node_modules， 则Babel 会把 node_modules 中所有的 第三方 JS 文件，都打包编译，这样，会非常消耗CPU，同时，打包速度非常慢；</p>
<p>2.2.2</p>
<p>哪怕，最终，Babel 把 所有 node_modules 中的JS转换完毕了，但是，项目也无法正常运行！</p>
</blockquote>
</li>
<li><p>在项目的根目录中，新建一个叫做 <code>.babelrc</code> 的 Babel 配置文件，这个配置文件，属于 JSON 格式，所以，在写 <code>.babelrc</code> 配置的时候，必须符合 JSON 语法规范： 不能写注释，字符串必须用双引号：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;presets&quot;</span>: [</span><br><span class="line">        [<span class="string">&quot;@babel/preset-env&quot;</span>, &#123;</span><br><span class="line">            <span class="string">&quot;modules&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">&quot;targets&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;browsers&quot;</span>: [<span class="string">&quot;&gt; 1%&quot;</span>, <span class="string">&quot;last 2 versions&quot;</span>, <span class="string">&quot;not ie &lt;= 8&quot;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;useBuiltIns&quot;</span>: <span class="string">&quot;usage&quot;</span></span><br><span class="line">        &#125;]</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;plugins&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;@babel/plugin-transform-runtime&quot;</span>,</span><br><span class="line">        <span class="string">&quot;@babel/plugin-proposal-class-properties&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="webpack-config-js配置遇到Error-Cannot-find-module-‘-babel-core’问题"><a href="#webpack-config-js配置遇到Error-Cannot-find-module-‘-babel-core’问题" class="headerlink" title="webpack.config.js配置遇到Error: Cannot find module ‘@babel/core’问题"></a><a href="https://www.cnblogs.com/soyxiaobi/p/9554565.html">webpack.config.js配置遇到Error: Cannot find module ‘@babel/core’问题</a></h4><blockquote>
<p><strong>官方默认babel-loader | babel 对应的版本需要一致: 即babel-loader需要搭配最新版本babel</strong></p>
</blockquote>
<p>两种解决方案:</p>
<ol>
<li>回退低版本</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -D babel-loader@7 babel-core babel-preset-env</span><br></pre></td></tr></table></figure>

<ol>
<li>更新到最高版本:</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -D babel-loader @babel/core @babel/preset-env webpack</span><br></pre></td></tr></table></figure>

<h2 id="压缩和优化css文件"><a href="#压缩和优化css文件" class="headerlink" title="压缩和优化css文件"></a>压缩和优化css文件</h2><p>下载 <code>optimize-css-assets-webpack-plugin</code> 插件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i optimize-css-assets-webpack-plugin -D</span><br></pre></td></tr></table></figure>

<p>在 <code>webpack.config.js</code> 中引入插件并添加配置：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 压缩css</span></span><br><span class="line"><span class="keyword">const</span> OptimizeCssAssetsPlugin = <span class="built_in">require</span>(<span class="string">&#x27;optimize-css-assets-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> OptimizeCssAssetsPlugin(&#123;</span><br><span class="line">        assetNameRegExp: <span class="regexp">/\.css$/g</span>, <span class="comment">//一个正则表达式，指示应优化/最小化的资产的名称。提供的正则表达式针对配置中ExtractTextPlugin实例导出的文件的文件名运行，而不是源CSS文件的文件名。默认为/\.css$/g</span></span><br><span class="line">        cssProcessor: <span class="built_in">require</span>(<span class="string">&#x27;cssnano&#x27;</span>), <span class="comment">//用于优化\最小化CSS的CSS处理器，默认为cssnano</span></span><br><span class="line">        cssProcessorOptions: &#123;</span><br><span class="line">            safe: <span class="literal">true</span>,</span><br><span class="line">            discardComments: &#123;</span><br><span class="line">                removeAll: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="comment">//传递给cssProcessor的选项，默认为&#123;&#125;</span></span><br><span class="line">        canPrint: <span class="literal">true</span> <span class="comment">//一个布尔值，指示插件是否可以将消息打印到控制台，默认为true</span></span><br><span class="line">    &#125;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h2 id="压缩和优化js文件"><a href="#压缩和优化js文件" class="headerlink" title="压缩和优化js文件"></a>压缩和优化js文件</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">yarn add webpack-parallel-uglify-plugin -D</span><br><span class="line"><span class="keyword">const</span> WebpackParallelUglifyPlugin = <span class="built_in">require</span>(<span class="string">&#x27;webpack-parallel-uglify-plugin&#x27;</span>)</span><br><span class="line">plugins: [</span><br><span class="line"><span class="keyword">new</span> WebpackParallelUglifyPlugin(&#123;</span><br><span class="line">      uglifyJS: &#123;</span><br><span class="line">        output: &#123;</span><br><span class="line">          beautify: <span class="literal">false</span>, <span class="comment">//不需要格式化</span></span><br><span class="line">          comments: <span class="literal">false</span> <span class="comment">//不保留注释</span></span><br><span class="line">        &#125;,</span><br><span class="line">        compress: &#123;</span><br><span class="line">          warnings: <span class="literal">false</span>, <span class="comment">// 在UglifyJs删除没有用到的代码时不输出警告</span></span><br><span class="line">          drop_console: <span class="literal">true</span>, <span class="comment">// 删除所有的 `console` 语句，可以兼容ie浏览器</span></span><br><span class="line">          collapse_vars: <span class="literal">true</span>, <span class="comment">// 内嵌定义了但是只用到一次的变量</span></span><br><span class="line">          reduce_vars: <span class="literal">true</span> <span class="comment">// 提取出出现多次但是没有定义成变量去引用的静态值</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h2 id="提取公共文件"><a href="#提取公共文件" class="headerlink" title="提取公共文件"></a>提取公共文件</h2><p>我们可看到 <code>src/js/a.js</code> 和 <code>src/main.js</code> 都引入了 <code>src/js/b.js</code> 文件，为什么要提取公共代码，简单来说，就是减少代码冗余，提高加载速度。和之前的 webpack 配置不一样：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//之前配置</span></span><br><span class="line"><span class="comment">// new webpack.optimize.SplitChunksPlugin(&#123;</span></span><br><span class="line"><span class="comment">//     name: &#x27;common&#x27;, // 如果还要提取公共代码,在新建一个实例</span></span><br><span class="line"><span class="comment">//     minChunks: 2, //重复两次之后就提取出来</span></span><br><span class="line"><span class="comment">//     chunks: [&#x27;index&#x27;, &#x27;a&#x27;] // 指定提取范围</span></span><br><span class="line"><span class="comment">// &#125;),</span></span><br><span class="line"><span class="comment">//现在配置</span></span><br><span class="line">optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">        cacheGroups: &#123;</span><br><span class="line">            commons: &#123;  <span class="comment">// 抽离自己写的公共代码</span></span><br><span class="line">                chunks: <span class="string">&quot;initial&quot;</span>,</span><br><span class="line">                name: <span class="string">&quot;common&quot;</span>, <span class="comment">// 打包后的文件名，任意命名</span></span><br><span class="line">                minChunks: <span class="number">2</span>,<span class="comment">//最小引用2次</span></span><br><span class="line">                minSize: <span class="number">0</span> <span class="comment">// 只要超出0字节就生成一个新包</span></span><br><span class="line">            &#125;,</span><br><span class="line">            vendor: &#123;   <span class="comment">// 抽离第三方插件</span></span><br><span class="line">                test: <span class="regexp">/node_modules/</span>,   <span class="comment">// 指定是node_modules下的第三方包</span></span><br><span class="line">                chunks: <span class="string">&#x27;initial&#x27;</span>,</span><br><span class="line">                name: <span class="string">&#x27;vendor&#x27;</span>,  <span class="comment">// 打包后的文件名，任意命名</span></span><br><span class="line">                <span class="comment">// 设置优先级，防止和自定义的公共代码提取时被覆盖，不进行打包</span></span><br><span class="line">                priority: <span class="number">10</span></span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="Source-Maps-调试配置"><a href="#Source-Maps-调试配置" class="headerlink" title="Source Maps 调试配置"></a>Source Maps 调试配置</h2><p>作为开发，代码调试当然少不了，那么问题来了，经过打包后的文件，你是不容易找到出错的地方的，<code>Source Map</code>就是用来解决这个问题的。</p>
<p>通过如下配置，我们会在打包时生成对应于打包文件的 <code>.map</code> 文件，使得编译后的代码可读性更高，更易于调试。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    devtool: <span class="string">&#x27;source-map&#x27;</span> <span class="comment">// 会生成对于调试的完整的.map文件，但同时也会减慢打包速度</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置好后，我们再次运行 <code>npm run build</code> 进行打包，这时我们会发现在 <code>dist</code> 文件夹中多出了一个 <code>bundle.js.map</code></p>
<p>如果我们的代码有 bug ，在浏览器的调试工具中会提示错误出现的位置，这就是 <code>devtool: &#39;source-map&#39;</code> 配置项的作用。</p>
<h2 id="开发环境-VS-生产环境"><a href="#开发环境-VS-生产环境" class="headerlink" title="开发环境 VS 生产环境"></a>开发环境 VS 生产环境</h2><h3 id="npm-run-dev"><a href="#npm-run-dev" class="headerlink" title="npm run dev"></a>npm run dev</h3><p><strong>npm run dev</strong> 是我们开发环境下打包的文件，当然由于 devServer 帮我们把文件放到内存中了，所以并不会输出打包后的 dist 文件夹。</p>
<h3 id="npm-run-build"><a href="#npm-run-build" class="headerlink" title="npm run build"></a>npm run build</h3><p>通过 <strong>npm run build</strong> 之后会生成一个dist目录文件夹，里面有我们打包后的文件。</p>
<h2 id="清理-dist文件夹-CleanwebpackPlugin"><a href="#清理-dist文件夹-CleanwebpackPlugin" class="headerlink" title="清理/dist文件夹(CleanwebpackPlugin)"></a>清理<code>/dist</code>文件夹(CleanwebpackPlugin)</h2><p>你可能已经注意到，在我们删掉 <code>/dist</code> 文件夹之前，由于前面的代码示例遗留，导致我们的 <code>/dist</code> 文件夹比较杂乱。<code>webpack</code> 会生成文件，然后将这些文件放置在 <code>/dist</code> 文件夹中，但是 <code>webpack</code> 无法追踪到哪些文件是实际在项目中用到的。</p>
<p>通常，在每次构建前清理 <code>/dist</code> 文件夹，是比较推荐的做法，因此只会生成用到的文件，这时候就用到 <code>CleanWebpackPlugin</code> 插件了。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm i clean-webpack-plugin -D</span><br><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> CleanWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;clean-webpack-plugin&#x27;</span>); <span class="comment">// 引入CleanWebpackPlugin插件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    ...</span><br><span class="line">    plugins: [</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin(),  <span class="comment">// 以前括号里面要传入数组([dist])来指定要删除的目录，新版 CleanWebpackPlugin 不需要传任何参数了</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>插件的使用方法都是一样的，首先引入，然后new一个实例，实例可传入参数。</p>
<p>现在我们运行 <code>npm run build</code> 后就会发现，webpack 会先将 <code>/dist</code> 文件夹删除，然后再生产新的 <code>/dist</code> 文件夹。</p>
<h2 id="webpack4-x-相关资源"><a href="#webpack4-x-相关资源" class="headerlink" title="webpack4.x 相关资源"></a>webpack4.x 相关资源</h2><ul>
<li><strong><a href="https://www.cnblogs.com/BetterMan-/p/9867642.html">webpack4.x最详细入门讲解</a></strong></li>
<li><a href="https://segmentfault.com/a/1190000018866232">从基础到实战 手摸手带你掌握新版Webpack4.0详解 教你看文档</a></li>
</ul>
<h2 id="webpack3-与-webpack4-使用差异"><a href="#webpack3-与-webpack4-使用差异" class="headerlink" title="webpack3 与 webpack4 使用差异"></a>webpack3 与 webpack4 使用差异</h2><ul>
<li><a href="https://blog.csdn.net/u012443286/article/details/79504289">webpack4.x开发环境配置</a></li>
</ul>
]]></content>
      <categories>
        <category>前端</category>
        <category>构建工具</category>
      </categories>
      <tags>
        <tag>Webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>阿里云云服务器ECS购买与使用（笔记）</title>
    <url>/posts/40394/</url>
    <content><![CDATA[<h2 id="购买"><a href="#购买" class="headerlink" title="购买"></a>购买</h2><p>进入阿里云下拉菜单选择 ecs ：</p>
<img src="/posts/40394/ecs_config.png" class="" title="ecs_config">

<p>我购买的配置如下：</p>
<img src="/posts/40394/ecs_config.png" class="" title="ecs_config">

<p>购买后实例就运行了，远程连接后安装一系列包和软件：</p>
<h2 id="如何安装"><a href="#如何安装" class="headerlink" title="如何安装"></a>如何安装</h2><p><a href="https://www.cnblogs.com/87hbteo/p/7802104.html">阿里云服务器 ECS LAMP 环境安装（Ubuntu）</a><br><a href="https://blog.csdn.net/KascLiyuan/article/details/73438093">阿里云 ECS 云服务器外网 IP 无法访问</a></p>
<h2 id="域名解析"><a href="#域名解析" class="headerlink" title="域名解析"></a>域名解析</h2><p><a href="https://jingyan.baidu.com/article/48b558e3f25e6d7f38c09aec.html">阿里云如何解析域名</a></p>
<a id="more"></a>

<h2 id="Github-Page-自定义域名"><a href="#Github-Page-自定义域名" class="headerlink" title="Github Page 自定义域名"></a>Github Page 自定义域名</h2><ul>
<li><a href="https://www.jianshu.com/p/8ac6c7c037c5">创建 Github Page 并设置自定义域名</a></li>
<li><a href="http://wiki.jikexueyuan.com/project/github-pages-basics/cname-file.html">添加 CNAME 文件到你的存储库中</a></li>
</ul>
<h2 id="Ubuntu-安装-nodejs"><a href="#Ubuntu-安装-nodejs" class="headerlink" title="Ubuntu 安装 nodejs"></a>Ubuntu 安装 nodejs</h2><ul>
<li><a href="https://evestorm.github.io/posts/58410/%E9%98%BF%E9%87%8C%E4%BA%91Ubuntu%E6%90%AD%E5%BB%BANodeJs%E7%8E%AF%E5%A2%83">https://blog.5udou.cn/blog/A-Li-Yun-UbuntuDa-Jian-NodeJsHuan-Jing-75</a></li>
</ul>
<h2 id="ubuntu-图形界面下无法用-root-登录解决办法"><a href="#ubuntu-图形界面下无法用-root-登录解决办法" class="headerlink" title="ubuntu 图形界面下无法用 root 登录解决办法"></a>ubuntu 图形界面下无法用 root 登录解决办法</h2><p>先按照 <a href="https://www.linuxidc.com/Linux/2017-01/139094.htm">这个教程</a> 走，但最后不重启。然后转到 <a href="https://blog.csdn.net/qq_39591507/article/details/81288644">这个教程</a>，执行第三步，也就是下面这段：</p>
<blockquote>
<p>进入/etc/pam.d 文件夹下，修改 gdm-autologin 和 gdm-passwd 文件内容(首先修改文件权限，参考步骤 2 的操作)</p>
<p>gdm-autologin 文件注释掉 auth required pam_success_if.so user!=root quiet_success 这一行</p>
<p>gdm-passwd 文件注释掉 auth required pam_success_if.so user!=root quiet_success 这一行</p>
</blockquote>
<p>做完后重启然后点击登录其他用户，输入 root 和密码 root（这个密码在上面第一个教程中已经自己设置了）就好。</p>
<h2 id="安装-LAMP-环境"><a href="#安装-LAMP-环境" class="headerlink" title="安装 LAMP 环境"></a>安装 LAMP 环境</h2><p><a href="https://blog.csdn.net/qq_27366789/article/details/81990291">在 ubuntu16.04 中一键创建 LAMP 环境</a></p>
<h3 id="编辑文件"><a href="#编辑文件" class="headerlink" title="编辑文件"></a>编辑文件</h3><ul>
<li>退出 mysql 命令行：<code>exit</code></li>
<li>vi 编辑文件 按下 i 表示编辑 按下 esc 退出编辑模式 按下 <code>:wq</code> 保存退出</li>
</ul>
<h3 id="mysql-操作"><a href="#mysql-操作" class="headerlink" title="mysql 操作"></a>mysql 操作</h3><p>登录 mysql -u root -p</p>
<p>-u 表示选择登陆的用户名， -p 表示登陆的用户密码，现在是 mysql 数据库是没有密码的，Enter password:处直接回车，就能够进入 mysql 数据库。</p>
<h4 id="导入导出"><a href="#导入导出" class="headerlink" title="导入导出"></a>导入导出</h4><p><a href="https://blog.csdn.net/hewenjing8168/article/details/80821447">ubuntu 下 mysql 数据库的导入导出</a></p>
<h2 id="安装-图形化-mysql-workbench"><a href="#安装-图形化-mysql-workbench" class="headerlink" title="安装 图形化 mysql-workbench"></a>安装 图形化 mysql-workbench</h2><p><a href="https://blog.csdn.net/qq_37638061/article/details/80246799">安装 mysql 服务，及安装图形化管理界面</a></p>
<h2 id="打开-mysql-图形化后无法连接数据库"><a href="#打开-mysql-图形化后无法连接数据库" class="headerlink" title="打开 mysql 图形化后无法连接数据库"></a>打开 mysql 图形化后无法连接数据库</h2><p><a href="https://blog.csdn.net/chexiansheng/article/details/89193955">Unbuntu 下 Mysql 连接 MysqlWorkBench 出现错误</a></p>
<h2 id="在-ubuntu-下搭建-ftp-服务器"><a href="#在-ubuntu-下搭建-ftp-服务器" class="headerlink" title="在 ubuntu 下搭建 ftp 服务器"></a>在 ubuntu 下搭建 ftp 服务器</h2><ul>
<li><a href="https://www.howtoing.com/how-to-set-up-vsftpd-for-a-user-s-directory-on-ubuntu-18-04">如何在 Ubuntu 18.04 上为用户目录设置 vsftpd</a><br>执行完上面操作后，会发现下面两个问题，按方法调整就好：</li>
<li><a href="https://blog.51cto.com/zhkao/1758125">使用 FileZilla FTP 下载时提示“不安全的服务器，不支持 FTPover TLS”,和“服务器不支持非 ASCII 字符”</a></li>
<li><a href="https://blog.csdn.net/wbryfl/article/details/82729189">ftp 连接错误——服务器发回了不可路由的地址。使用服务器地址代替。</a></li>
</ul>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>FTP 是文件传输协议的缩写，是一种曾经广泛用于在客户端和服务器之间移动文件的网络协议。 它已被更快，更安全，更方便的文件传输方式所取代。 许多休闲互联网用户希望通过<code>https</code>直接从他们的网络浏览器下载，命令行用户更有可能使用安全协议，如<code>scp</code>或<a href="https://www.howtoing.com/how-to-use-sftp-to-securely-transfer-files-with-a-remote-server/">SFTP</a> 。</p>
<p>FTP 仍然用于支持具有特定需求的遗留应用程序和工作流。 如果您可以选择使用哪种协议，请考虑探索更现代的选项。 但是，当您确实需要 FTP 时，vsftpd 是一个很好的选择。 vsftpd 针对安全性，性能和稳定性进行了优化，可以很好地防范其他 FTP 服务器中存在的许多安全问题，并且是许多 Linux 发行版的默认设置。</p>
<p>在本教程中，您将配置 vsftpd 以允许用户使用具有 SSL / TLS 保护的登录凭据的 FTP 将文件上载到其主目录。</p>
<h3 id="先决条件"><a href="#先决条件" class="headerlink" title="先决条件"></a>先决条件</h3><p>要学习本教程，您需要：</p>
<ul>
<li><strong>Ubuntu 18.04 服务器和具有 sudo 权限的非 root 用户</strong> ：您可以在<a href="https://www.howtoing.com/initial-server-setup-with-ubuntu-18-04/">使用 Ubuntu 18.04</a>指南的<a href="https://www.howtoing.com/initial-server-setup-with-ubuntu-18-04/">初始服务器设置中</a>了解有关如何使用这些权限设置用户的更多信息。</li>
</ul>
<h3 id="第-1-步-安装-vsftpd"><a href="#第-1-步-安装-vsftpd" class="headerlink" title="第 1 步 - 安装 vsftpd"></a>第 1 步 - 安装 vsftpd</h3><p>让我们首先更新我们的包列表并安装<code>vsftpd</code>守护进程：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install vsftpd</span><br></pre></td></tr></table></figure>

<p>安装完成后，让我们复制配置文件，这样我们就可以从空白配置开始，将原件保存为备份：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.orig</span><br></pre></td></tr></table></figure>

<p>通过备份配置，我们已准备好配置防火墙。</p>
<h3 id="第-2-步-打开防火墙"><a href="#第-2-步-打开防火墙" class="headerlink" title="第 2 步 - 打开防火墙"></a>第 2 步 - 打开防火墙</h3><p><strong>注意：</strong> 最后我们还得打开 80 和 8080 端口！！！</p>
<p>让我们检查防火墙状态以查看它是否已启用。 如果是，我们将确保允许 FTP 流量，因此防火墙规则不会阻止我们的测试。</p>
<p>检查防火墙状态：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ufw status</span><br></pre></td></tr></table></figure>

<p>在这种情况下，只允许 SSH 通过：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">OutputStatus: active</span><br><span class="line"></span><br><span class="line">To                         Action      From</span><br><span class="line">--                         ------      ----</span><br><span class="line">OpenSSH                    ALLOW       Anywhere</span><br><span class="line">OpenSSH (v6)               ALLOW       Anywhere (v6)</span><br></pre></td></tr></table></figure>

<p>您可能有其他规则或根本没有防火墙规则。 由于在这种情况下只允许 SSH 流量，因此我们需要为 FTP 流量添加规则。</p>
<p>让我们打开端口<code>20</code>和<code>21</code>用于 FTP，端口<code>990</code>用于启用 TLS，端口<code>40000-50000</code>用于我们计划在配置文件中设置的被动端口范围：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ufw allow 20/tcp</span><br><span class="line">sudo ufw allow 21/tcp</span><br><span class="line">sudo ufw allow 990/tcp</span><br><span class="line">sudo ufw allow 40000:50000/tcp</span><br><span class="line">sudo ufw status</span><br></pre></td></tr></table></figure>

<p>我们的防火墙规则现在应如下所示：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">OutputStatus: active</span><br><span class="line"></span><br><span class="line">To                         Action      From</span><br><span class="line">--                         ------      ----</span><br><span class="line">OpenSSH                    ALLOW       Anywhere</span><br><span class="line">990/tcp                    ALLOW       Anywhere</span><br><span class="line">20/tcp                     ALLOW       Anywhere</span><br><span class="line">21/tcp                     ALLOW       Anywhere</span><br><span class="line">40000:50000/tcp            ALLOW       Anywhere</span><br><span class="line">OpenSSH (v6)               ALLOW       Anywhere (v6)</span><br><span class="line">20/tcp (v6)                ALLOW       Anywhere (v6)</span><br><span class="line">21/tcp (v6)                ALLOW       Anywhere (v6)</span><br><span class="line">990/tcp (v6)               ALLOW       Anywhere (v6)</span><br><span class="line">40000:50000/tcp (v6)       ALLOW       Anywhere (v6)</span><br></pre></td></tr></table></figure>

<p>p.s. 如何删除一个 rule：<code>sudo ufw delete allow 80/tcp</code></p>
<p>安装了<code>vsftpd</code>并打开了必要的端口后，我们继续创建一个专用的 FTP 用户。</p>
<h3 id="第-3-步-准备用户目录"><a href="#第-3-步-准备用户目录" class="headerlink" title="第 3 步 - 准备用户目录"></a>第 3 步 - 准备用户目录</h3><p>我们将创建一个专用的 FTP 用户，但您可能已经有一个需要 FTP 访问的用户。 我们将注意保留现有用户对以下说明中的数据的访问权限。 即便如此，我们建议您在配置和测试设置之前先与新用户联系。</p>
<p>首先，添加一个测试用户：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo adduser sammy</span><br></pre></td></tr></table></figure>

<p>出现提示时分配密码。 随意通过其他提示按<code>ENTER</code> 。</p>
<p>当用户被限制在特定目录时，FTP 通常更安全。 <code>vsftpd</code>用<a href="https://www.howtoing.com/how-to-configure-chroot-environments-for-testing-on-an-ubuntu-12-04-vps/#what-is-a-chroot-environment"><code>chroot</code></a> jails 完成了这个。 为本地用户启用<code>chroot</code> ，默认情况下它们仅限于其主目录。 但是，由于<code>vsftpd</code>保护目录的方式，用户不能写入。 这对于只应通过 FTP 连接的新用户来说很好，但如果现有用户也具有 shell 访问权限，则可能需要写入其主文件夹。</p>
<p>在这个例子中，不是从主目录中删除写权限，而是创建一个<code>ftp</code>目录作为<code>chroot</code>和一个可写<code>files</code>目录来保存实际文件。</p>
<p>创建<code>ftp</code>文件夹：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo mkdir /home/sammy/ftp</span><br></pre></td></tr></table></figure>

<p>设置所有权：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chown nobody:nogroup /home/sammy/ftp</span><br></pre></td></tr></table></figure>

<p>删除写权限：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chmod a-w /home/sammy/ftp</span><br></pre></td></tr></table></figure>

<p>验证权限：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ls -la /home/sammy/ftp</span><br><span class="line">Outputtotal 8</span><br><span class="line">4 dr-xr-xr-x  2 nobody nogroup 4096 Aug 24 21:29 .</span><br><span class="line">4 drwxr-xr-x  3 sammy  sammy   4096 Aug 24 21:29 ..</span><br></pre></td></tr></table></figure>

<p>接下来，让我们创建文件上传目录并为用户分配所有权：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo mkdir /home/sammy/ftp/files</span><br><span class="line">sudo chown sammy:sammy /home/sammy/ftp/files</span><br></pre></td></tr></table></figure>

<p>对<code>ftp</code>目录的权限检查应返回以下内容：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ls -la /home/sammy/ftp</span><br><span class="line">Outputtotal 12</span><br><span class="line">dr-xr-xr-x 3 nobody nogroup 4096 Aug 26 14:01 .</span><br><span class="line">drwxr-xr-x 3 sammy  sammy   4096 Aug 26 13:59 ..</span><br><span class="line">drwxr-xr-x 2 sammy  sammy   4096 Aug 26 14:01 files</span><br></pre></td></tr></table></figure>

<p>最后，让我们添加一个<code>test.txt</code>文件，以便在测试时使用：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo &quot;vsftpd test file&quot; | sudo tee /home/sammy/ftp/files/test.txt</span><br></pre></td></tr></table></figure>

<p>现在我们已经保护了<code>ftp</code>目录并允许用户访问<code>files</code>目录，让我们修改我们的配置。</p>
<h3 id="第-4-步-配置-FTP-访问"><a href="#第-4-步-配置-FTP-访问" class="headerlink" title="第 4 步 - 配置 FTP 访问"></a>第 4 步 - 配置 FTP 访问</h3><p>我们计划允许具有本地 shell 帐户的单个用户与 FTP 连接。 这两个关键设置已在<code>vsftpd.conf</code>设置。 首先打开配置文件，验证配置中的设置是否与以下设置相匹配：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/vsftpd.conf</span><br></pre></td></tr></table></figure>

<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line"><span class="meta">#</span><span class="bash"> Allow anonymous FTP? (Disabled by default).</span></span><br><span class="line">anonymous_enable=NO</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment"># Uncomment this to allow local users to log in.</span></span></span><br><span class="line">local_enable=YES</span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>接下来，让我们通过取消注释<code>write_enable</code>设置来允许用户上传文件：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">write_enable=YES</span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>我们还将取消注释<code>chroot</code>以防止 FTP 连接的用户访问目录树之外的任何文件或命令：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>我们还添加一个<code>user_sub_token</code>以在<code>local_root directory</code>路径中插入用户名，这样我们的配置将适用于此用户和任何其他未来用户。 在文件中的任何位置添加这些设置：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">user_sub_token=$USER</span><br><span class="line">local_root=/home/$USER/ftp</span><br></pre></td></tr></table></figure>

<p>我们还限制了可用于被动 FTP 的端口范围，以确保有足够的连接可用：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">pasv_min_port=40000</span><br><span class="line">pasv_max_port=50000</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>在第 2 步中，我们打开了我们在此处为被动端口范围设置的端口。 如果更改值，请务必更新防火墙设置。</p>
<p>要根据具体情况允许 FTP 访问，让我们设置配置，以便用户只有在明确添加到列表时才能访问，而不是默认情况下：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">userlist_enable=YES</span><br><span class="line">userlist_file=/etc/vsftpd.userlist</span><br><span class="line">userlist_deny=NO</span><br></pre></td></tr></table></figure>

<p><code>userlist_deny</code>切换逻辑：当它设置为<code>YES</code> ，列表中的用户被拒绝 FTP 访问。 当它设置为<code>NO</code> ，只允许列表中的用户访问。</p>
<p>完成更改后，保存文件并退出编辑器。</p>
<p>最后，让我们将用户添加到<code>/etc/vsftpd.userlist</code> 。 使用<code>-a</code>标志追加到文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo &quot;sammy&quot; | sudo tee -a /etc/vsftpd.userlist</span><br></pre></td></tr></table></figure>

<p>检查它是否按预期添加：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /etc/vsftpd.userlist</span><br><span class="line">Outputsammy</span><br></pre></td></tr></table></figure>

<p>重新启动守护程序以加载配置更改：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart vsftpd</span><br></pre></td></tr></table></figure>

<p>配置到位后，我们继续测试 FTP 访问。</p>
<h3 id="第-5-步-测试-FTP-访问"><a href="#第-5-步-测试-FTP-访问" class="headerlink" title="第 5 步 - 测试 FTP 访问"></a>第 5 步 - 测试 FTP 访问</h3><p>我们已将服务器配置为仅允许用户<code>sammy</code>通过 FTP 连接。 让我们确保它按预期工作。</p>
<p><strong>匿名用户应该无法连接</strong> ：我们已禁用匿名访问。 让我们通过尝试匿名连接来测试它。 如果我们的配置设置正确，则应拒绝匿名用户的权限。 请务必将<code>203.0.113.0</code>替换为服务器的公共 IP 地址：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ftp -p 203.0.113.0</span><br><span class="line">OutputConnected to 203.0.113.0.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (203.0.113.0:default): anonymous</span><br><span class="line">530 Permission denied.</span><br><span class="line">ftp: Login failed.</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure>

<p>关闭连接：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bye</span><br></pre></td></tr></table></figure>

<p><strong>除了 sammy 之外的用户应该无法连接</strong> ：接下来，让我们尝试连接我们的 sudo 用户。 他们也应该被拒绝访问，并且应该在他们被允许输入密码之前发生：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ftp -p 203.0.113.0</span><br><span class="line">OutputConnected to 203.0.113.0.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (203.0.113.0:default): sudo_user</span><br><span class="line">530 Permission denied.</span><br><span class="line">ftp: Login failed.</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure>

<p>关闭连接：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bye</span><br></pre></td></tr></table></figure>

<p><strong>用户 sammy 应该能够连接，读取和写入文件</strong> ：让我们确保我们的指定用户可以连接：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ftp -p 203.0.113.0</span><br><span class="line">OutputConnected to 203.0.113.0.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (203.0.113.0:default): sammy</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password: your_user&#x27;s_password</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure>

<p>让我们切换到<code>files</code>目录并使用<code>get</code>命令将我们之前创建的测试文件传输到本地机器：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd files</span><br><span class="line">get test.txt</span><br><span class="line">Output227 Entering Passive Mode (203,0,113,0,169,12).</span><br><span class="line">150 Opening BINARY mode data connection for test.txt (16 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">16 bytes received in 0.0101 seconds (1588 bytes/s)</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来，让我们使用新名称上传文件以测试写入权限：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">put test.txt upload.txt</span><br><span class="line">Output227 Entering Passive Mode (203,0,113,0,164,71).</span><br><span class="line">150 Ok to send data.</span><br><span class="line">226 Transfer complete.</span><br><span class="line">16 bytes sent in 0.000894 seconds (17897 bytes/s)</span><br></pre></td></tr></table></figure>

<p>关闭连接：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bye</span><br></pre></td></tr></table></figure>

<p>现在我们已经测试了我们的配置，让我们采取措施进一步保护我们的服务器。</p>
<h3 id="第-6-步-保护交易"><a href="#第-6-步-保护交易" class="headerlink" title="第 6 步 - 保护交易"></a>第 6 步 - 保护交易</h3><p>由于 FTP 不会加密传输中的任何数据，包括用户凭据，因此我们将启用 TLS / SSL 来提供加密。 第一步是创建用于<code>vsftpd</code>的 SSL 证书。</p>
<p>让我们使用<code>openssl</code>创建一个新证书，并使用<code>-days</code>标志使其有效一年。 在同一个命令中，我们将添加一个私有的 2048 位 RSA 密钥。 通过将<code>-keyout</code>和<code>-out</code>标志都设置为相同的值，私钥和证书将位于同一文件中：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/vsftpd.pem -out /etc/ssl/private/vsftpd.pem</span><br></pre></td></tr></table></figure>

<p>系统将提示您提供证书的地址信息。 将您自己的信息替换为以下突出显示的值：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">OutputGenerating a 2048 bit RSA private key</span><br><span class="line">............................................................................+++</span><br><span class="line">...........+++</span><br><span class="line">writing new private key to &#x27;/etc/ssl/private/vsftpd.pem&#x27;</span><br><span class="line">-----</span><br><span class="line">You are about to be asked to enter information that will be incorporated</span><br><span class="line">into your certificate request.</span><br><span class="line">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class="line">There are quite a few fields but you can leave some blank</span><br><span class="line">For some fields there will be a default value,</span><br><span class="line">If you enter &#x27;.&#x27;, the field will be left blank.</span><br><span class="line">-----</span><br><span class="line">Country Name (2 letter code) [AU]:US</span><br><span class="line">State or Province Name (full name) [Some-State]:NY</span><br><span class="line">Locality Name (eg, city) []:New York City</span><br><span class="line">Organization Name (eg, company) [Internet Widgits Pty Ltd]:DigitalOcean</span><br><span class="line">Organizational Unit Name (eg, section) []:</span><br><span class="line">Common Name (e.g. server FQDN or YOUR name) []: your_server_ip</span><br><span class="line">Email Address []:</span><br></pre></td></tr></table></figure>

<p>有关证书标志的更多详细信息，请参阅<a href="https://www.howtoing.com/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs/">OpenSSL Essentials：使用 SSL 证书，私钥和 CSR</a></p>
<p>创建证书后，再次打开<code>vsftpd</code>配置文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/vsftpd.conf</span><br></pre></td></tr></table></figure>

<p>在文件的底部，您将看到以<code>rsa_</code>开头的两行。 评论它们，看起来像这样：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line"><span class="meta">#</span><span class="bash"> rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key</span></span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>在它们下面，添加以下指向我们刚刚创建的证书和私钥的行：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">rsa_cert_file=/etc/ssl/private/vsftpd.pem</span><br><span class="line">rsa_private_key_file=/etc/ssl/private/vsftpd.pem</span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>之后，我们将强制使用 SSL，这将阻止无法处理 TLS 的客户端连接。 这对于确保所有流量都已加密是必要的，但它可能会强制您的 FTP 用户更改客户端。 将<code>ssl_enable</code>更改为<code>YES</code> ：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">ssl_enable=YES</span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>之后，添加以下行以显式拒绝 SSL 上的匿名连接，并要求 SSL 进行数据传输和登录：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">allow_anon_ssl=NO</span><br><span class="line">force_local_data_ssl=YES</span><br><span class="line">force_local_logins_ssl=YES</span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>在此之后，通过添加以下行将服务器配置为使用 TLS（SSL 的首选后继者）：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">ssl_tlsv1=YES</span><br><span class="line">ssl_sslv2=NO</span><br><span class="line">ssl_sslv3=NO</span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>最后，我们将添加两个选项。 首先，我们不会要求重用 SSL，因为它可能会破坏许多 FTP 客户端。 我们将需要“高”加密密码套件，目前这意味着密钥长度等于或大于 128 位：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">require_ssl_reuse=NO</span><br><span class="line">ssl_ciphers=HIGH</span><br><span class="line">. . .</span><br></pre></td></tr></table></figure>

<p>完成的文件部分应如下所示：</p>
<p>/etc/vsftpd.conf 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> This option specifies the location of the RSA certificate to use <span class="keyword">for</span> SSL</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> encrypted connections.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem</span></span><br><span class="line"><span class="meta">#</span><span class="bash">rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key</span></span><br><span class="line">rsa_cert_file=/etc/ssl/private/vsftpd.pem</span><br><span class="line">rsa_private_key_file=/etc/ssl/private/vsftpd.pem</span><br><span class="line">ssl_enable=YES</span><br><span class="line">allow_anon_ssl=NO</span><br><span class="line">force_local_data_ssl=YES</span><br><span class="line">force_local_logins_ssl=YES</span><br><span class="line">ssl_tlsv1=YES</span><br><span class="line">ssl_sslv2=NO</span><br><span class="line">ssl_sslv3=NO</span><br></pre></td></tr></table></figure>

<p>完成后，保存并关闭文件。</p>
<p>重新启动服务器以使更改生效：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo systemctl restart vsftpd</span><br></pre></td></tr></table></figure>

<p>此时，我们将无法再使用不安全的命令行客户端进行连接。 如果我们尝试过，我们会看到类似的东西：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ftp -p 203.0.113.0</span><br><span class="line">Connected to 203.0.113.0.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (203.0.113.0:default): sammy</span><br><span class="line">530 Non-anonymous sessions must use encryption.</span><br><span class="line">ftp: Login failed.</span><br><span class="line">421 Service not available, remote server has closed connection</span><br><span class="line"><span class="meta">ftp&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来，让我们验证我们是否可以使用支持 TLS 的客户端进行连接。</p>
<h3 id="第-7-步-使用-FileZilla-测试-TLS"><a href="#第-7-步-使用-FileZilla-测试-TLS" class="headerlink" title="第 7 步 - 使用 FileZilla 测试 TLS"></a>第 7 步 - 使用 FileZilla 测试 TLS</h3><p>大多数现代 FTP 客户端都可以配置为使用 TLS 加密。 我们将演示如何与<a href="https://filezilla-project.org/">FileZilla</a>连接，因为它支持跨平台。 请参阅其他客户的文档。</p>
<p>首次打开 FileZilla 时，在主页上方找到站点管理器图标，这是最上一行最左侧的图标。 点击它：</p>
<img src="/posts/40394/filezilla_site_manager_vsftpd_18_04.png" class="" title="filezilla_site_manager_vsftpd_18_04">

<p>将打开一个新窗口。 单击右下角的“ <strong>新建站点”</strong>按钮：</p>
<img src="/posts/40394/new-site.png" class="" title="new-site">

<p>在“ <strong>我的网站”</strong>下，将出现一个带有“ <strong>新网站</strong> ”字样的新图标。 您可以立即命名或稍后返回并使用“ <strong>重命名”</strong>按钮。</p>
<p>使用名称或 IP 地址填写<strong>主机</strong>字段。 在“ <strong>加密”</strong>下拉菜单下，选择“ <strong>要求显式 FTP over TLS”</strong> 。</p>
<p>对于<strong>登录类型</strong> ，选择<strong>询问密码</strong> 。 在“ <strong>用户”</strong>字段中填写您的 FTP 用户：</p>


<p>单击界面底部的“连接”。 系统将要求您输入用户密码：</p>
<img src="/posts/40394/user-pass.png" class="" title="密码对话">

<p>单击<strong>确定</strong>以进行连接。 您现在应该使用 TLS / SSL 加密与您的服务器连接。</p>
<p>成功后，您将看到一个如下所示的服务器证书：</p>
<img src="/posts/40394/filezilla_certificate_vsftpd_three.png" class="" title="filezilla_certificate_vsftpd_three">

<p>当您接受证书后，双击<code>files</code>夹并将<code>upload.txt</code>拖到左侧以确认您能够下载文件：</p>
<p><a href="https://www.howtoing.com/wp-content/uploads/articles/vsftpd_18_04/vsftpd_images/filezilla_file_test_vsftpd_18_04.png"><img src="%E9%98%BF%E9%87%8C%E4%BA%91%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8ECS%E8%B4%AD%E4%B9%B0%E4%B8%8E%E4%BD%BF%E7%94%A8%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/filezilla_file_test_vsftpd_18_04.png" alt="下载test.txt"></a></p>
<img src="/posts/40394/filezilla_file_test_vsftpd_18_04.png" class="" title="下载test.txt">

<p>完成后，右键单击本地副本，将其重命名为<code>upload-tls.txt</code>并将其拖回服务器以确认您可以上传文件：</p>
<img src="/posts/40394/filezilla_file_upload_vsftpd_18_04.png" class="" title="重命名和上传">

<p>您现在已确认可以安全地成功传输启用了 SSL / TLS 的文件。</p>
<h3 id="第-8-步-禁用-Shell-访问（可选）"><a href="#第-8-步-禁用-Shell-访问（可选）" class="headerlink" title="第 8 步 - 禁用 Shell 访问（可选）"></a>第 8 步 - 禁用 Shell 访问（可选）</h3><p>如果由于客户端要求而无法使用 TLS，则可以通过禁用 FTP 用户以任何其他方式登录的方式来获得一些安全性。 防止它的一种相对简单的方法是创建一个自定义 shell。 这不会提供任何加密，但会限制受感染帐户对 FTP 可访问的文件的访问。</p>
<p>首先，在<code>bin</code>目录中打开一个名为<code>ftponly</code>的文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nano /bin/ftponly</span><br></pre></td></tr></table></figure>

<p>添加一条消息，告诉用户他们无法登录的原因：</p>
<p>/斌/ ftponly</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/sh</span></span><br><span class="line">echo &quot;This account is limited to FTP access only.&quot;</span><br></pre></td></tr></table></figure>

<p>保存文件并退出编辑器。</p>
<p>更改权限以使文件可执行：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chmod a+x /bin/ftponly</span><br></pre></td></tr></table></figure>

<p>打开有效 shell 列表：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo nano /etc/shells</span><br></pre></td></tr></table></figure>

<p>在底部添加：</p>
<p>/ etc / shells 中</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">. . .</span><br><span class="line">/bin/ftponly</span><br></pre></td></tr></table></figure>

<p>使用以下命令更新用户的 shell：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo usermod sammy -s /bin/ftponly</span><br></pre></td></tr></table></figure>

<p>现在尝试以<code>sammy</code>身份登录您的服务器：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh sammy@your_server_ip</span><br></pre></td></tr></table></figure>

<p>你应该看到类似的东西：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">OutputThis account is limited to FTP access only.</span><br><span class="line">Connection to 203.0.113.0 closed.</span><br></pre></td></tr></table></figure>

<p>这确认用户不能再<code>ssh</code>到服务器并且仅限于 FTP 访问。</p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>在本教程中，我们介绍了为具有本地帐户的用户设置 FTP。 如果您需要使用外部身份验证源，您可能需要了解<code>vsftpd</code>对虚拟用户的支持。 这通过使用 PAM（可插入身份验证模块）提供了丰富的选项，如果您管理其他系统（如 LDAP 或 Kerberos）中的用户，这是一个不错的选择。</p>
<h3 id="执行完上面操作后的问题解决"><a href="#执行完上面操作后的问题解决" class="headerlink" title="执行完上面操作后的问题解决"></a>执行完上面操作后的问题解决</h3><h4 id="使用-FileZilla-FTP-下载时提示“不安全的服务器，不支持-FTPover-TLS”-和“服务器不支持非-ASCII-字符”"><a href="#使用-FileZilla-FTP-下载时提示“不安全的服务器，不支持-FTPover-TLS”-和“服务器不支持非-ASCII-字符”" class="headerlink" title="使用 FileZilla FTP 下载时提示“不安全的服务器，不支持 FTPover TLS”,和“服务器不支持非 ASCII 字符”"></a>使用 FileZilla FTP 下载时提示“不安全的服务器，不支持 FTPover TLS”,和“服务器不支持非 ASCII 字符”</h4><p>1、提示“不安全的服务器，不支持 FTPover TLS</p>
<p>解决方法：在站点管理器中，加密方式选择：</p>


<p>2、提示“服务器不支持非 ASCII 字符”</p>
<p>解决方法：在站点管理器中字符集选择：自定义字符集：GBK</p>
<img src="/posts/40394/wKiom1b6SWvwBjm7AAA9pZvVBTE386.png" class="" title="wKiom1b6SWvwBjm7AAA9pZvVBTE386">

<p>OK,正常了</p>
<h4 id="ftp-连接错误——服务器发回了不可路由的地址。使用服务器地址代替。"><a href="#ftp-连接错误——服务器发回了不可路由的地址。使用服务器地址代替。" class="headerlink" title="ftp 连接错误——服务器发回了不可路由的地址。使用服务器地址代替。"></a>ftp 连接错误——服务器发回了不可路由的地址。使用服务器地址代替。</h4><p>设置 filezilla 客户端的连接参数</p>
<ol>
<li>选中某一连接项</li>
<li>高级——加密——只使用普通 ftp</li>
<li>传输设置——传输模式——主动</li>
<li>重新连接</li>
</ol>
<h2 id="ubuntu-下-Apache-虚拟站点配置"><a href="#ubuntu-下-Apache-虚拟站点配置" class="headerlink" title="ubuntu 下 Apache 虚拟站点配置"></a>ubuntu 下 Apache 虚拟站点配置</h2><p><a href="https://www.linuxidc.com/Linux/2017-05/143590.htm">https://www.linuxidc.com/Linux/2017-05/143590.htm</a></p>
<h2 id="apache-配置二级域名"><a href="#apache-配置二级域名" class="headerlink" title="apache 配置二级域名"></a>apache 配置二级域名</h2><p>[apache2 服务器 mod_rewrite 模块 开启方法<a href="https://www.cnblogs.com/wwufengg/articles/apache2-mod_rewrite.html">linux, ubuntu]</a></p>
<p>开启重写，p.s. 上面教程中说要把 <code>/etc/apache2/sites-enabled/000-default</code> 中的 <code>AllowOverride None 修改为： AllowOverride All</code> ，然而我的 Apache2 是新版（2.4），所以得转到 <code>/etc/apache2/</code> 。将名为 <code>apache2.conf</code> 的文件中的 <a href="http://www.kbase101.com/question/9571.html">下面代码从 NONE 改为 ALL</a> ：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Directory</span> /<span class="attr">var</span>/<span class="attr">www</span>/&gt;</span></span><br><span class="line">    Options Indexes FollowSymLinks</span><br><span class="line">    AllowOverride All</span><br><span class="line">    Require all granted</span><br><span class="line"><span class="tag">&lt;/<span class="name">Directory</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>目标二级域名：mall.evelance.cn</p>
<p>阿里云控制台配置：在阿里云的控制台中找到域名管理，然后选择顶级域名 evelance.cn 后面的“解析”字样。在新打开的页面中我们可以看到一个提供域名解析的界面，选择解析类型为 A 类解析，然后输入 mall（我们想要的二级域名的头），然后在地址里面输入我们刚才查看到的 ECS 的公网 ip，然后点击确认，之后我们的解析就会生效了。</p>
<p>ubuntu 服务器配置：</p>
<p>进入 /etc/apache2/site-available/ ，复制默认的虚拟主机配置文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo cp 000-default.conf mall.evelance.cn.conf</span><br></pre></td></tr></table></figure>

<p>修改配置：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">VirtualHost</span> *<span class="attr">:80</span>&gt;</span></span><br><span class="line">    ServerAdmin xxx@qq.com</span><br><span class="line">    ServerName mall.evelance.com</span><br><span class="line">    DocumentRoot /home/www/mall</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Directory</span> &quot;/<span class="attr">home</span>/<span class="attr">www</span>/<span class="attr">mall</span>&quot;&gt;</span></span><br><span class="line">        Options FollowSymLinks</span><br><span class="line">        AllowOverride All</span><br><span class="line">        #Require all denied</span><br><span class="line">        Require all granted</span><br><span class="line">    <span class="tag">&lt;/<span class="name">Directory</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    ErrorLog $&#123;APACHE_LOG_DIR&#125;/error.log</span><br><span class="line">    CustomLog $&#123;APACHE_LOG_DIR&#125;/access.log combined</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">VirtualHost</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 sites-enabled 目录下建立符号链接：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /etc/apache2/sites-enabled</span><br><span class="line"><span class="meta">#</span><span class="bash">建立对应的软链接</span></span><br><span class="line">sudo ln -s /etc/apache2/sites-available/mall.evelance.cn.conf /etc/apache2/sites-enabled/mall.evelance.cn.conf</span><br></pre></td></tr></table></figure>

<p>在对应目录放入项目代码：</p>
<p>把项目文件放进 /home/www/mall 中，并赋予文件夹权限：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chmod -R 777 /home/www/mall</span><br></pre></td></tr></table></figure>

<p>激活配置，重启 apache：</p>
<p>返回上级目录 <code>cd ../site-enable/</code>，输入 <code>cd sites-available/</code></p>
<p>输入 <code>a2ensite mall.evelance.cn.conf</code> ，如果提示已经激活过了，输入下面代码：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">a2dissite mall.evelance.cn.conf</span><br><span class="line">service apache2 reload</span><br><span class="line">a2ensite mall.evelance.cn.conf</span><br><span class="line">service apache2 reload</span><br></pre></td></tr></table></figure>

<p>参考：</p>
<ul>
<li><a href="https://blog.csdn.net/carolcoral/article/details/77857264">ECS 简单配置多个二级域名</a></li>
</ul>
<h3 id="域名解析-1"><a href="#域名解析-1" class="headerlink" title="域名解析"></a>域名解析</h3><p>登录阿里云，进入控制台，选择云解析 DNS。选择右侧的解析管理，进行二级域名的添加：</p>
<ul>
<li>记录类型：A</li>
<li>主机记录：[mall].evelance.cn</li>
<li>解析线路：默认</li>
<li>记录值：你的公共 IP</li>
<li>TTL：10 分钟</li>
</ul>
<p>参考：<a href="https://blog.csdn.net/wangjia55/article/details/81127647">阿里云添加二级域名的操作</a></p>
<h3 id="支持-https"><a href="#支持-https" class="headerlink" title="支持 https"></a>支持 https</h3><ol>
<li><a href="https://www.cnblogs.com/lxf1117/p/6650647.html">在阿里云里申请免费 Https 证书 SSL</a></li>
<li><a href="https://yq.aliyun.com/articles/697838">ubuntu apache2 配置安装 ssl 证书</a></li>
<li><a href="https://www.cnblogs.com/wpl-php/p/10287125.html">阿里云 Ubuntu16.04 apache2 ssl 证书下载与安装（必须有域名）</a></li>
<li>完成上述配置后，别忘了让防火墙允许 443 端口。<code>sudo ufw allow 443/tcp</code></li>
</ol>
]]></content>
      <categories>
        <category>后端</category>
        <category>服务器</category>
      </categories>
      <tags>
        <tag>笔记</tag>
        <tag>阿里云</tag>
      </tags>
  </entry>
</search>
