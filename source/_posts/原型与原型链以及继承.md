---
title: åŸå‹ä¸åŸå‹é“¾ä»¥åŠç»§æ‰¿
tags:
  - ç¬”è®°
  - åŸå‹
  - åŸå‹é“¾
  - ç»§æ‰¿
categories:
  - å‰ç«¯
  - JS
  - ECMAScript
top: true
abbrlink: 6240
date: 2021-07-21 11:21:22
---

## åŸå‹ prototype

### ğŸŒˆ prototypeæ˜¯ func çš„å±æ€§ï¼Œå…¶å€¼æ˜¯ä¸ªå¯¹è±¡

```javascript
function Handphone() {}
console.log(Handphone.prototype);
```

{% asset_img 1629297997929-a463ea99-2a25-477c-b05a-5111d5e7af73.png 100% %}

<!-- more -->

### prototype æ˜¯æ„é€ å‡½æ•°ä¸­çš„ï¼Œæ„é€ å‡ºçš„æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„å…¬å…±ç¥–å…ˆ

### æ‰€æœ‰è¢«è¯¥æ„é€ å‡½æ•°æ„é€ å‡ºæ¥çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç»§æ‰¿åŸå‹ä¸Šçš„å±æ€§å’Œæ–¹æ³•

```javascript
function Handphone(color, brand) {
	this.color = color;
  this.brand = brand;
}
Handphone.prototype.rom = '64G';
Handphone.prototype.ram = '6G';

var hp1 = new Handphone('red', 'å°ç±³');
var hp2 = new Handphone('black', 'huawei');

console.log(hp1.rom);
console.log(hp2.ram);
```

{% asset_img 1629298114840-51eba9bd-1bcb-4731-a8ab-8cffd487a3d0.png 100% %}

### ğŸŒˆ constructor æŒ‡å‘æ„é€ å‡½æ•°æœ¬èº«

```javascript
function Handphone(color, brand) {
	this.color = color;
  this.brand = brand;
}
console.dir(Handphone);
console.dir(Handphone.prototype.constructor);
```

{% asset_img 1629298193747-dc80ab42-c298-42ed-9a4f-5c826deec6bd.png 100% %}


### constructor å¯ä»¥è¢«ä¿®æ”¹

```javascript
function Telephone() {}
function Handphone(color, brand) {
	this.color = color;
  this.brand = brand;
}
Handphone.prototype = {
	constructor: Telephone
}
console.log(Handphone.prototype)
```

{% asset_img 1629298245111-538acda9-95db-424d-b68d-882a442b02d2.png 100% %}


### ğŸŒˆ __proto__ æ˜¯å®ä¾‹åŒ–ä»¥åçš„ç»“æœ

```javascript
function Car() {
	var this = {
  	__proto__: Car.prototype
  }
}
Car.prototype.name = 'Benz';
var car = new Car();
console.log(car);
```

{% asset_img 1629298300156-c2636466-a1dc-4828-9f0f-909ce3d92623.png 100% %}


```javascript
function Person() {}
Person.prototype.name = 'å¼ ä¸‰';

var p1 = {
	name: 'lance'
}

var person = new Person();
console.log(person.name);
person.__proto__ = p1;
console.log(person.name);
```

{% asset_img 1629298374656-773e389a-5c23-45e4-825e-e498e6c76be4.png 100% %}

### ğŸŒˆğŸŒˆğŸŒˆ å®ä¾‹åŒ–å¯¹è±¡ä»¥åå†æ¥ä¿®æ”¹æ„é€ å‡½æ•°çš„prototypeï¼Œä¸å½±å“è¯¥å¯¹è±¡çš„åŸå‹å±æ€§ ï¼Œå› ä¸ºä¿®æ”¹åçš„ prototype æŒ‡å‘äº†æ–°çš„å¯¹è±¡ï¼Œä¸å½±å“åŸæ¥çš„prototypeï¼Œä½†å½±å“åŸæ¥ prototype ä¸‹çš„ constructor 

```javascript
Car.prototype.name = 'Benz';
function Car() {}
var car = new Car();
Car.prototype = { // å®ä¾‹åŒ–ä¹‹åèµ‹å€¼ï¼Œcarè¿˜æ˜¯åŸæ¥çš„
	name: 'Mazda'
}
console.log(car.name); //ç­”æ¡ˆï¼š																										 Benz

console.dir(Car);
console.dir(car);
console.log(car.__proto__.constructor === Car); //ç­”æ¡ˆï¼š               true
console.log(Car.prototype.constructor === Object.prototype.constructor); //                 true
```

{% asset_img 1629299742226-3c8cbf61-9816-476c-9e83-f6dba3c4bc37.png 100% %}

```javascript
Car.prototype.name = 'Benz';
function Car() {}
var car = new Car();
Car.prototype.name = 'hhhh';
console.log(car.name); // 																													hhhh
```

{% asset_img 1629298433205-e8f5bdf3-f9a9-40dc-ae57-90348c0337e8.png 100% %}


**â†‘æ³¨æ„æ˜¯ç›´æ¥æ›¿æ¢** `**Car.prototype**` **è¿˜æ˜¯æ”¹** `**Car.prototype**` **å¯¹è±¡ä¸‹è¾¹çš„å±æ€§â†‘**

```javascript
Car.prototype.name = 'GC';
function Car() {}
var car = new Car();
Car.prototype = { // 																									å®ä¾‹åŒ–ä¹‹åèµ‹å€¼ï¼Œcarè¿˜æ˜¯åŸæ¥çš„
	name: 'Lance'
}
console.log(car.name); //																										 GC
var car2 = new Car();

console.log(Car);
console.log(car);
console.log(car2);
console.log(car.__proto__.constructor === Car); //																			 true
```

{% asset_img 1631175027959-92426dd1-14d0-43c4-bae4-329122de7cd2.png 100% %}


## åŸå‹é“¾

æ²¿ç€**åŸå‹**`**__proto__**`**å¾€ä¸Š**ä¸æ–­æ‰¾å±æ€§çš„è¿™æ¡é“¾æ¡å«åšåŸå‹é“¾

```javascript
Professor.prototype.tSkill = 'Java';
function Professor() {}
var professor = new Professor();

Teacher.prototype = professor;
function Teacher() {
	this.mSkill = 'JS/JQ';
}
var teacher = new Teacher();

Student.prototype = teacher;
function Student() {
	this.pSkill = 'HTML/CSS';
}
var student = new Student();

console.log(student);

// student: {
//   pSkill: 'HTML/CSS',
//   __proto__: { // teacher
//   	mSkill: 'JS/JQ',
//     __proto__: { // professor
//       __proto__: { // Professor.prototype
//         tSkill: 'Java',
//       	constructor: Professor,
//         __proto__: Object.prototype
//       }
//     }
//   }
// }

student.__proto__.__proto__.__proto__ === Professor.prototype; // true
student.__proto__.__proto__.__proto__.__proto__ === Object.prototype; // true
```

{% asset_img 1629888579596-509a97a0-83a5-4f46-a0dd-806dd20cf4f3.png 100% %}


### ğŸŒˆ åŸå‹é“¾çš„é¡¶ç«¯æ˜¯ Object.prototype

```javascript
Professor.prototype.tSkill = 'Java';
function Professor() {}
var professor = new Professor();

Teacher.prototype = professor;
function Teacher() {
	this.mSkill = 'JS/JQ';
}
var teacher = new Teacher();

Student.prototype = teacher;
function Student() {
	this.pSkill = 'HTML/CSS';
}
var student = new Student();

console.log(professor, Object.prototype);
```

{% asset_img 1629888867471-1224ce43-50f5-4873-95d7-f00f396d8634.png 100% %}


### ä¿®æ”¹åŸå‹ä¸Šçš„å€¼

#### ğŸŒˆ åŸå‹çš„å¼•ç”¨å€¼çš„å±æ€§å¯ä»¥ä¿®æ”¹

```javascript
Professor.prototype.tSkill = 'Java';
function Professor() {}
var professor = new Professor();

Teacher.prototype = professor;
function Teacher() {
	this.mSkill = 'JS/JQ';
  this.success = {
  	alibaba: '28',
    tencent: '20'
  }
}
var teacher = new Teacher();

Student.prototype = teacher;
function Student() {
	this.pSkill = 'HTML/CSS';
}

var student = new Student();
console.log({ "ä¿®æ”¹studentå¼•ç”¨å€¼ä¹‹å‰çš„success": student.success });

// ğŸŒ° æ­¤å¤„chromeæ§åˆ¶å°å…ˆæ‰“å°ï¼Œå†æ‰§è¡Œä¸‹è¾¹è¯­å¥
// ä¿®æ”¹å¼•ç”¨å€¼
student.success.baidu = '100';
console.log({ "ä¿®æ”¹studentå¼•ç”¨å€¼ä¹‹åçš„student": student });
```

{% asset_img 1629889874555-64c29aea-21ea-42e7-868d-96d50c559d83.png 100% %}


#### ğŸŒˆ ä¿®æ”¹åŸºæœ¬å€¼ï¼Œä¸å½±å“åŸå‹å±æ€§

```javascript
Professor.prototype.tSkill = 'Java';
function Professor() {}
var professor = new Professor();

Teacher.prototype = professor;
function Teacher() {
	this.mSkill = 'JS/JQ';
  this.success = {
  	alibaba: '28',
    tencent: '20'
  }
}
var teacher = new Teacher();

Student.prototype = teacher;
function Student() {
	this.pSkill = 'HTML/CSS';
}

var student = new Student();

// ä¿®æ”¹åŸºæœ¬ç±»å‹
console.log({ "ä¿®æ”¹studentåŸºæœ¬ç±»å‹ä¹‹å‰çš„success": student.success });
student.success = 666;
console.log({ "ä¿®æ”¹studentåŸºæœ¬ç±»å‹ä¹‹åçš„student": student });
```

{% asset_img 1629890113977-a029c36d-c40d-4e5b-9e11-a38f80a68b04.png 100% %}


#### ä¿®æ”¹ä¸€ä¸ªåŸå‹ä¸Šä¸å­˜åœ¨çš„å¼•ç”¨å€¼ï¼ŒæŠ¥é”™

```javascript
Professor.prototype.tSkill = 'Java';
function Professor() {}
var professor = new Professor();

Teacher.prototype = professor;
function Teacher() {
	this.mSkill = 'JS/JQ';
  this.success = {
  	alibaba: '28',
    tencent: '20'
  }
}
var teacher = new Teacher();

Student.prototype = teacher;
function Student() {
	this.pSkill = 'HTML/CSS';
}

var student = new Student();

// ä¿®æ”¹ä¸å­˜åœ¨çš„å¼•ç”¨ç±»å‹
student.profile.name = 'lance';
// æŠ¥é”™: Cannot set property 'name' of undefined
```

#### ğŸŒˆ åŸå§‹å€¼è‡ªå¢

```javascript
Professor.prototype.tSkill = 'Java';
function Professor() {}
var professor = new Professor();

Teacher.prototype = professor;
function Teacher() {
	this.mSkill = 'JS/JQ';
  this.students = 500;
}
var teacher = new Teacher();

Student.prototype = teacher;
function Student() {
	this.pSkill = 'HTML/CSS';
}
var student = new Student();
console.log(student.students);
student.students++;
console.log(teacher);
console.log(student);
```

{% asset_img 1629890656491-fc35d864-43e8-40ea-b83a-054b387c3178.png 100% %}


åˆ†æï¼šå­¦ç”Ÿçš„studentså€¼å˜äº†ï¼Œprofessorçš„studentså€¼æ²¡å˜ã€‚è¿‡ç¨‹æ˜¯ï¼š

1. `student.students++;` => `student.students = student.students + 1`
2. =èµ‹å€¼å³è¾¹ student è‡ªèº«æ²¡æœ‰ studentsï¼Œåœ¨åŸå‹ä¸Šè¯»å– students å€¼ï¼Œå† + 1 è®¡ç®—

3. =èµ‹å€¼å·¦è¾¹ student.students æ˜¯ä¸ªåŸå§‹å€¼ï¼Œåˆ™åœ¨è‡ªèº«ä¸Šæ·»åŠ  students å±æ€§
4. æœ€åèµ‹å€¼

### è°è°ƒç”¨ï¼ŒthisæŒ‡å‘è°

```javascript
function Car() {
	this.brand = 'Benz';
}
Car.prototype = {
	brand: 'Mazda',
  intro: function() {
  	console.log('æˆ‘æ˜¯' + this.brand + 'è½¦');
  }
}
var car = new Car();
car.intro();
console.log(car);
Car.prototype.intro();
```

{% asset_img 1629891057285-dea5483c-742a-4f6c-afdd-ac7d90c05ebe.png 100% %}



```javascript
function Person() {
	this.smoke = function() {
  	this.weight--;
  }
}
Person.prototype = {
	weight: 130
}
var person = new Person();
person.smoke();
person.weight;
console.log(person);
console.log(Person.prototype);
```

{% asset_img 1629891105460-39bb7dbb-d1ed-4287-beb5-95e5be4f374b.png 100% %}


## ğŸŒˆ ç»§æ‰¿

### å®ä¾‹åŒ–å¯¹è±¡ç»§æ‰¿

- ç‰¹ç‚¹ï¼šç»§æ‰¿äº†åŸå‹é“¾ä¸Šçš„æ‰€æœ‰å±æ€§
- ç¼ºç‚¹ï¼š**ç»§æ‰¿äº†ä¸€äº›æ²¡å¿…è¦ç»§æ‰¿çš„å±æ€§**ï¼Œä¾‹å¦‚ name

```javascript
Professor.prototype = {
	name: 'Mr.Zhang',
  tSkill: 'Java'
}
function Professor() {}
var professor = new Professor();

Teacher.prototype = professor;
function Teacher() {
	this.name = 'Mr.Wang';
  this.mSkill = 'JS';
}
var teacher = new Teacher();

Student.prototype = teacher;
function Student() {
	this.name = 'Mr.Li';
  this.pSkill = 'HTML';
}
var student = new Student();
console.log(student);
```

{% asset_img 1629967595153-c47c71f9-2ef8-4788-9195-b733ce13c652.png 100% %}


### åˆ©ç”¨ call/apply å€Ÿç”¨æ„é€ å‡½æ•°

- æœ¬è´¨ï¼šcall/apply æ˜¯é€šè¿‡æ”¹å˜ this æŒ‡å‘ï¼Œæ¥å€Ÿç”¨æ„é€ å‡½æ•°çš„å±æ€§å’Œæ–¹æ³•
- æ­¤æ–¹æ³•å®ä¾‹åŒ–çš„ student **æ— æ³•ç»§æ‰¿ Teacher.prototype åŸå‹ä¸Šçš„å±æ€§**

```javascript
Teacher.prototype.wife = 'Ms.Liu';
function Teacher(name, mSkill) {
	this.name = name;
  this.mSkill = mSkill;
}
function Student(name, mSkill, age, major) {
	Teacher.apply(this, [name, mSkill]);
  this.age = age;
  this.major = major;
}
var student = new Student('Mr.B', 'JS', 18, 'Computer');
console.log(student);
```

{% asset_img 1629967814849-d45921e2-08d9-4225-9424-f910ab907047.png 100% %}


### Student.prototype = Teacher.prototype

- ç‰¹ç‚¹ï¼šèƒ½å¤Ÿç»§æ‰¿ Teacher åŸå‹
- ç¼ºç‚¹ï¼šStudent å’Œ Teacher **å…±ç”¨åŸå‹**ï¼Œä¿®æ”¹ Student.prototype ä¼šå¯¼è‡´ Teacher.prototype æ”¹å˜

```javascript
function Teacher() {
	this.name = 'Mr.Wang';
  this.mSkill = 'JS';
}
Teacher.prototype = {
	pSkill: 'JQ'
}
var teacher = new Teacher();

Student.prototype = Teacher.prototype;
function Student() {
	this.name = 'Mr.Li';
}

var student = new Student();
Student.prototype.name = 'student';
console.log(student);
console.log(Teacher.prototype);
```

{% asset_img 1629968259162-ffa2e2d8-03df-49bf-bf58-2963f42f18b3.png 100% %}


### ğŸŒˆ åœ£æ¯æ¨¡å¼ç»§æ‰¿ï¼ˆåœ£æ¯ä¸­é—´çš„éƒ¨ä½å°±æ˜¯è¿æ¥ä¸¤å¤´çš„ä¸­é—´ä»¶ï¼‰

æ–¹æ¡ˆï¼š

1. åˆ›å»ºä¸€ä¸ªç©ºçš„æ„é€ å‡½æ•°
2. ä½¿å…¶ç»§æ‰¿çˆ¶ç±»æ„é€ å‡½æ•°çš„åŸå‹

1. ç”±æ­¤æ„é€ å‡½æ•°å®ä¾‹åŒ–å‡ºä¸€ä¸ªå¯¹è±¡
2. æŠŠæ­¤å¯¹è±¡èµ‹å€¼ç»™å­ç±»æ„é€ å‡½æ•°çš„ prototype åŸå‹

```javascript
function Teacher() {
	this.name = 'Mr.Wang';
  this.mSkill = 'JS';
}
Teacher.prototype = {
	pSkill: 'JQ'
}
var teacher = new Teacher();

function Student() {
	this.name = 'Mr.Li';
}

function Buffer() {}
Buffer.prototype = Teacher.prototype;
var buffer = new Buffer();

Student.prototype = buffer;
Student.prototype.age = 18;
var student = new Student();
console.log(teacher);
console.log(buffer);
console.log(student);
```

{% asset_img 1629969154512-3056ad9c-792e-4e49-8a7f-cf53ad7a1283.png 100% %}

#### å°è£…ç»§æ‰¿æ–¹æ³•

```javascript
Teacher.prototype.name = 'Mr.Wang';
function Teacher() {}
function Student() {}

inherit(Student, Teacher);
var s = new Student();
var t = new Teacher();
console.log(t);
console.log(s);

function inherit(Target, Origin) {
	function Buffer() {}
  Buffer.prototype = Origin.prototype;
  Target.prototype = new Buffer();
	// è¿˜åŸæ„é€ å™¨
  Target.prototype.constructor = Target;
  // æŒ‡å®šç»§æ‰¿æº
  Target.prototype.super_class = Origin;
}
```

{% asset_img 1629969244842-25dcd1a4-81f9-41bd-bb72-015f6401fc6b.png 100% %}


#### åœ£æ¯æ¨¡å¼+IIFE+é—­åŒ…

```javascript
Teacher.prototype.name = 'Mr.Wang';
function Teacher() {}
function Student() {}

inherit(Student, Teacher);
var s = new Student();
var t = new Teacher();
console.log(t);
console.log(s);

var inherit = (function () {
	function Buffer() {}
	return function (Target, Origin) {
    Buffer.prototype = Origin.prototype;
    Target.prototype = new Buffer();
    // è¿˜åŸæ„é€ å™¨
    Target.prototype.constructor = Target;
    // æŒ‡å®šç»§æ‰¿æº
    Target.prototype.super_class = Origin;
  }
})();
```

#### ğŸŒˆ åœ£æ¯æ¨¡å¼ + call/apply ç»„åˆç»§æ‰¿

```javascript
function Person(name, age) {
    this.name = name;
    this.age = age;
    this.sayHi = function() {
        console.log("sayHi");
    }
}

Person.prototype.eat = function() {
    console.log("eat");
}

function Student(name, age, score) {
    Person.call(this, name, age);
    this.score = score;
    this.study = function() {
        console.log("study");
    }
}

var inherit = (function () {
	function Buffer() {}
	return function (Target, Origin) {
    Buffer.prototype = Origin.prototype;
    Target.prototype = new Buffer();
    // è¿˜åŸæ„é€ å™¨
    Target.prototype.constructor = Target;
    // æŒ‡å®šç»§æ‰¿æº
    Target.prototype.super_class = Origin;
  }
})();


inherit(Student, Person);
var stu1 = new Student("Lance", 19, 100);
console.dir(stu1);
```

{% asset_img 1629969604329-657e6152-56c7-48ee-a091-cfcb913e5497.png 100% %}

