<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"evestorm.github.io","root":"/","images":"/images","scheme":"Pisces","version":"8.0.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="转载自：https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;146641652 前言在 Vue 的官网中的过渡动画章节中，可以看到一个很酷炫的**动画效果**   乍一看，让我们手写出这个逻辑应该是非常复杂的，先看看本文最后要实现的效果吧，和这个案例是非常类似的。">
<meta property="og:type" content="article">
<meta property="og:title" content="转载-前端动画必知必会：React和Vue都在用的FLIP思想实战">
<meta property="og:url" content="https://evestorm.github.io/posts/7822/index.html">
<meta property="og:site_name" content="EVE | 暴风雨前夕">
<meta property="og:description" content="转载自：https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;146641652 前言在 Vue 的官网中的过渡动画章节中，可以看到一个很酷炫的**动画效果**   乍一看，让我们手写出这个逻辑应该是非常复杂的，先看看本文最后要实现的效果吧，和这个案例是非常类似的。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://evestorm.github.io/posts/7822/v2-741e6456c4471c34f6e346d3032ff323_b.jpg">
<meta property="og:image" content="https://evestorm.github.io/posts/7822/v2-67ea1b4e81adc6d0ee281a79c4a9da64_b.jpg">
<meta property="article:published_time" content="2021-03-05T09:13:07.000Z">
<meta property="article:modified_time" content="2021-03-10T06:07:47.942Z">
<meta property="article:author" content="Lance">
<meta property="article:tag" content="技巧">
<meta property="article:tag" content="转载">
<meta property="article:tag" content="解决方案">
<meta property="article:tag" content="动画">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://evestorm.github.io/posts/7822/v2-741e6456c4471c34f6e346d3032ff323_b.jpg">


<link rel="canonical" href="https://evestorm.github.io/posts/7822/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<title>转载-前端动画必知必会：React和Vue都在用的FLIP思想实战 | EVE | 暴风雨前夕</title>
  


  <script>
    !function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement("script"),tag=t.getElementsByTagName("script")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,"script","assets.growingio.com/2.1/gio.js","gio");
    gio('init', 'cc683d67407a283ba8d0382c43e8ca28', {});
    gio('send');
  </script>

  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">EVE | 暴风雨前夕</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Lance的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%84%E8%A7%88"><span class="nav-number">2.</span> <span class="nav-text">预览</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E9%9C%80%E6%B1%82"><span class="nav-number">3.</span> <span class="nav-text">分析需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FLIP"><span class="nav-number">4.</span> <span class="nav-text">FLIP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#First"><span class="nav-number">4.1.</span> <span class="nav-text">First</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Last"><span class="nav-number">4.2.</span> <span class="nav-text">Last</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Invert"><span class="nav-number">4.3.</span> <span class="nav-text">Invert</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Play"><span class="nav-number">4.4.</span> <span class="nav-text">Play</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0"><span class="nav-number">5.</span> <span class="nav-text">实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B9%B1%E5%BA%8F"><span class="nav-number">6.</span> <span class="nav-text">乱序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E5%9C%B0%E5%9D%80"><span class="nav-number">7.</span> <span class="nav-text">源码地址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">8.</span> <span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FLIP-1"><span class="nav-number">8.1.</span> <span class="nav-text">FLIP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web-Animation"><span class="nav-number">8.2.</span> <span class="nav-text">Web Animation</span></a></li></ol></li></ol></div>
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Lance"
      src="/uploads/avatar_lance.jpeg">
  <p class="site-author-name" itemprop="name">Lance</p>
  <div class="site-description" itemprop="description">Front-end developer and iOS developer</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">248</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">57</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">86</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/evestorm" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;evestorm" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1572534835@qq.com" title="E-Mail → mailto:1572534835@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://evestorm.github.io/posts/7822/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar_lance.jpeg">
      <meta itemprop="name" content="Lance">
      <meta itemprop="description" content="Front-end developer and iOS developer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EVE | 暴风雨前夕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          转载-前端动画必知必会：React和Vue都在用的FLIP思想实战
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-05 17:13:07" itemprop="dateCreated datePublished" datetime="2021-03-05T17:13:07+08:00">2021-03-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-03-10 14:07:47" itemprop="dateModified" datetime="2021-03-10T14:07:47+08:00">2021-03-10</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/CSS/" itemprop="url" rel="index"><span itemprop="name">CSS</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/CSS/%E5%8A%A8%E7%94%BB/" itemprop="url" rel="index"><span itemprop="name">动画</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/posts/7822/#SOHUCS" itemprop="discussionUrl">
        <span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="posts/7822/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>转载自：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/146641652">https://zhuanlan.zhihu.com/p/146641652</a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在 Vue 的官网中的过渡动画章节中，可以看到一个很酷炫的**<a href="https://link.zhihu.com/?target=https://cn.vuejs.org/v2/guide/transitions.html%23%E5%88%97%E8%A1%A8%E7%9A%84%E6%8E%92%E5%BA%8F%E8%BF%87%E6%B8%A1">动画效果</a>**</p>
<img src="/posts/7822/v2-741e6456c4471c34f6e346d3032ff323_b.jpg" class="" title="v2-741e6456c4471c34f6e346d3032ff323_b">

<p>乍一看，让我们手写出这个逻辑应该是非常复杂的，先看看本文最后要实现的效果吧，和这个案例是非常类似的。</p>
<a id="more"></a>

<h2 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h2><img src="/posts/7822/v2-67ea1b4e81adc6d0ee281a79c4a9da64_b.jpg" class="" title="v2-67ea1b4e81adc6d0ee281a79c4a9da64_b">

<p>也可以直接进预览网址里看：</p>
<p><a href="https://link.zhihu.com/?target=http://sl1673495.gitee.io/flip-animation">http://sl1673495.gitee.io/flip-animation</a></p>
<p>图片素材依然引用自知乎问题**<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28997505">《有个漂亮女朋友是种怎样的体验？》</a>**，侵删。</p>
<h2 id="分析需求"><a href="#分析需求" class="headerlink" title="分析需求"></a>分析需求</h2><p>拿到了这个需求，第一直觉是怎么做？假设第一行第一个图片移动到了第二行第三列，是不是要计算出第一行的高度，再计算出第二行前两个元素的宽度，然后从初始的坐标点通过 CSS 或者一些动画 API 移动过去？这样做是可以，但是在图片不定高不定宽，并且一次要移动很多图片情况下，这个计算方法就非常复杂了。并且这种情况下，图片的坐标都需要我们手动管理，非常不利于维护和扩展。</p>
<p>换种思路，能不能直接很自然的把 DOM 元素通过原生 API 添加到 DOM 树中，然后让浏览器帮我们好这个终点值，最后我们再动画位移过去？</p>
<p>在文档里我们发现一个名词：<code>FLIP</code>，这给了我们一个线索，是不是用这个玩意就可以写出这个动画呢？</p>
<p>答案是肯定的，顺着这个线索找到 <code>Aerotwist</code> 社区里的一篇文章：**<a href="https://link.zhihu.com/?target=https://aerotwist.com/blog/flip-your-animations/">flip-your-animations</a>**，以这篇文章为切入点，一步步来实现一个类似的效果。</p>
<h2 id="FLIP"><a href="#FLIP" class="headerlink" title="FLIP"></a>FLIP</h2><p><code>FLIP</code> 究竟是什么东西呢？先看下它的定义：</p>
<h3 id="First"><a href="#First" class="headerlink" title="First"></a><strong>First</strong></h3><p>即将做动画的元素的初始状态（比如位置、透明度等等）。</p>
<h3 id="Last"><a href="#Last" class="headerlink" title="Last"></a><strong>Last</strong></h3><p>即将做动画的元素的最终状态。</p>
<h3 id="Invert"><a href="#Invert" class="headerlink" title="Invert"></a><strong>Invert</strong></h3><p>这一步比较关键，假设我们图片的初始位置是 <code>左: 0, 上：0</code>，元素动画后的最终位置是 <code>左：100, 上100</code>，那么很明显这个元素是向右下角运动了 <code>100px</code>。</p>
<p><strong>但是</strong>，此时我们不按照常规思维去先计算它的最终位置，然后再命令元素从 <code>0, 0</code> 运动到 <code>100, 100</code>，而是<strong>先让元素自己移动过去</strong>（比如在 Vue 中用数据来驱动，在数组前面追加几个图片，之前的图片就自己移动到下面去了）。</p>
<p>这里有一个关键的知识点要注意了，也是我在之前的文章**<a href="https://link.zhihu.com/?target=https://juejin.im/post/5ec73026f265da76da29cb25">《深入解析你不知道的 EventLoop 和浏览器渲染、帧动画、空闲回调》</a>**中提到过的：</p>
<p>DOM 元素属性的改变（比如 <code>left</code>、<code>right</code>、 <code>transform</code> 等等），会被集中起来延迟到浏览器的下一帧统一渲染，所以我们可以得到一个这样的中间时间点：<strong>DOM 状态（位置信息）改变了，而浏览器还没渲染</strong>。</p>
<p>有了这个前置条件，我们就可以保证先让 Vue 去操作 DOM 变更，此时浏览器还未渲染，我们已经能得到 DOM 状态变更后的位置了。</p>
<p>说的具体点，假设我们的图片是一行两个排列，图片数组初始化的状态是 <code>[img1, img2</code>，此时我们往数组头部追加两个元素 <code>[img3, img4, img1, img2]</code>，那么 <code>img1</code> 和 <code>img2</code> 就自然而然的被挤到下一行去了。</p>
<p>假设 <code>img1</code> 的初始位置是 <code>0, 0</code>，被数据驱动导致的 DOM 改变挤下去后的位置是 <code>100, 100</code>，那么此时浏览器还没有渲染，我们可以在这个时间点把 <code>img1.style.transform = translate(-100px, -100px)</code>，让它 先 <strong>Invert</strong> 倒置回位移前的位置。</p>
<h3 id="Play"><a href="#Play" class="headerlink" title="Play"></a><strong>Play</strong></h3><p>倒置了以后，想要让它做动画就很简单了，再让它回到 <code>0, 0</code> 的位置即可，本文会采用最新的 <code>Web Animation API</code> 来实现最后的 <code>Play</code>。</p>
<p><strong><a href="https://link.zhihu.com/?target=https://developer.mozilla.org/zh-CN/docs/Web/API/Animation">MDN 文档：Web Animation</a></strong></p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>首先图片渲染很简单，就让图片通过简单的排成 4 列即可：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.wrap</span> &#123;</span></span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: wrap;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="css">  <span class="selector-class">.img</span> &#123;</span></span><br><span class="line">    width: 25%;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img-wrap&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;src in imgs&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;src&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">ref</span>=<span class="string">&quot;imgs&quot;</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;src&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>那么关键点就在于怎么往这个 <code>imgs</code> 数组里追加元素后，做一个流畅的路径动画。</p>
<p>我们来实现追加图片的方法 <code>add</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">add</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> newData = <span class="built_in">this</span>.getSister()</span><br><span class="line">  <span class="keyword">await</span> preload(newData)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先随机的取出几张图片作为待放入数组的元素，利用 <code>new Image</code> 预加载这些图片，防止渲染一堆空白图片到屏幕上。</p>
<p>然后定义一个计算一组 DOM 元素位置的函数 <code>getRects</code>，利用 <code>getBoundingClientRect</code> 可以获得最新的位置信息，这个方法在接下来获取图片元素旧位置和新位置时都要使用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRects</span>(<span class="params">doms</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> doms.map(<span class="function"><span class="params">dom</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> rect = dom.getBoundingClientRect();</span><br><span class="line">    <span class="keyword">const</span> &#123; left, top &#125; = rect;</span><br><span class="line">    <span class="keyword">return</span> &#123; left, top &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当前已有的图片</span></span><br><span class="line"><span class="keyword">const</span> prevImgs = <span class="built_in">this</span>.$refs.imgs.slice();</span><br><span class="line"><span class="keyword">const</span> prevPositions = getRects(prevImgs);</span><br></pre></td></tr></table></figure>

<p>记录完图片的旧位置后，就可以向数组里追加新的图片了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.imgs = newData.concat(<span class="built_in">this</span>.imgs);</span><br></pre></td></tr></table></figure>

<p>随后就是比较关键的点了，我们知道 Vue 是异步渲染的，也就是改变了这个 <code>imgs</code> 数组后不会立刻发生 DOM 的变动，此时我们要用到 <code>nextTick</code> 这个 API，这个 API 把你传入的回调函数放进了 <code>microTask</code> 队列，正如上文提到的事件循环的文章里所说，<code>microTask</code>队列的执行一定发生在浏览器重新渲染前。</p>
<p>由于先调用了 <code>this.imgs = newData.concat(this.imgs)</code> 这段代码，触发了 Vue 的响应式依赖更新，此时 Vue 内部会把本次 DOM 更新的渲染函数先放到 <code>microTask</code>队列中，此时的队列是<code>[changeDOM]</code>。</p>
<p>调用了 <code>nextTick(callback)</code> 后，这个<code>callback</code>函数也会被追加到队列中，此时的队列是 <code>[changeDOM, callback]</code>。</p>
<p>这下聪明的你肯定就明白了，为什么 <code>nextTick</code>的回调函数里一定能获取到最新的 DOM 元素，此时新加入图片的 DOM 已经在 DOM 树中，但是屏幕还没有发生绘制，调用 <code>getBoundingClientRect</code> 可以触发「强制同步布局」，此后的代码里就可以获取到 DOM 在屏幕预计出现的准确位置。（注意，位置信息是最新的，但是屏幕上并没有发生绘制）</p>
<p>由于我们之前保存了图片元素节点的数组 <code>prevImgs</code>，所以在 <code>nextTick</code> 里对这些旧图片再调用一次 <code>getRect</code> 方法，获取到的就是旧图片的最新位置了。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">add</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="comment">// 最新 DOM 状态</span></span><br><span class="line">  <span class="built_in">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 再调用同样的方法获取最新的元素位置</span></span><br><span class="line">    <span class="keyword">const</span> currentPositions = getRects(prevImgs)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>此时我们已经拥有了 <code>Invert</code> 步骤的关键信息，新位置和旧位置，那么接下来就很简单了，把图片数组循环做一个倒置后 <code>Play</code>的动画即可。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">prevImgs.forEach(<span class="function">(<span class="params">imgRef, imgIndex</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> currentPosition = currentPositions[imgIndex];</span><br><span class="line">  <span class="keyword">const</span> prevPosition = prevPositions[imgIndex];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 倒置后的位置，虽然图片移动到最新位置了，但你先给我回去，等着我来让你做动画。</span></span><br><span class="line">  <span class="keyword">const</span> invert = &#123;</span><br><span class="line">    left: prevPosition.left - currentPosition.left,</span><br><span class="line">    top: prevPosition.top - currentPosition.top</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> keyframes = [</span><br><span class="line">    <span class="comment">// 初始位置是倒置后的位置</span></span><br><span class="line">    &#123;</span><br><span class="line">      transform: <span class="string">`translate(<span class="subst">$&#123;invert.left&#125;</span>px, <span class="subst">$&#123;invert.top&#125;</span>px)`</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 图片更新后本来应该在的位置</span></span><br><span class="line">    &#123; <span class="attr">transform</span>: <span class="string">&#x27;translate(0)&#x27;</span> &#125;</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> options = &#123;</span><br><span class="line">    duration: <span class="number">300</span>,</span><br><span class="line">    easing: <span class="string">&#x27;cubic-bezier(0,0,0.32,1)&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 开始运动！</span></span><br><span class="line">  <span class="keyword">const</span> animation = imgRef.animate(keyframes, options);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>此时一个非常流畅的路径动画效果就完成了。</p>
<p>完整实现如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">add</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> newData = <span class="built_in">this</span>.getSister()</span><br><span class="line">  <span class="keyword">await</span> preload(newData)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> prevImgs = <span class="built_in">this</span>.$refs.imgs.slice()</span><br><span class="line">  <span class="keyword">const</span> prevPositions = getRects(prevImgs)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">this</span>.imgs = newData.concat(<span class="built_in">this</span>.imgs)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> currentPositions = getRects(prevImgs)</span><br><span class="line"></span><br><span class="line">    prevImgs.forEach(<span class="function">(<span class="params">imgRef, imgIndex</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> currentPosition = currentPositions[imgIndex]</span><br><span class="line">      <span class="keyword">const</span> prevPosition = prevPositions[imgIndex]</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> invert = &#123;</span><br><span class="line">        left: prevPosition.left - currentPosition.left,</span><br><span class="line">        top: prevPosition.top - currentPosition.top,</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> keyframes = [</span><br><span class="line">        &#123;</span><br><span class="line">          transform: <span class="string">`translate(<span class="subst">$&#123;invert.left&#125;</span>px, <span class="subst">$&#123;invert.top&#125;</span>px)`</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123; <span class="attr">transform</span>: <span class="string">&quot;translate(0)&quot;</span> &#125;,</span><br><span class="line">      ]</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> options = &#123;</span><br><span class="line">        duration: <span class="number">300</span>,</span><br><span class="line">        easing: <span class="string">&quot;cubic-bezier(0,0,0.32,1)&quot;</span>,</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> animation = imgRef.animate(keyframes, options)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h2 id="乱序"><a href="#乱序" class="headerlink" title="乱序"></a>乱序</h2><p>现在我们想要实现官网 demo 中的 <code>shuffle</code> 效果，有了追加图片逻辑的铺垫，是不是已经觉得思路如泉涌了？没错，即使图片被打乱的再厉害，只要我们有「图片开始时的位置」和「图片结束时的位置」，那就可以轻松做到路径动画。</p>
<p>现在我们需要做的是把动画的逻辑抽离出来，我们分析一下整条链路：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">保存旧位置 -&gt; 改变数据驱动视图更新 -&gt; 获得新位置 -&gt; 利用 FLIP 做动画</span><br></pre></td></tr></table></figure>

<p>其实外部只需要传入一个 <code>update</code> 方法告诉我们如何去更新图片数组，就可以把这个逻辑完全抽象到一个函数里去。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">scheduleAnimation</span>(<span class="params">update</span>)</span> &#123;</span><br><span class="line">  <span class="comment">// 获取旧图片的位置</span></span><br><span class="line">  <span class="keyword">const</span> prevImgs = <span class="built_in">this</span>.$refs.imgs.slice()</span><br><span class="line">  <span class="keyword">const</span> prevSrcRectMap = createSrcRectMap(prevImgs)</span><br><span class="line">  <span class="comment">// 更新数据</span></span><br><span class="line">  update()</span><br><span class="line">  <span class="comment">// DOM更新后</span></span><br><span class="line">  <span class="built_in">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> currentSrcRectMap = createSrcRectMap(prevImgs)</span><br><span class="line">    <span class="built_in">Object</span>.keys(prevSrcRectMap).forEach(<span class="function">(<span class="params">src</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> currentRect = currentSrcRectMap[src]</span><br><span class="line">      <span class="keyword">const</span> prevRect = prevSrcRectMap[src]</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> invert = &#123;</span><br><span class="line">        left: prevRect.left - currentRect.left,</span><br><span class="line">        top: prevRect.top - currentRect.top,</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> keyframes = [</span><br><span class="line">        &#123;</span><br><span class="line">          transform: <span class="string">`translate(<span class="subst">$&#123;invert.left&#125;</span>px, <span class="subst">$&#123;invert.top&#125;</span>px)`</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123; <span class="attr">transform</span>: <span class="string">&quot;&quot;</span> &#125;,</span><br><span class="line">      ]</span><br><span class="line">      <span class="keyword">const</span> options = &#123;</span><br><span class="line">        duration: <span class="number">300</span>,</span><br><span class="line">        easing: <span class="string">&quot;cubic-bezier(0,0,0.32,1)&quot;</span>,</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> animation = currentRect.img.animate(keyframes, options)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么追加图片和乱序的函数就变得非常简单了：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 追加图片</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">add</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> newData = <span class="built_in">this</span>.getSister()</span><br><span class="line">  <span class="keyword">await</span> preload(newData)</span><br><span class="line">  <span class="built_in">this</span>.scheduleAnimation(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.imgs = newData.concat(<span class="built_in">this</span>.imgs)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 乱序图片</span></span><br><span class="line"><span class="function"><span class="title">shuffle</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">this</span>.scheduleAnimation(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.imgs = shuffle(<span class="built_in">this</span>.imgs)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="源码地址"><a href="#源码地址" class="headerlink" title="源码地址"></a>源码地址</h2><p><a href="https://link.zhihu.com/?target=https://github.com/sl1673495/flip-animation">https://github.com/sl1673495/flip-animation</a></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="FLIP-1"><a href="#FLIP-1" class="headerlink" title="FLIP"></a><strong>FLIP</strong></h3><p>FLIP 不光可以做位置变化的动画，对于透明度、宽高等等也一样可以很轻松的实现。</p>
<p>比如电商平台中经常会出现一个动画，点击一张商品图片后，商品从它本来的位置慢慢的放大成了一张完整的页面。</p>
<p><code>FLIP</code>的思路掌握后，只要你知道元素动画前的状态和元素动画后的状态，你都可以轻松的通过「倒置状态」后，让它们做一个流畅的动画后到达目的地，并且此时的 DOM 状态是很干净的，而不是通过大量计算的方式强迫它从 <code>0, 0</code> 位移到 <code>100, 100</code>，并且让 DOM 样式上留下 <code>transform: translate(100px, 100px)</code> 类似的字样。</p>
<h3 id="Web-Animation"><a href="#Web-Animation" class="headerlink" title="Web Animation"></a><strong>Web Animation</strong></h3><p>利用 <code>Web Animation API</code> 可以让我们用 JavaScript 更加直观的描述我们需要元素去做的动画，想象一下这个需求如果用 CSS 来做，我们大概会这样去完成这个需求：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> currentImgStyle = currentRect.img.style;</span><br><span class="line">currentImgStyle.transform = <span class="string">`translate(<span class="subst">$&#123;invert.left&#125;</span>px, <span class="subst">$&#123;invert.top&#125;</span>px)`</span>;</span><br><span class="line">currentImgStyle.transitionDuration = <span class="string">&#x27;0s&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>._reflow = <span class="built_in">document</span>.body.offsetHeight;</span><br><span class="line"></span><br><span class="line">currentRect.img.classList.add(<span class="string">&#x27;move&#x27;</span>);</span><br><span class="line"></span><br><span class="line">currentImgStyle.transform = currentRect.img.style.transitionDuration = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">currentRect.img.addEventListener(<span class="string">&#x27;transitionend&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  currentRect.img.classList.remove(<span class="string">&#x27;move&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这是选择用比较原生的方式去控制 CSS 样式实现的 FLIP 动画，这段代码让我觉得不舒服的点在于：</p>
<ol>
<li>需要通过 <code>class</code> 的增加和删除来和 CSS 来进行交互，整体流程不太符合直觉。</li>
<li>需要监听动画完成事件，并且做一些清理操作，容易遗漏。</li>
<li>需要利用 <code>document.body.offsetHeight</code> 这样的方式触发 <code>强制同步布局</code>，比较 hack 的知识点。</li>
<li>需要利用 <code>this._reflow = document.body.offsetHeight</code> 这样的方式向元素实例上增加一个没有意义的属性，防止被 Rollup 等打包工具 <code>tree-shaking</code> 误删。 比较 hack 的知识点 +1。</li>
</ol>
<p>而利用 <code>Web Animation API</code> 的代码则变得非常符合直觉和易于维护：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> keyframes = [</span><br><span class="line">  &#123;</span><br><span class="line">    transform: <span class="string">`translate(<span class="subst">$&#123;invert.left&#125;</span>px, <span class="subst">$&#123;invert.top&#125;</span>px)`</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">transform</span>: <span class="string">&#x27;&#x27;</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  duration: <span class="number">300</span>,</span><br><span class="line">  easing: <span class="string">&#x27;cubic-bezier(0,0,0.32,1)&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> animation = currentRect.img.animate(keyframes, options);</span><br></pre></td></tr></table></figure>

<p>关于兼容性问题，W3C 已经提供了 **<code>Web Animation API Polyfill</code>**，可以放心大胆的使用。</p>
<p>期待在不久的未来，我们可以抛弃旧的动画模式，迎接这种更新更好的 API。</p>
<p>希望这篇文章能让对动画发愁的你有一些收获，谢谢！</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%8A%80%E5%B7%A7/" rel="tag"><i class="fa fa-tag"></i> 技巧</a>
              <a href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag"><i class="fa fa-tag"></i> 转载</a>
              <a href="/tags/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" rel="tag"><i class="fa fa-tag"></i> 解决方案</a>
              <a href="/tags/%E5%8A%A8%E7%94%BB/" rel="tag"><i class="fa fa-tag"></i> 动画</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/463/" rel="prev" title="封装element-ui的el-upload实现上传删除和预览">
                  <i class="fa fa-chevron-left"></i> 封装element-ui的el-upload实现上传删除和预览
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/42521/" rel="next" title="element-ui表单验证切换国际化后失效解决方案">
                  element-ui表单验证切换国际化后失效解决方案 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments">
    <div id="SOHUCS"></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lance</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  

<script src="/js/local-search.js"></script>






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






  <script>
  NexT.utils.loadComments('#SOHUCS', () => {
    NexT.utils.getScript('https://changyan.sohu.com/upload/changyan.js', () => {
      window.changyan.api.config({
        appid: 'cyvaqAKVv',
        conf : 'c7535289deb20d0d9235ebae6a69b912'
      });
    });
  });
  </script>
  <script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script>
<!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/clipboard.min.js"></script>  
<script type="text/javascript" src="/js/clipboard-use.js"></script>
</body>
</html>
